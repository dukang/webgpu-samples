{"version":3,"sources":["webpack:///./src/glslang.ts","webpack:///./src/cube.ts","webpack:///./node_modules/gl-matrix/esm/common.js","webpack:///./node_modules/gl-matrix/esm/mat4.js","webpack:///./node_modules/gl-matrix/esm/vec3.js","webpack:///./node_modules/dat.gui/build/dat.gui.module.js","webpack:///./node_modules/codemirror/lib/codemirror.js"],"names":["glslang","undefined","glslangModule","import","default","cubeVertexSize","cubePositionOffset","cubeColorOffset","cubeUVOffset","cubeVertexArray","Float32Array","EPSILON","ARRAY_TYPE","Array","RANDOM","Math","random","PI","create","out","clone","a","copy","fromValues","m00","m01","m02","m03","m10","m11","m12","m13","m20","m21","m22","m23","m30","m31","m32","m33","set","identity","transpose","a01","a02","a03","a12","a13","a23","invert","a00","a10","a11","a20","a21","a22","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","adjoint","determinant","multiply","b","b0","b1","b2","b3","translate","v","x","y","z","rotate","rad","axis","s","c","t","b12","b20","b21","b22","len","hypot","sin","cos","rotateX","rotateY","rotateZ","fromTranslation","fromScaling","fromRotation","fromXRotation","fromYRotation","fromZRotation","fromRotationTranslation","q","w","x2","y2","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","fromQuat2","translation","bx","by","bz","bw","ax","ay","az","aw","magnitude","getTranslation","mat","getScaling","getRotation","scaling","is1","is2","is3","sm11","sm12","sm13","sm21","sm22","sm23","sm31","sm32","sm33","trace","S","sqrt","fromRotationTranslationScale","sx","sy","sz","fromRotationTranslationScaleOrigin","o","ox","oy","oz","out0","out1","out2","out4","out5","out6","out8","out9","out10","fromQuat","yx","zx","zy","frustum","left","right","bottom","top","near","far","rl","tb","nf","perspective","fovy","aspect","f","tan","Infinity","perspectiveFromFieldOfView","fov","upTan","upDegrees","downTan","downDegrees","leftTan","leftDegrees","rightTan","rightDegrees","xScale","yScale","ortho","lr","bt","lookAt","eye","center","up","x0","x1","y0","y1","z0","z1","eyex","eyey","eyez","upx","upy","upz","centerx","centery","centerz","abs","targetTo","target","str","frob","add","subtract","multiplyScalar","multiplyScalarAndAdd","scale","exactEquals","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","a14","a15","b4","b5","b6","b7","b8","b9","b13","b14","b15","max","i","arguments","length","mul","sub","divide","ceil","floor","min","round","scaleAndAdd","distance","squaredDistance","squaredLength","negate","inverse","normalize","dot","cross","lerp","hermite","d","factorTimes2","factor1","factor2","factor3","factor4","bezier","inverseFactor","inverseFactorTimesTwo","r","zScale","transformMat4","m","transformMat3","transformQuat","qx","qy","qz","qw","uvx","uvy","uvz","uuvx","uuvy","uuvz","w2","p","angle","mag","cosine","acos","zero","vec","div","dist","sqrDist","sqrLen","forEach","stride","offset","count","fn","arg","l","colorToString","color","forceCSSHex","colorFormat","__state","conversionName","toString","g","h","toFixed","hex","ARR_EACH","prototype","ARR_SLICE","slice","Common","BREAK","extend","this","each","call","obj","isObject","Object","keys","key","isUndefined","bind","defaults","compose","toCall","args","apply","itr","scope","_key","defer","fnc","setTimeout","debounce","func","threshold","callImmediately","timeout","delayed","callNow","clearTimeout","toArray","isNull","isNaN","_isNaN","_x","isArray","constructor","isNumber","isString","isBoolean","isFunction","INTERPRETATIONS","litmus","conversions","THREE_CHAR_HEX","read","original","test","match","space","parseInt","write","SIX_CHAR_HEX","CSS_RGB","parseFloat","CSS_RGBA","HEX","RGB_ARRAY","RGBA_ARRAY","RGBA_OBJ","RGB_OBJ","HSVA_OBJ","HSV_OBJ","result","toReturn","interpret","family","conversion","tmpComponent","ColorMath","hsv_to_rgb","hi","rgb_to_hsv","delta","NaN","rgb_to_hex","hex_with_component","component_from_hex","componentIndex","value","_typeof","Symbol","iterator","classCallCheck","instance","Constructor","TypeError","createClass","defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","protoProps","staticProps","get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","parent","getPrototypeOf","getter","inherits","subClass","superClass","setPrototypeOf","__proto__","possibleConstructorReturn","self","ReferenceError","Color","Error","defineRGBComponent","component","componentHexIndex","recalculateRGB","defineHSVComponent","recalculateHSV","COMPONENTS","Controller","initialValue","domElement","document","createElement","__onChange","__onFinishChange","newValue","updateDisplay","getValue","EVENT_MAP_INV","HTMLEvents","MouseEvents","KeyboardEvents","k","e","CSS_VALUE_PIXELS","cssValueToPixels","val","dom","makeSelectable","elem","selectable","style","onselectstart","MozUserSelect","KhtmlUserSelect","unselectable","makeFullscreen","hor","vert","vertical","horizontal","position","fakeEvent","eventType","pars","aux","params","className","evt","createEvent","clientX","clientY","initMouseEvent","bubbles","cancelable","window","clickCount","init","initKeyboardEvent","initKeyEvent","ctrlKey","altKey","shiftKey","metaKey","keyCode","charCode","initEvent","dispatchEvent","event","newBool","bool","addEventListener","attachEvent","unbind","removeEventListener","detachEvent","addClass","classes","split","indexOf","push","join","replace","removeClass","removeAttribute","index","splice","hasClass","RegExp","getWidth","getComputedStyle","width","getHeight","height","getOffset","el","offsetParent","offsetLeft","offsetTop","isActive","activeElement","type","href","BooleanController","_Controller","_this2","_this","__prev","__checkbox","setAttribute","setValue","appendChild","checked","OptionController","opts","options","__select","map","element","opt","innerHTML","desiredValue","selectedIndex","StringController","onChange","__input","blur","numDecimals","NumberController","_params","__min","__max","__step","step","__impliedStep","pow","log","LN10","__precision","_v","minValue","maxValue","stepValue","NumberControllerBox","_NumberController","__truncationSuspended","prevY","onFinish","onMouseDrag","diff","onMouseUp","attempted","decimals","tenTo","i1","i2","o1","o2","NumberControllerSlider","preventDefault","bgRect","__background","getBoundingClientRect","onTouchMove","touches","onTouchEnd","__foreground","pct","FunctionController","text","__button","fire","ColorController","__color","__temp","__selector","__saturation_field","__field_knob","__field_knob_border","__hue_knob","__hue_field","__input_textShadow","onBlur","valueField","fieldDown","setSV","fieldUpSV","fieldDownH","setH","fieldUpH","toOriginal","fieldRect","_ref","padding","backgroundColor","boxShadow","border","borderRadius","zIndex","borderRight","marginRight","display","cursor","background","linearGradient","cssText","outline","textAlign","fontWeight","textShadow","mismatch","flip","_flip","marginLeft","marginTop","toHexString","vendors","vendor","css","cssContent","indoc","doc","injected","head","getElementsByTagName","saveDialogContents","ControllerFactory","requestAnimationFrame$1","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","CenteredDiv","backgroundElement","opacity","WebkitTransition","transition","body","hide","webkitTransform","layout","innerWidth","innerHeight","___$insertStyle","SUPPORTS_LOCAL_STORAGE","localStorage","SAVE_DIALOGUE","autoPlaceVirgin","autoPlaceContainer","hideableGuis","GUI","__ul","__folders","__controllers","__rememberedObjects","__rememberedObjectIndecesToControllers","__listening","closeOnTop","autoPlace","DEFAULT_WIDTH","resizable","hideable","load","preset","scrollable","root","useLocalStorage","getItem","getLocalStorageHash","saveToLocalStorage","titleRow","getRoot","gui","__preset_select","setPresetSelectIndex","revert","setWidth","name","closed","CLASS_CLOSED","onResize","__closeButton","TEXT_OPEN","TEXT_CLOSED","setItem","CLASS_MAIN","savedGui","JSON","parse","CLASS_CLOSE_BUTTON","CLASS_CLOSE_TOP","insertBefore","childNodes","CLASS_CLOSE_BOTTOM","titleRowName","createTextNode","addRow","CLASS_AUTO_PLACE_CONTAINER","CLASS_AUTO_PLACE","__resizeHandler","onResizeDebounced","addResizeHandle","stringify","getSaveObject","saveToLocalStorageIfPossible","newDom","liBefore","li","removeListeners","markPresetModified","modified","recallSavedValue","controller","matchedIndex","controllerMap","remembered","presetMap","_add","factoryArgs","concat","before","__li","container","CLASS_CONTROLLER_ROW","__gui","_options","nextSibling","nextElementSibling","remove","_nextSibling","_name","firstElementChild","listen","box","method","pc","pb","returned","oldName","wasListening","newController","stopPropagation","borderLeftColor","isModified","augmentController","location","addPresetOption","setSelected","showHideExplain","explain","addSaveMenu","__save_row","firstChild","gears","button","button2","button3","select","getElementById","localStorageCheckBox","newConstructorTextArea","which","show","focus","save","presetName","prompt","saveAs","pmouseX","drag","dragStop","CLASS_DRAG","dragStart","__resize_handle","getCurrentPreset","useInitialValues","savedValues","toggleHide","CLASS_TOO_TALL","_keydownHandler","addColor","removeChild","destroy","subfolder","removeFolder","addFolder","newGuiParams","folders","folder","parentElement","open","close","node","offsetHeight","remember","updateDisplays","controllerArray","GUI$1","module","exports","userAgent","navigator","platform","gecko","ie_upto10","ie_11up","exec","edge","ie","ie_version","documentMode","webkit","qtwebkit","chrome","presto","safari","mac_geMountainLion","phantom","ios","android","mobile","mac","chromeOS","windows","presto_version","Number","flipCtrlCmd","captureRightClick","classTest","cls","range","rmClass","current","after","removeChildren","removeChildrenAndAdd","elt","tag","content","eltP","contains","child","nodeType","parentNode","host","activeElt","shadowRoot","joinClasses","as","createRange","start","end","endNode","setEnd","setStart","createTextRange","moveToElementText","collapse","moveEnd","moveStart","selectInput","copyObj","overwrite","prop","hasOwnProperty","countColumn","string","tabSize","startIndex","startValue","search","n","nextTab","selectionStart","selectionEnd","_e","Delayed","id","time","handler","onTimeout","array","Date","ms","Pass","sel_dontScroll","scroll","sel_mouse","origin","sel_move","findColumn","goal","pos","col","skipped","spaceStrs","spaceStr","lst","arr","nothing","createObj","base","inst","nonASCIISingleCaseWordChar","isWordCharBasic","ch","toUpperCase","toLowerCase","isWordChar","helper","source","isEmpty","extendingChars","isExtendingChar","charCodeAt","skipExtendingChars","dir","charAt","findFirst","pred","from","to","midF","mid","bidiOther","getBidiPartAt","order","sticky","found","cur","bidiOrdering","bidiRE","isNeutral","isStrong","countsAsLeft","countsAsNum","BidiSpan","level","direction","outerType","code","types","i$1","prev","i$2","type$1","i$3","prev$1","type$2","i$4","type$3","j","i$5","cur$1","type$4","i$6","end$1","replace$1","j$1","i$7","at","isRTL","j$2","nstart","unshift","reverse","getOrder","line","noHandlers","on","emitter","_handlers","getHandlers","off","signal","handlers","signalDOMEvent","cm","override","defaultPrevented","e_defaultPrevented","codemirrorIgnore","signalCursorActivity","cursorActivity","curOp","cursorActivityHandlers","hasHandler","eventMixin","ctor","e_preventDefault","returnValue","e_stopPropagation","cancelBubble","e_stop","e_target","srcElement","e_button","zwspSupported","badBidiRects","dragAndDrop","zeroWidthElement","measure","offsetWidth","hasBadBidiRects","txt","r0","r1","splitLinesAuto","nl","rt","hasSelection","getSelection","te","ownerDocument","selection","compareEndPoints","hasCopyEvent","oncopy","badZoomedRects","modes","mimeModes","defineMode","mode","dependencies","resolveMode","spec","getMode","mfactory","modeObj","modeExtensions","exts","helperType","modeProps","prop$1","extendMode","properties","copyState","state","nstate","innerMode","info","startState","StringStream","lineOracle","lastColumnPos","lastColumnValue","lineStart","getLine","first","size","chunk","lines","children","chunkSize","getBetween","iter","getLines","updateLineHeight","lineNo","no","lineAtHeight","outer","lh","isLine","lineNumberFor","String","lineNumberFormatter","firstLineNumber","Pos","cmp","equalCursorPos","copyPos","maxPos","minPos","clipLine","clipPos","last","linelen","clipToLen","clipPosArray","eol","sol","peek","next","eat","eatWhile","eatSpace","skipToEnd","skipTo","backUp","column","indentation","pattern","consume","caseInsensitive","cased","substr","hideFirstChars","inner","lookAhead","oracle","baseToken","SavedContext","Context","maxLookAhead","baseTokens","baseTokenPos","highlightLine","context","forceToEnd","st","modeGen","lineClasses","runMode","loop","overlay","overlays","i_end","opaque","styles","bgClass","textClass","getLineStyles","updateFrontier","getContextBefore","resetState","maxHighlightLength","stateAfter","styleClasses","highlightFrontier","modeFrontier","precise","minindent","minline","lim","indented","findStartLine","saved","fromSaved","processLine","viewFrom","viewTo","nextLine","startAt","stream","callBlankLine","readToken","blankLine","token","Token","takeToken","asArray","tokens","extractLineClasses","output","lineClass","flattenSpans","curStart","curStyle","addModeClass","mName","sawReadOnlySpans","sawCollapsedSpans","MarkedSpan","marker","getMarkedSpanFor","spans","span","removeMarkedSpan","stretchSpansOverChange","change","full","oldFirst","markedSpans","oldLast","startCh","endCh","isInsert","old","nw","inclusiveLeft","insertLeft","endsAfter","inclusiveRight","markedSpansBefore","startsBefore","markedSpansAfter","sameLine","span$1","clearEmptySpans","newMarkers","gapMarkers","gap","clearWhenEmpty","detachMarkedSpans","detachLine","attachMarkedSpans","attachLine","extraLeft","extraRight","compareCollapsedMarkers","lenDiff","aPos","find","bPos","fromCmp","toCmp","collapsedSpanAtSide","sps","sp","collapsed","collapsedSpanAtStart","collapsedSpanAtEnd","collapsedSpanAround","conflictingCollapsedRange","visualLine","merged","visualLineNo","lineN","vis","visualLineEndNo","lastLine","lineIsHidden","widgetNode","lineIsHiddenInner","heightAtLine","lineObj","lineLength","found$1","findMaxLine","maxLine","maxLineLength","maxLineChanged","Line","estimateHeight","cleanUpLine","styleToClassCache","styleToClassCacheWithMode","interpretTokenStyle","cache","buildLineContent","lineView","builder","pre","trailingSpace","splitSpaces","getOption","rest","addToken","buildToken","buildTokenBadBidi","insertLineContent","externalMeasured","maps","caches","lastChild","querySelector","defaultSpecialCharPlaceholder","title","startStyle","endStyle","attributes","displayText","trailingBefore","spaceBefore","special","specialChars","mustWrap","createDocumentFragment","lastIndex","txt$1","tabWidth","specialCharPlaceholder","fullStyle","attr","part","buildCollapsedSpan","ignoreWidget","widget","input","needsContentAttribute","setUneditable","allText","spanStyle","spanEndStyle","spanStartStyle","nextChange","foundBookmarks","endStyles","upto","tokenText","LineView","visualLineContinued","hidden","buildViewArray","nextPos","view","operationGroup","orphanDelayedCallbacks","signalLater","list","delayedCallbacks","fireOrphanDelayed","updateLineForChanges","dims","changes","updateLineText","updateLineGutter","updateLineClasses","updateLineWidgets","ensureLineWrapped","replaceChild","getLineContent","ext","built","wrap","updateLineBackground","wrapClass","gutter","gutterBackground","gutterClass","fixedGutter","fixedPos","gutterTotalWidth","markers","gutterMarkers","lineNumbers","wrap$1","gutterWrap","lineNumber","gutterLeft","gutterSpecs","gutterWidth","alignable","isWidget","insertLineWidgets","buildLineElement","insertLineWidgetsFor","allowAbove","widgets","ws","handleMouseEvents","positionLineWidget","above","noHScroll","wrapperWidth","coverGutter","paddingLeft","widgetHeight","parentStyle","gutters","wrapper","clientWidth","eventInWidget","getAttribute","sizer","mover","paddingTop","lineSpace","paddingVert","paddingH","cachedPaddingH","currentStyle","data","paddingRight","scrollGap","nativeBarWidth","displayWidth","scroller","barWidth","displayHeight","clientHeight","barHeight","mapFromLineView","measureChar","bias","measureCharPrepared","prepareMeasureForLine","findViewForLine","findViewIndex","getDimensions","forceUpdate","lineMeasure","updateExternalMeasurement","rect","hasHeights","prepared","varHeight","wrapping","lineWrapping","curWidth","heights","rects","getClientRects","ensureLineHeights","place","nodeAndOffsetInLineMap","coverStart","coverEnd","getUsefulRect","screen","logicalXDPI","deviceXDPI","normal","fromRange","hasBadZoomedRects","scaleX","scaleY","logicalYDPI","deviceYDPI","maybeUpdateRectForZooming","rSpan","charWidth","nullRect","rtop","rbot","bot","bogus","singleCursorHeightPerLine","rbottom","measureCharInner","measureText","mStart","mEnd","clearLineMeasurementCacheFor","clearLineMeasurementCache","externalMeasure","clearCaches","cachedCharWidth","cachedTextHeight","lineNumChars","pageScrollX","pageXOffset","documentElement","scrollLeft","pageScrollY","pageYOffset","scrollTop","widgetTopHeight","intoCoordSystem","includeWidgets","yOff","viewOffset","lOff","xOff","fromCoordSystem","coords","localBox","lineSpaceBox","charCoords","cursorCoords","preparedMeasure","getBidi","partPos","other","estimateCoords","PosWithInfo","outside","xRel","coordsChar","coordsCharInner","rangeEnd","wrappedLineExtent","begin","wrappedLineExtentChar","boxIsAfter","ltr","coordsBidiPartWrapped","coordsBidiPart","baseX","chAround","boxAround","atLeft","atStart","_lineNo","ref","closestDist","endX","textHeight","anchor","clientLeft","compensateForHScroll","th","perLine","widgetsHeight","estimateLineHeights","est","estHeight","posFromMouse","liberal","forRect","colDiff","regChange","lendiff","updateLineNumbers","viewChanged","resetView","cut","viewCuttingPoint","cut$1","cutTop","cutBot","regLineChange","oldN","newN","countDirtyView","dirty","updateSelection","showSelection","prepareSelection","primary","curFragment","cursors","selFragment","sel","ranges","primIndex","empty","showCursorWhenSelecting","drawSelectionCursor","drawSelectionRange","cursorHeight","otherCursor","cmpCoords","fragment","leftSide","rightSide","sizerWidth","docLTR","drawForLine","fromArg","toArg","lineLen","wrapX","side","extent","iterateBidiSections","fromPos","toPos","openStart","openEnd","openRight","topLeft","topRight","botLeft","botRight","sFrom","sTo","fromLine","toLine","singleVLine","leftEnd","rightStart","restartBlink","focused","clearInterval","blinker","cursorDiv","visibility","cursorBlinkRate","setInterval","ensureFocus","onFocus","delayBlurEvent","delayingBlurEvent","readOnly","selForContextMenu","reset","receivedFocus","shift","updateHeightsInViewport","prevBottom","lineDiv","updateWidgetHeight","chWidth","visibleLines","viewport","ensure","ensureFrom","ensureTo","calculateScrollPos","snapMargin","screentop","docBottom","atTop","atBottom","newTop","screenleft","screenw","tooWide","addToScrollTop","resolveScrollToPos","ensureCursorVisible","getCursor","scrollToPos","margin","cursorScrollMargin","scrollToCoords","scrollToCoordsRange","sPos","updateScrollTop","updateDisplaySimple","setScrollTop","startWorker","forceScroll","scrollHeight","scrollbars","setScrollLeft","isScroller","scrollWidth","alignHorizontally","measureForScrollbars","gutterW","docH","viewHeight","viewWidth","barLeft","docHeight","NativeScrollbars","horiz","tabIndex","checkedZeroWidth","minHeight","minWidth","update","needsH","needsV","sWidth","totalHeight","totalWidth","zeroWidthHack","disableHoriz","enableZeroWidthBar","disableVert","pointerEvents","bar","delay","maybeDisable","elementFromPoint","clear","NullScrollbars","updateScrollbars","startWidth","startHeight","updateScrollbarsInner","sizes","paddingBottom","heightForcer","borderBottom","scrollbarFiller","coverGutterNextToScrollbar","gutterFiller","scrollbarModel","initScrollbars","scrollbarStyle","nextOpId","startOperation","op","updateInput","typing","changeObjs","cursorActivityCalled","selectionChanged","updateMaxLine","ops","ownsGroup","endOperation","endCb","group","callbacks","fireCallbacksForOps","finishOperation","endOperation_R1","endOperation_W1","endOperation_R2","endOperation_W2","endOperation_finish","endOperations","scrollbarsClipped","marginBottom","borderRightWidth","maybeClipScrollbars","mustUpdate","DisplayUpdate","updatedDisplay","updateDisplayIfNeeded","barMeasure","adjustWidthTo","maxScrollLeft","preparedSelection","takeFocus","setDocumentHeight","postUpdateDisplay","wheelStartX","wheelStartY","doScroll","scrollNode","scrollIntoView","maybeScrollWindow","limit","changed","endCoords","scrollPos","startTop","startLeft","scrollPosIntoView","maybeHiddenMarkers","unhidden","maybeUnhiddenMarkers","finish","runInOp","operation","methodOp","docMethodOp","highlight","highlightWorker","workTime","changedLines","oldStyles","highlighted","oldCls","newCls","ischange","workDelay","force","visible","editorIsHidden","wrapperHeight","oldDisplayWidth","events","renderedView","maybeUpdateLineNumberWidth","viewportMargin","different","lastWrapHeight","lastWrapWidth","adjustView","toUpdate","selSnapshot","hasFocus","active","anchorNode","anchorOffset","focusNode","focusOffset","selectionSnapshot","updateNumbersFrom","rm","currentWheelTarget","updateNumber","patchDisplay","snapshot","removeAllRanges","addRange","restoreSelection","selectionDiv","reportedViewFrom","reportedViewTo","updateGutterSpace","alignWidgets","comp","align","innerW","lineGutter","lineNumInnerWidth","lineNumWidth","getGutters","sawLineNumbers","renderGutters","specs","gElt","updateGutters","Display","draggable","wheelDX","wheelDY","activeTouch","wheelSamples","wheelPixelsPerUnit","wheelEventDelta","dx","wheelDeltaX","dy","wheelDeltaY","detail","HORIZONTAL_AXIS","VERTICAL_AXIS","wheelDelta","wheelEventPixels","onScrollWheel","canScrollX","canScrollY","pixels","movedX","movedY","sample","Selection","equals","here","there","deepCopy","Range","somethingSelected","normalizeSelection","mayTouch","selectionsMayTouch","prim","sort","inv","simpleSelection","changeEnd","adjustForChange","computeSelAfterChange","offsetPos","loadMode","modeOption","resetModeState","isWholeLineUpdate","wholeLineUpdateBefore","updateDoc","spansFor","updateLine","linesFor","firstLine","lastText","lastSpans","nlines","insert","added","added$1","added$2","linkedDocs","sharedHistOnly","propagate","skip","sharedHist","linked","rel","shared","attachDoc","setDirectionClass","History","startGen","done","undone","undoDepth","lastModTime","lastSelTime","lastOp","lastSelOp","lastOrigin","lastSelOrigin","generation","maxGeneration","historyChangeFromChange","histChange","attachLocalSpans","clearSelectionEvents","pop","addChangeToHistory","selAfter","opId","hist","history","historyEventDelay","lastChangeEvent","pushSelectionToHistory","addSelectionToHistory","selectionEventCanBeMerged","clearRedo","dest","existing","removeClearedSpans","explicitlyCleared","mergeOldSpans","getOldSpans","stretched","oldCur","stretchCur","copyHistoryArray","newGroup","instantiateSel","newChanges","extendRange","posBefore","extendSelection","setSelection","extendSelections","heads","replaceOneSelection","setSimpleSelection","setSelectionReplaceHistory","setSelectionNoUndo","filterSelectionChange","setSelectionInner","skipAtomicInSelection","reCheckSelection","mayClear","newAnchor","skipAtomic","newHead","skipAtomicInner","oldPos","preventCursorLeft","selectLeft","preventCursorRight","selectRight","atomic","movePos","cantEdit","selectAll","filterChange","canceled","cancel","makeChange","ignoreReadOnly","suppressEdits","mark","parts","mk","newParts","dfrom","dto","removeReadOnlyRanges","makeChangeInner","makeChangeSingleDoc","rebased","rebaseHist","makeChangeFromHistory","allowSelectionOnly","suppress","antiChanges","filter","shiftDoc","removed","recomputeMaxLength","checkWidthStart","retreatFrontier","changesHandler","changeHandler","makeChangeSingleDocInEditor","replaceRange","assign","splitLines","rebaseHistSelSingle","rebaseHistArray","ok","copied","changeLine","handle","changeType","LeafChunk","BranchChunk","removeInner","insertInner","iterN","oldHeight","remaining","leaf","maybeSpill","me","sibling","myIndex","used","LineWidget","adjustScrollWhenAboveVisible","this$1","oldH","nextMarkerId","TextMarker","markText","cloneNode","isParent","SharedTextMarker","markTextShared","replacedWith","addToHistory","curLine","addMarkedSpan","clearOnEnter","clearHistory","withOp","visual","dHeight","findSharedMarkers","findMarks","detachSharedMarkers","subMarker","nextDocId","Doc","lineSep","cleanGeneration","lineSeparator","getRange","getLineHandle","getLineNumber","getLineHandleVisualStart","lineCount","listSelections","setCursor","extendSelectionsBy","setSelections","addSelection","getSelections","replaceSelection","dup","replaceSelections","newSel","hint","oldPrev","newPrev","computeReplacedSel","undo","redo","undoSelection","redoSelection","setExtending","getExtending","historySize","markClean","changeGeneration","forceSplit","isClean","gen","getHistory","setHistory","histData","setGutterMarker","gutterID","clearGutter","lineInfo","addLineClass","where","removeLineClass","addLineWidget","insertAt","aboveVisible","removeLineWidget","setBookmark","realOpts","findMarksAt","getAllMarks","posFromIndex","sepSize","indexFromPos","copyHistory","linkedDoc","mFrom","mTo","subMark","copySharedMarkers","unlinkDoc","CodeMirror","splitIds","iterLinkedDocs","getEditor","setDirection","eachLine","lastDrop","onDrop","clearDragCursor","files","dataTransfer","isReadOnly","FileReader","File","markAsReadAndPasteIfAllFilesAreRead","readTextFromFile","file","allowDropFileTypes","reader","onerror","onload","readAsText","draggingText","text$1","getData","selected","dragCursor","forEachCodeMirror","getElementsByClassName","byClass","editors","globalsRegistered","ensureGlobalHandlers","resizeTimer","setSize","keyNames","3","8","9","13","16","17","18","19","20","27","32","33","34","35","36","37","38","39","40","44","45","46","59","61","91","92","93","106","107","109","110","111","145","173","186","187","188","189","190","191","192","219","220","221","222","63232","63233","63234","63235","63272","63273","63275","63276","63277","63302","fromCharCode","keyMap","normalizeKeyName","alt","ctrl","cmd","mod","normalizeKeyMap","keymap","keyname","lookupKey","getKeyMap","fallthrough","isModifierKey","addModifierNames","noShift","keyName","altGraphKey","deleteNearSelection","compute","kill","toKill","replaced","moveCharLogically","moveLogically","endOfLine","visually","prep","targetTop","basic","pcDefault","emacsy","macDefault","commands","singleSelection","killLine","deleteLine","delLineLeft","delWrappedLineLeft","delWrappedLineRight","rightPos","goDocStart","goDocEnd","goLineStart","goLineStartSmart","lineStartSmart","goLineEnd","visualLineEnd","lineEnd","goLineRight","goLineLeft","goLineLeftSmart","goLineUp","moveV","goLineDown","goPageUp","goPageDown","goCharLeft","moveH","goCharRight","goColumnLeft","goColumnRight","goWordLeft","goGroupRight","goGroupLeft","goWordRight","delCharBefore","deleteH","delCharAfter","delWordBefore","delWordAfter","delGroupBefore","delGroupAfter","indentAuto","indentSelection","indentMore","indentLess","insertTab","insertSoftTab","spaces","defaultTab","execCommand","transposeChars","newlineAndIndent","sels","indentLine","openLine","toggleOverwrite","firstNonWS","inWS","doHandleBinding","bound","dropShift","ensurePolled","prevShift","stopSeq","dispatchKey","seq","keySeq","dispatchKeyInner","keyMaps","extraKeys","lookupKeyForEditor","handleKeyBinding","motion","lastStoppedKey","onKeyDown","handled","showCrossHair","onKeyUp","onKeyPress","handleCharBinding","lastClick","lastDoubleClick","PastClick","onMouseDown","supportsTouch","clickInGutter","repeat","now","compare","clickRepeat","selectingText","handleMappedButton","contained","behavior","option","unit","addNew","moveOnDrag","configureMouse","dragDrop","moved","dragEnd","mouseMove","e2","leftButtonStartDrag","ourRange","ourIndex","startSel","rangeForUnit","lastPos","extendTo","startCol","posCol","leftPos","oldRange","ranges$1","anchorLine","boundary","headIndex","usePart","bidiSimplify","editorSize","counter","move","buttons","curCount","leftButtonSelect","leftButtonDown","onContextMenu","findWordAt","gutterEvent","prevent","mX","mY","lineBox","contextMenuInGutter","themeChanged","theme","Init","optionHandlers","dragDropChanged","funcs","dragFunctions","toggle","enter","over","leave","drop","wrappingChanged","inputStyles","inputStyle","pasteIncoming","cutIncoming","autofocus","word","getField","touchFinished","prevTouch","finishTouch","farAway","touch","radiusX","radiusY","isMouseLikeTouchEvent","pageX","pageY","frag","onDragOver","setData","effectAllowed","setDragImage","img","src","_top","onDragStart","inp","registerEventHandlers","finishInit","initHooks","textRendering","how","aggressive","indent","curSpace","curSpaceString","indentUnit","indentString","indentWithTabs","pos$1","defineInitHook","lastCopied","setLastCopied","newLastCopied","applyTextInput","inserted","deleted","recent","paste","textLines","multiPaste","pasteLinesPerSelection","lineWise","changeEvent","triggerElectric","handlePaste","pasted","clipboardData","disableInput","electricChars","smartIndent","getModeAt","electricInput","copyableRanges","lineRange","disableBrowserMagic","field","spellcheck","autocorrect","autocapitalize","hiddenTextarea","findPosH","origDir","lineDir","moveOnce","boundToLine","bidi","mv","getWrappedLineExtent","moveInStorageOrder","searchInVisualLine","getRes","res","nextCh","moveVisually","sawType","getHelper","hitSide","findPosV","pageSize","moveAmount","ContentEditableInput","lastAnchorNode","lastAnchorOffset","lastFocusNode","lastFocusOffset","polling","composing","gracePeriod","readDOMTimeout","posToDOM","badPos","bad","domToPos","lineNode","locateNodeInLineView","textNode","topNode","nodeValue","curNode","textContent","previousSibling","dist$1","onCopyCut","lineWiseCopyCut","clearData","kludge","hadFocus","showPrimarySelection","updateFromDOM","readFromDOMSoon","forceCompositionEnd","showMultipleSelections","curAnchor","curFocus","rng","rangeCount","getRangeAt","startGracePeriod","rememberSelection","selectionInEditor","commonAncestorContainer","pollSelection","pollInterval","poll","scan","isInGutter","triggerOnKeyDown","pollContent","fromIndex","fromNode","toNode","toIndex","newText","closing","extraLinebreak","addText","walk","cmText","markerID","isBlock","nodeName","domTextBetween","oldText","cutFront","cutEnd","oldTop","maxCutFront","newBot","oldBot","maxCutEnd","chFrom","chTo","contentEditable","readOnlyChanged","resetPosition","TextareaInput","prevInput","pollingFast","createField","textarea","prepareCopyCut","fastPoll","Event","_display","moveInputWithCursor","headPos","wrapOff","lineOff","teTop","teLeft","drawn","contextMenuPending","slowPoll","missed","same","resetSelectionOnContextMenu","oldScrollY","oldCSS","oldWrapperCSS","wrapperBox","scrollY","scrollTo","rehide","detectingSelectAll","prepareSelectAllHack","mouseup","extval","disabled","deflt","notOnInit","defineOption","newBreaks","refresh","getInputField","detach","attach","integer","defineOptions","helpers","setOption","getDoc","addKeyMap","removeKeyMap","addOverlay","score","priority","insertSorted","modeSpec","removeOverlay","newRanges","getTokenAt","getLineTokens","getTokenTypeAt","getHelpers","help","_global","getStateAfter","defaultTextHeight","defaultCharWidth","getViewport","addWidget","vspace","hspace","triggerOnKeyPress","triggerOnKeyUp","triggerOnMouseDown","amount","rtlMoveVisually","goalColumn","goals","startChar","check","getScrollInfo","scrollToRange","swapDoc","phrase","phraseText","phrases","getWrapperElement","getScrollerElement","getGutterElement","registerHelper","registerGlobalHelper","predicate","addEditorMethods","dontDelegate","defineMIME","mime","defineExtension","defineDocExtension","fromTextArea","tabindex","placeholder","realSubmit","form","leaveSubmitMethodAlone","submit","wrappedSubmit","getTextArea","toTextArea","cmpPos","addLegacyProps","version","factory"],"mappings":"kYAAA,IAAIA,OAAUC,EACC,e,yCACb,QAAgBA,IAAZD,EAAuB,OAAOA,EAElC,MAAME,QAAsBC,OAAiC,sEAE7D,OADAH,QAAgBE,EAAcE,UACvBJ,O,gCCNT,0KAAO,MAAMK,EAAiB,GACjBC,EAAqB,EACrBC,EAAkB,GAClBC,EAAe,GACfC,EAAkB,IAAIC,aAAa,CAE5C,GAAI,EAAG,EAAG,EAAK,EAAG,EAAG,EAAG,EAAI,EAAG,GAC9B,GAAI,EAAG,EAAG,EAAI,EAAG,EAAG,EAAG,EAAI,EAAG,GAC9B,GAAI,GAAI,EAAG,EAAG,EAAG,EAAG,EAAG,EAAI,EAAG,EAC/B,GAAI,GAAI,EAAG,EAAI,EAAG,EAAG,EAAG,EAAI,EAAG,EAC/B,GAAI,EAAG,EAAG,EAAK,EAAG,EAAG,EAAG,EAAI,EAAG,GAC9B,GAAI,GAAI,EAAG,EAAG,EAAG,EAAG,EAAG,EAAI,EAAG,EAE/B,EAAG,EAAG,EAAG,EAAM,EAAG,EAAG,EAAG,EAAI,EAAG,EAC/B,GAAI,EAAG,EAAG,EAAK,EAAG,EAAG,EAAG,EAAI,EAAG,EAC/B,GAAI,GAAI,EAAG,EAAI,EAAG,EAAG,EAAG,EAAI,EAAG,EAC/B,EAAG,GAAI,EAAG,EAAK,EAAG,EAAG,EAAG,EAAI,EAAG,EAC/B,EAAG,EAAG,EAAG,EAAM,EAAG,EAAG,EAAG,EAAI,EAAG,EAC/B,GAAI,GAAI,EAAG,EAAI,EAAG,EAAG,EAAG,EAAI,EAAG,GAE9B,EAAG,EAAG,EAAG,EAAK,EAAG,EAAG,EAAG,EAAI,EAAG,EAC/B,EAAG,EAAG,EAAG,EAAM,EAAG,EAAG,EAAG,EAAI,EAAG,EAC/B,EAAG,GAAI,EAAG,EAAK,EAAG,EAAG,EAAG,EAAI,EAAG,GAC9B,EAAG,GAAI,EAAG,EAAI,EAAG,EAAG,EAAG,EAAI,EAAG,GAC9B,EAAG,EAAG,EAAG,EAAK,EAAG,EAAG,EAAG,EAAI,EAAG,EAC/B,EAAG,GAAI,EAAG,EAAK,EAAG,EAAG,EAAG,EAAI,EAAG,GAE9B,GAAI,EAAG,EAAG,EAAI,EAAG,EAAG,EAAG,EAAI,EAAG,GAC9B,EAAG,EAAG,EAAG,EAAK,EAAG,EAAG,EAAG,EAAI,EAAG,GAC9B,EAAG,GAAI,EAAG,EAAI,EAAG,EAAG,EAAG,EAAI,EAAG,GAC9B,GAAI,GAAI,EAAG,EAAG,EAAG,EAAG,EAAG,EAAI,EAAG,GAC9B,GAAI,EAAG,EAAG,EAAI,EAAG,EAAG,EAAG,EAAI,EAAG,GAC9B,EAAG,GAAI,EAAG,EAAI,EAAG,EAAG,EAAG,EAAI,EAAG,EAE/B,EAAG,EAAG,EAAG,EAAM,EAAG,EAAG,EAAG,EAAI,EAAG,GAC9B,EAAG,EAAG,EAAG,EAAK,EAAG,EAAG,EAAG,EAAI,EAAG,GAC9B,GAAI,EAAG,EAAG,EAAI,EAAG,EAAG,EAAG,EAAI,EAAG,GAC9B,GAAI,EAAG,EAAG,EAAI,EAAG,EAAG,EAAG,EAAI,EAAG,EAC/B,GAAI,EAAG,EAAG,EAAK,EAAG,EAAG,EAAG,EAAI,EAAG,EAC/B,EAAG,EAAG,EAAG,EAAM,EAAG,EAAG,EAAG,EAAI,EAAG,EAE/B,GAAI,GAAI,EAAG,EAAI,EAAG,EAAG,EAAG,EAAI,EAAG,GAC9B,GAAI,GAAI,EAAG,EAAG,EAAG,EAAG,EAAG,EAAI,EAAG,GAC9B,EAAG,GAAI,EAAG,EAAI,EAAG,EAAG,EAAG,EAAI,EAAG,EAC/B,EAAG,GAAI,EAAG,EAAK,EAAG,EAAG,EAAG,EAAI,EAAG,EAC/B,GAAI,GAAI,EAAG,EAAI,EAAG,EAAG,EAAG,EAAI,EAAG,GAC9B,EAAG,GAAI,EAAG,EAAI,EAAG,EAAG,EAAG,EAAI,EAAG,K,+/HCzC5B,IAAIC,EAAU,KACVC,EAAqC,oBAAjBF,aAA+BA,aAAeG,MAClEC,EAASC,KAAKC,OAUZD,KAAKE,GCLX,SAASC,IACd,IAAIC,EAAM,IAAI,EAAoB,IAqBlC,OAnBI,GAAuBT,eACzBS,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,GAGZA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,IAAM,EACVA,EAAI,IAAM,EACHA,EASF,SAASC,EAAMC,GACpB,IAAIF,EAAM,IAAI,EAAoB,IAiBlC,OAhBAA,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACLF,EAUF,SAASG,EAAKH,EAAKE,GAiBxB,OAhBAF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACLF,EAwBF,SAASI,EAAWC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,GACpG,IAAIpB,EAAM,IAAI,EAAoB,IAiBlC,OAhBAA,EAAI,GAAKK,EACTL,EAAI,GAAKM,EACTN,EAAI,GAAKO,EACTP,EAAI,GAAKQ,EACTR,EAAI,GAAKS,EACTT,EAAI,GAAKU,EACTV,EAAI,GAAKW,EACTX,EAAI,GAAKY,EACTZ,EAAI,GAAKa,EACTb,EAAI,GAAKc,EACTd,EAAI,IAAMe,EACVf,EAAI,IAAMgB,EACVhB,EAAI,IAAMiB,EACVjB,EAAI,IAAMkB,EACVlB,EAAI,IAAMmB,EACVnB,EAAI,IAAMoB,EACHpB,EAyBF,SAASqB,EAAIrB,EAAKK,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,GAiBlG,OAhBApB,EAAI,GAAKK,EACTL,EAAI,GAAKM,EACTN,EAAI,GAAKO,EACTP,EAAI,GAAKQ,EACTR,EAAI,GAAKS,EACTT,EAAI,GAAKU,EACTV,EAAI,GAAKW,EACTX,EAAI,GAAKY,EACTZ,EAAI,GAAKa,EACTb,EAAI,GAAKc,EACTd,EAAI,IAAMe,EACVf,EAAI,IAAMgB,EACVhB,EAAI,IAAMiB,EACVjB,EAAI,IAAMkB,EACVlB,EAAI,IAAMmB,EACVnB,EAAI,IAAMoB,EACHpB,EASF,SAASsB,EAAStB,GAiBvB,OAhBAA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACHA,EAUF,SAASuB,EAAUvB,EAAKE,GAE7B,GAAIF,IAAQE,EAAG,CACb,IAAIsB,EAAMtB,EAAE,GACRuB,EAAMvB,EAAE,GACRwB,EAAMxB,EAAE,GACRyB,EAAMzB,EAAE,GACR0B,EAAM1B,EAAE,GACR2B,EAAM3B,EAAE,IACZF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,IACXF,EAAI,GAAKwB,EACTxB,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,IACXF,EAAI,GAAKyB,EACTzB,EAAI,GAAK2B,EACT3B,EAAI,IAAME,EAAE,IACZF,EAAI,IAAM0B,EACV1B,EAAI,IAAM4B,EACV5B,EAAI,IAAM6B,OAEV7B,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,IACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,IACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,GACZF,EAAI,IAAME,EAAE,GACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IAGd,OAAOF,EAUF,SAAS8B,EAAO9B,EAAKE,GAC1B,IAAI6B,EAAM7B,EAAE,GACRsB,EAAMtB,EAAE,GACRuB,EAAMvB,EAAE,GACRwB,EAAMxB,EAAE,GACR8B,EAAM9B,EAAE,GACR+B,EAAM/B,EAAE,GACRyB,EAAMzB,EAAE,GACR0B,EAAM1B,EAAE,GACRgC,EAAMhC,EAAE,GACRiC,EAAMjC,EAAE,GACRkC,EAAMlC,EAAE,IACR2B,EAAM3B,EAAE,IACRmC,EAAMnC,EAAE,IACRoC,EAAMpC,EAAE,IACRqC,EAAMrC,EAAE,IACRsC,EAAMtC,EAAE,IACRuC,EAAMV,EAAME,EAAMT,EAAMQ,EACxBU,EAAMX,EAAMJ,EAAMF,EAAMO,EACxBW,EAAMZ,EAAMH,EAAMF,EAAMM,EACxBY,EAAMpB,EAAMG,EAAMF,EAAMQ,EACxBY,EAAMrB,EAAMI,EAAMF,EAAMO,EACxBa,EAAMrB,EAAMG,EAAMF,EAAMC,EACxBoB,EAAMb,EAAMI,EAAMH,EAAME,EACxBW,EAAMd,EAAMK,EAAMH,EAAMC,EACxBY,EAAMf,EAAMM,EAAMX,EAAMQ,EACxBa,EAAMf,EAAMI,EAAMH,EAAME,EACxBa,EAAMhB,EAAMK,EAAMX,EAAMS,EACxBc,EAAMhB,EAAMI,EAAMX,EAAMU,EAExBc,EAAMZ,EAAMW,EAAMV,EAAMS,EAAMR,EAAMO,EAAMN,EAAMK,EAAMJ,EAAMG,EAAMF,EAAMC,EAE5E,OAAKM,GAILA,EAAM,EAAMA,EACZrD,EAAI,IAAMiC,EAAMmB,EAAMzB,EAAMwB,EAAMvB,EAAMsB,GAAOG,EAC/CrD,EAAI,IAAMyB,EAAM0B,EAAM3B,EAAM4B,EAAM1B,EAAMwB,GAAOG,EAC/CrD,EAAI,IAAMsC,EAAMQ,EAAMP,EAAMM,EAAML,EAAMI,GAAOS,EAC/CrD,EAAI,IAAMoC,EAAMS,EAAMV,EAAMW,EAAMjB,EAAMe,GAAOS,EAC/CrD,EAAI,IAAM2B,EAAMsB,EAAMjB,EAAMoB,EAAMxB,EAAMoB,GAAOK,EAC/CrD,EAAI,IAAM+B,EAAMqB,EAAM3B,EAAMwB,EAAMvB,EAAMsB,GAAOK,EAC/CrD,EAAI,IAAMuC,EAAMI,EAAMN,EAAMS,EAAMN,EAAME,GAAOW,EAC/CrD,EAAI,IAAMkC,EAAMY,EAAMV,EAAMO,EAAMd,EAAMa,GAAOW,EAC/CrD,EAAI,IAAMgC,EAAMmB,EAAMlB,EAAMgB,EAAMrB,EAAMmB,GAAOM,EAC/CrD,EAAI,IAAMwB,EAAMyB,EAAMlB,EAAMoB,EAAMzB,EAAMqB,GAAOM,EAC/CrD,EAAI,KAAOqC,EAAMQ,EAAMP,EAAMK,EAAMH,EAAMC,GAAOY,EAChDrD,EAAI,KAAOmC,EAAMQ,EAAMT,EAAMW,EAAMhB,EAAMY,GAAOY,EAChDrD,EAAI,KAAOiC,EAAMe,EAAMhB,EAAMkB,EAAMvB,EAAMoB,GAAOM,EAChDrD,EAAI,KAAO+B,EAAMmB,EAAM1B,EAAMwB,EAAMvB,EAAMsB,GAAOM,EAChDrD,EAAI,KAAOsC,EAAMI,EAAML,EAAMO,EAAML,EAAME,GAAOY,EAChDrD,EAAI,KAAOkC,EAAMU,EAAMT,EAAMO,EAAMN,EAAMK,GAAOY,EACzCrD,GApBE,KA8BJ,SAASsD,EAAQtD,EAAKE,GAC3B,IAAI6B,EAAM7B,EAAE,GACRsB,EAAMtB,EAAE,GACRuB,EAAMvB,EAAE,GACRwB,EAAMxB,EAAE,GACR8B,EAAM9B,EAAE,GACR+B,EAAM/B,EAAE,GACRyB,EAAMzB,EAAE,GACR0B,EAAM1B,EAAE,GACRgC,EAAMhC,EAAE,GACRiC,EAAMjC,EAAE,GACRkC,EAAMlC,EAAE,IACR2B,EAAM3B,EAAE,IACRmC,EAAMnC,EAAE,IACRoC,EAAMpC,EAAE,IACRqC,EAAMrC,EAAE,IACRsC,EAAMtC,EAAE,IAiBZ,OAhBAF,EAAI,GAAKiC,GAAOG,EAAMI,EAAMX,EAAMU,GAAOJ,GAAOR,EAAMa,EAAMZ,EAAMW,GAAOD,GAAOX,EAAME,EAAMD,EAAMQ,GAClGpC,EAAI,KAAOwB,GAAOY,EAAMI,EAAMX,EAAMU,GAAOJ,GAAOV,EAAMe,EAAMd,EAAMa,GAAOD,GAAOb,EAAMI,EAAMH,EAAMU,IACpGpC,EAAI,GAAKwB,GAAOG,EAAMa,EAAMZ,EAAMW,GAAON,GAAOR,EAAMe,EAAMd,EAAMa,GAAOD,GAAOb,EAAMG,EAAMF,EAAMC,GAClG3B,EAAI,KAAOwB,GAAOG,EAAME,EAAMD,EAAMQ,GAAOH,GAAOR,EAAMI,EAAMH,EAAMU,GAAOD,GAAOV,EAAMG,EAAMF,EAAMC,IACpG3B,EAAI,KAAOgC,GAAOI,EAAMI,EAAMX,EAAMU,GAAOL,GAAOP,EAAMa,EAAMZ,EAAMW,GAAOF,GAAOV,EAAME,EAAMD,EAAMQ,IACpGpC,EAAI,GAAK+B,GAAOK,EAAMI,EAAMX,EAAMU,GAAOL,GAAOT,EAAMe,EAAMd,EAAMa,GAAOF,GAAOZ,EAAMI,EAAMH,EAAMU,GAClGpC,EAAI,KAAO+B,GAAOJ,EAAMa,EAAMZ,EAAMW,GAAOP,GAAOP,EAAMe,EAAMd,EAAMa,GAAOF,GAAOZ,EAAMG,EAAMF,EAAMC,IACpG3B,EAAI,GAAK+B,GAAOJ,EAAME,EAAMD,EAAMQ,GAAOJ,GAAOP,EAAMI,EAAMH,EAAMU,GAAOF,GAAOT,EAAMG,EAAMF,EAAMC,GAClG3B,EAAI,GAAKgC,GAAOG,EAAMK,EAAMX,EAAMS,GAAOJ,GAAOD,EAAMO,EAAMZ,EAAMU,GAAOD,GAAOJ,EAAMJ,EAAMD,EAAMO,GAClGnC,EAAI,KAAO+B,GAAOI,EAAMK,EAAMX,EAAMS,GAAOJ,GAAOV,EAAMgB,EAAMd,EAAMY,GAAOD,GAAOb,EAAMK,EAAMH,EAAMS,IACpGnC,EAAI,IAAM+B,GAAOE,EAAMO,EAAMZ,EAAMU,GAAON,GAAOR,EAAMgB,EAAMd,EAAMY,GAAOD,GAAOb,EAAMI,EAAMF,EAAMO,GACnGjC,EAAI,MAAQ+B,GAAOE,EAAMJ,EAAMD,EAAMO,GAAOH,GAAOR,EAAMK,EAAMH,EAAMS,GAAOD,GAAOV,EAAMI,EAAMF,EAAMO,IACrGjC,EAAI,MAAQgC,GAAOG,EAAMI,EAAMH,EAAME,GAAOJ,GAAOD,EAAMM,EAAMZ,EAAMW,GAAOD,GAAOJ,EAAMG,EAAMT,EAAMQ,IACrGnC,EAAI,IAAM+B,GAAOI,EAAMI,EAAMH,EAAME,GAAOJ,GAAOV,EAAMe,EAAMd,EAAMa,GAAOD,GAAOb,EAAMY,EAAMX,EAAMU,GACnGnC,EAAI,MAAQ+B,GAAOE,EAAMM,EAAMZ,EAAMW,GAAON,GAAOR,EAAMe,EAAMd,EAAMa,GAAOD,GAAOb,EAAMG,EAAMF,EAAMQ,IACrGjC,EAAI,IAAM+B,GAAOE,EAAMG,EAAMT,EAAMQ,GAAOH,GAAOR,EAAMY,EAAMX,EAAMU,GAAOD,GAAOV,EAAMG,EAAMF,EAAMQ,GAC5FjC,EASF,SAASuD,EAAYrD,GAC1B,IAAI6B,EAAM7B,EAAE,GACRsB,EAAMtB,EAAE,GACRuB,EAAMvB,EAAE,GACRwB,EAAMxB,EAAE,GACR8B,EAAM9B,EAAE,GACR+B,EAAM/B,EAAE,GACRyB,EAAMzB,EAAE,GACR0B,EAAM1B,EAAE,GACRgC,EAAMhC,EAAE,GACRiC,EAAMjC,EAAE,GACRkC,EAAMlC,EAAE,IACR2B,EAAM3B,EAAE,IACRmC,EAAMnC,EAAE,IACRoC,EAAMpC,EAAE,IACRqC,EAAMrC,EAAE,IACRsC,EAAMtC,EAAE,IAcZ,OAbU6B,EAAME,EAAMT,EAAMQ,IAWlBI,EAAMI,EAAMX,EAAMU,IAVlBR,EAAMJ,EAAMF,EAAMO,IASlBG,EAAMK,EAAMX,EAAMS,IARlBP,EAAMH,EAAMF,EAAMM,IAOlBG,EAAMI,EAAMH,EAAME,IANlBd,EAAMG,EAAMF,EAAMQ,IAKlBC,EAAMM,EAAMX,EAAMQ,IAJlBb,EAAMI,EAAMF,EAAMO,IAGlBC,EAAMK,EAAMH,EAAMC,IAFlBZ,EAAMG,EAAMF,EAAMC,IAClBO,EAAMI,EAAMH,EAAME,GAkBvB,SAASmB,EAASxD,EAAKE,EAAGuD,GAC/B,IAAI1B,EAAM7B,EAAE,GACRsB,EAAMtB,EAAE,GACRuB,EAAMvB,EAAE,GACRwB,EAAMxB,EAAE,GACR8B,EAAM9B,EAAE,GACR+B,EAAM/B,EAAE,GACRyB,EAAMzB,EAAE,GACR0B,EAAM1B,EAAE,GACRgC,EAAMhC,EAAE,GACRiC,EAAMjC,EAAE,GACRkC,EAAMlC,EAAE,IACR2B,EAAM3B,EAAE,IACRmC,EAAMnC,EAAE,IACRoC,EAAMpC,EAAE,IACRqC,EAAMrC,EAAE,IACRsC,EAAMtC,EAAE,IAERwD,EAAKD,EAAE,GACPE,EAAKF,EAAE,GACPG,EAAKH,EAAE,GACPI,EAAKJ,EAAE,GA6BX,OA5BAzD,EAAI,GAAK0D,EAAK3B,EAAM4B,EAAK3B,EAAM4B,EAAK1B,EAAM2B,EAAKxB,EAC/CrC,EAAI,GAAK0D,EAAKlC,EAAMmC,EAAK1B,EAAM2B,EAAKzB,EAAM0B,EAAKvB,EAC/CtC,EAAI,GAAK0D,EAAKjC,EAAMkC,EAAKhC,EAAMiC,EAAKxB,EAAMyB,EAAKtB,EAC/CvC,EAAI,GAAK0D,EAAKhC,EAAMiC,EAAK/B,EAAMgC,EAAK/B,EAAMgC,EAAKrB,EAC/CkB,EAAKD,EAAE,GACPE,EAAKF,EAAE,GACPG,EAAKH,EAAE,GACPI,EAAKJ,EAAE,GACPzD,EAAI,GAAK0D,EAAK3B,EAAM4B,EAAK3B,EAAM4B,EAAK1B,EAAM2B,EAAKxB,EAC/CrC,EAAI,GAAK0D,EAAKlC,EAAMmC,EAAK1B,EAAM2B,EAAKzB,EAAM0B,EAAKvB,EAC/CtC,EAAI,GAAK0D,EAAKjC,EAAMkC,EAAKhC,EAAMiC,EAAKxB,EAAMyB,EAAKtB,EAC/CvC,EAAI,GAAK0D,EAAKhC,EAAMiC,EAAK/B,EAAMgC,EAAK/B,EAAMgC,EAAKrB,EAC/CkB,EAAKD,EAAE,GACPE,EAAKF,EAAE,GACPG,EAAKH,EAAE,IACPI,EAAKJ,EAAE,IACPzD,EAAI,GAAK0D,EAAK3B,EAAM4B,EAAK3B,EAAM4B,EAAK1B,EAAM2B,EAAKxB,EAC/CrC,EAAI,GAAK0D,EAAKlC,EAAMmC,EAAK1B,EAAM2B,EAAKzB,EAAM0B,EAAKvB,EAC/CtC,EAAI,IAAM0D,EAAKjC,EAAMkC,EAAKhC,EAAMiC,EAAKxB,EAAMyB,EAAKtB,EAChDvC,EAAI,IAAM0D,EAAKhC,EAAMiC,EAAK/B,EAAMgC,EAAK/B,EAAMgC,EAAKrB,EAChDkB,EAAKD,EAAE,IACPE,EAAKF,EAAE,IACPG,EAAKH,EAAE,IACPI,EAAKJ,EAAE,IACPzD,EAAI,IAAM0D,EAAK3B,EAAM4B,EAAK3B,EAAM4B,EAAK1B,EAAM2B,EAAKxB,EAChDrC,EAAI,IAAM0D,EAAKlC,EAAMmC,EAAK1B,EAAM2B,EAAKzB,EAAM0B,EAAKvB,EAChDtC,EAAI,IAAM0D,EAAKjC,EAAMkC,EAAKhC,EAAMiC,EAAKxB,EAAMyB,EAAKtB,EAChDvC,EAAI,IAAM0D,EAAKhC,EAAMiC,EAAK/B,EAAMgC,EAAK/B,EAAMgC,EAAKrB,EACzCxC,EAWF,SAAS8D,EAAU9D,EAAKE,EAAG6D,GAChC,IAGIhC,EAAKP,EAAKC,EAAKC,EACfM,EAAKC,EAAKN,EAAKC,EACfM,EAAKC,EAAKC,EAAKP,EALfmC,EAAID,EAAE,GACNE,EAAIF,EAAE,GACNG,EAAIH,EAAE,GAyCV,OApCI7D,IAAMF,GACRA,EAAI,IAAME,EAAE,GAAK8D,EAAI9D,EAAE,GAAK+D,EAAI/D,EAAE,GAAKgE,EAAIhE,EAAE,IAC7CF,EAAI,IAAME,EAAE,GAAK8D,EAAI9D,EAAE,GAAK+D,EAAI/D,EAAE,GAAKgE,EAAIhE,EAAE,IAC7CF,EAAI,IAAME,EAAE,GAAK8D,EAAI9D,EAAE,GAAK+D,EAAI/D,EAAE,IAAMgE,EAAIhE,EAAE,IAC9CF,EAAI,IAAME,EAAE,GAAK8D,EAAI9D,EAAE,GAAK+D,EAAI/D,EAAE,IAAMgE,EAAIhE,EAAE,MAE9C6B,EAAM7B,EAAE,GACRsB,EAAMtB,EAAE,GACRuB,EAAMvB,EAAE,GACRwB,EAAMxB,EAAE,GACR8B,EAAM9B,EAAE,GACR+B,EAAM/B,EAAE,GACRyB,EAAMzB,EAAE,GACR0B,EAAM1B,EAAE,GACRgC,EAAMhC,EAAE,GACRiC,EAAMjC,EAAE,GACRkC,EAAMlC,EAAE,IACR2B,EAAM3B,EAAE,IACRF,EAAI,GAAK+B,EACT/B,EAAI,GAAKwB,EACTxB,EAAI,GAAKyB,EACTzB,EAAI,GAAK0B,EACT1B,EAAI,GAAKgC,EACThC,EAAI,GAAKiC,EACTjC,EAAI,GAAK2B,EACT3B,EAAI,GAAK4B,EACT5B,EAAI,GAAKkC,EACTlC,EAAI,GAAKmC,EACTnC,EAAI,IAAMoC,EACVpC,EAAI,IAAM6B,EACV7B,EAAI,IAAM+B,EAAMiC,EAAIhC,EAAMiC,EAAI/B,EAAMgC,EAAIhE,EAAE,IAC1CF,EAAI,IAAMwB,EAAMwC,EAAI/B,EAAMgC,EAAI9B,EAAM+B,EAAIhE,EAAE,IAC1CF,EAAI,IAAMyB,EAAMuC,EAAIrC,EAAMsC,EAAI7B,EAAM8B,EAAIhE,EAAE,IAC1CF,EAAI,IAAM0B,EAAMsC,EAAIpC,EAAMqC,EAAIpC,EAAMqC,EAAIhE,EAAE,KAGrCF,EAWF,SAAS,EAAMA,EAAKE,EAAG6D,GAC5B,IAAIC,EAAID,EAAE,GACNE,EAAIF,EAAE,GACNG,EAAIH,EAAE,GAiBV,OAhBA/D,EAAI,GAAKE,EAAE,GAAK8D,EAChBhE,EAAI,GAAKE,EAAE,GAAK8D,EAChBhE,EAAI,GAAKE,EAAE,GAAK8D,EAChBhE,EAAI,GAAKE,EAAE,GAAK8D,EAChBhE,EAAI,GAAKE,EAAE,GAAK+D,EAChBjE,EAAI,GAAKE,EAAE,GAAK+D,EAChBjE,EAAI,GAAKE,EAAE,GAAK+D,EAChBjE,EAAI,GAAKE,EAAE,GAAK+D,EAChBjE,EAAI,GAAKE,EAAE,GAAKgE,EAChBlE,EAAI,GAAKE,EAAE,GAAKgE,EAChBlE,EAAI,IAAME,EAAE,IAAMgE,EAClBlE,EAAI,IAAME,EAAE,IAAMgE,EAClBlE,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACLF,EAYF,SAASmE,EAAOnE,EAAKE,EAAGkE,EAAKC,GAClC,IAIIC,EAAGC,EAAGC,EACNzC,EAAKP,EAAKC,EAAKC,EACfM,EAAKC,EAAKN,EAAKC,EACfM,EAAKC,EAAKC,EAAKP,EACfY,EAAKC,EAAKC,EACVQ,EAAKC,EAAKqB,EACVC,EAAKC,EAAKC,EAVVZ,EAAIK,EAAK,GACTJ,EAAII,EAAK,GACTH,EAAIG,EAAK,GACTQ,EAAMjF,KAAKkF,MAAMd,EAAGC,EAAGC,GAS3B,OAAIW,EAAM,EACD,MAITb,GADAa,EAAM,EAAIA,EAEVZ,GAAKY,EACLX,GAAKW,EACLP,EAAI1E,KAAKmF,IAAIX,GAEbI,EAAI,GADJD,EAAI3E,KAAKoF,IAAIZ,IAEbrC,EAAM7B,EAAE,GACRsB,EAAMtB,EAAE,GACRuB,EAAMvB,EAAE,GACRwB,EAAMxB,EAAE,GACR8B,EAAM9B,EAAE,GACR+B,EAAM/B,EAAE,GACRyB,EAAMzB,EAAE,GACR0B,EAAM1B,EAAE,GACRgC,EAAMhC,EAAE,GACRiC,EAAMjC,EAAE,GACRkC,EAAMlC,EAAE,IACR2B,EAAM3B,EAAE,IAERuC,EAAMuB,EAAIA,EAAIQ,EAAID,EAClB7B,EAAMuB,EAAID,EAAIQ,EAAIN,EAAII,EACtB3B,EAAMuB,EAAIF,EAAIQ,EAAIP,EAAIK,EACtBnB,EAAMa,EAAIC,EAAIO,EAAIN,EAAII,EACtBlB,EAAMa,EAAIA,EAAIO,EAAID,EAClBE,EAAMP,EAAID,EAAIO,EAAIR,EAAIM,EACtBI,EAAMV,EAAIE,EAAIM,EAAIP,EAAIK,EACtBK,EAAMV,EAAIC,EAAIM,EAAIR,EAAIM,EACtBM,EAAMV,EAAIA,EAAIM,EAAID,EAElBvE,EAAI,GAAK+B,EAAMU,EAAMT,EAAMU,EAAMR,EAAMS,EACvC3C,EAAI,GAAKwB,EAAMiB,EAAMR,EAAMS,EAAMP,EAAMQ,EACvC3C,EAAI,GAAKyB,EAAMgB,EAAMd,EAAMe,EAAMN,EAAMO,EACvC3C,EAAI,GAAK0B,EAAMe,EAAMb,EAAMc,EAAMb,EAAMc,EACvC3C,EAAI,GAAK+B,EAAMoB,EAAMnB,EAAMoB,EAAMlB,EAAMuC,EACvCzE,EAAI,GAAKwB,EAAM2B,EAAMlB,EAAMmB,EAAMjB,EAAMsC,EACvCzE,EAAI,GAAKyB,EAAM0B,EAAMxB,EAAMyB,EAAMhB,EAAMqC,EACvCzE,EAAI,GAAK0B,EAAMyB,EAAMvB,EAAMwB,EAAMvB,EAAM4C,EACvCzE,EAAI,GAAK+B,EAAM2C,EAAM1C,EAAM2C,EAAMzC,EAAM0C,EACvC5E,EAAI,GAAKwB,EAAMkD,EAAMzC,EAAM0C,EAAMxC,EAAMyC,EACvC5E,EAAI,IAAMyB,EAAMiD,EAAM/C,EAAMgD,EAAMvC,EAAMwC,EACxC5E,EAAI,IAAM0B,EAAMgD,EAAM9C,EAAM+C,EAAM9C,EAAM+C,EAEpC1E,IAAMF,IAERA,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,KAGPF,GAWF,SAASiF,EAAQjF,EAAKE,EAAGkE,GAC9B,IAAIE,EAAI1E,KAAKmF,IAAIX,GACbG,EAAI3E,KAAKoF,IAAIZ,GACbpC,EAAM9B,EAAE,GACR+B,EAAM/B,EAAE,GACRyB,EAAMzB,EAAE,GACR0B,EAAM1B,EAAE,GACRgC,EAAMhC,EAAE,GACRiC,EAAMjC,EAAE,GACRkC,EAAMlC,EAAE,IACR2B,EAAM3B,EAAE,IAuBZ,OArBIA,IAAMF,IAERA,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,KAIdF,EAAI,GAAKgC,EAAMuC,EAAIrC,EAAMoC,EACzBtE,EAAI,GAAKiC,EAAMsC,EAAIpC,EAAMmC,EACzBtE,EAAI,GAAK2B,EAAM4C,EAAInC,EAAMkC,EACzBtE,EAAI,GAAK4B,EAAM2C,EAAI1C,EAAMyC,EACzBtE,EAAI,GAAKkC,EAAMqC,EAAIvC,EAAMsC,EACzBtE,EAAI,GAAKmC,EAAMoC,EAAItC,EAAMqC,EACzBtE,EAAI,IAAMoC,EAAMmC,EAAI5C,EAAM2C,EAC1BtE,EAAI,IAAM6B,EAAM0C,EAAI3C,EAAM0C,EACnBtE,EAWF,SAASkF,EAAQlF,EAAKE,EAAGkE,GAC9B,IAAIE,EAAI1E,KAAKmF,IAAIX,GACbG,EAAI3E,KAAKoF,IAAIZ,GACbrC,EAAM7B,EAAE,GACRsB,EAAMtB,EAAE,GACRuB,EAAMvB,EAAE,GACRwB,EAAMxB,EAAE,GACRgC,EAAMhC,EAAE,GACRiC,EAAMjC,EAAE,GACRkC,EAAMlC,EAAE,IACR2B,EAAM3B,EAAE,IAuBZ,OArBIA,IAAMF,IAERA,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,KAIdF,EAAI,GAAK+B,EAAMwC,EAAIrC,EAAMoC,EACzBtE,EAAI,GAAKwB,EAAM+C,EAAIpC,EAAMmC,EACzBtE,EAAI,GAAKyB,EAAM8C,EAAInC,EAAMkC,EACzBtE,EAAI,GAAK0B,EAAM6C,EAAI1C,EAAMyC,EACzBtE,EAAI,GAAK+B,EAAMuC,EAAIpC,EAAMqC,EACzBvE,EAAI,GAAKwB,EAAM8C,EAAInC,EAAMoC,EACzBvE,EAAI,IAAMyB,EAAM6C,EAAIlC,EAAMmC,EAC1BvE,EAAI,IAAM0B,EAAM4C,EAAIzC,EAAM0C,EACnBvE,EAWF,SAASmF,EAAQnF,EAAKE,EAAGkE,GAC9B,IAAIE,EAAI1E,KAAKmF,IAAIX,GACbG,EAAI3E,KAAKoF,IAAIZ,GACbrC,EAAM7B,EAAE,GACRsB,EAAMtB,EAAE,GACRuB,EAAMvB,EAAE,GACRwB,EAAMxB,EAAE,GACR8B,EAAM9B,EAAE,GACR+B,EAAM/B,EAAE,GACRyB,EAAMzB,EAAE,GACR0B,EAAM1B,EAAE,GAuBZ,OArBIA,IAAMF,IAERA,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,IACZF,EAAI,IAAME,EAAE,KAIdF,EAAI,GAAK+B,EAAMwC,EAAIvC,EAAMsC,EACzBtE,EAAI,GAAKwB,EAAM+C,EAAItC,EAAMqC,EACzBtE,EAAI,GAAKyB,EAAM8C,EAAI5C,EAAM2C,EACzBtE,EAAI,GAAK0B,EAAM6C,EAAI3C,EAAM0C,EACzBtE,EAAI,GAAKgC,EAAMuC,EAAIxC,EAAMuC,EACzBtE,EAAI,GAAKiC,EAAMsC,EAAI/C,EAAM8C,EACzBtE,EAAI,GAAK2B,EAAM4C,EAAI9C,EAAM6C,EACzBtE,EAAI,GAAK4B,EAAM2C,EAAI7C,EAAM4C,EAClBtE,EAcF,SAASoF,EAAgBpF,EAAK+D,GAiBnC,OAhBA/D,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM+D,EAAE,GACZ/D,EAAI,IAAM+D,EAAE,GACZ/D,EAAI,IAAM+D,EAAE,GACZ/D,EAAI,IAAM,EACHA,EAcF,SAASqF,EAAYrF,EAAK+D,GAiB/B,OAhBA/D,EAAI,GAAK+D,EAAE,GACX/D,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK+D,EAAE,GACX/D,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,IAAM+D,EAAE,GACZ/D,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACHA,EAeF,SAASsF,EAAatF,EAAKoE,EAAKC,GACrC,IAIIC,EAAGC,EAAGC,EAJNR,EAAIK,EAAK,GACTJ,EAAII,EAAK,GACTH,EAAIG,EAAK,GACTQ,EAAMjF,KAAKkF,MAAMd,EAAGC,EAAGC,GAG3B,OAAIW,EAAM,EACD,MAITb,GADAa,EAAM,EAAIA,EAEVZ,GAAKY,EACLX,GAAKW,EACLP,EAAI1E,KAAKmF,IAAIX,GAEbI,EAAI,GADJD,EAAI3E,KAAKoF,IAAIZ,IAGbpE,EAAI,GAAKgE,EAAIA,EAAIQ,EAAID,EACrBvE,EAAI,GAAKiE,EAAID,EAAIQ,EAAIN,EAAII,EACzBtE,EAAI,GAAKkE,EAAIF,EAAIQ,EAAIP,EAAIK,EACzBtE,EAAI,GAAK,EACTA,EAAI,GAAKgE,EAAIC,EAAIO,EAAIN,EAAII,EACzBtE,EAAI,GAAKiE,EAAIA,EAAIO,EAAID,EACrBvE,EAAI,GAAKkE,EAAID,EAAIO,EAAIR,EAAIM,EACzBtE,EAAI,GAAK,EACTA,EAAI,GAAKgE,EAAIE,EAAIM,EAAIP,EAAIK,EACzBtE,EAAI,GAAKiE,EAAIC,EAAIM,EAAIR,EAAIM,EACzBtE,EAAI,IAAMkE,EAAIA,EAAIM,EAAID,EACtBvE,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACHA,GAcF,SAASuF,EAAcvF,EAAKoE,GACjC,IAAIE,EAAI1E,KAAKmF,IAAIX,GACbG,EAAI3E,KAAKoF,IAAIZ,GAkBjB,OAhBApE,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAKuE,EACTvE,EAAI,GAAKsE,EACTtE,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,IAAMsE,EACVtE,EAAI,IAAMuE,EACVvE,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACHA,EAcF,SAASwF,EAAcxF,EAAKoE,GACjC,IAAIE,EAAI1E,KAAKmF,IAAIX,GACbG,EAAI3E,KAAKoF,IAAIZ,GAkBjB,OAhBApE,EAAI,GAAKuE,EACTvE,EAAI,GAAK,EACTA,EAAI,IAAMsE,EACVtE,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAKsE,EACTtE,EAAI,GAAK,EACTA,EAAI,IAAMuE,EACVvE,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACHA,EAcF,SAASyF,EAAczF,EAAKoE,GACjC,IAAIE,EAAI1E,KAAKmF,IAAIX,GACbG,EAAI3E,KAAKoF,IAAIZ,GAkBjB,OAhBApE,EAAI,GAAKuE,EACTvE,EAAI,GAAKsE,EACTtE,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,IAAMsE,EACVtE,EAAI,GAAKuE,EACTvE,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACHA,EAkBF,SAAS0F,EAAwB1F,EAAK2F,EAAG5B,GAE9C,IAAIC,EAAI2B,EAAE,GACN1B,EAAI0B,EAAE,GACNzB,EAAIyB,EAAE,GACNC,EAAID,EAAE,GACNE,EAAK7B,EAAIA,EACT8B,EAAK7B,EAAIA,EACT8B,EAAK7B,EAAIA,EACT8B,EAAKhC,EAAI6B,EACTI,EAAKjC,EAAI8B,EACTI,EAAKlC,EAAI+B,EACTI,EAAKlC,EAAI6B,EACTM,EAAKnC,EAAI8B,EACTM,EAAKnC,EAAI6B,EACTO,EAAKV,EAAIC,EACTU,EAAKX,EAAIE,EACTU,EAAKZ,EAAIG,EAiBb,OAhBA/F,EAAI,GAAK,GAAKmG,EAAKE,GACnBrG,EAAI,GAAKiG,EAAKO,EACdxG,EAAI,GAAKkG,EAAKK,EACdvG,EAAI,GAAK,EACTA,EAAI,GAAKiG,EAAKO,EACdxG,EAAI,GAAK,GAAKgG,EAAKK,GACnBrG,EAAI,GAAKoG,EAAKE,EACdtG,EAAI,GAAK,EACTA,EAAI,GAAKkG,EAAKK,EACdvG,EAAI,GAAKoG,EAAKE,EACdtG,EAAI,IAAM,GAAKgG,EAAKG,GACpBnG,EAAI,IAAM,EACVA,EAAI,IAAM+D,EAAE,GACZ/D,EAAI,IAAM+D,EAAE,GACZ/D,EAAI,IAAM+D,EAAE,GACZ/D,EAAI,IAAM,EACHA,EAUF,SAASyG,EAAUzG,EAAKE,GAC7B,IAAIwG,EAAc,IAAI,EAAoB,GACtCC,GAAMzG,EAAE,GACR0G,GAAM1G,EAAE,GACR2G,GAAM3G,EAAE,GACR4G,EAAK5G,EAAE,GACP6G,EAAK7G,EAAE,GACP8G,EAAK9G,EAAE,GACP+G,EAAK/G,EAAE,GACPgH,EAAKhH,EAAE,GACPiH,EAAYR,EAAKA,EAAKC,EAAKA,EAAKC,EAAKA,EAAKC,EAAKA,EAanD,OAXIK,EAAY,GACdT,EAAY,GAA+C,GAAzCK,EAAKD,EAAKI,EAAKP,EAAKK,EAAKH,EAAKI,EAAKL,GAAUO,EAC/DT,EAAY,GAA+C,GAAzCM,EAAKF,EAAKI,EAAKN,EAAKK,EAAKN,EAAKI,EAAKF,GAAUM,EAC/DT,EAAY,GAA+C,GAAzCO,EAAKH,EAAKI,EAAKL,EAAKE,EAAKH,EAAKI,EAAKL,GAAUQ,IAE/DT,EAAY,GAA+C,GAAzCK,EAAKD,EAAKI,EAAKP,EAAKK,EAAKH,EAAKI,EAAKL,GACrDF,EAAY,GAA+C,GAAzCM,EAAKF,EAAKI,EAAKN,EAAKK,EAAKN,EAAKI,EAAKF,GACrDH,EAAY,GAA+C,GAAzCO,EAAKH,EAAKI,EAAKL,EAAKE,EAAKH,EAAKI,EAAKL,IAGvDjB,EAAwB1F,EAAKE,EAAGwG,GACzB1G,EAYF,SAASoH,EAAepH,EAAKqH,GAIlC,OAHArH,EAAI,GAAKqH,EAAI,IACbrH,EAAI,GAAKqH,EAAI,IACbrH,EAAI,GAAKqH,EAAI,IACNrH,EAaF,SAASsH,EAAWtH,EAAKqH,GAC9B,IAAI3G,EAAM2G,EAAI,GACV1G,EAAM0G,EAAI,GACVzG,EAAMyG,EAAI,GACVvG,EAAMuG,EAAI,GACVtG,EAAMsG,EAAI,GACVrG,EAAMqG,EAAI,GACVnG,EAAMmG,EAAI,GACVlG,EAAMkG,EAAI,GACVjG,EAAMiG,EAAI,IAId,OAHArH,EAAI,GAAKJ,KAAKkF,MAAMpE,EAAKC,EAAKC,GAC9BZ,EAAI,GAAKJ,KAAKkF,MAAMhE,EAAKC,EAAKC,GAC9BhB,EAAI,GAAKJ,KAAKkF,MAAM5D,EAAKC,EAAKC,GACvBpB,EAYF,SAASuH,EAAYvH,EAAKqH,GAC/B,IAAIG,EAAU,IAAI,EAAoB,GACtCF,EAAWE,EAASH,GACpB,IAAII,EAAM,EAAID,EAAQ,GAClBE,EAAM,EAAIF,EAAQ,GAClBG,EAAM,EAAIH,EAAQ,GAClBI,EAAOP,EAAI,GAAKI,EAChBI,EAAOR,EAAI,GAAKK,EAChBI,EAAOT,EAAI,GAAKM,EAChBI,EAAOV,EAAI,GAAKI,EAChBO,EAAOX,EAAI,GAAKK,EAChBO,EAAOZ,EAAI,GAAKM,EAChBO,EAAOb,EAAI,GAAKI,EAChBU,EAAOd,EAAI,GAAKK,EAChBU,EAAOf,EAAI,IAAMM,EACjBU,EAAQT,EAAOI,EAAOI,EACtBE,EAAI,EA4BR,OA1BID,EAAQ,GACVC,EAA6B,EAAzB1I,KAAK2I,KAAKF,EAAQ,GACtBrI,EAAI,GAAK,IAAOsI,EAChBtI,EAAI,IAAMiI,EAAOE,GAAQG,EACzBtI,EAAI,IAAMkI,EAAOJ,GAAQQ,EACzBtI,EAAI,IAAM6H,EAAOE,GAAQO,GAChBV,EAAOI,GAAQJ,EAAOQ,GAC/BE,EAA0C,EAAtC1I,KAAK2I,KAAK,EAAMX,EAAOI,EAAOI,GAClCpI,EAAI,IAAMiI,EAAOE,GAAQG,EACzBtI,EAAI,GAAK,IAAOsI,EAChBtI,EAAI,IAAM6H,EAAOE,GAAQO,EACzBtI,EAAI,IAAMkI,EAAOJ,GAAQQ,GAChBN,EAAOI,GAChBE,EAA0C,EAAtC1I,KAAK2I,KAAK,EAAMP,EAAOJ,EAAOQ,GAClCpI,EAAI,IAAMkI,EAAOJ,GAAQQ,EACzBtI,EAAI,IAAM6H,EAAOE,GAAQO,EACzBtI,EAAI,GAAK,IAAOsI,EAChBtI,EAAI,IAAMiI,EAAOE,GAAQG,IAEzBA,EAA0C,EAAtC1I,KAAK2I,KAAK,EAAMH,EAAOR,EAAOI,GAClChI,EAAI,IAAM6H,EAAOE,GAAQO,EACzBtI,EAAI,IAAMkI,EAAOJ,GAAQQ,EACzBtI,EAAI,IAAMiI,EAAOE,GAAQG,EACzBtI,EAAI,GAAK,IAAOsI,GAGXtI,EAoBF,SAASwI,EAA6BxI,EAAK2F,EAAG5B,EAAGO,GAEtD,IAAIN,EAAI2B,EAAE,GACN1B,EAAI0B,EAAE,GACNzB,EAAIyB,EAAE,GACNC,EAAID,EAAE,GACNE,EAAK7B,EAAIA,EACT8B,EAAK7B,EAAIA,EACT8B,EAAK7B,EAAIA,EACT8B,EAAKhC,EAAI6B,EACTI,EAAKjC,EAAI8B,EACTI,EAAKlC,EAAI+B,EACTI,EAAKlC,EAAI6B,EACTM,EAAKnC,EAAI8B,EACTM,EAAKnC,EAAI6B,EACTO,EAAKV,EAAIC,EACTU,EAAKX,EAAIE,EACTU,EAAKZ,EAAIG,EACT0C,EAAKnE,EAAE,GACPoE,EAAKpE,EAAE,GACPqE,EAAKrE,EAAE,GAiBX,OAhBAtE,EAAI,IAAM,GAAKmG,EAAKE,IAAOoC,EAC3BzI,EAAI,IAAMiG,EAAKO,GAAMiC,EACrBzI,EAAI,IAAMkG,EAAKK,GAAMkC,EACrBzI,EAAI,GAAK,EACTA,EAAI,IAAMiG,EAAKO,GAAMkC,EACrB1I,EAAI,IAAM,GAAKgG,EAAKK,IAAOqC,EAC3B1I,EAAI,IAAMoG,EAAKE,GAAMoC,EACrB1I,EAAI,GAAK,EACTA,EAAI,IAAMkG,EAAKK,GAAMoC,EACrB3I,EAAI,IAAMoG,EAAKE,GAAMqC,EACrB3I,EAAI,KAAO,GAAKgG,EAAKG,IAAOwC,EAC5B3I,EAAI,IAAM,EACVA,EAAI,IAAM+D,EAAE,GACZ/D,EAAI,IAAM+D,EAAE,GACZ/D,EAAI,IAAM+D,EAAE,GACZ/D,EAAI,IAAM,EACHA,EAuBF,SAAS4I,EAAmC5I,EAAK2F,EAAG5B,EAAGO,EAAGuE,GAE/D,IAAI7E,EAAI2B,EAAE,GACN1B,EAAI0B,EAAE,GACNzB,EAAIyB,EAAE,GACNC,EAAID,EAAE,GACNE,EAAK7B,EAAIA,EACT8B,EAAK7B,EAAIA,EACT8B,EAAK7B,EAAIA,EACT8B,EAAKhC,EAAI6B,EACTI,EAAKjC,EAAI8B,EACTI,EAAKlC,EAAI+B,EACTI,EAAKlC,EAAI6B,EACTM,EAAKnC,EAAI8B,EACTM,EAAKnC,EAAI6B,EACTO,EAAKV,EAAIC,EACTU,EAAKX,EAAIE,EACTU,EAAKZ,EAAIG,EACT0C,EAAKnE,EAAE,GACPoE,EAAKpE,EAAE,GACPqE,EAAKrE,EAAE,GACPwE,EAAKD,EAAE,GACPE,EAAKF,EAAE,GACPG,EAAKH,EAAE,GACPI,GAAQ,GAAK9C,EAAKE,IAAOoC,EACzBS,GAAQjD,EAAKO,GAAMiC,EACnBU,GAAQjD,EAAKK,GAAMkC,EACnBW,GAAQnD,EAAKO,GAAMkC,EACnBW,GAAQ,GAAKrD,EAAKK,IAAOqC,EACzBY,GAAQlD,EAAKE,GAAMoC,EACnBa,GAAQrD,EAAKK,GAAMoC,EACnBa,GAAQpD,EAAKE,GAAMqC,EACnBc,GAAS,GAAKzD,EAAKG,IAAOwC,EAiB9B,OAhBA3I,EAAI,GAAKiJ,EACTjJ,EAAI,GAAKkJ,EACTlJ,EAAI,GAAKmJ,EACTnJ,EAAI,GAAK,EACTA,EAAI,GAAKoJ,EACTpJ,EAAI,GAAKqJ,EACTrJ,EAAI,GAAKsJ,EACTtJ,EAAI,GAAK,EACTA,EAAI,GAAKuJ,EACTvJ,EAAI,GAAKwJ,EACTxJ,EAAI,IAAMyJ,EACVzJ,EAAI,IAAM,EACVA,EAAI,IAAM+D,EAAE,GAAK+E,GAAMG,EAAOH,EAAKM,EAAOL,EAAKQ,EAAOP,GACtDhJ,EAAI,IAAM+D,EAAE,GAAKgF,GAAMG,EAAOJ,EAAKO,EAAON,EAAKS,EAAOR,GACtDhJ,EAAI,IAAM+D,EAAE,GAAKiF,GAAMG,EAAOL,EAAKQ,EAAOP,EAAKU,EAAQT,GACvDhJ,EAAI,IAAM,EACHA,EAWF,SAAS0J,EAAS1J,EAAK2F,GAC5B,IAAI3B,EAAI2B,EAAE,GACN1B,EAAI0B,EAAE,GACNzB,EAAIyB,EAAE,GACNC,EAAID,EAAE,GACNE,EAAK7B,EAAIA,EACT8B,EAAK7B,EAAIA,EACT8B,EAAK7B,EAAIA,EACT8B,EAAKhC,EAAI6B,EACT8D,EAAK1F,EAAI4B,EACTM,EAAKlC,EAAI6B,EACT8D,EAAK1F,EAAI2B,EACTgE,EAAK3F,EAAI4B,EACTO,EAAKnC,EAAI6B,EACTO,EAAKV,EAAIC,EACTU,EAAKX,EAAIE,EACTU,EAAKZ,EAAIG,EAiBb,OAhBA/F,EAAI,GAAK,EAAImG,EAAKE,EAClBrG,EAAI,GAAK2J,EAAKnD,EACdxG,EAAI,GAAK4J,EAAKrD,EACdvG,EAAI,GAAK,EACTA,EAAI,GAAK2J,EAAKnD,EACdxG,EAAI,GAAK,EAAIgG,EAAKK,EAClBrG,EAAI,GAAK6J,EAAKvD,EACdtG,EAAI,GAAK,EACTA,EAAI,GAAK4J,EAAKrD,EACdvG,EAAI,GAAK6J,EAAKvD,EACdtG,EAAI,IAAM,EAAIgG,EAAKG,EACnBnG,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EACHA,EAeF,SAAS8J,EAAQ9J,EAAK+J,EAAMC,EAAOC,EAAQC,EAAKC,EAAMC,GAC3D,IAAIC,EAAK,GAAKL,EAAQD,GAClBO,EAAK,GAAKJ,EAAMD,GAChBM,EAAK,GAAKJ,EAAOC,GAiBrB,OAhBApK,EAAI,GAAY,EAAPmK,EAAWE,EACpBrK,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAY,EAAPmK,EAAWG,EACpBtK,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,IAAMgK,EAAQD,GAAQM,EAC1BrK,EAAI,IAAMkK,EAAMD,GAAUK,EAC1BtK,EAAI,KAAOoK,EAAMD,GAAQI,EACzBvK,EAAI,KAAO,EACXA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAMoK,EAAMD,EAAO,EAAII,EAC3BvK,EAAI,IAAM,EACHA,EAcF,SAASwK,EAAYxK,EAAKyK,EAAMC,EAAQP,EAAMC,GACnD,IACIG,EADAI,EAAI,EAAM/K,KAAKgL,IAAIH,EAAO,GA0B9B,OAxBAzK,EAAI,GAAK2K,EAAID,EACb1K,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK2K,EACT3K,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,KAAO,EACXA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAM,EAEC,MAAPoK,GAAeA,IAAQS,KACzBN,EAAK,GAAKJ,EAAOC,GACjBpK,EAAI,KAAOoK,EAAMD,GAAQI,EACzBvK,EAAI,IAAM,EAAIoK,EAAMD,EAAOI,IAE3BvK,EAAI,KAAO,EACXA,EAAI,KAAO,EAAImK,GAGVnK,EAcF,SAAS8K,EAA2B9K,EAAK+K,EAAKZ,EAAMC,GACzD,IAAIY,EAAQpL,KAAKgL,IAAIG,EAAIE,UAAYrL,KAAKE,GAAK,KAC3CoL,EAAUtL,KAAKgL,IAAIG,EAAII,YAAcvL,KAAKE,GAAK,KAC/CsL,EAAUxL,KAAKgL,IAAIG,EAAIM,YAAczL,KAAKE,GAAK,KAC/CwL,EAAW1L,KAAKgL,IAAIG,EAAIQ,aAAe3L,KAAKE,GAAK,KACjD0L,EAAS,GAAOJ,EAAUE,GAC1BG,EAAS,GAAOT,EAAQE,GAiB5B,OAhBAlL,EAAI,GAAKwL,EACTxL,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAKyL,EACTzL,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,KAAQoL,EAAUE,GAAYE,EAAS,GAC3CxL,EAAI,IAAMgL,EAAQE,GAAWO,EAAS,GACtCzL,EAAI,IAAMoK,GAAOD,EAAOC,GACxBpK,EAAI,KAAO,EACXA,EAAI,IAAM,EACVA,EAAI,IAAM,EACVA,EAAI,IAAMoK,EAAMD,GAAQA,EAAOC,GAC/BpK,EAAI,IAAM,EACHA,EAeF,SAAS0L,EAAM1L,EAAK+J,EAAMC,EAAOC,EAAQC,EAAKC,EAAMC,GACzD,IAAIuB,EAAK,GAAK5B,EAAOC,GACjB4B,EAAK,GAAK3B,EAASC,GACnBK,EAAK,GAAKJ,EAAOC,GAiBrB,OAhBApK,EAAI,IAAM,EAAI2L,EACd3L,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,IAAM,EAAI4L,EACd5L,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,IAAM,EAAIuK,EACdvK,EAAI,IAAM,EACVA,EAAI,KAAO+J,EAAOC,GAAS2B,EAC3B3L,EAAI,KAAOkK,EAAMD,GAAU2B,EAC3B5L,EAAI,KAAOoK,EAAMD,GAAQI,EACzBvK,EAAI,IAAM,EACHA,EAaF,SAAS6L,EAAO7L,EAAK8L,EAAKC,EAAQC,GACvC,IAAIC,EAAIC,EAAIrG,EAAIsG,EAAIC,EAAItG,EAAIuG,EAAIC,EAAIvG,EAAIlB,EACpC0H,EAAOT,EAAI,GACXU,EAAOV,EAAI,GACXW,EAAOX,EAAI,GACXY,EAAMV,EAAG,GACTW,EAAMX,EAAG,GACTY,EAAMZ,EAAG,GACTa,EAAUd,EAAO,GACjBe,EAAUf,EAAO,GACjBgB,EAAUhB,EAAO,GAErB,OAAInM,KAAKoN,IAAIT,EAAOM,GAAW,GAAoBjN,KAAKoN,IAAIR,EAAOM,GAAW,GAAoBlN,KAAKoN,IAAIP,EAAOM,GAAW,EACpHzL,EAAStB,IAGlBqM,EAAKE,EAAOM,EACZP,EAAKE,EAAOM,EACZ/G,EAAK0G,EAAOM,EAKZd,EAAKU,GADL5G,GAHAlB,EAAM,EAAIjF,KAAKkF,MAAMuH,EAAIC,EAAIvG,IAIb6G,GAFhBN,GAAMzH,GAGNqH,EAAKU,GAJLP,GAAMxH,GAIU6H,EAAM3G,EACtBF,EAAK6G,EAAMJ,EAAKK,EAAMN,GACtBxH,EAAMjF,KAAKkF,MAAMmH,EAAIC,EAAIrG,KAQvBoG,GADApH,EAAM,EAAIA,EAEVqH,GAAMrH,EACNgB,GAAMhB,IAPNoH,EAAK,EACLC,EAAK,EACLrG,EAAK,GAQPsG,EAAKG,EAAKzG,EAAKE,EAAKmG,EACpBE,EAAKrG,EAAKkG,EAAKI,EAAKxG,EACpBC,EAAKuG,EAAKH,EAAKI,EAAKL,GACpBpH,EAAMjF,KAAKkF,MAAMqH,EAAIC,EAAItG,KAQvBqG,GADAtH,EAAM,EAAIA,EAEVuH,GAAMvH,EACNiB,GAAMjB,IAPNsH,EAAK,EACLC,EAAK,EACLtG,EAAK,GAQP9F,EAAI,GAAKiM,EACTjM,EAAI,GAAKmM,EACTnM,EAAI,GAAKqM,EACTrM,EAAI,GAAK,EACTA,EAAI,GAAKkM,EACTlM,EAAI,GAAKoM,EACTpM,EAAI,GAAKsM,EACTtM,EAAI,GAAK,EACTA,EAAI,GAAK6F,EACT7F,EAAI,GAAK8F,EACT9F,EAAI,IAAM+F,EACV/F,EAAI,IAAM,EACVA,EAAI,MAAQiM,EAAKM,EAAOL,EAAKM,EAAO3G,EAAK4G,GACzCzM,EAAI,MAAQmM,EAAKI,EAAOH,EAAKI,EAAO1G,EAAK2G,GACzCzM,EAAI,MAAQqM,EAAKE,EAAOD,EAAKE,EAAOzG,EAAK0G,GACzCzM,EAAI,IAAM,EACHA,GAYF,SAASiN,EAASjN,EAAK8L,EAAKoB,EAAQlB,GACzC,IAAIO,EAAOT,EAAI,GACXU,EAAOV,EAAI,GACXW,EAAOX,EAAI,GACXY,EAAMV,EAAG,GACTW,EAAMX,EAAG,GACTY,EAAMZ,EAAG,GACTK,EAAKE,EAAOW,EAAO,GACnBZ,EAAKE,EAAOU,EAAO,GACnBnH,EAAK0G,EAAOS,EAAO,GACnBrI,EAAMwH,EAAKA,EAAKC,EAAKA,EAAKvG,EAAKA,EAE/BlB,EAAM,IAERwH,GADAxH,EAAM,EAAIjF,KAAK2I,KAAK1D,GAEpByH,GAAMzH,EACNkB,GAAMlB,GAGR,IAAIoH,EAAKU,EAAM5G,EAAK6G,EAAMN,EACtBJ,EAAKU,EAAMP,EAAKK,EAAM3G,EACtBF,EAAK6G,EAAMJ,EAAKK,EAAMN,EA0B1B,OAzBAxH,EAAMoH,EAAKA,EAAKC,EAAKA,EAAKrG,EAAKA,GAErB,IAERoG,GADApH,EAAM,EAAIjF,KAAK2I,KAAK1D,GAEpBqH,GAAMrH,EACNgB,GAAMhB,GAGR7E,EAAI,GAAKiM,EACTjM,EAAI,GAAKkM,EACTlM,EAAI,GAAK6F,EACT7F,EAAI,GAAK,EACTA,EAAI,GAAKsM,EAAKzG,EAAKE,EAAKmG,EACxBlM,EAAI,GAAK+F,EAAKkG,EAAKI,EAAKxG,EACxB7F,EAAI,GAAKqM,EAAKH,EAAKI,EAAKL,EACxBjM,EAAI,GAAK,EACTA,EAAI,GAAKqM,EACTrM,EAAI,GAAKsM,EACTtM,EAAI,IAAM+F,EACV/F,EAAI,IAAM,EACVA,EAAI,IAAMuM,EACVvM,EAAI,IAAMwM,EACVxM,EAAI,IAAMyM,EACVzM,EAAI,IAAM,EACHA,EASF,SAASmN,EAAIjN,GAClB,MAAO,QAAUA,EAAE,GAAK,KAAOA,EAAE,GAAK,KAAOA,EAAE,GAAK,KAAOA,EAAE,GAAK,KAAOA,EAAE,GAAK,KAAOA,EAAE,GAAK,KAAOA,EAAE,GAAK,KAAOA,EAAE,GAAK,KAAOA,EAAE,GAAK,KAAOA,EAAE,GAAK,KAAOA,EAAE,IAAM,KAAOA,EAAE,IAAM,KAAOA,EAAE,IAAM,KAAOA,EAAE,IAAM,KAAOA,EAAE,IAAM,KAAOA,EAAE,IAAM,IAS3O,SAASkN,EAAKlN,GACnB,OAAON,KAAKkF,MAAM5E,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAAKA,EAAE,IAAKA,EAAE,IAAKA,EAAE,IAAKA,EAAE,IAAKA,EAAE,KAW9G,SAASmN,EAAIrN,EAAKE,EAAGuD,GAiB1B,OAhBAzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,IAAME,EAAE,IAAMuD,EAAE,IACpBzD,EAAI,IAAME,EAAE,IAAMuD,EAAE,IACpBzD,EAAI,IAAME,EAAE,IAAMuD,EAAE,IACpBzD,EAAI,IAAME,EAAE,IAAMuD,EAAE,IACpBzD,EAAI,IAAME,EAAE,IAAMuD,EAAE,IACpBzD,EAAI,IAAME,EAAE,IAAMuD,EAAE,IACbzD,EAWF,SAASsN,EAAStN,EAAKE,EAAGuD,GAiB/B,OAhBAzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,IAAME,EAAE,IAAMuD,EAAE,IACpBzD,EAAI,IAAME,EAAE,IAAMuD,EAAE,IACpBzD,EAAI,IAAME,EAAE,IAAMuD,EAAE,IACpBzD,EAAI,IAAME,EAAE,IAAMuD,EAAE,IACpBzD,EAAI,IAAME,EAAE,IAAMuD,EAAE,IACpBzD,EAAI,IAAME,EAAE,IAAMuD,EAAE,IACbzD,EAWF,SAASuN,EAAevN,EAAKE,EAAGuD,GAiBrC,OAhBAzD,EAAI,GAAKE,EAAE,GAAKuD,EAChBzD,EAAI,GAAKE,EAAE,GAAKuD,EAChBzD,EAAI,GAAKE,EAAE,GAAKuD,EAChBzD,EAAI,GAAKE,EAAE,GAAKuD,EAChBzD,EAAI,GAAKE,EAAE,GAAKuD,EAChBzD,EAAI,GAAKE,EAAE,GAAKuD,EAChBzD,EAAI,GAAKE,EAAE,GAAKuD,EAChBzD,EAAI,GAAKE,EAAE,GAAKuD,EAChBzD,EAAI,GAAKE,EAAE,GAAKuD,EAChBzD,EAAI,GAAKE,EAAE,GAAKuD,EAChBzD,EAAI,IAAME,EAAE,IAAMuD,EAClBzD,EAAI,IAAME,EAAE,IAAMuD,EAClBzD,EAAI,IAAME,EAAE,IAAMuD,EAClBzD,EAAI,IAAME,EAAE,IAAMuD,EAClBzD,EAAI,IAAME,EAAE,IAAMuD,EAClBzD,EAAI,IAAME,EAAE,IAAMuD,EACXzD,EAYF,SAASwN,EAAqBxN,EAAKE,EAAGuD,EAAGgK,GAiB9C,OAhBAzN,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAAKgK,EACvBzN,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAAKgK,EACvBzN,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAAKgK,EACvBzN,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAAKgK,EACvBzN,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAAKgK,EACvBzN,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAAKgK,EACvBzN,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAAKgK,EACvBzN,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAAKgK,EACvBzN,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAAKgK,EACvBzN,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAAKgK,EACvBzN,EAAI,IAAME,EAAE,IAAMuD,EAAE,IAAMgK,EAC1BzN,EAAI,IAAME,EAAE,IAAMuD,EAAE,IAAMgK,EAC1BzN,EAAI,IAAME,EAAE,IAAMuD,EAAE,IAAMgK,EAC1BzN,EAAI,IAAME,EAAE,IAAMuD,EAAE,IAAMgK,EAC1BzN,EAAI,IAAME,EAAE,IAAMuD,EAAE,IAAMgK,EAC1BzN,EAAI,IAAME,EAAE,IAAMuD,EAAE,IAAMgK,EACnBzN,EAUF,SAAS0N,EAAYxN,EAAGuD,GAC7B,OAAOvD,EAAE,KAAOuD,EAAE,IAAMvD,EAAE,KAAOuD,EAAE,IAAMvD,EAAE,KAAOuD,EAAE,IAAMvD,EAAE,KAAOuD,EAAE,IAAMvD,EAAE,KAAOuD,EAAE,IAAMvD,EAAE,KAAOuD,EAAE,IAAMvD,EAAE,KAAOuD,EAAE,IAAMvD,EAAE,KAAOuD,EAAE,IAAMvD,EAAE,KAAOuD,EAAE,IAAMvD,EAAE,KAAOuD,EAAE,IAAMvD,EAAE,MAAQuD,EAAE,KAAOvD,EAAE,MAAQuD,EAAE,KAAOvD,EAAE,MAAQuD,EAAE,KAAOvD,EAAE,MAAQuD,EAAE,KAAOvD,EAAE,MAAQuD,EAAE,KAAOvD,EAAE,MAAQuD,EAAE,IAUvR,SAAS,EAAOvD,EAAGuD,GACxB,IAAIkK,EAAKzN,EAAE,GACP0N,EAAK1N,EAAE,GACP2N,EAAK3N,EAAE,GACP4N,EAAK5N,EAAE,GACP6N,EAAK7N,EAAE,GACP8N,EAAK9N,EAAE,GACP+N,EAAK/N,EAAE,GACPgO,EAAKhO,EAAE,GACPiO,EAAKjO,EAAE,GACPkO,EAAKlO,EAAE,GACP8B,EAAM9B,EAAE,IACR+B,EAAM/B,EAAE,IACRyB,EAAMzB,EAAE,IACR0B,EAAM1B,EAAE,IACRmO,EAAMnO,EAAE,IACRoO,EAAMpO,EAAE,IACRwD,EAAKD,EAAE,GACPE,EAAKF,EAAE,GACPG,EAAKH,EAAE,GACPI,EAAKJ,EAAE,GACP8K,EAAK9K,EAAE,GACP+K,EAAK/K,EAAE,GACPgL,EAAKhL,EAAE,GACPiL,EAAKjL,EAAE,GACPkL,EAAKlL,EAAE,GACPmL,EAAKnL,EAAE,GACPN,EAAMM,EAAE,IACRL,EAAMK,EAAE,IACRgB,EAAMhB,EAAE,IACRoL,EAAMpL,EAAE,IACRqL,EAAMrL,EAAE,IACRsL,EAAMtL,EAAE,IACZ,OAAO7D,KAAKoN,IAAIW,EAAKjK,IAAO,EAAmB9D,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAIW,GAAK/N,KAAKoN,IAAItJ,KAAQ9D,KAAKoN,IAAIY,EAAKjK,IAAO,EAAmB/D,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAIY,GAAKhO,KAAKoN,IAAIrJ,KAAQ/D,KAAKoN,IAAIa,EAAKjK,IAAO,EAAmBhE,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAIa,GAAKjO,KAAKoN,IAAIpJ,KAAQhE,KAAKoN,IAAIc,EAAKjK,IAAO,EAAmBjE,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAIc,GAAKlO,KAAKoN,IAAInJ,KAAQjE,KAAKoN,IAAIe,EAAKQ,IAAO,EAAmB3O,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAIe,GAAKnO,KAAKoN,IAAIuB,KAAQ3O,KAAKoN,IAAIgB,EAAKQ,IAAO,EAAmB5O,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAIgB,GAAKpO,KAAKoN,IAAIwB,KAAQ5O,KAAKoN,IAAIiB,EAAKQ,IAAO,EAAmB7O,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAIiB,GAAKrO,KAAKoN,IAAIyB,KAAQ7O,KAAKoN,IAAIkB,EAAKQ,IAAO,EAAmB9O,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAIkB,GAAKtO,KAAKoN,IAAI0B,KAAQ9O,KAAKoN,IAAImB,EAAKQ,IAAO,EAAmB/O,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAImB,GAAKvO,KAAKoN,IAAI2B,KAAQ/O,KAAKoN,IAAIoB,EAAKQ,IAAO,EAAmBhP,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAIoB,GAAKxO,KAAKoN,IAAI4B,KAAQhP,KAAKoN,IAAIhL,EAAMmB,IAAQ,EAAmBvD,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAIhL,GAAMpC,KAAKoN,IAAI7J,KAASvD,KAAKoN,IAAI/K,EAAMmB,IAAQ,EAAmBxD,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAI/K,GAAMrC,KAAKoN,IAAI5J,KAASxD,KAAKoN,IAAIrL,EAAM8C,IAAQ,EAAmB7E,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAIrL,GAAM/B,KAAKoN,IAAIvI,KAAS7E,KAAKoN,IAAIpL,EAAMiN,IAAQ,EAAmBjP,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAIpL,GAAMhC,KAAKoN,IAAI6B,KAASjP,KAAKoN,IAAIqB,EAAMS,IAAQ,EAAmBlP,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAIqB,GAAMzO,KAAKoN,IAAI8B,KAASlP,KAAKoN,IAAIsB,EAAMS,IAAQ,EAAmBnP,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAIsB,GAAM1O,KAAKoN,IAAI+B,IDhuDn2CnP,KAAKkF,QAAOlF,KAAKkF,MAAQ,WAI5B,IAHA,IAAIb,EAAI,EACJgL,EAAIC,UAAUC,OAEXF,KACLhL,GAAKiL,UAAUD,GAAKC,UAAUD,GAGhC,OAAOrP,KAAK2I,KAAKtE,KC+tDZ,IAAImL,EAAM5L,EAMN6L,GAAM/B,ECzwDV,SAAS,KACd,IAAItN,EAAM,IAAI,EAAoB,GAQlC,OANI,GAAuBT,eACzBS,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,GAGJA,EASF,SAAS,GAAME,GACpB,IAAIF,EAAM,IAAI,EAAoB,GAIlC,OAHAA,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACJF,EASF,SAAS,GAAOE,GACrB,IAAI8D,EAAI9D,EAAE,GACN+D,EAAI/D,EAAE,GACNgE,EAAIhE,EAAE,GACV,OAAON,KAAKkF,MAAMd,EAAGC,EAAGC,GAWnB,SAAS,GAAWF,EAAGC,EAAGC,GAC/B,IAAIlE,EAAM,IAAI,EAAoB,GAIlC,OAHAA,EAAI,GAAKgE,EACThE,EAAI,GAAKiE,EACTjE,EAAI,GAAKkE,EACFlE,EAUF,SAAS,GAAKA,EAAKE,GAIxB,OAHAF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACXF,EAAI,GAAKE,EAAE,GACJF,EAYF,SAAS,GAAIA,EAAKgE,EAAGC,EAAGC,GAI7B,OAHAlE,EAAI,GAAKgE,EACThE,EAAI,GAAKiE,EACTjE,EAAI,GAAKkE,EACFlE,EAWF,SAAS,GAAIA,EAAKE,EAAGuD,GAI1B,OAHAzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GACXzD,EAWF,SAAS,GAASA,EAAKE,EAAGuD,GAI/B,OAHAzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GACXzD,EAWF,SAAS,GAASA,EAAKE,EAAGuD,GAI/B,OAHAzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GACXzD,EAWF,SAASsP,GAAOtP,EAAKE,EAAGuD,GAI7B,OAHAzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAClBzD,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GACXzD,EAUF,SAASuP,GAAKvP,EAAKE,GAIxB,OAHAF,EAAI,GAAKJ,KAAK2P,KAAKrP,EAAE,IACrBF,EAAI,GAAKJ,KAAK2P,KAAKrP,EAAE,IACrBF,EAAI,GAAKJ,KAAK2P,KAAKrP,EAAE,IACdF,EAUF,SAASwP,GAAMxP,EAAKE,GAIzB,OAHAF,EAAI,GAAKJ,KAAK4P,MAAMtP,EAAE,IACtBF,EAAI,GAAKJ,KAAK4P,MAAMtP,EAAE,IACtBF,EAAI,GAAKJ,KAAK4P,MAAMtP,EAAE,IACfF,EAWF,SAASyP,GAAIzP,EAAKE,EAAGuD,GAI1B,OAHAzD,EAAI,GAAKJ,KAAK6P,IAAIvP,EAAE,GAAIuD,EAAE,IAC1BzD,EAAI,GAAKJ,KAAK6P,IAAIvP,EAAE,GAAIuD,EAAE,IAC1BzD,EAAI,GAAKJ,KAAK6P,IAAIvP,EAAE,GAAIuD,EAAE,IACnBzD,EAWF,SAASgP,GAAIhP,EAAKE,EAAGuD,GAI1B,OAHAzD,EAAI,GAAKJ,KAAKoP,IAAI9O,EAAE,GAAIuD,EAAE,IAC1BzD,EAAI,GAAKJ,KAAKoP,IAAI9O,EAAE,GAAIuD,EAAE,IAC1BzD,EAAI,GAAKJ,KAAKoP,IAAI9O,EAAE,GAAIuD,EAAE,IACnBzD,EAUF,SAAS0P,GAAM1P,EAAKE,GAIzB,OAHAF,EAAI,GAAKJ,KAAK8P,MAAMxP,EAAE,IACtBF,EAAI,GAAKJ,KAAK8P,MAAMxP,EAAE,IACtBF,EAAI,GAAKJ,KAAK8P,MAAMxP,EAAE,IACfF,EAWF,SAAS,GAAMA,EAAKE,EAAGuD,GAI5B,OAHAzD,EAAI,GAAKE,EAAE,GAAKuD,EAChBzD,EAAI,GAAKE,EAAE,GAAKuD,EAChBzD,EAAI,GAAKE,EAAE,GAAKuD,EACTzD,EAYF,SAAS2P,GAAY3P,EAAKE,EAAGuD,EAAGgK,GAIrC,OAHAzN,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAAKgK,EACvBzN,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAAKgK,EACvBzN,EAAI,GAAKE,EAAE,GAAKuD,EAAE,GAAKgK,EAChBzN,EAUF,SAAS4P,GAAS1P,EAAGuD,GAC1B,IAAIO,EAAIP,EAAE,GAAKvD,EAAE,GACb+D,EAAIR,EAAE,GAAKvD,EAAE,GACbgE,EAAIT,EAAE,GAAKvD,EAAE,GACjB,OAAON,KAAKkF,MAAMd,EAAGC,EAAGC,GAUnB,SAAS2L,GAAgB3P,EAAGuD,GACjC,IAAIO,EAAIP,EAAE,GAAKvD,EAAE,GACb+D,EAAIR,EAAE,GAAKvD,EAAE,GACbgE,EAAIT,EAAE,GAAKvD,EAAE,GACjB,OAAO8D,EAAIA,EAAIC,EAAIA,EAAIC,EAAIA,EAStB,SAAS4L,GAAc5P,GAC5B,IAAI8D,EAAI9D,EAAE,GACN+D,EAAI/D,EAAE,GACNgE,EAAIhE,EAAE,GACV,OAAO8D,EAAIA,EAAIC,EAAIA,EAAIC,EAAIA,EAUtB,SAAS6L,GAAO/P,EAAKE,GAI1B,OAHAF,EAAI,IAAME,EAAE,GACZF,EAAI,IAAME,EAAE,GACZF,EAAI,IAAME,EAAE,GACLF,EAUF,SAASgQ,GAAQhQ,EAAKE,GAI3B,OAHAF,EAAI,GAAK,EAAME,EAAE,GACjBF,EAAI,GAAK,EAAME,EAAE,GACjBF,EAAI,GAAK,EAAME,EAAE,GACVF,EAUF,SAASiQ,GAAUjQ,EAAKE,GAC7B,IAAI8D,EAAI9D,EAAE,GACN+D,EAAI/D,EAAE,GACNgE,EAAIhE,EAAE,GACN2E,EAAMb,EAAIA,EAAIC,EAAIA,EAAIC,EAAIA,EAU9B,OARIW,EAAM,IAERA,EAAM,EAAIjF,KAAK2I,KAAK1D,IAGtB7E,EAAI,GAAKE,EAAE,GAAK2E,EAChB7E,EAAI,GAAKE,EAAE,GAAK2E,EAChB7E,EAAI,GAAKE,EAAE,GAAK2E,EACT7E,EAUF,SAASkQ,GAAIhQ,EAAGuD,GACrB,OAAOvD,EAAE,GAAKuD,EAAE,GAAKvD,EAAE,GAAKuD,EAAE,GAAKvD,EAAE,GAAKuD,EAAE,GAWvC,SAAS0M,GAAMnQ,EAAKE,EAAGuD,GAC5B,IAAIsD,EAAK7G,EAAE,GACP8G,EAAK9G,EAAE,GACP+G,EAAK/G,EAAE,GACPyG,EAAKlD,EAAE,GACPmD,EAAKnD,EAAE,GACPoD,EAAKpD,EAAE,GAIX,OAHAzD,EAAI,GAAKgH,EAAKH,EAAKI,EAAKL,EACxB5G,EAAI,GAAKiH,EAAKN,EAAKI,EAAKF,EACxB7G,EAAI,GAAK+G,EAAKH,EAAKI,EAAKL,EACjB3G,EAYF,SAASoQ,GAAKpQ,EAAKE,EAAGuD,EAAGe,GAC9B,IAAIuC,EAAK7G,EAAE,GACP8G,EAAK9G,EAAE,GACP+G,EAAK/G,EAAE,GAIX,OAHAF,EAAI,GAAK+G,EAAKvC,GAAKf,EAAE,GAAKsD,GAC1B/G,EAAI,GAAKgH,EAAKxC,GAAKf,EAAE,GAAKuD,GAC1BhH,EAAI,GAAKiH,EAAKzC,GAAKf,EAAE,GAAKwD,GACnBjH,EAcF,SAASqQ,GAAQrQ,EAAKE,EAAGuD,EAAGc,EAAG+L,EAAG9L,GACvC,IAAI+L,EAAe/L,EAAIA,EACnBgM,EAAUD,GAAgB,EAAI/L,EAAI,GAAK,EACvCiM,EAAUF,GAAgB/L,EAAI,GAAKA,EACnCkM,EAAUH,GAAgB/L,EAAI,GAC9BmM,EAAUJ,GAAgB,EAAI,EAAI/L,GAItC,OAHAxE,EAAI,GAAKE,EAAE,GAAKsQ,EAAU/M,EAAE,GAAKgN,EAAUlM,EAAE,GAAKmM,EAAUJ,EAAE,GAAKK,EACnE3Q,EAAI,GAAKE,EAAE,GAAKsQ,EAAU/M,EAAE,GAAKgN,EAAUlM,EAAE,GAAKmM,EAAUJ,EAAE,GAAKK,EACnE3Q,EAAI,GAAKE,EAAE,GAAKsQ,EAAU/M,EAAE,GAAKgN,EAAUlM,EAAE,GAAKmM,EAAUJ,EAAE,GAAKK,EAC5D3Q,EAcF,SAAS4Q,GAAO5Q,EAAKE,EAAGuD,EAAGc,EAAG+L,EAAG9L,GACtC,IAAIqM,EAAgB,EAAIrM,EACpBsM,EAAwBD,EAAgBA,EACxCN,EAAe/L,EAAIA,EACnBgM,EAAUM,EAAwBD,EAClCJ,EAAU,EAAIjM,EAAIsM,EAClBJ,EAAU,EAAIH,EAAeM,EAC7BF,EAAUJ,EAAe/L,EAI7B,OAHAxE,EAAI,GAAKE,EAAE,GAAKsQ,EAAU/M,EAAE,GAAKgN,EAAUlM,EAAE,GAAKmM,EAAUJ,EAAE,GAAKK,EACnE3Q,EAAI,GAAKE,EAAE,GAAKsQ,EAAU/M,EAAE,GAAKgN,EAAUlM,EAAE,GAAKmM,EAAUJ,EAAE,GAAKK,EACnE3Q,EAAI,GAAKE,EAAE,GAAKsQ,EAAU/M,EAAE,GAAKgN,EAAUlM,EAAE,GAAKmM,EAAUJ,EAAE,GAAKK,EAC5D3Q,EAUF,SAASH,GAAOG,EAAKyN,GAC1BA,EAAQA,GAAS,EACjB,IAAIsD,EAAwB,EAApB,IAA0BnR,KAAKE,GACnCoE,EAAwB,EAApB,IAA0B,EAC9B8M,EAASpR,KAAK2I,KAAK,EAAMrE,EAAIA,GAAKuJ,EAItC,OAHAzN,EAAI,GAAKJ,KAAKoF,IAAI+L,GAAKC,EACvBhR,EAAI,GAAKJ,KAAKmF,IAAIgM,GAAKC,EACvBhR,EAAI,GAAKkE,EAAIuJ,EACNzN,EAYF,SAASiR,GAAcjR,EAAKE,EAAGgR,GACpC,IAAIlN,EAAI9D,EAAE,GACN+D,EAAI/D,EAAE,GACNgE,EAAIhE,EAAE,GACN0F,EAAIsL,EAAE,GAAKlN,EAAIkN,EAAE,GAAKjN,EAAIiN,EAAE,IAAMhN,EAAIgN,EAAE,IAK5C,OAJAtL,EAAIA,GAAK,EACT5F,EAAI,IAAMkR,EAAE,GAAKlN,EAAIkN,EAAE,GAAKjN,EAAIiN,EAAE,GAAKhN,EAAIgN,EAAE,KAAOtL,EACpD5F,EAAI,IAAMkR,EAAE,GAAKlN,EAAIkN,EAAE,GAAKjN,EAAIiN,EAAE,GAAKhN,EAAIgN,EAAE,KAAOtL,EACpD5F,EAAI,IAAMkR,EAAE,GAAKlN,EAAIkN,EAAE,GAAKjN,EAAIiN,EAAE,IAAMhN,EAAIgN,EAAE,KAAOtL,EAC9C5F,EAWF,SAASmR,GAAcnR,EAAKE,EAAGgR,GACpC,IAAIlN,EAAI9D,EAAE,GACN+D,EAAI/D,EAAE,GACNgE,EAAIhE,EAAE,GAIV,OAHAF,EAAI,GAAKgE,EAAIkN,EAAE,GAAKjN,EAAIiN,EAAE,GAAKhN,EAAIgN,EAAE,GACrClR,EAAI,GAAKgE,EAAIkN,EAAE,GAAKjN,EAAIiN,EAAE,GAAKhN,EAAIgN,EAAE,GACrClR,EAAI,GAAKgE,EAAIkN,EAAE,GAAKjN,EAAIiN,EAAE,GAAKhN,EAAIgN,EAAE,GAC9BlR,EAYF,SAASoR,GAAcpR,EAAKE,EAAGyF,GAEpC,IAAI0L,EAAK1L,EAAE,GACP2L,EAAK3L,EAAE,GACP4L,EAAK5L,EAAE,GACP6L,EAAK7L,EAAE,GACP3B,EAAI9D,EAAE,GACN+D,EAAI/D,EAAE,GACNgE,EAAIhE,EAAE,GAGNuR,EAAMH,EAAKpN,EAAIqN,EAAKtN,EACpByN,EAAMH,EAAKvN,EAAIqN,EAAKnN,EACpByN,EAAMN,EAAKpN,EAAIqN,EAAKtN,EAEpB4N,EAAON,EAAKK,EAAMJ,EAAKG,EACvBG,EAAON,EAAKE,EAAMJ,EAAKM,EACvBG,EAAOT,EAAKK,EAAMJ,EAAKG,EAEvBM,EAAU,EAALP,EAYT,OAXAC,GAAOM,EACPL,GAAOK,EACPJ,GAAOI,EAEPH,GAAQ,EACRC,GAAQ,EACRC,GAAQ,EAER9R,EAAI,GAAKgE,EAAIyN,EAAMG,EACnB5R,EAAI,GAAKiE,EAAIyN,EAAMG,EACnB7R,EAAI,GAAKkE,EAAIyN,EAAMG,EACZ9R,EAWF,SAAS,GAAQA,EAAKE,EAAGuD,EAAGW,GACjC,IAAI4N,EAAI,GACJjB,EAAI,GAaR,OAXAiB,EAAE,GAAK9R,EAAE,GAAKuD,EAAE,GAChBuO,EAAE,GAAK9R,EAAE,GAAKuD,EAAE,GAChBuO,EAAE,GAAK9R,EAAE,GAAKuD,EAAE,GAEhBsN,EAAE,GAAKiB,EAAE,GACTjB,EAAE,GAAKiB,EAAE,GAAKpS,KAAKoF,IAAIZ,GAAO4N,EAAE,GAAKpS,KAAKmF,IAAIX,GAC9C2M,EAAE,GAAKiB,EAAE,GAAKpS,KAAKmF,IAAIX,GAAO4N,EAAE,GAAKpS,KAAKoF,IAAIZ,GAE9CpE,EAAI,GAAK+Q,EAAE,GAAKtN,EAAE,GAClBzD,EAAI,GAAK+Q,EAAE,GAAKtN,EAAE,GAClBzD,EAAI,GAAK+Q,EAAE,GAAKtN,EAAE,GACXzD,EAWF,SAAS,GAAQA,EAAKE,EAAGuD,EAAGW,GACjC,IAAI4N,EAAI,GACJjB,EAAI,GAaR,OAXAiB,EAAE,GAAK9R,EAAE,GAAKuD,EAAE,GAChBuO,EAAE,GAAK9R,EAAE,GAAKuD,EAAE,GAChBuO,EAAE,GAAK9R,EAAE,GAAKuD,EAAE,GAEhBsN,EAAE,GAAKiB,EAAE,GAAKpS,KAAKmF,IAAIX,GAAO4N,EAAE,GAAKpS,KAAKoF,IAAIZ,GAC9C2M,EAAE,GAAKiB,EAAE,GACTjB,EAAE,GAAKiB,EAAE,GAAKpS,KAAKoF,IAAIZ,GAAO4N,EAAE,GAAKpS,KAAKmF,IAAIX,GAE9CpE,EAAI,GAAK+Q,EAAE,GAAKtN,EAAE,GAClBzD,EAAI,GAAK+Q,EAAE,GAAKtN,EAAE,GAClBzD,EAAI,GAAK+Q,EAAE,GAAKtN,EAAE,GACXzD,EAWF,SAAS,GAAQA,EAAKE,EAAGuD,EAAGW,GACjC,IAAI4N,EAAI,GACJjB,EAAI,GAaR,OAXAiB,EAAE,GAAK9R,EAAE,GAAKuD,EAAE,GAChBuO,EAAE,GAAK9R,EAAE,GAAKuD,EAAE,GAChBuO,EAAE,GAAK9R,EAAE,GAAKuD,EAAE,GAEhBsN,EAAE,GAAKiB,EAAE,GAAKpS,KAAKoF,IAAIZ,GAAO4N,EAAE,GAAKpS,KAAKmF,IAAIX,GAC9C2M,EAAE,GAAKiB,EAAE,GAAKpS,KAAKmF,IAAIX,GAAO4N,EAAE,GAAKpS,KAAKoF,IAAIZ,GAC9C2M,EAAE,GAAKiB,EAAE,GAEThS,EAAI,GAAK+Q,EAAE,GAAKtN,EAAE,GAClBzD,EAAI,GAAK+Q,EAAE,GAAKtN,EAAE,GAClBzD,EAAI,GAAK+Q,EAAE,GAAKtN,EAAE,GACXzD,EASF,SAASiS,GAAM/R,EAAGuD,GACvB,IAAIsD,EAAK7G,EAAE,GACP8G,EAAK9G,EAAE,GACP+G,EAAK/G,EAAE,GACPyG,EAAKlD,EAAE,GACPmD,EAAKnD,EAAE,GACPoD,EAAKpD,EAAE,GAGPyO,EAFOtS,KAAK2I,KAAKxB,EAAKA,EAAKC,EAAKA,EAAKC,EAAKA,GACnCrH,KAAK2I,KAAK5B,EAAKA,EAAKC,EAAKA,EAAKC,EAAKA,GAE1CsL,EAASD,GAAOhC,GAAIhQ,EAAGuD,GAAKyO,EAChC,OAAOtS,KAAKwS,KAAKxS,KAAK6P,IAAI7P,KAAKoP,IAAImD,GAAS,GAAI,IAS3C,SAASE,GAAKrS,GAInB,OAHAA,EAAI,GAAK,EACTA,EAAI,GAAK,EACTA,EAAI,GAAK,EACFA,EASF,SAAS,GAAIE,GAClB,MAAO,QAAUA,EAAE,GAAK,KAAOA,EAAE,GAAK,KAAOA,EAAE,GAAK,IAU/C,SAAS,GAAYA,EAAGuD,GAC7B,OAAOvD,EAAE,KAAOuD,EAAE,IAAMvD,EAAE,KAAOuD,EAAE,IAAMvD,EAAE,KAAOuD,EAAE,GAU/C,SAAS,GAAOvD,EAAGuD,GACxB,IAAIkK,EAAKzN,EAAE,GACP0N,EAAK1N,EAAE,GACP2N,EAAK3N,EAAE,GACPwD,EAAKD,EAAE,GACPE,EAAKF,EAAE,GACPG,EAAKH,EAAE,GACX,OAAO7D,KAAKoN,IAAIW,EAAKjK,IAAO,EAAmB9D,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAIW,GAAK/N,KAAKoN,IAAItJ,KAAQ9D,KAAKoN,IAAIY,EAAKjK,IAAO,EAAmB/D,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAIY,GAAKhO,KAAKoN,IAAIrJ,KAAQ/D,KAAKoN,IAAIa,EAAKjK,IAAO,EAAmBhE,KAAKoP,IAAI,EAAKpP,KAAKoN,IAAIa,GAAKjO,KAAKoN,IAAIpJ,IAOzP,IAmDD0O,GAnDK,GAAM,GAMN,GAAM,GAMNC,GAAMjD,GAMNkD,GAAO5C,GAMP6C,GAAU5C,GAMV,GAAM,GAMN6C,GAAS5C,GAcT6C,IACLL,GAAM,KACH,SAAUpS,EAAG0S,EAAQC,EAAQC,EAAOC,EAAIC,GAC7C,IAAI/D,EAAGgE,EAgBP,IAdKL,IACHA,EAAS,GAGNC,IACHA,EAAS,GAITI,EADEH,EACElT,KAAK6P,IAAIqD,EAAQF,EAASC,EAAQ3S,EAAEiP,QAEpCjP,EAAEiP,OAGHF,EAAI4D,EAAQ5D,EAAIgE,EAAGhE,GAAK2D,EAC3BN,GAAI,GAAKpS,EAAE+O,GACXqD,GAAI,GAAKpS,EAAE+O,EAAI,GACfqD,GAAI,GAAKpS,EAAE+O,EAAI,GACf8D,EAAGT,GAAKA,GAAKU,GACb9S,EAAE+O,GAAKqD,GAAI,GACXpS,EAAE+O,EAAI,GAAKqD,GAAI,GACfpS,EAAE+O,EAAI,GAAKqD,GAAI,GAGjB,OAAOpS,K,gCClvBX,SAASgT,EAAeC,EAAOC,GAC7B,IAAIC,EAAcF,EAAMG,QAAQC,eAAeC,WAC3CzC,EAAInR,KAAK8P,MAAMyD,EAAMpC,GACrB0C,EAAI7T,KAAK8P,MAAMyD,EAAMM,GACrBhQ,EAAI7D,KAAK8P,MAAMyD,EAAM1P,GACrBvD,EAAIiT,EAAMjT,EACVwT,EAAI9T,KAAK8P,MAAMyD,EAAMO,GACrBpP,EAAI6O,EAAM7O,EAAEqP,QAAQ,GACpB5P,EAAIoP,EAAMpP,EAAE4P,QAAQ,GACxB,GAAIP,GAA+B,mBAAhBC,GAAoD,iBAAhBA,EAAgC,CAErF,IADA,IAAIlG,EAAMgG,EAAMS,IAAIJ,SAAS,IACtBrG,EAAIgC,OAAS,GAClBhC,EAAM,IAAMA,EAEd,MAAO,IAAMA,EACR,MAAoB,YAAhBkG,EACF,OAAStC,EAAI,IAAM0C,EAAI,IAAMhQ,EAAI,IACf,aAAhB4P,EACF,QAAUtC,EAAI,IAAM0C,EAAI,IAAMhQ,EAAI,IAAMvD,EAAI,IAC1B,QAAhBmT,EACF,KAAOF,EAAMS,IAAIJ,SAAS,IACR,cAAhBH,EACF,IAAMtC,EAAI,IAAM0C,EAAI,IAAMhQ,EAAI,IACZ,eAAhB4P,EACF,IAAMtC,EAAI,IAAM0C,EAAI,IAAMhQ,EAAI,IAAMvD,EAAI,IACtB,YAAhBmT,EACF,MAAQtC,EAAI,MAAQ0C,EAAI,MAAQhQ,EAAI,IAClB,aAAhB4P,EACF,MAAQtC,EAAI,MAAQ0C,EAAI,MAAQhQ,EAAI,MAAQvD,EAAI,IAC9B,YAAhBmT,EACF,MAAQK,EAAI,MAAQpP,EAAI,MAAQP,EAAI,IAClB,aAAhBsP,EACF,MAAQK,EAAI,MAAQpP,EAAI,MAAQP,EAAI,MAAQ7D,EAAI,IAElD,iBAhET,mCAmEA,IAAI2T,EAAWnU,MAAMoU,UAAUnB,QAC3BoB,EAAYrU,MAAMoU,UAAUE,MAC5BC,EAAS,CACXC,MAAO,GACPC,OAAQ,SAAgBjH,GAStB,OARAkH,KAAKC,KAAKN,EAAUO,KAAKpF,UAAW,IAAI,SAAUqF,IACrCH,KAAKI,SAASD,GAAOE,OAAOC,KAAKH,GAAO,IAC9C5B,QAAQ,SAAUgC,GAChBP,KAAKQ,YAAYL,EAAII,MACxBzH,EAAOyH,GAAOJ,EAAII,KAEpBE,KAAKT,SACNA,MACIlH,GAET4H,SAAU,SAAkB5H,GAS1B,OARAkH,KAAKC,KAAKN,EAAUO,KAAKpF,UAAW,IAAI,SAAUqF,IACrCH,KAAKI,SAASD,GAAOE,OAAOC,KAAKH,GAAO,IAC9C5B,QAAQ,SAAUgC,GACjBP,KAAKQ,YAAY1H,EAAOyH,MAC1BzH,EAAOyH,GAAOJ,EAAII,KAEpBE,KAAKT,SACNA,MACIlH,GAET6H,QAAS,WACP,IAAIC,EAASjB,EAAUO,KAAKpF,WAC5B,OAAO,WAEL,IADA,IAAI+F,EAAOlB,EAAUO,KAAKpF,WACjBD,EAAI+F,EAAO7F,OAAS,EAAGF,GAAK,EAAGA,IACtCgG,EAAO,CAACD,EAAO/F,GAAGiG,MAAMd,KAAMa,IAEhC,OAAOA,EAAK,KAGhBZ,KAAM,SAAcE,EAAKY,EAAKC,GAC5B,GAAKb,EAGL,GAAIV,GAAYU,EAAI5B,SAAW4B,EAAI5B,UAAYkB,EAC7CU,EAAI5B,QAAQwC,EAAKC,QACZ,GAAIb,EAAIpF,SAAWoF,EAAIpF,OAAS,EAAG,CACxC,IACI8D,EADA0B,OAAM,EAEV,IAAKA,EAAM,EAAG1B,EAAIsB,EAAIpF,OAAQwF,EAAM1B,EAAG0B,IACrC,GAAIA,KAAOJ,GAAOY,EAAIb,KAAKc,EAAOb,EAAII,GAAMA,KAASP,KAAKF,MACxD,YAIJ,IAAK,IAAImB,KAAQd,EACf,GAAIY,EAAIb,KAAKc,EAAOb,EAAIc,GAAOA,KAAUjB,KAAKF,MAC5C,QAKRoB,MAAO,SAAeC,GACpBC,WAAWD,EAAK,IAElBE,SAAU,SAAkBC,EAAMC,EAAWC,GAC3C,IAAIC,OAAU,EACd,OAAO,WACL,IAAItB,EAAMH,KACNa,EAAO/F,UACX,SAAS4G,IACPD,EAAU,KACLD,GAAiBF,EAAKR,MAAMX,EAAKU,GAExC,IAAIc,EAAUH,IAAoBC,EAClCG,aAAaH,GACbA,EAAUL,WAAWM,EAASH,GAC1BI,GACFL,EAAKR,MAAMX,EAAKU,KAItBgB,QAAS,SAAiB1B,GACxB,OAAIA,EAAI0B,QAAgB1B,EAAI0B,UACrBlC,EAAUO,KAAKC,IAExBK,YAAa,SAAqBL,GAChC,YAAezV,IAARyV,GAET2B,OAAQ,SAAgB3B,GACtB,OAAe,OAARA,GAET4B,MAAO,SAAUC,GACf,SAASD,EAAME,GACb,OAAOD,EAAOlB,MAAMd,KAAMlF,WAK5B,OAHAiH,EAAM3C,SAAW,WACf,OAAO4C,EAAO5C,YAET2C,EAPF,EAQL,SAAU5B,GACV,OAAO4B,MAAM5B,MAEf+B,QAAS5W,MAAM4W,SAAW,SAAU/B,GAClC,OAAOA,EAAIgC,cAAgB7W,OAE7B8U,SAAU,SAAkBD,GAC1B,OAAOA,IAAQE,OAAOF,IAExBiC,SAAU,SAAkBjC,GAC1B,OAAOA,IAAQA,EAAM,GAEvBkC,SAAU,SAAkBlC,GAC1B,OAAOA,IAAQA,EAAM,IAEvBmC,UAAW,SAAmBnC,GAC5B,OAAe,IAARA,IAAyB,IAARA,GAE1BoC,WAAY,SAAoBpC,GAC9B,MAA+C,sBAAxCE,OAAOX,UAAUN,SAASc,KAAKC,KAItCqC,EAAkB,CACtB,CACEC,OAAQ5C,EAAOwC,SACfK,YAAa,CACXC,eAAgB,CACdC,KAAM,SAAcC,GAClB,IAAIC,EAAOD,EAASE,MAAM,sCAC1B,OAAa,OAATD,GAGG,CACLE,MAAO,MACPxD,IAAKyD,SAAS,KAAOH,EAAK,GAAG1D,WAAa0D,EAAK,GAAG1D,WAAa0D,EAAK,GAAG1D,WAAa0D,EAAK,GAAG1D,WAAa0D,EAAK,GAAG1D,WAAa0D,EAAK,GAAG1D,WAAY,KAGtJ8D,MAAOpE,GAETqE,aAAc,CACZP,KAAM,SAAcC,GAClB,IAAIC,EAAOD,EAASE,MAAM,qBAC1B,OAAa,OAATD,GAGG,CACLE,MAAO,MACPxD,IAAKyD,SAAS,KAAOH,EAAK,GAAG1D,WAAY,KAG7C8D,MAAOpE,GAETsE,QAAS,CACPR,KAAM,SAAcC,GAClB,IAAIC,EAAOD,EAASE,MAAM,4CAC1B,OAAa,OAATD,GAGG,CACLE,MAAO,MACPrG,EAAG0G,WAAWP,EAAK,IACnBzD,EAAGgE,WAAWP,EAAK,IACnBzT,EAAGgU,WAAWP,EAAK,MAGvBI,MAAOpE,GAETwE,SAAU,CACRV,KAAM,SAAcC,GAClB,IAAIC,EAAOD,EAASE,MAAM,wDAC1B,OAAa,OAATD,GAGG,CACLE,MAAO,MACPrG,EAAG0G,WAAWP,EAAK,IACnBzD,EAAGgE,WAAWP,EAAK,IACnBzT,EAAGgU,WAAWP,EAAK,IACnBhX,EAAGuX,WAAWP,EAAK,MAGvBI,MAAOpE,KAIb,CACE2D,OAAQ5C,EAAOuC,SACfM,YAAa,CACXa,IAAK,CACHX,KAAM,SAAcC,GAClB,MAAO,CACLG,MAAO,MACPxD,IAAKqD,EACL1D,eAAgB,QAGpB+D,MAAO,SAAenE,GACpB,OAAOA,EAAMS,QAKrB,CACEiD,OAAQ5C,EAAOqC,QACfQ,YAAa,CACXc,UAAW,CACTZ,KAAM,SAAcC,GAClB,OAAwB,IAApBA,EAAS9H,QAGN,CACLiI,MAAO,MACPrG,EAAGkG,EAAS,GACZxD,EAAGwD,EAAS,GACZxT,EAAGwT,EAAS,KAGhBK,MAAO,SAAenE,GACpB,MAAO,CAACA,EAAMpC,EAAGoC,EAAMM,EAAGN,EAAM1P,KAGpCoU,WAAY,CACVb,KAAM,SAAcC,GAClB,OAAwB,IAApBA,EAAS9H,QACN,CACLiI,MAAO,MACPrG,EAAGkG,EAAS,GACZxD,EAAGwD,EAAS,GACZxT,EAAGwT,EAAS,GACZ/W,EAAG+W,EAAS,KAGhBK,MAAO,SAAenE,GACpB,MAAO,CAACA,EAAMpC,EAAGoC,EAAMM,EAAGN,EAAM1P,EAAG0P,EAAMjT,OAKjD,CACE2W,OAAQ5C,EAAOO,SACfsC,YAAa,CACXgB,SAAU,CACRd,KAAM,SAAcC,GAClB,SAAIhD,EAAOuC,SAASS,EAASlG,IAAMkD,EAAOuC,SAASS,EAASxD,IAAMQ,EAAOuC,SAASS,EAASxT,IAAMwQ,EAAOuC,SAASS,EAAS/W,KACjH,CACLkX,MAAO,MACPrG,EAAGkG,EAASlG,EACZ0C,EAAGwD,EAASxD,EACZhQ,EAAGwT,EAASxT,EACZvD,EAAG+W,EAAS/W,IAKlBoX,MAAO,SAAenE,GACpB,MAAO,CACLpC,EAAGoC,EAAMpC,EACT0C,EAAGN,EAAMM,EACThQ,EAAG0P,EAAM1P,EACTvD,EAAGiT,EAAMjT,KAIf6X,QAAS,CACPf,KAAM,SAAcC,GAClB,SAAIhD,EAAOuC,SAASS,EAASlG,IAAMkD,EAAOuC,SAASS,EAASxD,IAAMQ,EAAOuC,SAASS,EAASxT,KAClF,CACL2T,MAAO,MACPrG,EAAGkG,EAASlG,EACZ0C,EAAGwD,EAASxD,EACZhQ,EAAGwT,EAASxT,IAKlB6T,MAAO,SAAenE,GACpB,MAAO,CACLpC,EAAGoC,EAAMpC,EACT0C,EAAGN,EAAMM,EACThQ,EAAG0P,EAAM1P,KAIfuU,SAAU,CACRhB,KAAM,SAAcC,GAClB,SAAIhD,EAAOuC,SAASS,EAASvD,IAAMO,EAAOuC,SAASS,EAAS3S,IAAM2P,EAAOuC,SAASS,EAASlT,IAAMkQ,EAAOuC,SAASS,EAAS/W,KACjH,CACLkX,MAAO,MACP1D,EAAGuD,EAASvD,EACZpP,EAAG2S,EAAS3S,EACZP,EAAGkT,EAASlT,EACZ7D,EAAG+W,EAAS/W,IAKlBoX,MAAO,SAAenE,GACpB,MAAO,CACLO,EAAGP,EAAMO,EACTpP,EAAG6O,EAAM7O,EACTP,EAAGoP,EAAMpP,EACT7D,EAAGiT,EAAMjT,KAIf+X,QAAS,CACPjB,KAAM,SAAcC,GAClB,SAAIhD,EAAOuC,SAASS,EAASvD,IAAMO,EAAOuC,SAASS,EAAS3S,IAAM2P,EAAOuC,SAASS,EAASlT,KAClF,CACLqT,MAAO,MACP1D,EAAGuD,EAASvD,EACZpP,EAAG2S,EAAS3S,EACZP,EAAGkT,EAASlT,IAKlBuT,MAAO,SAAenE,GACpB,MAAO,CACLO,EAAGP,EAAMO,EACTpP,EAAG6O,EAAM7O,EACTP,EAAGoP,EAAMpP,QAMfmU,OAAS,EACTC,OAAW,EACXC,EAAY,WACdD,GAAW,EACX,IAAIlB,EAAW/H,UAAUC,OAAS,EAAI8E,EAAOgC,QAAQ/G,WAAaA,UAAU,GAe5E,OAdA+E,EAAOI,KAAKuC,GAAiB,SAAUyB,GACrC,GAAIA,EAAOxB,OAAOI,GAUhB,OATAhD,EAAOI,KAAKgE,EAAOvB,aAAa,SAAUwB,EAAY/E,GAEpD,GADA2E,EAASI,EAAWtB,KAAKC,IACR,IAAbkB,IAAiC,IAAXD,EAIxB,OAHAC,EAAWD,EACXA,EAAO3E,eAAiBA,EACxB2E,EAAOI,WAAaA,EACbrE,EAAOC,SAGXD,EAAOC,SAGXiE,GAGLI,OAAe,EACfC,EAAY,CACdC,WAAY,SAAoB/E,EAAGpP,EAAGP,GACpC,IAAI2U,EAAK9Y,KAAK4P,MAAMkE,EAAI,IAAM,EAC1B/I,EAAI+I,EAAI,GAAK9T,KAAK4P,MAAMkE,EAAI,IAC5B1B,EAAIjO,GAAK,EAAMO,GACfqB,EAAI5B,GAAK,EAAM4G,EAAIrG,GACnBE,EAAIT,GAAK,GAAO,EAAM4G,GAAKrG,GAC3BC,EAAI,CAAC,CAACR,EAAGS,EAAGwN,GAAI,CAACrM,EAAG5B,EAAGiO,GAAI,CAACA,EAAGjO,EAAGS,GAAI,CAACwN,EAAGrM,EAAG5B,GAAI,CAACS,EAAGwN,EAAGjO,GAAI,CAACA,EAAGiO,EAAGrM,IAAI+S,GAC3E,MAAO,CACL3H,EAAU,IAAPxM,EAAE,GACLkP,EAAU,IAAPlP,EAAE,GACLd,EAAU,IAAPc,EAAE,KAGToU,WAAY,SAAoB5H,EAAG0C,EAAGhQ,GACpC,IAAIgM,EAAM7P,KAAK6P,IAAIsB,EAAG0C,EAAGhQ,GACrBuL,EAAMpP,KAAKoP,IAAI+B,EAAG0C,EAAGhQ,GACrBmV,EAAQ5J,EAAMS,EACdiE,OAAI,EAER,OAAY,IAAR1E,EAGK,CACL0E,EAAGmF,IACHvU,EAAG,EACHP,EAAG,IAIL2P,EADE3C,IAAM/B,GACHyE,EAAIhQ,GAAKmV,EACLnF,IAAMzE,EACX,GAAKvL,EAAIsN,GAAK6H,EAEd,GAAK7H,EAAI0C,GAAKmF,GAEpBlF,GAAK,GACG,IACNA,GAAK,GAEA,CACLA,EAAO,IAAJA,EACHpP,EArBIsU,EAAQ5J,EAsBZjL,EAAGiL,EAAM,OAGb8J,WAAY,SAAoB/H,EAAG0C,EAAGhQ,GACpC,IAAImQ,EAAMQ,KAAK2E,mBAAmB,EAAG,EAAGhI,GAGxC,OAFA6C,EAAMQ,KAAK2E,mBAAmBnF,EAAK,EAAGH,GACtCG,EAAMQ,KAAK2E,mBAAmBnF,EAAK,EAAGnQ,IAGxCuV,mBAAoB,SAA4BpF,EAAKqF,GACnD,OAAOrF,GAAwB,EAAjBqF,EAAqB,KAErCF,mBAAoB,SAA4BnF,EAAKqF,EAAgBC,GACnE,OAAOA,IAAUX,EAAgC,EAAjBU,GAAsBrF,IAAQ,KAAQ2E,KAItEY,EAA4B,mBAAXC,QAAoD,iBAApBA,OAAOC,SAAwB,SAAU9E,GAC5F,cAAcA,GACZ,SAAUA,GACZ,OAAOA,GAAyB,mBAAX6E,QAAyB7E,EAAIgC,cAAgB6C,QAAU7E,IAAQ6E,OAAOtF,UAAY,gBAAkBS,GAavH+E,EAAiB,SAAUC,EAAUC,GACvC,KAAMD,aAAoBC,GACxB,MAAM,IAAIC,UAAU,sCAIpBC,EAAc,WAChB,SAASC,EAAiBzM,EAAQ0M,GAChC,IAAK,IAAI3K,EAAI,EAAGA,EAAI2K,EAAMzK,OAAQF,IAAK,CACrC,IAAI4K,EAAaD,EAAM3K,GACvB4K,EAAWC,WAAaD,EAAWC,aAAc,EACjDD,EAAWE,cAAe,EACtB,UAAWF,IAAYA,EAAWG,UAAW,GACjDvF,OAAOwF,eAAe/M,EAAQ2M,EAAWlF,IAAKkF,IAIlD,OAAO,SAAUL,EAAaU,EAAYC,GAGxC,OAFID,GAAYP,EAAiBH,EAAY1F,UAAWoG,GACpDC,GAAaR,EAAiBH,EAAaW,GACxCX,GAdO,GAwBdY,EAAM,SAASA,EAAIC,EAAQC,EAAUC,GACxB,OAAXF,IAAiBA,EAASG,SAAS1G,WACvC,IAAI2G,EAAOhG,OAAOiG,yBAAyBL,EAAQC,GAEnD,QAAaxb,IAAT2b,EAAoB,CACtB,IAAIE,EAASlG,OAAOmG,eAAeP,GAEnC,OAAe,OAAXM,OACF,EAEOP,EAAIO,EAAQL,EAAUC,GAE1B,GAAI,UAAWE,EACpB,OAAOA,EAAKvB,MAEZ,IAAI2B,EAASJ,EAAKL,IAElB,YAAetb,IAAX+b,EAIGA,EAAOvG,KAAKiG,QAJnB,GAQAO,EAAW,SAAUC,EAAUC,GACjC,GAA0B,mBAAfA,GAA4C,OAAfA,EACtC,MAAM,IAAIvB,UAAU,kEAAoEuB,GAG1FD,EAASjH,UAAYW,OAAO1U,OAAOib,GAAcA,EAAWlH,UAAW,CACrEyC,YAAa,CACX2C,MAAO6B,EACPjB,YAAY,EACZE,UAAU,EACVD,cAAc,KAGdiB,IAAYvG,OAAOwG,eAAiBxG,OAAOwG,eAAeF,EAAUC,GAAcD,EAASG,UAAYF,IAazGG,EAA4B,SAAUC,EAAM9G,GAC9C,IAAK8G,EACH,MAAM,IAAIC,eAAe,6DAG3B,OAAO/G,GAAyB,iBAATA,GAAqC,mBAATA,EAA8B8G,EAAP9G,GAGxEgH,EAAQ,WACV,SAASA,IAGP,GAFAhC,EAAelF,KAAMkH,GACrBlH,KAAKd,QAAU8E,EAAUlD,MAAMd,KAAMlF,YAChB,IAAjBkF,KAAKd,QACP,MAAM,IAAIiI,MAAM,uCAElBnH,KAAKd,QAAQpT,EAAIkU,KAAKd,QAAQpT,GAAK,EAkBrC,OAhBAwZ,EAAY4B,EAAO,CAAC,CAClB3G,IAAK,WACLuE,MAAO,WACL,OAAOhG,EAAckB,QAEtB,CACDO,IAAK,cACLuE,MAAO,WACL,OAAOhG,EAAckB,MAAM,KAE5B,CACDO,IAAK,aACLuE,MAAO,WACL,OAAO9E,KAAKd,QAAQgF,WAAWhB,MAAMlD,UAGlCkH,EAzBG,GA2BZ,SAASE,EAAmBtO,EAAQuO,EAAWC,GAC7CjH,OAAOwF,eAAe/M,EAAQuO,EAAW,CACvCrB,IAAK,WACH,MAA2B,QAAvBhG,KAAKd,QAAQ8D,OAGjBkE,EAAMK,eAAevH,KAAMqH,EAAWC,GAF7BtH,KAAKd,QAAQmI,IAKxBpa,IAAK,SAAgB0C,GACQ,QAAvBqQ,KAAKd,QAAQ8D,QACfkE,EAAMK,eAAevH,KAAMqH,EAAWC,GACtCtH,KAAKd,QAAQ8D,MAAQ,OAEvBhD,KAAKd,QAAQmI,GAAa1X,KAIhC,SAAS6X,EAAmB1O,EAAQuO,GAClChH,OAAOwF,eAAe/M,EAAQuO,EAAW,CACvCrB,IAAK,WACH,MAA2B,QAAvBhG,KAAKd,QAAQ8D,OAGjBkE,EAAMO,eAAezH,MAFZA,KAAKd,QAAQmI,IAKxBpa,IAAK,SAAgB0C,GACQ,QAAvBqQ,KAAKd,QAAQ8D,QACfkE,EAAMO,eAAezH,MACrBA,KAAKd,QAAQ8D,MAAQ,OAEvBhD,KAAKd,QAAQmI,GAAa1X,KAIhCuX,EAAMK,eAAiB,SAAUxI,EAAOsI,EAAWC,GACjD,GAA4B,QAAxBvI,EAAMG,QAAQ8D,MAChBjE,EAAMG,QAAQmI,GAAajD,EAAUQ,mBAAmB7F,EAAMG,QAAQM,IAAK8H,OACtE,IAA4B,QAAxBvI,EAAMG,QAAQ8D,MAGvB,MAAM,IAAImE,MAAM,yBAFhBtH,EAAOE,OAAOhB,EAAMG,QAASkF,EAAUC,WAAWtF,EAAMG,QAAQI,EAAGP,EAAMG,QAAQhP,EAAG6O,EAAMG,QAAQvP,MAKtGuX,EAAMO,eAAiB,SAAU1I,GAC/B,IAAI+E,EAASM,EAAUG,WAAWxF,EAAMpC,EAAGoC,EAAMM,EAAGN,EAAM1P,GAC1DwQ,EAAOE,OAAOhB,EAAMG,QAAS,CAC3BhP,EAAG4T,EAAO5T,EACVP,EAAGmU,EAAOnU,IAEPkQ,EAAOkC,MAAM+B,EAAOxE,GAEdO,EAAOW,YAAYzB,EAAMG,QAAQI,KAC1CP,EAAMG,QAAQI,EAAI,GAFlBP,EAAMG,QAAQI,EAAIwE,EAAOxE,GAK7B4H,EAAMQ,WAAa,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,MAAO,KACzDN,EAAmBF,EAAMxH,UAAW,IAAK,GACzC0H,EAAmBF,EAAMxH,UAAW,IAAK,GACzC0H,EAAmBF,EAAMxH,UAAW,IAAK,GACzC8H,EAAmBN,EAAMxH,UAAW,KACpC8H,EAAmBN,EAAMxH,UAAW,KACpC8H,EAAmBN,EAAMxH,UAAW,KACpCW,OAAOwF,eAAeqB,EAAMxH,UAAW,IAAK,CAC1CsG,IAAK,WACH,OAAOhG,KAAKd,QAAQpT,GAEtBmB,IAAK,SAAgB0C,GACnBqQ,KAAKd,QAAQpT,EAAI6D,KAGrB0Q,OAAOwF,eAAeqB,EAAMxH,UAAW,MAAO,CAC5CsG,IAAK,WAIH,MAH4B,SAAvBhG,KAAKd,QAAQ8D,QAChBhD,KAAKd,QAAQM,IAAM4E,EAAUM,WAAW1E,KAAKrD,EAAGqD,KAAKX,EAAGW,KAAK3Q,IAExD2Q,KAAKd,QAAQM,KAEtBvS,IAAK,SAAgB0C,GACnBqQ,KAAKd,QAAQ8D,MAAQ,MACrBhD,KAAKd,QAAQM,IAAM7P,KAIvB,IAAIgY,EAAa,WACf,SAASA,EAAW1B,EAAQC,GAC1BhB,EAAelF,KAAM2H,GACrB3H,KAAK4H,aAAe3B,EAAOC,GAC3BlG,KAAK6H,WAAaC,SAASC,cAAc,OACzC/H,KAAKiG,OAASA,EACdjG,KAAKkG,SAAWA,EAChBlG,KAAKgI,gBAAatd,EAClBsV,KAAKiI,sBAAmBvd,EAwC1B,OAtCA4a,EAAYqC,EAAY,CAAC,CACvBpH,IAAK,WACLuE,MAAO,SAAkB3D,GAEvB,OADAnB,KAAKgI,WAAa7G,EACXnB,OAER,CACDO,IAAK,iBACLuE,MAAO,SAAwB3D,GAE7B,OADAnB,KAAKiI,iBAAmB9G,EACjBnB,OAER,CACDO,IAAK,WACLuE,MAAO,SAAkBoD,GAMvB,OALAlI,KAAKiG,OAAOjG,KAAKkG,UAAYgC,EACzBlI,KAAKgI,YACPhI,KAAKgI,WAAW9H,KAAKF,KAAMkI,GAE7BlI,KAAKmI,gBACEnI,OAER,CACDO,IAAK,WACLuE,MAAO,WACL,OAAO9E,KAAKiG,OAAOjG,KAAKkG,YAEzB,CACD3F,IAAK,gBACLuE,MAAO,WACL,OAAO9E,OAER,CACDO,IAAK,aACLuE,MAAO,WACL,OAAO9E,KAAK4H,eAAiB5H,KAAKoI,eAG/BT,EAhDQ,GAwDbU,EAAgB,GACpBxI,EAAOI,KANS,CACdqI,WAAY,CAAC,UACbC,YAAa,CAAC,QAAS,YAAa,YAAa,UAAW,aAC5DC,eAAgB,CAAC,aAGI,SAAU7Y,EAAG8Y,GAClC5I,EAAOI,KAAKtQ,GAAG,SAAU+Y,GACvBL,EAAcK,GAAKD,QAGvB,IAAIE,EAAmB,kBACvB,SAASC,EAAiBC,GACxB,GAAY,MAARA,GAAehJ,EAAOW,YAAYqI,GACpC,OAAO,EAET,IAAI9F,EAAQ8F,EAAI9F,MAAM4F,GACtB,OAAK9I,EAAOiC,OAAOiB,GAGZ,EAFEM,WAAWN,EAAM,IAI5B,IAAI+F,EAAM,CACRC,eAAgB,SAAwBC,EAAMC,QAC/Bve,IAATse,QAAqCte,IAAfse,EAAKE,QAC/BF,EAAKG,cAAgBF,EAAa,WAChC,OAAO,GACL,aACJD,EAAKE,MAAME,cAAgBH,EAAa,OAAS,OACjDD,EAAKE,MAAMG,gBAAkBJ,EAAa,OAAS,OACnDD,EAAKM,aAAeL,EAAa,KAAO,QAE1CM,eAAgB,SAAwBP,EAAMQ,EAAKC,GACjD,IAAIC,EAAWD,EACXE,EAAaH,EACb3J,EAAOW,YAAYmJ,KACrBA,GAAa,GAEX9J,EAAOW,YAAYkJ,KACrBA,GAAW,GAEbV,EAAKE,MAAMU,SAAW,WAClBD,IACFX,EAAKE,MAAMvT,KAAO,EAClBqT,EAAKE,MAAMtT,MAAQ,GAEjB8T,IACFV,EAAKE,MAAMpT,IAAM,EACjBkT,EAAKE,MAAMrT,OAAS,IAGxBgU,UAAW,SAAmBb,EAAMc,EAAWC,EAAMC,GACnD,IAAIC,EAASF,GAAQ,GACjBG,EAAY7B,EAAcyB,GAC9B,IAAKI,EACH,MAAM,IAAI/C,MAAM,cAAgB2C,EAAY,mBAE9C,IAAIK,EAAMrC,SAASsC,YAAYF,GAC/B,OAAQA,GACN,IAAK,cAED,IAAIG,EAAUJ,EAAOra,GAAKqa,EAAOI,SAAW,EACxCC,EAAUL,EAAOpa,GAAKoa,EAAOK,SAAW,EAC5CH,EAAII,eAAeT,EAAWG,EAAOO,UAAW,EAAOP,EAAOQ,aAAc,EAAMC,OAAQT,EAAOU,YAAc,EAAG,EAClH,EACAN,EACAC,GACA,GAAO,GAAO,GAAO,EAAO,EAAG,MAC/B,MAEJ,IAAK,iBAED,IAAIM,EAAOT,EAAIU,mBAAqBV,EAAIW,aACxCjL,EAAOa,SAASuJ,EAAQ,CACtBQ,YAAY,EACZM,SAAS,EACTC,QAAQ,EACRC,UAAU,EACVC,SAAS,EACTC,aAASzgB,EACT0gB,cAAU1gB,IAEZkgB,EAAKd,EAAWG,EAAOO,UAAW,EAAOP,EAAOQ,WAAYC,OAAQT,EAAOc,QAASd,EAAOe,OAAQf,EAAOgB,SAAUhB,EAAOiB,QAASjB,EAAOkB,QAASlB,EAAOmB,UAC3J,MAEJ,QAEIjB,EAAIkB,UAAUvB,EAAWG,EAAOO,UAAW,EAAOP,EAAOQ,aAAc,GAI7E5K,EAAOa,SAASyJ,EAAKH,GACrBhB,EAAKsC,cAAcnB,IAErB1J,KAAM,SAAcuI,EAAMuC,EAAOjK,EAAMkK,GACrC,IAAIC,EAAOD,IAAW,EAMtB,OALIxC,EAAK0C,iBACP1C,EAAK0C,iBAAiBH,EAAOjK,EAAMmK,GAC1BzC,EAAK2C,aACd3C,EAAK2C,YAAY,KAAOJ,EAAOjK,GAE1BwH,GAET8C,OAAQ,SAAgB5C,EAAMuC,EAAOjK,EAAMkK,GACzC,IAAIC,EAAOD,IAAW,EAMtB,OALIxC,EAAK6C,oBACP7C,EAAK6C,oBAAoBN,EAAOjK,EAAMmK,GAC7BzC,EAAK8C,aACd9C,EAAK8C,YAAY,KAAOP,EAAOjK,GAE1BwH,GAETiD,SAAU,SAAkB/C,EAAMkB,GAChC,QAAuBxf,IAAnBse,EAAKkB,UACPlB,EAAKkB,UAAYA,OACZ,GAAIlB,EAAKkB,YAAcA,EAAW,CACvC,IAAI8B,EAAUhD,EAAKkB,UAAU+B,MAAM,OACC,IAAhCD,EAAQE,QAAQhC,KAClB8B,EAAQG,KAAKjC,GACblB,EAAKkB,UAAY8B,EAAQI,KAAK,KAAKC,QAAQ,OAAQ,IAAIA,QAAQ,OAAQ,KAG3E,OAAOvD,GAETwD,YAAa,SAAqBtD,EAAMkB,GACtC,GAAIA,EACF,GAAIlB,EAAKkB,YAAcA,EACrBlB,EAAKuD,gBAAgB,aAChB,CACL,IAAIP,EAAUhD,EAAKkB,UAAU+B,MAAM,MAC/BO,EAAQR,EAAQE,QAAQhC,IACb,IAAXsC,IACFR,EAAQS,OAAOD,EAAO,GACtBxD,EAAKkB,UAAY8B,EAAQI,KAAK,WAIlCpD,EAAKkB,eAAYxf,EAEnB,OAAOoe,GAET4D,SAAU,SAAkB1D,EAAMkB,GAChC,OAAO,IAAIyC,OAAO,aAAezC,EAAY,cAAcpH,KAAKkG,EAAKkB,aAAc,GAErF0C,SAAU,SAAkB5D,GAC1B,IAAIE,EAAQ2D,iBAAiB7D,GAC7B,OAAOJ,EAAiBM,EAAM,sBAAwBN,EAAiBM,EAAM,uBAAyBN,EAAiBM,EAAM,iBAAmBN,EAAiBM,EAAM,kBAAoBN,EAAiBM,EAAM4D,QAEpNC,UAAW,SAAmB/D,GAC5B,IAAIE,EAAQ2D,iBAAiB7D,GAC7B,OAAOJ,EAAiBM,EAAM,qBAAuBN,EAAiBM,EAAM,wBAA0BN,EAAiBM,EAAM,gBAAkBN,EAAiBM,EAAM,mBAAqBN,EAAiBM,EAAM8D,SAEpNC,UAAW,SAAmBC,GAC5B,IAAIlE,EAAOkE,EACPzO,EAAS,CAAE9I,KAAM,EAAGG,IAAK,GAC7B,GAAIkT,EAAKmE,aACP,GACE1O,EAAO9I,MAAQqT,EAAKoE,WACpB3O,EAAO3I,KAAOkT,EAAKqE,UACnBrE,EAAOA,EAAKmE,mBACLnE,GAEX,OAAOvK,GAET6O,SAAU,SAAkBtE,GAC1B,OAAOA,IAASlB,SAASyF,gBAAkBvE,EAAKwE,MAAQxE,EAAKyE,QAI7DC,EAAoB,SAAUC,GAEhC,SAASD,EAAkBzH,EAAQC,GACjChB,EAAelF,KAAM0N,GACrB,IAAIE,EAAS7G,EAA0B/G,MAAO0N,EAAkB5G,WAAazG,OAAOmG,eAAekH,IAAoBxN,KAAKF,KAAMiG,EAAQC,IACtI2H,EAAQD,EAUZ,OATAA,EAAOE,OAASF,EAAOxF,WACvBwF,EAAOG,WAAajG,SAASC,cAAc,SAC3C6F,EAAOG,WAAWC,aAAa,OAAQ,YAIvClF,EAAIrI,KAAKmN,EAAOG,WAAY,UAH5B,WACEF,EAAMI,UAAUJ,EAAMC,WAEwB,GAChDF,EAAO/F,WAAWqG,YAAYN,EAAOG,YACrCH,EAAOzF,gBACAyF,EA0BT,OAxCAlH,EAASgH,EAAmBC,GAgB5BrI,EAAYoI,EAAmB,CAAC,CAC9BnN,IAAK,WACLuE,MAAO,SAAkBnV,GACvB,IAAIoU,EAAWiC,EAAI0H,EAAkBhO,UAAUoH,WAAazG,OAAOmG,eAAekH,EAAkBhO,WAAY,WAAYM,MAAME,KAAKF,KAAMrQ,GAK7I,OAJIqQ,KAAKiI,kBACPjI,KAAKiI,iBAAiB/H,KAAKF,KAAMA,KAAKoI,YAExCpI,KAAK8N,OAAS9N,KAAKoI,WACZrE,IAER,CACDxD,IAAK,gBACLuE,MAAO,WASL,OARwB,IAApB9E,KAAKoI,YACPpI,KAAK+N,WAAWC,aAAa,UAAW,WACxChO,KAAK+N,WAAWI,SAAU,EAC1BnO,KAAK8N,QAAS,IAEd9N,KAAK+N,WAAWI,SAAU,EAC1BnO,KAAK8N,QAAS,GAET9H,EAAI0H,EAAkBhO,UAAUoH,WAAazG,OAAOmG,eAAekH,EAAkBhO,WAAY,gBAAiBM,MAAME,KAAKF,UAGjI0N,EAzCe,CA0CtB/F,GAEEyG,EAAmB,SAAUT,GAE/B,SAASS,EAAiBnI,EAAQC,EAAUmI,GAC1CnJ,EAAelF,KAAMoO,GACrB,IAAIR,EAAS7G,EAA0B/G,MAAOoO,EAAiBtH,WAAazG,OAAOmG,eAAe4H,IAAmBlO,KAAKF,KAAMiG,EAAQC,IACpIoI,EAAUD,EACVR,EAAQD,EAEZ,GADAA,EAAOW,SAAWzG,SAASC,cAAc,UACrClI,EAAOqC,QAAQoM,GAAU,CAC3B,IAAIE,EAAM,GACV3O,EAAOI,KAAKqO,GAAS,SAAUG,GAC7BD,EAAIC,GAAWA,KAEjBH,EAAUE,EAcZ,OAZA3O,EAAOI,KAAKqO,GAAS,SAAUxJ,EAAOvE,GACpC,IAAImO,EAAM5G,SAASC,cAAc,UACjC2G,EAAIC,UAAYpO,EAChBmO,EAAIV,aAAa,QAASlJ,GAC1B+I,EAAMU,SAASL,YAAYQ,MAE7Bd,EAAOzF,gBACPW,EAAIrI,KAAKmN,EAAOW,SAAU,UAAU,WAClC,IAAIK,EAAe5O,KAAKsO,QAAQtO,KAAK6O,eAAe/J,MACpD+I,EAAMI,SAASW,MAEjBhB,EAAO/F,WAAWqG,YAAYN,EAAOW,UAC9BX,EAmBT,OA7CAlH,EAAS0H,EAAkBT,GA4B3BrI,EAAY8I,EAAkB,CAAC,CAC7B7N,IAAK,WACLuE,MAAO,SAAkBnV,GACvB,IAAIoU,EAAWiC,EAAIoI,EAAiB1O,UAAUoH,WAAazG,OAAOmG,eAAe4H,EAAiB1O,WAAY,WAAYM,MAAME,KAAKF,KAAMrQ,GAI3I,OAHIqQ,KAAKiI,kBACPjI,KAAKiI,iBAAiB/H,KAAKF,KAAMA,KAAKoI,YAEjCrE,IAER,CACDxD,IAAK,gBACLuE,MAAO,WACL,OAAIgE,EAAIwE,SAAStN,KAAKuO,UAAkBvO,MACxCA,KAAKuO,SAASzJ,MAAQ9E,KAAKoI,WACpBpC,EAAIoI,EAAiB1O,UAAUoH,WAAazG,OAAOmG,eAAe4H,EAAiB1O,WAAY,gBAAiBM,MAAME,KAAKF,WAG/HoO,EA9Cc,CA+CrBzG,GAEEmH,EAAmB,SAAUnB,GAE/B,SAASmB,EAAiB7I,EAAQC,GAChChB,EAAelF,KAAM8O,GACrB,IAAIlB,EAAS7G,EAA0B/G,MAAO8O,EAAiBhI,WAAazG,OAAOmG,eAAesI,IAAmB5O,KAAKF,KAAMiG,EAAQC,IACpI2H,EAAQD,EACZ,SAASmB,IACPlB,EAAMI,SAASJ,EAAMmB,QAAQlK,OAmB/B,OAZA8I,EAAOoB,QAAUlH,SAASC,cAAc,SACxC6F,EAAOoB,QAAQhB,aAAa,OAAQ,QACpClF,EAAIrI,KAAKmN,EAAOoB,QAAS,QAASD,GAClCjG,EAAIrI,KAAKmN,EAAOoB,QAAS,SAAUD,GACnCjG,EAAIrI,KAAKmN,EAAOoB,QAAS,QATzB,WACMnB,EAAM5F,kBACR4F,EAAM5F,iBAAiB/H,KAAK2N,EAAOA,EAAMzF,eAQ7CU,EAAIrI,KAAKmN,EAAOoB,QAAS,WAAW,SAAUtG,GAC1B,KAAdA,EAAEyC,SACJnL,KAAKiP,UAGTrB,EAAOzF,gBACPyF,EAAO/F,WAAWqG,YAAYN,EAAOoB,SAC9BpB,EAWT,OApCAlH,EAASoI,EAAkBnB,GA2B3BrI,EAAYwJ,EAAkB,CAAC,CAC7BvO,IAAK,gBACLuE,MAAO,WAIL,OAHKgE,EAAIwE,SAAStN,KAAKgP,WACrBhP,KAAKgP,QAAQlK,MAAQ9E,KAAKoI,YAErBpC,EAAI8I,EAAiBpP,UAAUoH,WAAazG,OAAOmG,eAAesI,EAAiBpP,WAAY,gBAAiBM,MAAME,KAAKF,UAG/H8O,EArCc,CAsCrBnH,GAEF,SAASuH,EAAYtf,GACnB,IAAIqS,EAAKrS,EAAEwP,WACX,OAAI6C,EAAGiK,QAAQ,MAAQ,EACdjK,EAAGlH,OAASkH,EAAGiK,QAAQ,KAAO,EAEhC,EAET,IAAIiD,EAAmB,SAAUxB,GAE/B,SAASwB,EAAiBlJ,EAAQC,EAAU+D,GAC1C/E,EAAelF,KAAMmP,GACrB,IAAItB,EAAQ9G,EAA0B/G,MAAOmP,EAAiBrI,WAAazG,OAAOmG,eAAe2I,IAAmBjP,KAAKF,KAAMiG,EAAQC,IACnIkJ,EAAUnF,GAAU,GAcxB,OAbA4D,EAAMwB,MAAQD,EAAQ/T,IACtBwS,EAAMyB,MAAQF,EAAQxU,IACtBiT,EAAM0B,OAASH,EAAQI,KACnB3P,EAAOW,YAAYqN,EAAM0B,QACA,IAAvB1B,EAAMjG,aACRiG,EAAM4B,cAAgB,EAEtB5B,EAAM4B,cAAgBjkB,KAAKkkB,IAAI,GAAIlkB,KAAK4P,MAAM5P,KAAKmkB,IAAInkB,KAAKoN,IAAIiV,EAAMjG,eAAiBpc,KAAKokB,OAAS,GAGvG/B,EAAM4B,cAAgB5B,EAAM0B,OAE9B1B,EAAMgC,YAAcX,EAAYrB,EAAM4B,eAC/B5B,EAqCT,OAvDAnH,EAASyI,EAAkBxB,GAoB3BrI,EAAY6J,EAAkB,CAAC,CAC7B5O,IAAK,WACLuE,MAAO,SAAkBnV,GACvB,IAAImgB,EAAKngB,EAST,YARmBjF,IAAfsV,KAAKqP,OAAuBS,EAAK9P,KAAKqP,MACxCS,EAAK9P,KAAKqP,WACc3kB,IAAfsV,KAAKsP,OAAuBQ,EAAK9P,KAAKsP,QAC/CQ,EAAK9P,KAAKsP,YAEQ5kB,IAAhBsV,KAAKuP,QAAwBO,EAAK9P,KAAKuP,QAAW,IACpDO,EAAKtkB,KAAK8P,MAAMwU,EAAK9P,KAAKuP,QAAUvP,KAAKuP,QAEpCvJ,EAAImJ,EAAiBzP,UAAUoH,WAAazG,OAAOmG,eAAe2I,EAAiBzP,WAAY,WAAYM,MAAME,KAAKF,KAAM8P,KAEpI,CACDvP,IAAK,MACLuE,MAAO,SAAaiL,GAElB,OADA/P,KAAKqP,MAAQU,EACN/P,OAER,CACDO,IAAK,MACLuE,MAAO,SAAakL,GAElB,OADAhQ,KAAKsP,MAAQU,EACNhQ,OAER,CACDO,IAAK,OACLuE,MAAO,SAAcmL,GAInB,OAHAjQ,KAAKuP,OAASU,EACdjQ,KAAKyP,cAAgBQ,EACrBjQ,KAAK6P,YAAcX,EAAYe,GACxBjQ,SAGJmP,EAxDc,CAyDrBxH,GAMF,IAAIuI,EAAsB,SAAUC,GAElC,SAASD,EAAoBjK,EAAQC,EAAU+D,GAC7C/E,EAAelF,KAAMkQ,GACrB,IAAItC,EAAS7G,EAA0B/G,MAAOkQ,EAAoBpJ,WAAazG,OAAOmG,eAAe0J,IAAsBhQ,KAAKF,KAAMiG,EAAQC,EAAU+D,IACxJ2D,EAAOwC,uBAAwB,EAC/B,IAAIvC,EAAQD,EACRyC,OAAQ,EAOZ,SAASC,IACHzC,EAAM5F,kBACR4F,EAAM5F,iBAAiB/H,KAAK2N,EAAOA,EAAMzF,YAM7C,SAASmI,EAAY7H,GACnB,IAAI8H,EAAOH,EAAQ3H,EAAE4B,QACrBuD,EAAMI,SAASJ,EAAMzF,WAAaoI,EAAO3C,EAAM4B,eAC/CY,EAAQ3H,EAAE4B,QAEZ,SAASmG,IACP3H,EAAI8C,OAAOlB,OAAQ,YAAa6F,GAChCzH,EAAI8C,OAAOlB,OAAQ,UAAW+F,GAC9BH,IAsBF,OAfA1C,EAAOoB,QAAUlH,SAASC,cAAc,SACxC6F,EAAOoB,QAAQhB,aAAa,OAAQ,QACpClF,EAAIrI,KAAKmN,EAAOoB,QAAS,UA/BzB,WACE,IAAI0B,EAAYrN,WAAWwK,EAAMmB,QAAQlK,OACpCjF,EAAOkC,MAAM2O,IAChB7C,EAAMI,SAASyC,MA6BnB5H,EAAIrI,KAAKmN,EAAOoB,QAAS,QArBzB,WACEsB,OAqBFxH,EAAIrI,KAAKmN,EAAOoB,QAAS,aATzB,SAAqBtG,GACnBI,EAAIrI,KAAKiK,OAAQ,YAAa6F,GAC9BzH,EAAIrI,KAAKiK,OAAQ,UAAW+F,GAC5BJ,EAAQ3H,EAAE4B,WAOZxB,EAAIrI,KAAKmN,EAAOoB,QAAS,WAAW,SAAUtG,GAC1B,KAAdA,EAAEyC,UACJ0C,EAAMuC,uBAAwB,EAC9BpQ,KAAKiP,OACLpB,EAAMuC,uBAAwB,EAC9BE,QAGJ1C,EAAOzF,gBACPyF,EAAO/F,WAAWqG,YAAYN,EAAOoB,SAC9BpB,EAST,OA5DAlH,EAASwJ,EAAqBC,GAqD9B7K,EAAY4K,EAAqB,CAAC,CAChC3P,IAAK,gBACLuE,MAAO,WA5DX,IAAwBA,EAAO6L,EACzBC,EA6DA,OADA5Q,KAAKgP,QAAQlK,MAAQ9E,KAAKoQ,sBAAwBpQ,KAAKoI,YA7DrCtD,EA6DiE9E,KAAKoI,WA7D/DuI,EA6D2E3Q,KAAK6P,YA5DzGe,EAAQplB,KAAKkkB,IAAI,GAAIiB,GAClBnlB,KAAK8P,MAAMwJ,EAAQ8L,GAASA,GA4DxB5K,EAAIkK,EAAoBxQ,UAAUoH,WAAazG,OAAOmG,eAAe0J,EAAoBxQ,WAAY,gBAAiBM,MAAME,KAAKF,UAGrIkQ,EA7DiB,CA8DxBf,GAEF,SAASX,EAAI7e,EAAGkhB,EAAIC,EAAIC,EAAIC,GAC1B,OAAOD,GAAmBphB,EAAIkhB,IAAOC,EAAKD,IAA7BG,EAAKD,GAEpB,IAAIE,EAAyB,SAAUd,GAErC,SAASc,EAAuBhL,EAAQC,EAAU7K,EAAKT,EAAK4U,GAC1DtK,EAAelF,KAAMiR,GACrB,IAAIrD,EAAS7G,EAA0B/G,MAAOiR,EAAuBnK,WAAazG,OAAOmG,eAAeyK,IAAyB/Q,KAAKF,KAAMiG,EAAQC,EAAU,CAAE7K,IAAKA,EAAKT,IAAKA,EAAK4U,KAAMA,KACtL3B,EAAQD,EAaZ,SAAS2C,EAAY7H,GACnBA,EAAEwI,iBACF,IAAIC,EAAStD,EAAMuD,aAAaC,wBAEhC,OADAxD,EAAMI,SAASO,EAAI9F,EAAE2B,QAAS8G,EAAOxb,KAAMwb,EAAOvb,MAAOiY,EAAMwB,MAAOxB,EAAMyB,SACrE,EAET,SAASmB,IACP3H,EAAI8C,OAAOlB,OAAQ,YAAa6F,GAChCzH,EAAI8C,OAAOlB,OAAQ,UAAW+F,GAC1B5C,EAAM5F,kBACR4F,EAAM5F,iBAAiB/H,KAAK2N,EAAOA,EAAMzF,YAW7C,SAASkJ,EAAY5I,GACnB,IAAI2B,EAAU3B,EAAE6I,QAAQ,GAAGlH,QACvB8G,EAAStD,EAAMuD,aAAaC,wBAChCxD,EAAMI,SAASO,EAAInE,EAAS8G,EAAOxb,KAAMwb,EAAOvb,MAAOiY,EAAMwB,MAAOxB,EAAMyB,QAE5E,SAASkC,IACP1I,EAAI8C,OAAOlB,OAAQ,YAAa4G,GAChCxI,EAAI8C,OAAOlB,OAAQ,WAAY8G,GAC3B3D,EAAM5F,kBACR4F,EAAM5F,iBAAiB/H,KAAK2N,EAAOA,EAAMzF,YAM7C,OAhDAwF,EAAOwD,aAAetJ,SAASC,cAAc,OAC7C6F,EAAO6D,aAAe3J,SAASC,cAAc,OAC7Ce,EAAIrI,KAAKmN,EAAOwD,aAAc,aAI9B,SAAqB1I,GACnBZ,SAASyF,cAAc0B,OACvBnG,EAAIrI,KAAKiK,OAAQ,YAAa6F,GAC9BzH,EAAIrI,KAAKiK,OAAQ,UAAW+F,GAC5BF,EAAY7H,MAPdI,EAAIrI,KAAKmN,EAAOwD,aAAc,cAsB9B,SAAsB1I,GACpB,GAAyB,IAArBA,EAAE6I,QAAQxW,OACZ,OAEF+N,EAAIrI,KAAKiK,OAAQ,YAAa4G,GAC9BxI,EAAIrI,KAAKiK,OAAQ,WAAY8G,GAC7BF,EAAY5I,MA3BdI,EAAIiD,SAAS6B,EAAOwD,aAAc,UAClCtI,EAAIiD,SAAS6B,EAAO6D,aAAc,aAwClC7D,EAAOzF,gBACPyF,EAAOwD,aAAalD,YAAYN,EAAO6D,cACvC7D,EAAO/F,WAAWqG,YAAYN,EAAOwD,cAC9BxD,EAUT,OA/DAlH,EAASuK,EAAwBd,GAuDjC7K,EAAY2L,EAAwB,CAAC,CACnC1Q,IAAK,gBACLuE,MAAO,WACL,IAAI4M,GAAO1R,KAAKoI,WAAapI,KAAKqP,QAAUrP,KAAKsP,MAAQtP,KAAKqP,OAE9D,OADArP,KAAKyR,aAAavI,MAAM4D,MAAc,IAAN4E,EAAY,IACrC1L,EAAIiL,EAAuBvR,UAAUoH,WAAazG,OAAOmG,eAAeyK,EAAuBvR,WAAY,gBAAiBM,MAAME,KAAKF,UAG3IiR,EAhEoB,CAiE3B9B,GAEEwC,EAAqB,SAAUhE,GAEjC,SAASgE,EAAmB1L,EAAQC,EAAU0L,GAC5C1M,EAAelF,KAAM2R,GACrB,IAAI/D,EAAS7G,EAA0B/G,MAAO2R,EAAmB7K,WAAazG,OAAOmG,eAAemL,IAAqBzR,KAAKF,KAAMiG,EAAQC,IACxI2H,EAAQD,EAUZ,OATAA,EAAOiE,SAAW/J,SAASC,cAAc,OACzC6F,EAAOiE,SAASlD,eAAqBjkB,IAATknB,EAAqB,OAASA,EAC1D9I,EAAIrI,KAAKmN,EAAOiE,SAAU,SAAS,SAAUnJ,GAG3C,OAFAA,EAAEwI,iBACFrD,EAAMiE,QACC,KAEThJ,EAAIiD,SAAS6B,EAAOiE,SAAU,UAC9BjE,EAAO/F,WAAWqG,YAAYN,EAAOiE,UAC9BjE,EAcT,OA5BAlH,EAASiL,EAAoBhE,GAgB7BrI,EAAYqM,EAAoB,CAAC,CAC/BpR,IAAK,OACLuE,MAAO,WACD9E,KAAKgI,YACPhI,KAAKgI,WAAW9H,KAAKF,MAEvBA,KAAKoI,WAAWlI,KAAKF,KAAKiG,QACtBjG,KAAKiI,kBACPjI,KAAKiI,iBAAiB/H,KAAKF,KAAMA,KAAKoI,gBAIrCuJ,EA7BgB,CA8BvBhK,GAEEoK,EAAkB,SAAUpE,GAE9B,SAASoE,EAAgB9L,EAAQC,GAC/BhB,EAAelF,KAAM+R,GACrB,IAAInE,EAAS7G,EAA0B/G,MAAO+R,EAAgBjL,WAAazG,OAAOmG,eAAeuL,IAAkB7R,KAAKF,KAAMiG,EAAQC,IACtI0H,EAAOoE,QAAU,IAAI9K,EAAM0G,EAAOxF,YAClCwF,EAAOqE,OAAS,IAAI/K,EAAM,GAC1B,IAAI2G,EAAQD,EACZA,EAAO/F,WAAaC,SAASC,cAAc,OAC3Ce,EAAIC,eAAe6E,EAAO/F,YAAY,GACtC+F,EAAOsE,WAAapK,SAASC,cAAc,OAC3C6F,EAAOsE,WAAWhI,UAAY,WAC9B0D,EAAOuE,mBAAqBrK,SAASC,cAAc,OACnD6F,EAAOuE,mBAAmBjI,UAAY,mBACtC0D,EAAOwE,aAAetK,SAASC,cAAc,OAC7C6F,EAAOwE,aAAalI,UAAY,aAChC0D,EAAOyE,oBAAsB,aAC7BzE,EAAO0E,WAAaxK,SAASC,cAAc,OAC3C6F,EAAO0E,WAAWpI,UAAY,WAC9B0D,EAAO2E,YAAczK,SAASC,cAAc,OAC5C6F,EAAO2E,YAAYrI,UAAY,YAC/B0D,EAAOoB,QAAUlH,SAASC,cAAc,SACxC6F,EAAOoB,QAAQxB,KAAO,OACtBI,EAAO4E,mBAAqB,aAC5B1J,EAAIrI,KAAKmN,EAAOoB,QAAS,WAAW,SAAUtG,GAC1B,KAAdA,EAAEyC,SACJsH,EAAOvS,KAAKF,SAGhB8I,EAAIrI,KAAKmN,EAAOoB,QAAS,OAAQyD,GACjC3J,EAAIrI,KAAKmN,EAAOsE,WAAY,aAAa,WACvCpJ,EAAIiD,SAAS/L,KAAM,QAAQS,KAAKiK,OAAQ,WAAW,WACjD5B,EAAIwD,YAAYuB,EAAMqE,WAAY,cAGtCpJ,EAAIrI,KAAKmN,EAAOsE,WAAY,cAAc,WACxCpJ,EAAIiD,SAAS/L,KAAM,QAAQS,KAAKiK,OAAQ,YAAY,WAClD5B,EAAIwD,YAAYuB,EAAMqE,WAAY,cAGtC,IA2MiBlJ,EA3Mb0J,EAAa5K,SAASC,cAAc,OA8DxC,SAAS4K,EAAUjK,GACjBkK,EAAMlK,GACNI,EAAIrI,KAAKiK,OAAQ,YAAakI,GAC9B9J,EAAIrI,KAAKiK,OAAQ,YAAakI,GAC9B9J,EAAIrI,KAAKiK,OAAQ,UAAWmI,GAC5B/J,EAAIrI,KAAKiK,OAAQ,WAAYmI,GAE/B,SAASC,EAAWpK,GAClBqK,EAAKrK,GACLI,EAAIrI,KAAKiK,OAAQ,YAAaqI,GAC9BjK,EAAIrI,KAAKiK,OAAQ,YAAaqI,GAC9BjK,EAAIrI,KAAKiK,OAAQ,UAAWsI,GAC5BlK,EAAIrI,KAAKiK,OAAQ,WAAYsI,GAE/B,SAASH,IACP/J,EAAI8C,OAAOlB,OAAQ,YAAakI,GAChC9J,EAAI8C,OAAOlB,OAAQ,YAAakI,GAChC9J,EAAI8C,OAAOlB,OAAQ,UAAWmI,GAC9B/J,EAAI8C,OAAOlB,OAAQ,WAAYmI,GAC/BvC,IAEF,SAAS0C,IACPlK,EAAI8C,OAAOlB,OAAQ,YAAaqI,GAChCjK,EAAI8C,OAAOlB,OAAQ,YAAaqI,GAChCjK,EAAI8C,OAAOlB,OAAQ,UAAWsI,GAC9BlK,EAAI8C,OAAOlB,OAAQ,WAAYsI,GAC/B1C,IAEF,SAASmC,IACP,IAAI5X,EAAImJ,EAAUhE,KAAK8E,QACb,IAANjK,GACFgT,EAAMmE,QAAQ9S,QAAUrE,EACxBgT,EAAMI,SAASJ,EAAMmE,QAAQiB,eAE7BjT,KAAK8E,MAAQ+I,EAAMmE,QAAQ5S,WAG/B,SAASkR,IACHzC,EAAM5F,kBACR4F,EAAM5F,iBAAiB/H,KAAK2N,EAAOA,EAAMmE,QAAQiB,cAWrD,SAASL,EAAMlK,IACoB,IAA7BA,EAAE8E,KAAKtB,QAAQ,UACjBxD,EAAEwI,iBAEJ,IAAIgC,EAAYrF,EAAMsE,mBAAmBd,wBACrC8B,EAAOzK,EAAE6I,SAAW7I,EAAE6I,QAAQ,IAAM7I,EACpC2B,EAAU8I,EAAK9I,QACfC,EAAU6I,EAAK7I,QACfpa,GAAKma,EAAU6I,EAAUvd,OAASud,EAAUtd,MAAQsd,EAAUvd,MAC9DhG,EAAI,GAAK2a,EAAU4I,EAAUpd,MAAQod,EAAUrd,OAASqd,EAAUpd,KActE,OAbInG,EAAI,EACNA,EAAI,EACKA,EAAI,IACbA,EAAI,GAEFO,EAAI,EACNA,EAAI,EACKA,EAAI,IACbA,EAAI,GAEN2d,EAAMmE,QAAQriB,EAAIA,EAClBke,EAAMmE,QAAQ9hB,EAAIA,EAClB2d,EAAMI,SAASJ,EAAMmE,QAAQiB,eACtB,EAET,SAASF,EAAKrK,IACqB,IAA7BA,EAAE8E,KAAKtB,QAAQ,UACjBxD,EAAEwI,iBAEJ,IAAIgC,EAAYrF,EAAM0E,YAAYlB,wBAG9B/R,EAAI,IAFIoJ,EAAE6I,SAAW7I,EAAE6I,QAAQ,IAAM7I,GACrB4B,QACG4I,EAAUpd,MAAQod,EAAUrd,OAASqd,EAAUpd,KAQtE,OAPIwJ,EAAI,EACNA,EAAI,EACKA,EAAI,IACbA,EAAI,GAENuO,EAAMmE,QAAQ1S,EAAQ,IAAJA,EAClBuO,EAAMI,SAASJ,EAAMmE,QAAQiB,eACtB,EAET,OAzJApT,EAAOE,OAAO6N,EAAOsE,WAAWhJ,MAAO,CACrC4D,MAAO,QACPE,OAAQ,QACRoG,QAAS,MACTC,gBAAiB,OACjBC,UAAW,gCAEbzT,EAAOE,OAAO6N,EAAOwE,aAAalJ,MAAO,CACvCU,SAAU,WACVkD,MAAO,OACPE,OAAQ,OACRuG,OAAQ3F,EAAOyE,qBAAuBzE,EAAOoE,QAAQriB,EAAI,GAAM,OAAS,QACxE2jB,UAAW,8BACXE,aAAc,OACdC,OAAQ,IAEV5T,EAAOE,OAAO6N,EAAO0E,WAAWpJ,MAAO,CACrCU,SAAU,WACVkD,MAAO,OACPE,OAAQ,MACR0G,YAAa,iBACbD,OAAQ,IAEV5T,EAAOE,OAAO6N,EAAOuE,mBAAmBjJ,MAAO,CAC7C4D,MAAO,QACPE,OAAQ,QACRuG,OAAQ,iBACRI,YAAa,MACbC,QAAS,eACTC,OAAQ,YAEVhU,EAAOE,OAAO2S,EAAWxJ,MAAO,CAC9B4D,MAAO,OACPE,OAAQ,OACR8G,WAAY,SAEdC,EAAerB,EAAY,MAAO,gBAAiB,QACnD7S,EAAOE,OAAO6N,EAAO2E,YAAYrJ,MAAO,CACtC4D,MAAO,OACPE,OAAQ,QACRuG,OAAQ,iBACRM,OAAQ,YACRjK,SAAU,WACV9T,IAAK,MACLF,MAAO,SA8JQoT,EA5JL4E,EAAO2E,aA6JhBrJ,MAAM4K,WAAa,GACxB9K,EAAKE,MAAM8K,SAAW,qIACtBhL,EAAKE,MAAM8K,SAAW,kIACtBhL,EAAKE,MAAM8K,SAAW,6HACtBhL,EAAKE,MAAM8K,SAAW,8HACtBhL,EAAKE,MAAM8K,SAAW,0HAjKpBnU,EAAOE,OAAO6N,EAAOoB,QAAQ9F,MAAO,CAClC+K,QAAS,OACTC,UAAW,SACXnV,MAAO,OACPwU,OAAQ,EACRY,WAAY,OACZC,WAAYxG,EAAO4E,mBAAqB,oBAE1C1J,EAAIrI,KAAKmN,EAAOuE,mBAAoB,YAAaQ,GACjD7J,EAAIrI,KAAKmN,EAAOuE,mBAAoB,aAAcQ,GAClD7J,EAAIrI,KAAKmN,EAAOwE,aAAc,YAAaO,GAC3C7J,EAAIrI,KAAKmN,EAAOwE,aAAc,aAAcO,GAC5C7J,EAAIrI,KAAKmN,EAAO2E,YAAa,YAAaO,GAC1ChK,EAAIrI,KAAKmN,EAAO2E,YAAa,aAAcO,GA2C3ClF,EAAOuE,mBAAmBjE,YAAYwE,GACtC9E,EAAOsE,WAAWhE,YAAYN,EAAOwE,cACrCxE,EAAOsE,WAAWhE,YAAYN,EAAOuE,oBACrCvE,EAAOsE,WAAWhE,YAAYN,EAAO2E,aACrC3E,EAAO2E,YAAYrE,YAAYN,EAAO0E,YACtC1E,EAAO/F,WAAWqG,YAAYN,EAAOoB,SACrCpB,EAAO/F,WAAWqG,YAAYN,EAAOsE,YACrCtE,EAAOzF,gBA2CAyF,EAwCT,OAzOAlH,EAASqL,EAAiBpE,GAmM1BrI,EAAYyM,EAAiB,CAAC,CAC5BxR,IAAK,gBACLuE,MAAO,WACL,IAAIjK,EAAImJ,EAAUhE,KAAKoI,YACvB,IAAU,IAANvN,EAAa,CACf,IAAIwZ,GAAW,EACfxU,EAAOI,KAAKiH,EAAMQ,YAAY,SAAUL,GACtC,IAAKxH,EAAOW,YAAY3F,EAAEwM,MAAgBxH,EAAOW,YAAYR,KAAKgS,QAAQ9S,QAAQmI,KAAexM,EAAEwM,KAAerH,KAAKgS,QAAQ9S,QAAQmI,GAErI,OADAgN,GAAW,EACJ,KAERrU,MACCqU,GACFxU,EAAOE,OAAOC,KAAKgS,QAAQ9S,QAASrE,GAGxCgF,EAAOE,OAAOC,KAAKiS,OAAO/S,QAASc,KAAKgS,QAAQ9S,SAChDc,KAAKiS,OAAOnmB,EAAI,EAChB,IAAIwoB,EAAOtU,KAAKgS,QAAQriB,EAAI,IAAOqQ,KAAKgS,QAAQ9hB,EAAI,GAAM,IAAM,EAC5DqkB,EAAQ,IAAMD,EAClBzU,EAAOE,OAAOC,KAAKoS,aAAalJ,MAAO,CACrCsL,WAAY,IAAMxU,KAAKgS,QAAQ9hB,EAAI,EAAI,KACvCukB,UAAW,KAAO,EAAIzU,KAAKgS,QAAQriB,GAAK,EAAI,KAC5C0jB,gBAAiBrT,KAAKiS,OAAOyC,cAC7BnB,OAAQvT,KAAKqS,oBAAsB,OAASiC,EAAO,IAAMA,EAAO,IAAMA,EAAO,MAE/EtU,KAAKsS,WAAWpJ,MAAMuL,UAAyC,KAA5B,EAAIzU,KAAKgS,QAAQ1S,EAAI,KAAa,KACrEU,KAAKiS,OAAO/hB,EAAI,EAChB8P,KAAKiS,OAAOtiB,EAAI,EAChBokB,EAAe/T,KAAKmS,mBAAoB,OAAQ,OAAQnS,KAAKiS,OAAOyC,eACpE1U,KAAKgP,QAAQlK,MAAQ9E,KAAKgS,QAAQ5S,WAClCS,EAAOE,OAAOC,KAAKgP,QAAQ9F,MAAO,CAChCmK,gBAAiBrT,KAAKgS,QAAQ0C,cAC9B3V,MAAO,OAASuV,EAAO,IAAMA,EAAO,IAAMA,EAAO,IACjDF,WAAYpU,KAAKwS,mBAAqB,QAAU+B,EAAQ,IAAMA,EAAQ,IAAMA,EAAQ,aAInFxC,EA1Oa,CA2OpBpK,GACEgN,EAAU,CAAC,QAAS,MAAO,WAAY,OAAQ,IACnD,SAASZ,EAAe/K,EAAMpZ,EAAG9D,EAAGuD,GAClC2Z,EAAKE,MAAM4K,WAAa,GACxBjU,EAAOI,KAAK0U,GAAS,SAAUC,GAC7B5L,EAAKE,MAAM8K,SAAW,eAAiBY,EAAS,mBAAqBhlB,EAAI,KAAO9D,EAAI,QAAUuD,EAAI,cAYtG,IAAIwlB,EASM,SAAgBC,EAAYC,GAClC,IAAIC,EAAMD,GAASjN,SACfmN,EAAWnN,SAASC,cAAc,SACtCkN,EAASzH,KAAO,WAChByH,EAAStG,UAAYmG,EACrB,IAAII,EAAOF,EAAIG,qBAAqB,QAAQ,GAC5C,IACED,EAAKhH,YAAY+G,GACjB,MAAOvM,MAKT0M,EAAqB,4pBAErBC,EAAoB,SAA2BpP,EAAQC,GACzD,IAAI0B,EAAe3B,EAAOC,GAC1B,OAAIrG,EAAOqC,QAAQpH,UAAU,KAAO+E,EAAOO,SAAStF,UAAU,IACrD,IAAIsT,EAAiBnI,EAAQC,EAAUpL,UAAU,IAEtD+E,EAAOuC,SAASwF,GACd/H,EAAOuC,SAAStH,UAAU,KAAO+E,EAAOuC,SAAStH,UAAU,IACzD+E,EAAOuC,SAAStH,UAAU,IACrB,IAAImW,EAAuBhL,EAAQC,EAAUpL,UAAU,GAAIA,UAAU,GAAIA,UAAU,IAErF,IAAImW,EAAuBhL,EAAQC,EAAUpL,UAAU,GAAIA,UAAU,IAE1E+E,EAAOuC,SAAStH,UAAU,IACrB,IAAIoV,EAAoBjK,EAAQC,EAAU,CAAE7K,IAAKP,UAAU,GAAIF,IAAKE,UAAU,GAAI0U,KAAM1U,UAAU,KAEpG,IAAIoV,EAAoBjK,EAAQC,EAAU,CAAE7K,IAAKP,UAAU,GAAIF,IAAKE,UAAU,KAEnF+E,EAAOwC,SAASuF,GACX,IAAIkH,EAAiB7I,EAAQC,GAElCrG,EAAO0C,WAAWqF,GACb,IAAI+J,EAAmB1L,EAAQC,EAAU,IAE9CrG,EAAOyC,UAAUsF,GACZ,IAAI8F,EAAkBzH,EAAQC,GAEhC,MAMT,IAAIoP,EAA0B5K,OAAO6K,uBAAyB7K,OAAO8K,6BAA+B9K,OAAO+K,0BAA4B/K,OAAOgL,wBAA0BhL,OAAOiL,yBAH/K,SAA+BC,GAC7BxU,WAAWwU,EAAU,IAAO,KAI1BC,EAAc,WAChB,SAASA,IACP3Q,EAAelF,KAAM6V,GACrB7V,KAAK8V,kBAAoBhO,SAASC,cAAc,OAChDlI,EAAOE,OAAOC,KAAK8V,kBAAkB5M,MAAO,CAC1CmK,gBAAiB,kBACjBvd,IAAK,EACLH,KAAM,EACNie,QAAS,OACTH,OAAQ,OACRsC,QAAS,EACTC,iBAAkB,sBAClBC,WAAY,wBAEdnN,EAAIS,eAAevJ,KAAK8V,mBACxB9V,KAAK8V,kBAAkB5M,MAAMU,SAAW,QACxC5J,KAAK6H,WAAaC,SAASC,cAAc,OACzClI,EAAOE,OAAOC,KAAK6H,WAAWqB,MAAO,CACnCU,SAAU,QACVgK,QAAS,OACTH,OAAQ,OACRsC,QAAS,EACTC,iBAAkB,uDAClBC,WAAY,iDAEdnO,SAASoO,KAAKhI,YAAYlO,KAAK8V,mBAC/BhO,SAASoO,KAAKhI,YAAYlO,KAAK6H,YAC/B,IAAIgG,EAAQ7N,KACZ8I,EAAIrI,KAAKT,KAAK8V,kBAAmB,SAAS,WACxCjI,EAAMsI,UA2CV,OAxCA7Q,EAAYuQ,EAAa,CAAC,CACxBtV,IAAK,OACLuE,MAAO,WACL,IAAI+I,EAAQ7N,KACZA,KAAK8V,kBAAkB5M,MAAM0K,QAAU,QACvC5T,KAAK6H,WAAWqB,MAAM0K,QAAU,QAChC5T,KAAK6H,WAAWqB,MAAM6M,QAAU,EAChC/V,KAAK6H,WAAWqB,MAAMkN,gBAAkB,aACxCpW,KAAKqW,SACLxW,EAAOqB,OAAM,WACX2M,EAAMiI,kBAAkB5M,MAAM6M,QAAU,EACxClI,EAAMhG,WAAWqB,MAAM6M,QAAU,EACjClI,EAAMhG,WAAWqB,MAAMkN,gBAAkB,gBAG5C,CACD7V,IAAK,OACLuE,MAAO,WACL,IAAI+I,EAAQ7N,KACRmW,EAAO,SAASA,IAClBtI,EAAMhG,WAAWqB,MAAM0K,QAAU,OACjC/F,EAAMiI,kBAAkB5M,MAAM0K,QAAU,OACxC9K,EAAI8C,OAAOiC,EAAMhG,WAAY,sBAAuBsO,GACpDrN,EAAI8C,OAAOiC,EAAMhG,WAAY,gBAAiBsO,GAC9CrN,EAAI8C,OAAOiC,EAAMhG,WAAY,iBAAkBsO,IAEjDrN,EAAIrI,KAAKT,KAAK6H,WAAY,sBAAuBsO,GACjDrN,EAAIrI,KAAKT,KAAK6H,WAAY,gBAAiBsO,GAC3CrN,EAAIrI,KAAKT,KAAK6H,WAAY,iBAAkBsO,GAC5CnW,KAAK8V,kBAAkB5M,MAAM6M,QAAU,EACvC/V,KAAK6H,WAAWqB,MAAM6M,QAAU,EAChC/V,KAAK6H,WAAWqB,MAAMkN,gBAAkB,eAEzC,CACD7V,IAAK,SACLuE,MAAO,WACL9E,KAAK6H,WAAWqB,MAAMvT,KAAO+U,OAAO4L,WAAa,EAAIxN,EAAI8D,SAAS5M,KAAK6H,YAAc,EAAI,KACzF7H,KAAK6H,WAAWqB,MAAMpT,IAAM4U,OAAO6L,YAAc,EAAIzN,EAAIiE,UAAU/M,KAAK6H,YAAc,EAAI,SAGvFgO,EAxES,GA6ElBhB,EAtnDA,SAAyBA,GACvB,GAAKA,GAGiB,oBAAXnK,OAAX,CAIA,IAAIxB,EAAQpB,SAASC,cAAc,SAMnC,OAJAmB,EAAM8E,aAAa,OAAQ,YAC3B9E,EAAMyF,UAAYkG,EAClB/M,SAASoN,KAAKhH,YAAYhF,GAEnB2L,GAsmDQ2B,CAAgB,urLAGjC,IAIIC,EAAyB,WAC3B,IACE,QAAS/L,OAAOgM,aAChB,MAAOhO,GACP,OAAO,GAJkB,GAOzBiO,OAAgB,EAChBC,GAAkB,EAClBC,OAAqB,EACrBV,GAAO,EACPW,EAAe,GACfC,EAAM,SAASA,EAAIhN,GACrB,IAAI8D,EAAQ7N,KACRiK,EAASF,GAAQ,GACrB/J,KAAK6H,WAAaC,SAASC,cAAc,OACzC/H,KAAKgX,KAAOlP,SAASC,cAAc,MACnC/H,KAAK6H,WAAWqG,YAAYlO,KAAKgX,MACjClO,EAAIiD,SAAS/L,KAAK6H,WAtBA,MAuBlB7H,KAAKiX,UAAY,GACjBjX,KAAKkX,cAAgB,GACrBlX,KAAKmX,oBAAsB,GAC3BnX,KAAKoX,uCAAyC,GAC9CpX,KAAKqX,YAAc,GACnBpN,EAASpK,EAAOa,SAASuJ,EAAQ,CAC/BqN,YAAY,EACZC,WAAW,EACXzK,MAAOiK,EAAIS,gBAEbvN,EAASpK,EAAOa,SAASuJ,EAAQ,CAC/BwN,UAAWxN,EAAOsN,UAClBG,SAAUzN,EAAOsN,YAEd1X,EAAOW,YAAYyJ,EAAO0N,MAK7B1N,EAAO0N,KAAO,CAAEC,OAvCc,WAmC1B3N,EAAO2N,SACT3N,EAAO0N,KAAKC,OAAS3N,EAAO2N,QAK5B/X,EAAOW,YAAYyJ,EAAO1D,SAAW0D,EAAOyN,UAC9CZ,EAAa3K,KAAKnM,MAEpBiK,EAAOwN,UAAY5X,EAAOW,YAAYyJ,EAAO1D,SAAW0D,EAAOwN,UAC3DxN,EAAOsN,WAAa1X,EAAOW,YAAYyJ,EAAO4N,cAChD5N,EAAO4N,YAAa,GAEtB,IAoLMC,EApLFC,EAAkBtB,GAAyF,SAA/DC,aAAasB,QAAQC,GAAoBjY,KAAM,YAC3FkY,OAAqB,EACrBC,OAAW,EAmGf,GAlGA9X,OAAOkF,iBAAiBvF,KACxB,CACEuG,OAAQ,CACNP,IAAK,WACH,OAAOiE,EAAO1D,SAGlBsR,WAAY,CACV7R,IAAK,WACH,OAAOiE,EAAO4N,aAGlBN,UAAW,CACTvR,IAAK,WACH,OAAOiE,EAAOsN,YAGlBD,WAAY,CACVtR,IAAK,WACH,OAAOiE,EAAOqN,aAGlBM,OAAQ,CACN5R,IAAK,WACH,OAAI6H,EAAMtH,OACDsH,EAAMuK,UAAUR,OAElB3N,EAAO0N,KAAKC,QAErB3qB,IAAK,SAAgB0C,GACfke,EAAMtH,OACRsH,EAAMuK,UAAUR,OAASjoB,EAEzBsa,EAAO0N,KAAKC,OAASjoB,EAgtB/B,SAA8B0oB,GAC5B,IAAK,IAAI7L,EAAQ,EAAGA,EAAQ6L,EAAIC,gBAAgBvd,OAAQyR,IAClD6L,EAAIC,gBAAgB9L,GAAO1H,QAAUuT,EAAIT,SAC3CS,EAAIC,gBAAgBzJ,cAAgBrC,GAjtBlC+L,CAAqBvY,MACrB6N,EAAM2K,WAGV1L,MAAO,CACL9G,IAAK,WACH,OAAOiE,EAAO6C,OAEhB7f,IAAK,SAAgB0C,GACnBsa,EAAO6C,MAAQnd,EACf8oB,GAAS5K,EAAOle,KAGpB+oB,KAAM,CACJ1S,IAAK,WACH,OAAOiE,EAAOyO,MAEhBzrB,IAAK,SAAgB0C,GACnBsa,EAAOyO,KAAO/oB,EACVwoB,IACFA,EAASxJ,UAAY1E,EAAOyO,QAIlCC,OAAQ,CACN3S,IAAK,WACH,OAAOiE,EAAO0O,QAEhB1rB,IAAK,SAAgB0C,GACnBsa,EAAO0O,OAAShpB,EACZsa,EAAO0O,OACT7P,EAAIiD,SAAS8B,EAAMmJ,KAAMD,EAAI6B,cAE7B9P,EAAIwD,YAAYuB,EAAMmJ,KAAMD,EAAI6B,cAElC5Y,KAAK6Y,WACDhL,EAAMiL,gBACRjL,EAAMiL,cAAcnK,UAAYhf,EAAIonB,EAAIgC,UAAYhC,EAAIiC,eAI9DrB,KAAM,CACJ3R,IAAK,WACH,OAAOiE,EAAO0N,OAGlBI,gBAAiB,CACf/R,IAAK,WACH,OAAO+R,GAET9qB,IAAK,SAAgBwe,GACfgL,IACFsB,EAAkBtM,EACdA,EACF3C,EAAIrI,KAAKiK,OAAQ,SAAUwN,GAE3BpP,EAAI8C,OAAOlB,OAAQ,SAAUwN,GAE/BxB,aAAauC,QAAQhB,GAAoBpK,EAAO,WAAYpC,QAKhE5L,EAAOW,YAAYyJ,EAAO1D,QAAS,CAIrC,GAHAvG,KAAK2Y,OAAS1O,EAAO0O,SAAU,EAC/B7P,EAAIiD,SAAS/L,KAAK6H,WAAYkP,EAAImC,YAClCpQ,EAAIC,eAAe/I,KAAK6H,YAAY,GAChC4O,GACEsB,EAAiB,CACnBlK,EAAMkK,iBAAkB,EACxB,IAAIoB,EAAWzC,aAAasB,QAAQC,GAAoBjY,KAAM,QAC1DmZ,IACFlP,EAAO0N,KAAOyB,KAAKC,MAAMF,IAI/BnZ,KAAK8Y,cAAgBhR,SAASC,cAAc,OAC5C/H,KAAK8Y,cAAcnK,UAAYoI,EAAIiC,YACnClQ,EAAIiD,SAAS/L,KAAK8Y,cAAe/B,EAAIuC,oBACjCrP,EAAOqN,YACTxO,EAAIiD,SAAS/L,KAAK8Y,cAAe/B,EAAIwC,iBACrCvZ,KAAK6H,WAAW2R,aAAaxZ,KAAK8Y,cAAe9Y,KAAK6H,WAAW4R,WAAW,MAE5E3Q,EAAIiD,SAAS/L,KAAK8Y,cAAe/B,EAAI2C,oBACrC1Z,KAAK6H,WAAWqG,YAAYlO,KAAK8Y,gBAEnChQ,EAAIrI,KAAKT,KAAK8Y,cAAe,SAAS,WACpCjL,EAAM8K,QAAU9K,EAAM8K,cAEnB,MACiBjuB,IAAlBuf,EAAO0O,SACT1O,EAAO0O,QAAS,GAElB,IAAIgB,EAAe7R,SAAS8R,eAAe3P,EAAOyO,MAClD5P,EAAIiD,SAAS4N,EAAc,mBAC3BxB,EAAW0B,EAAOhM,EAAO8L,GAMzB7Q,EAAIiD,SAAS/L,KAAKgX,KAAMD,EAAI6B,cAC5B9P,EAAIiD,SAASoM,EAAU,SACvBrP,EAAIrI,KAAK0X,EAAU,SAPA,SAAsBzP,GAGvC,OAFAA,EAAEwI,iBACFrD,EAAM8K,QAAU9K,EAAM8K,QACf,KAKJ1O,EAAO0O,SACV3Y,KAAK2Y,QAAS,GAGd1O,EAAOsN,YACL1X,EAAOW,YAAYyJ,EAAO1D,UACxBqQ,IACFC,EAAqB/O,SAASC,cAAc,OAC5Ce,EAAIiD,SAAS8K,EAzMD,MA0MZ/N,EAAIiD,SAAS8K,EAAoBE,EAAI+C,4BACrChS,SAASoO,KAAKhI,YAAY2I,GAC1BD,GAAkB,GAEpBC,EAAmB3I,YAAYlO,KAAK6H,YACpCiB,EAAIiD,SAAS/L,KAAK6H,WAAYkP,EAAIgD,mBAE/B/Z,KAAKuG,QACRkS,GAAS5K,EAAO5D,EAAO6C,QAG3B9M,KAAKga,gBAAkB,WACrBnM,EAAMoM,qBAERnR,EAAIrI,KAAKiK,OAAQ,SAAU1K,KAAKga,iBAChClR,EAAIrI,KAAKT,KAAKgX,KAAM,sBAAuBhX,KAAKga,iBAChDlR,EAAIrI,KAAKT,KAAKgX,KAAM,gBAAiBhX,KAAKga,iBAC1ClR,EAAIrI,KAAKT,KAAKgX,KAAM,iBAAkBhX,KAAKga,iBAC3Cha,KAAK6Y,WACD5O,EAAOwN,WACTyC,GAAgBla,MAElBkY,EAAqB,WACfzB,GAA0F,SAAhEC,aAAasB,QAAQC,GAAoBpK,EAAO,aAC5E6I,aAAauC,QAAQhB,GAAoBpK,EAAO,OAAQuL,KAAKe,UAAUtM,EAAMuM,mBAGjFpa,KAAKqa,6BAA+BnC,EAQ/BjO,EAAO1D,UANNuR,EAAOjK,EAAMuK,WACZtL,OAAS,EACdjN,EAAOqB,OAAM,WACX4W,EAAKhL,OAAS,OA+OpB,SAAS+M,EAAOxB,EAAKiC,EAAQC,GAC3B,IAAIC,EAAK1S,SAASC,cAAc,MAUhC,OATIuS,GACFE,EAAGtM,YAAYoM,GAEbC,EACFlC,EAAIrB,KAAKwC,aAAagB,EAAID,GAE1BlC,EAAIrB,KAAK9I,YAAYsM,GAEvBnC,EAAIQ,WACG2B,EAET,SAASC,EAAgBpC,GACvBvP,EAAI8C,OAAOlB,OAAQ,SAAU2N,EAAI2B,iBAC7B3B,EAAIgC,8BACNvR,EAAI8C,OAAOlB,OAAQ,SAAU2N,EAAIgC,8BAGrC,SAASK,EAAmBrC,EAAKsC,GAC/B,IAAIjM,EAAM2J,EAAIC,gBAAgBD,EAAIC,gBAAgBzJ,eAEhDH,EAAIC,UADFgM,EACcjM,EAAI5J,MAAQ,IAEZ4J,EAAI5J,MAqGxB,SAAS8V,GAAiBvC,EAAKwC,GAC7B,IAAI/C,EAAOO,EAAID,UACX0C,EAAehD,EAAKX,oBAAoBjL,QAAQ2O,EAAW5U,QAC/D,IAAsB,IAAlB6U,EAAqB,CACvB,IAAIC,EAAgBjD,EAAKV,uCAAuC0D,GAMhE,QALsBpwB,IAAlBqwB,IACFA,EAAgB,GAChBjD,EAAKV,uCAAuC0D,GAAgBC,GAE9DA,EAAcF,EAAW3U,UAAY2U,EACjC/C,EAAKH,MAAQG,EAAKH,KAAKqD,WAAY,CACrC,IAAIC,EAAYnD,EAAKH,KAAKqD,WACtBpD,OAAS,EACb,GAAIqD,EAAU5C,EAAIT,QAChBA,EAASqD,EAAU5C,EAAIT,YAClB,KAAIqD,EAAqC,QAG9C,OAFArD,EAASqD,EAAqC,QAIhD,GAAIrD,EAAOkD,SAA+DpwB,IAA9CktB,EAAOkD,GAAcD,EAAW3U,UAAyB,CACnF,IAAIpB,EAAQ8S,EAAOkD,GAAcD,EAAW3U,UAC5C2U,EAAWjT,aAAe9C,EAC1B+V,EAAW5M,SAASnJ,MAK5B,SAASoW,GAAK7C,EAAKpS,EAAQC,EAAU+D,GACnC,QAAyBvf,IAArBub,EAAOC,GACT,MAAM,IAAIiB,MAAM,WAAalB,EAAS,sBAAwBC,EAAW,KAE3E,IAAI2U,OAAa,EACjB,GAAI5Q,EAAOlL,MACT8b,EAAa,IAAI9I,EAAgB9L,EAAQC,OACpC,CACL,IAAIiV,EAAc,CAAClV,EAAQC,GAAUkV,OAAOnR,EAAOkR,aACnDN,EAAaxF,EAAkBvU,MAAMuX,EAAK8C,GAExClR,EAAOoR,kBAAkB1T,IAC3BsC,EAAOoR,OAASpR,EAAOoR,OAAOC,MAEhCV,GAAiBvC,EAAKwC,GACtB/R,EAAIiD,SAAS8O,EAAWhT,WAAY,KACpC,IAAI6Q,EAAO5Q,SAASC,cAAc,QAClCe,EAAIiD,SAAS2M,EAAM,iBACnBA,EAAK/J,UAAYkM,EAAW3U,SAC5B,IAAIqV,EAAYzT,SAASC,cAAc,OACvCwT,EAAUrN,YAAYwK,GACtB6C,EAAUrN,YAAY2M,EAAWhT,YACjC,IAAI2S,EAAKX,EAAOxB,EAAKkD,EAAWtR,EAAOoR,QASvC,OARAvS,EAAIiD,SAASyO,EAAIzD,EAAIyE,sBACjBX,aAAsB9I,EACxBjJ,EAAIiD,SAASyO,EAAI,SAEjB1R,EAAIiD,SAASyO,EAAIzV,EAAQ8V,EAAWzS,aAzJxC,SAA2BiQ,EAAKmC,EAAIK,GAmClC,GAlCAA,EAAWS,KAAOd,EAClBK,EAAWY,MAAQpD,EACnBxY,EAAOE,OAAO8a,EAA8C,CAC1DvM,QAAS,SAAiBoN,GACxB,GAAI5gB,UAAUC,OAAS,EAAG,CACxB,IAAI4gB,EAAcd,EAAWS,KAAKM,mBAElC,OADAf,EAAWgB,SACJX,GAAK7C,EAAKwC,EAAW5U,OAAQ4U,EAAW3U,SAAU,CACvDmV,OAAQM,EACRR,YAAa,CAACtb,EAAOgC,QAAQ/G,cAGjC,GAAI+E,EAAOqC,QAAQwZ,IAAa7b,EAAOO,SAASsb,GAAW,CACzD,IAAII,EAAejB,EAAWS,KAAKM,mBAEnC,OADAf,EAAWgB,SACJX,GAAK7C,EAAKwC,EAAW5U,OAAQ4U,EAAW3U,SAAU,CACvDmV,OAAQS,EACRX,YAAa,CAACO,OAIpBhD,KAAM,SAAcqD,GAElB,OADAlB,EAAWS,KAAKU,kBAAkBA,kBAAkBrN,UAAYoN,EACzDlB,GAEToB,OAAQ,WAEN,OADApB,EAAWY,MAAMQ,OAAOpB,GACjBA,GAETgB,OAAQ,WAEN,OADAhB,EAAWY,MAAMI,OAAOhB,GACjBA,KAGPA,aAAsB5J,EAAwB,CAChD,IAAIiL,EAAM,IAAIhM,EAAoB2K,EAAW5U,OAAQ4U,EAAW3U,SAAU,CAAE7K,IAAKwf,EAAWxL,MAAOzU,IAAKigB,EAAWvL,MAAOE,KAAMqL,EAAWtL,SAC3I1P,EAAOI,KAAK,CAAC,gBAAiB,WAAY,iBAAkB,OAAQ,MAAO,QAAQ,SAAUkc,GAC3F,IAAIC,EAAKvB,EAAWsB,GAChBE,EAAKH,EAAIC,GACbtB,EAAWsB,GAAUD,EAAIC,GAAU,WACjC,IAAItb,EAAOvV,MAAMoU,UAAUE,MAAMM,KAAKpF,WAEtC,OADAuhB,EAAGvb,MAAMob,EAAKrb,GACPub,EAAGtb,MAAM+Z,EAAYha,OAGhCiI,EAAIiD,SAASyO,EAAI,cACjBK,EAAWhT,WAAW2R,aAAa0C,EAAIrU,WAAYgT,EAAWhT,WAAWmU,wBACpE,GAAInB,aAAsB3K,EAAqB,CACpD,IAAIvT,EAAI,SAAW2f,GACjB,GAAIzc,EAAOuC,SAASyY,EAAWxL,QAAUxP,EAAOuC,SAASyY,EAAWvL,OAAQ,CAC1E,IAAIiN,EAAU1B,EAAWS,KAAKU,kBAAkBA,kBAAkBrN,UAC9D6N,EAAe3B,EAAWY,MAAMpE,YAAYnL,QAAQ2O,IAAe,EACvEA,EAAWgB,SACX,IAAIY,EAAgBvB,GAAK7C,EAAKwC,EAAW5U,OAAQ4U,EAAW3U,SAAU,CACpEmV,OAAQR,EAAWS,KAAKM,mBACxBT,YAAa,CAACN,EAAWxL,MAAOwL,EAAWvL,MAAOuL,EAAWtL,UAI/D,OAFAkN,EAAc/D,KAAK6D,GACfC,GAAcC,EAAcR,SACzBQ,EAET,OAAOH,GAETzB,EAAWxf,IAAMwE,EAAOc,QAAQhE,EAAGke,EAAWxf,KAC9Cwf,EAAWjgB,IAAMiF,EAAOc,QAAQhE,EAAGke,EAAWjgB,UACrCigB,aAAsBnN,GAC/B5E,EAAIrI,KAAK+Z,EAAI,SAAS,WACpB1R,EAAIe,UAAUgR,EAAW9M,WAAY,YAEvCjF,EAAIrI,KAAKoa,EAAW9M,WAAY,SAAS,SAAUrF,GACjDA,EAAEgU,sBAEK7B,aAAsBlJ,GAC/B7I,EAAIrI,KAAK+Z,EAAI,SAAS,WACpB1R,EAAIe,UAAUgR,EAAWhJ,SAAU,YAErC/I,EAAIrI,KAAK+Z,EAAI,aAAa,WACxB1R,EAAIiD,SAAS8O,EAAWhJ,SAAU,YAEpC/I,EAAIrI,KAAK+Z,EAAI,YAAY,WACvB1R,EAAIwD,YAAYuO,EAAWhJ,SAAU,aAE9BgJ,aAAsB9I,IAC/BjJ,EAAIiD,SAASyO,EAAI,SACjBK,EAAW1S,cAAgBtI,EAAOc,SAAQ,SAAUkI,GAElD,OADA2R,EAAGtR,MAAMyT,gBAAkB9B,EAAW7I,QAAQ5S,WACvCyJ,IACNgS,EAAW1S,eACd0S,EAAW1S,iBAEb0S,EAAW5M,SAAWpO,EAAOc,SAAQ,SAAUkI,GAI7C,OAHIwP,EAAID,UAAUE,iBAAmBuC,EAAW+B,cAC9ClC,EAAmBrC,EAAID,WAAW,GAE7BvP,IACNgS,EAAW5M,UA2Dd4O,CAAkBxE,EAAKmC,EAAIK,GAC3BxC,EAAInB,cAAc/K,KAAK0O,GAChBA,EAET,SAAS5C,GAAoBI,EAAK9X,GAChC,OAAOuH,SAASgV,SAASrP,KAAO,IAAMlN,EAExC,SAASwc,GAAgB1E,EAAKK,EAAMsE,GAClC,IAAItO,EAAM5G,SAASC,cAAc,UACjC2G,EAAIC,UAAY+J,EAChBhK,EAAI5J,MAAQ4T,EACZL,EAAIC,gBAAgBpK,YAAYQ,GAC5BsO,IACF3E,EAAIC,gBAAgBzJ,cAAgBwJ,EAAIC,gBAAgBvd,OAAS,GAGrE,SAASkiB,GAAgB5E,EAAK6E,GAC5BA,EAAQhU,MAAM0K,QAAUyE,EAAIN,gBAAkB,QAAU,OAE1D,SAASoF,GAAY9E,GACnB,IAAIla,EAAMka,EAAI+E,WAAatV,SAASC,cAAc,MAClDe,EAAIiD,SAASsM,EAAIxQ,WAAY,YAC7BwQ,EAAIrB,KAAKwC,aAAarb,EAAKka,EAAIrB,KAAKqG,YACpCvU,EAAIiD,SAAS5N,EAAK,YAClB,IAAImf,EAAQxV,SAASC,cAAc,QACnCuV,EAAM3O,UAAY,SAClB7F,EAAIiD,SAASuR,EAAO,gBACpB,IAAIC,EAASzV,SAASC,cAAc,QACpCwV,EAAO5O,UAAY,OACnB7F,EAAIiD,SAASwR,EAAQ,UACrBzU,EAAIiD,SAASwR,EAAQ,QACrB,IAAIC,EAAU1V,SAASC,cAAc,QACrCyV,EAAQ7O,UAAY,MACpB7F,EAAIiD,SAASyR,EAAS,UACtB1U,EAAIiD,SAASyR,EAAS,WACtB,IAAIC,EAAU3V,SAASC,cAAc,QACrC0V,EAAQ9O,UAAY,SACpB7F,EAAIiD,SAAS0R,EAAS,UACtB3U,EAAIiD,SAAS0R,EAAS,UACtB,IAAIC,EAASrF,EAAIC,gBAAkBxQ,SAASC,cAAc,UAmB1D,GAlBIsQ,EAAIV,MAAQU,EAAIV,KAAKqD,WACvBnb,EAAOI,KAAKoY,EAAIV,KAAKqD,YAAY,SAAUlW,EAAOvE,GAChDwc,GAAgB1E,EAAK9X,EAAKA,IAAQ8X,EAAIT,WAGxCmF,GAAgB1E,EAzrBc,WAyrBoB,GAEpDvP,EAAIrI,KAAKid,EAAQ,UAAU,WACzB,IAAK,IAAIlR,EAAQ,EAAGA,EAAQ6L,EAAIC,gBAAgBvd,OAAQyR,IACtD6L,EAAIC,gBAAgB9L,GAAOmC,UAAY0J,EAAIC,gBAAgB9L,GAAO1H,MAEpEuT,EAAIT,OAAS5X,KAAK8E,SAEpB3G,EAAI+P,YAAYwP,GAChBvf,EAAI+P,YAAYoP,GAChBnf,EAAI+P,YAAYqP,GAChBpf,EAAI+P,YAAYsP,GAChBrf,EAAI+P,YAAYuP,GACZhH,EAAwB,CAC1B,IAAIyG,EAAUpV,SAAS6V,eAAe,oBAClCC,EAAuB9V,SAAS6V,eAAe,oBACjC7V,SAAS6V,eAAe,mBAC9BzU,MAAM0K,QAAU,QACsC,SAA9D8C,aAAasB,QAAQC,GAAoBI,EAAK,aAChDuF,EAAqB5P,aAAa,UAAW,WAE/CiP,GAAgB5E,EAAK6E,GACrBpU,EAAIrI,KAAKmd,EAAsB,UAAU,WACvCvF,EAAIN,iBAAmBM,EAAIN,gBAC3BkF,GAAgB5E,EAAK6E,MAGzB,IAAIW,EAAyB/V,SAAS6V,eAAe,sBACrD7U,EAAIrI,KAAKod,EAAwB,WAAW,SAAUnV,IAChDA,EAAEwC,SAAwB,KAAZxC,EAAEoV,OAA8B,KAAdpV,EAAEyC,SACpCwL,EAAcR,UAGlBrN,EAAIrI,KAAK6c,EAAO,SAAS,WACvBO,EAAuBlP,UAAYyK,KAAKe,UAAU9B,EAAI+B,qBAAiB1vB,EAAW,GAClFisB,EAAcoH,OACdF,EAAuBG,QACvBH,EAAuBH,YAEzB5U,EAAIrI,KAAK8c,EAAQ,SAAS,WACxBlF,EAAI4F,UAENnV,EAAIrI,KAAK+c,EAAS,SAAS,WACzB,IAAIU,EAAaC,OAAO,4BACpBD,GACF7F,EAAI+F,OAAOF,MAGfpV,EAAIrI,KAAKgd,EAAS,SAAS,WACzBpF,EAAIG,YAGR,SAAS0B,GAAgB7B,GACvB,IAAIgG,OAAU,EASd,SAASC,EAAK5V,GAKZ,OAJAA,EAAEwI,iBACFmH,EAAIvL,OAASuR,EAAU3V,EAAE2B,QACzBgO,EAAIQ,WACJwF,EAAU3V,EAAE2B,SACL,EAET,SAASkU,IACPzV,EAAIwD,YAAY+L,EAAIS,cAAe/B,EAAIyH,YACvC1V,EAAI8C,OAAOlB,OAAQ,YAAa4T,GAChCxV,EAAI8C,OAAOlB,OAAQ,UAAW6T,GAEhC,SAASE,EAAU/V,GAMjB,OALAA,EAAEwI,iBACFmN,EAAU3V,EAAE2B,QACZvB,EAAIiD,SAASsM,EAAIS,cAAe/B,EAAIyH,YACpC1V,EAAIrI,KAAKiK,OAAQ,YAAa4T,GAC9BxV,EAAIrI,KAAKiK,OAAQ,UAAW6T,IACrB,EA1BTlG,EAAIqG,gBAAkB5W,SAASC,cAAc,OAC7ClI,EAAOE,OAAOsY,EAAIqG,gBAAgBxV,MAAO,CACvC4D,MAAO,MACP0H,WAAY,OACZxH,OAAQ,QACR6G,OAAQ,YACRjK,SAAU,aAsBZd,EAAIrI,KAAK4X,EAAIqG,gBAAiB,YAAaD,GAC3C3V,EAAIrI,KAAK4X,EAAIS,cAAe,YAAa2F,GACzCpG,EAAIxQ,WAAW2R,aAAanB,EAAIqG,gBAAiBrG,EAAIxQ,WAAWmU,mBAElE,SAASvD,GAASJ,EAAK7mB,GACrB6mB,EAAIxQ,WAAWqB,MAAM4D,MAAQtb,EAAI,KAC7B6mB,EAAI+E,YAAc/E,EAAId,YACxBc,EAAI+E,WAAWlU,MAAM4D,MAAQtb,EAAI,MAE/B6mB,EAAIS,gBACNT,EAAIS,cAAc5P,MAAM4D,MAAQtb,EAAI,MAGxC,SAASmtB,GAAiBtG,EAAKuG,GAC7B,IAAI7a,EAAW,GASf,OARAlE,EAAOI,KAAKoY,EAAIlB,qBAAqB,SAAUtO,EAAK2D,GAClD,IAAIqS,EAAc,GACd9D,EAAgB1C,EAAIjB,uCAAuC5K,GAC/D3M,EAAOI,KAAK8a,GAAe,SAAUF,EAAY3U,GAC/C2Y,EAAY3Y,GAAY0Y,EAAmB/D,EAAWjT,aAAeiT,EAAWzS,cAElFrE,EAASyI,GAASqS,KAEb9a,EApjBTgT,EAAI+H,WAAa,WACf3I,GAAQA,EACRtW,EAAOI,KAAK6W,GAAc,SAAUuB,GAClCA,EAAIxQ,WAAWqB,MAAM0K,QAAUuC,EAAO,OAAS,OAGnDY,EAAIgD,iBAAmB,IACvBhD,EAAI+C,2BAA6B,KACjC/C,EAAImC,WAAa,OACjBnC,EAAIyE,qBAAuB,KAC3BzE,EAAIgI,eAAiB,qBACrBhI,EAAI6B,aAAe,SACnB7B,EAAIuC,mBAAqB,eACzBvC,EAAIwC,gBAAkB,YACtBxC,EAAI2C,mBAAqB,eACzB3C,EAAIyH,WAAa,OACjBzH,EAAIS,cAAgB,IACpBT,EAAIiC,YAAc,iBAClBjC,EAAIgC,UAAY,gBAChBhC,EAAIiI,gBAAkB,SAAUtW,GACM,SAAhCZ,SAASyF,cAAcC,MApQT,KAoQ6B9E,EAAEoV,OApQ/B,KAoQ0DpV,EAAEyC,SAC5E4L,EAAI+H,cAGRhW,EAAIrI,KAAKiK,OAAQ,UAAWqM,EAAIiI,iBAAiB,GACjDnf,EAAOE,OAAOgX,EAAIrX,UAClB,CACEzG,IAAK,SAAagN,EAAQC,GACxB,OAAOgV,GAAKlb,KAAMiG,EAAQC,EAAU,CAClCiV,YAAa7vB,MAAMoU,UAAUE,MAAMM,KAAKpF,UAAW,MAGvDmkB,SAAU,SAAkBhZ,EAAQC,GAClC,OAAOgV,GAAKlb,KAAMiG,EAAQC,EAAU,CAClCnH,OAAO,KAGX8c,OAAQ,SAAgBhB,GACtB7a,KAAKgX,KAAKkI,YAAYrE,EAAWS,MACjCtb,KAAKkX,cAAczK,OAAOzM,KAAKkX,cAAchL,QAAQ2O,GAAa,GAClE,IAAIhN,EAAQ7N,KACZH,EAAOqB,OAAM,WACX2M,EAAMgL,eAGVsG,QAAS,WACP,GAAInf,KAAKuG,OACP,MAAM,IAAIY,MAAM,8GAEdnH,KAAKuX,WACPV,EAAmBqI,YAAYlf,KAAK6H,YAEtC,IAAIgG,EAAQ7N,KACZH,EAAOI,KAAKD,KAAKiX,WAAW,SAAUmI,GACpCvR,EAAMwR,aAAaD,MAErBtW,EAAI8C,OAAOlB,OAAQ,UAAWqM,EAAIiI,iBAAiB,GACnDvE,EAAgBza,OAElBsf,UAAW,SAAmB5G,GAC5B,QAA6BhuB,IAAzBsV,KAAKiX,UAAUyB,GACjB,MAAM,IAAIvR,MAAM,sDAA6DuR,EAAO,KAEtF,IAAI6G,EAAe,CAAE7G,KAAMA,EAAMnS,OAAQvG,MACzCuf,EAAahI,UAAYvX,KAAKuX,UAC1BvX,KAAK2X,MACT3X,KAAK2X,KAAK6H,SACVxf,KAAK2X,KAAK6H,QAAQ9G,KAChB6G,EAAa5G,OAAS3Y,KAAK2X,KAAK6H,QAAQ9G,GAAMC,OAC9C4G,EAAa5H,KAAO3X,KAAK2X,KAAK6H,QAAQ9G,IAExC,IAAIL,EAAM,IAAItB,EAAIwI,GAClBvf,KAAKiX,UAAUyB,GAAQL,EACvB,IAAImC,EAAKX,EAAO7Z,KAAMqY,EAAIxQ,YAE1B,OADAiB,EAAIiD,SAASyO,EAAI,UACVnC,GAETgH,aAAc,SAAsBI,GAClCzf,KAAKgX,KAAKkI,YAAYO,EAAO5X,WAAW6X,sBACjC1f,KAAKiX,UAAUwI,EAAO/G,MACzB1Y,KAAK2X,MACT3X,KAAK2X,KAAK6H,SACVxf,KAAK2X,KAAK6H,QAAQC,EAAO/G,cAChB1Y,KAAK2X,KAAK6H,QAAQC,EAAO/G,MAElC+B,EAAgBgF,GAChB,IAAI5R,EAAQ7N,KACZH,EAAOI,KAAKwf,EAAOxI,WAAW,SAAUmI,GACtCK,EAAOJ,aAAaD,MAEtBvf,EAAOqB,OAAM,WACX2M,EAAMgL,eAGV8G,KAAM,WACJ3f,KAAK2Y,QAAS,GAEhBiH,MAAO,WACL5f,KAAK2Y,QAAS,GAEhBxC,KAAM,WACJnW,KAAK6H,WAAWqB,MAAM0K,QAAU,QAElCmK,KAAM,WACJ/d,KAAK6H,WAAWqB,MAAM0K,QAAU,IAElCiF,SAAU,WACR,IAAIf,EAAO9X,KAAKoY,UAChB,GAAIN,EAAKD,WAAY,CACnB,IAAI/hB,EAAMgT,EAAImE,UAAU6K,EAAKd,MAAMlhB,IAC/BwJ,EAAI,EACRO,EAAOI,KAAK6X,EAAKd,KAAKyC,YAAY,SAAUoG,GACpC/H,EAAKP,WAAasI,IAAS/H,EAAKsF,aACpC9d,GAAKwJ,EAAIiE,UAAU8S,OAGnBnV,OAAO6L,YAAczgB,EAnWL,GAmWiCwJ,GACnDwJ,EAAIiD,SAAS+L,EAAKjQ,WAAYkP,EAAIgI,gBAClCjH,EAAKd,KAAK9N,MAAM8D,OAAStC,OAAO6L,YAAczgB,EArW5B,GAqWwD,OAE1EgT,EAAIwD,YAAYwL,EAAKjQ,WAAYkP,EAAIgI,gBACrCjH,EAAKd,KAAK9N,MAAM8D,OAAS,QAGzB8K,EAAK4G,iBACP7e,EAAOqB,OAAM,WACX4W,EAAK4G,gBAAgBxV,MAAM8D,OAAS8K,EAAKd,KAAK8I,aAAe,QAG7DhI,EAAKgB,gBACPhB,EAAKgB,cAAc5P,MAAM4D,MAAQgL,EAAKhL,MAAQ,OAGlDmN,kBAAmBpa,EAAOwB,UAAS,WACjCrB,KAAK6Y,aACJ,IACHkH,SAAU,WAKR,GAJIlgB,EAAOW,YAAYmW,MACrBA,EAAgB,IAAId,GACNhO,WAAW8G,UAAYyG,GAEnCpV,KAAKuG,OACP,MAAM,IAAIY,MAAM,kDAElB,IAAI0G,EAAQ7N,KACZH,EAAOI,KAAK3U,MAAMoU,UAAUE,MAAMM,KAAKpF,YAAY,SAAUmL,GAClB,IAArC4H,EAAMsJ,oBAAoBpc,QAC5BoiB,GAAYtP,IAEqC,IAA/CA,EAAMsJ,oBAAoBjL,QAAQjG,IACpC4H,EAAMsJ,oBAAoBhL,KAAKlG,MAG/BjG,KAAKuX,WACPkB,GAASzY,KAAMA,KAAK8M,QAGxBsL,QAAS,WAEP,IADA,IAAIC,EAAMrY,KACHqY,EAAI9R,QACT8R,EAAMA,EAAI9R,OAEZ,OAAO8R,GAET+B,cAAe,WACb,IAAIrW,EAAW/D,KAAK2X,KAapB,OAZA5T,EAAS4U,OAAS3Y,KAAK2Y,OACnB3Y,KAAKmX,oBAAoBpc,OAAS,IACpCgJ,EAAS6T,OAAS5X,KAAK4X,OAClB7T,EAASiX,aACZjX,EAASiX,WAAa,IAExBjX,EAASiX,WAAWhb,KAAK4X,QAAU+G,GAAiB3e,OAEtD+D,EAASyb,QAAU,GACnB3f,EAAOI,KAAKD,KAAKiX,WAAW,SAAUxI,EAASlO,GAC7CwD,EAASyb,QAAQjf,GAAOkO,EAAQ2L,mBAE3BrW,GAETka,KAAM,WACCje,KAAK2X,KAAKqD,aACbhb,KAAK2X,KAAKqD,WAAa,IAEzBhb,KAAK2X,KAAKqD,WAAWhb,KAAK4X,QAAU+G,GAAiB3e,MACrD0a,EAAmB1a,MAAM,GACzBA,KAAKqa,gCAEP+D,OAAQ,SAAgBF,GACjBle,KAAK2X,KAAKqD,aACbhb,KAAK2X,KAAKqD,WAAa,GACvBhb,KAAK2X,KAAKqD,WAAsC,QAAI2D,GAAiB3e,MAAM,IAE7EA,KAAK2X,KAAKqD,WAAWkD,GAAcS,GAAiB3e,MACpDA,KAAK4X,OAASsG,EACdnB,GAAgB/c,KAAMke,GAAY,GAClCle,KAAKqa,gCAEP7B,OAAQ,SAAgBH,GACtBxY,EAAOI,KAAKD,KAAKkX,eAAe,SAAU2D,GACnC7a,KAAKoY,UAAUT,KAAKqD,WAGvBJ,GAAiBvC,GAAOrY,KAAKoY,UAAWyC,GAFxCA,EAAW5M,SAAS4M,EAAWjT,cAI7BiT,EAAW5S,kBACb4S,EAAW5S,iBAAiB/H,KAAK2a,EAAYA,EAAWzS,cAEzDpI,MACHH,EAAOI,KAAKD,KAAKiX,WAAW,SAAUwI,GACpCA,EAAOjH,OAAOiH,MAEXpH,GACHqC,EAAmB1a,KAAKoY,WAAW,IAGvC6D,OAAQ,SAAgBpB,GACtB,IAAIjQ,EAAmC,IAA5B5K,KAAKqX,YAAYtc,OAC5BiF,KAAKqX,YAAYlL,KAAK0O,GAClBjQ,GAkWR,SAASoV,EAAeC,GACS,IAA3BA,EAAgBllB,QAClBua,EAAwBpV,KAAKwK,QAAQ,WACnCsV,EAAeC,MAGnBpgB,EAAOI,KAAKggB,GAAiB,SAAU9vB,GACrCA,EAAEgY,mBAxWA6X,CAAehgB,KAAKqX,cAGxBlP,cAAe,WACbtI,EAAOI,KAAKD,KAAKkX,eAAe,SAAU2D,GACxCA,EAAW1S,mBAEbtI,EAAOI,KAAKD,KAAKiX,WAAW,SAAUwI,GACpCA,EAAOtX,sBAoWb,IAkBI+X,GAAQnJ,G,mBCr8EqDoJ,EAAOC,QAGhE,WAAe,aAIrB,IAAIC,EAAYC,UAAUD,UACtBE,EAAWD,UAAUC,SAErBC,EAAQ,aAAa1d,KAAKud,GAC1BI,EAAY,UAAU3d,KAAKud,GAC3BK,EAAU,wCAAwCC,KAAKN,GACvDO,EAAO,cAAcD,KAAKN,GAC1BQ,EAAKJ,GAAaC,GAAWE,EAC7BE,EAAaD,IAAOJ,EAAY3Y,SAASiZ,cAAgB,IAAMH,GAAQF,GAAS,IAChFM,GAAUJ,GAAQ,WAAW9d,KAAKud,GAClCY,EAAWD,GAAU,eAAele,KAAKud,GACzCa,GAAUN,GAAQ,WAAW9d,KAAKud,GAClCc,EAAS,UAAUre,KAAKud,GACxBe,EAAS,iBAAiBte,KAAKwd,UAAU1L,QACzCyM,EAAqB,+BAA+Bve,KAAKud,GACzDiB,EAAU,YAAYxe,KAAKud,GAE3BkB,GAAOX,GAAQ,cAAc9d,KAAKud,IAAc,cAAcvd,KAAKud,GACnEmB,EAAU,UAAU1e,KAAKud,GAEzBoB,EAASF,GAAOC,GAAW,mDAAmD1e,KAAKud,GACnFqB,EAAMH,GAAO,MAAMze,KAAKyd,GACxBoB,EAAW,WAAW7e,KAAKud,GAC3BuB,EAAU,OAAO9e,KAAKyd,GAEtBsB,EAAiBV,GAAUd,EAAUtd,MAAM,uBAC3C8e,IAAkBA,EAAiBC,OAAOD,EAAe,KACzDA,GAAkBA,GAAkB,KAAMV,GAAS,EAAOH,GAAS,GAEvE,IAAIe,EAAcL,IAAQT,GAAYE,IAA6B,MAAlBU,GAA0BA,EAAiB,QACxFG,EAAoBxB,GAAUK,GAAMC,GAAc,EAEtD,SAASmB,EAAUC,GAAO,OAAO,IAAIvV,OAAO,UAAYuV,EAAM,iBAE9D,IAkCIC,EAlCAC,EAAU,SAASvC,EAAMqC,GAC3B,IAAIG,EAAUxC,EAAK3V,UACfnH,EAAQkf,EAAUC,GAAKvB,KAAK0B,GAChC,GAAItf,EAAO,CACT,IAAIuf,EAAQD,EAAQziB,MAAMmD,EAAMyJ,MAAQzJ,EAAM,GAAGhI,QACjD8kB,EAAK3V,UAAYmY,EAAQziB,MAAM,EAAGmD,EAAMyJ,QAAU8V,EAAQvf,EAAM,GAAKuf,EAAQ,MAIjF,SAASC,EAAe7Z,GACtB,IAAK,IAAIhK,EAAQgK,EAAE+Q,WAAW1e,OAAQ2D,EAAQ,IAAKA,EAC/CgK,EAAEwW,YAAYxW,EAAE2U,YACpB,OAAO3U,EAGT,SAAS8Z,EAAqBjc,EAAQmC,GACpC,OAAO6Z,EAAehc,GAAQ2H,YAAYxF,GAG5C,SAAS+Z,EAAIC,EAAKC,EAASzY,EAAWhB,GACpC,IAAIR,EAAIZ,SAASC,cAAc2a,GAG/B,GAFIxY,IAAaxB,EAAEwB,UAAYA,GAC3BhB,IAASR,EAAEQ,MAAM8K,QAAU9K,GACT,iBAAXyZ,EAAuBja,EAAEwF,YAAYpG,SAAS8R,eAAe+I,SACnE,GAAIA,EAAW,IAAK,IAAI9nB,EAAI,EAAGA,EAAI8nB,EAAQ5nB,SAAUF,EAAK6N,EAAEwF,YAAYyU,EAAQ9nB,IACrF,OAAO6N,EAGT,SAASka,EAAKF,EAAKC,EAASzY,EAAWhB,GACrC,IAAIR,EAAI+Z,EAAIC,EAAKC,EAASzY,EAAWhB,GAErC,OADAR,EAAEsF,aAAa,OAAQ,gBAChBtF,EAoBT,SAASma,EAAStc,EAAQuc,GAGxB,GAFsB,GAAlBA,EAAMC,WACND,EAAQA,EAAME,YACdzc,EAAOsc,SACP,OAAOtc,EAAOsc,SAASC,GAC3B,GAEE,GADsB,IAAlBA,EAAMC,WAAkBD,EAAQA,EAAMG,MACtCH,GAASvc,EAAU,OAAO,QACvBuc,EAAQA,EAAME,YAGzB,SAASE,IAIP,IAAI3V,EACJ,IACEA,EAAgBzF,SAASyF,cACzB,MAAM7E,GACN6E,EAAgBzF,SAASoO,MAAQ,KAEnC,KAAO3I,GAAiBA,EAAc4V,YAAc5V,EAAc4V,WAAW5V,eACzEA,EAAgBA,EAAc4V,WAAW5V,cAC7C,OAAOA,EAGT,SAASxB,EAAS8T,EAAMqC,GACtB,IAAIG,EAAUxC,EAAK3V,UACd+X,EAAUC,GAAKpf,KAAKuf,KAAYxC,EAAK3V,YAAcmY,EAAU,IAAM,IAAMH,GAEhF,SAASkB,EAAYt3B,EAAGuD,GAEtB,IADA,IAAIg0B,EAAKv3B,EAAEmgB,MAAM,KACRpR,EAAI,EAAGA,EAAIwoB,EAAGtoB,OAAQF,IACvBwoB,EAAGxoB,KAAOonB,EAAUoB,EAAGxoB,IAAIiI,KAAKzT,KAAMA,GAAK,IAAMg0B,EAAGxoB,IAC5D,OAAOxL,EAlDmB8yB,EAAxBra,SAASwb,YAAuB,SAASzD,EAAM0D,EAAOC,EAAKC,GAC7D,IAAI9mB,EAAImL,SAASwb,cAGjB,OAFA3mB,EAAE+mB,OAAOD,GAAW5D,EAAM2D,GAC1B7mB,EAAEgnB,SAAS9D,EAAM0D,GACV5mB,GAEM,SAASkjB,EAAM0D,EAAOC,GACnC,IAAI7mB,EAAImL,SAASoO,KAAK0N,kBACtB,IAAMjnB,EAAEknB,kBAAkBhE,EAAKmD,YAC/B,MAAMta,GAAK,OAAO/L,EAIlB,OAHAA,EAAEmnB,UAAS,GACXnnB,EAAEonB,QAAQ,YAAaP,GACvB7mB,EAAEqnB,UAAU,YAAaT,GAClB5mB,GAwCT,IAAIsnB,EAAc,SAASpE,GAAQA,EAAKnC,UAMxC,SAASjd,EAAKlK,GACZ,IAAIsK,EAAOvV,MAAMoU,UAAUE,MAAMM,KAAKpF,UAAW,GACjD,OAAO,WAAW,OAAOvE,EAAEuK,MAAM,KAAMD,IAGzC,SAASqjB,EAAQ/jB,EAAKrH,EAAQqrB,GAE5B,IAAK,IAAIC,KADJtrB,IAAUA,EAAS,IACPqH,GACTA,EAAIkkB,eAAeD,KAAwB,IAAdD,GAAwBrrB,EAAOurB,eAAeD,KAC7EtrB,EAAOsrB,GAAQjkB,EAAIikB,IACzB,OAAOtrB,EAKT,SAASwrB,EAAYC,EAAQf,EAAKgB,EAASC,EAAYC,GAC1C,MAAPlB,IAEU,IADZA,EAAMe,EAAOI,OAAO,kBACHnB,EAAMe,EAAOxpB,QAEhC,IAAK,IAAIF,EAAI4pB,GAAc,EAAGG,EAAIF,GAAc,IAAK,CACnD,IAAIG,EAAUN,EAAOrY,QAAQ,KAAMrR,GACnC,GAAIgqB,EAAU,GAAKA,GAAWrB,EAC1B,OAAOoB,GAAKpB,EAAM3oB,GACtB+pB,GAAKC,EAAUhqB,EACf+pB,GAAKJ,EAAWI,EAAIJ,EACpB3pB,EAAIgqB,EAAU,GA/BdtD,EACA0C,EAAc,SAASpE,GAAQA,EAAKiF,eAAiB,EAAGjF,EAAKkF,aAAelF,EAAK/a,MAAM/J,QAClF8lB,IACLoD,EAAc,SAASpE,GAAQ,IAAMA,EAAKnC,SAAY,MAAMsH,OAgChE,IAAIC,EAAU,WACZjlB,KAAKklB,GAAK,KACVllB,KAAKzJ,EAAI,KACTyJ,KAAKmlB,KAAO,EACZnlB,KAAKolB,QAAU3kB,EAAKT,KAAKqlB,UAAWrlB,OAoBtC,SAASkM,EAAQoZ,EAAO7C,GACtB,IAAK,IAAI5nB,EAAI,EAAGA,EAAIyqB,EAAMvqB,SAAUF,EAChC,GAAIyqB,EAAMzqB,IAAM4nB,EAAO,OAAO5nB,EAClC,OAAQ,EArBVoqB,EAAQvlB,UAAU2lB,UAAY,SAAUre,GACtCA,EAAKke,GAAK,EACNle,EAAKme,OAAS,IAAII,KACpBve,EAAKzQ,IAEL6K,WAAW4F,EAAKoe,QAASpe,EAAKme,MAAQ,IAAII,OAG9CN,EAAQvlB,UAAUzS,IAAM,SAAUu4B,EAAIjvB,GACpCyJ,KAAKzJ,EAAIA,EACT,IAAI4uB,GAAQ,IAAII,KAAOC,IAClBxlB,KAAKklB,IAAMC,EAAOnlB,KAAKmlB,QAC1BvjB,aAAa5B,KAAKklB,IAClBllB,KAAKklB,GAAK9jB,WAAWpB,KAAKolB,QAASI,GACnCxlB,KAAKmlB,KAAOA,IAWhB,IAIIM,EAAO,CAACrmB,SAAU,WAAW,MAAO,oBAGpCsmB,EAAiB,CAACC,QAAQ,GAAQC,EAAY,CAACC,OAAQ,UAAWC,EAAW,CAACD,OAAQ,SAI1F,SAASE,EAAWxB,EAAQyB,EAAMxB,GAChC,IAAK,IAAIyB,EAAM,EAAGC,EAAM,IAAK,CAC3B,IAAIrB,EAAUN,EAAOrY,QAAQ,KAAM+Z,IACnB,GAAZpB,IAAiBA,EAAUN,EAAOxpB,QACtC,IAAIorB,EAAUtB,EAAUoB,EACxB,GAAIpB,GAAWN,EAAOxpB,QAAUmrB,EAAMC,GAAWH,EAC7C,OAAOC,EAAMz6B,KAAK6P,IAAI8qB,EAASH,EAAOE,GAI1C,GAHAA,GAAOrB,EAAUoB,EAEjBA,EAAMpB,EAAU,GADhBqB,GAAO1B,EAAW0B,EAAM1B,IAEbwB,EAAQ,OAAOC,GAI9B,IAAIG,EAAY,CAAC,IACjB,SAASC,EAASzB,GAChB,KAAOwB,EAAUrrB,QAAU6pB,GACvBwB,EAAUja,KAAKma,EAAIF,GAAa,KACpC,OAAOA,EAAUxB,GAGnB,SAAS0B,EAAIC,GAAO,OAAOA,EAAIA,EAAIxrB,OAAO,GAE1C,SAASyT,EAAI8W,EAAO/uB,GAElB,IADA,IAAI3K,EAAM,GACDiP,EAAI,EAAGA,EAAIyqB,EAAMvqB,OAAQF,IAAOjP,EAAIiP,GAAKtE,EAAE+uB,EAAMzqB,GAAIA,GAC9D,OAAOjP,EAST,SAAS46B,KAET,SAASC,EAAUC,EAAMlhB,GACvB,IAAImhB,EAQJ,OAPItmB,OAAO1U,OACTg7B,EAAOtmB,OAAO1U,OAAO+6B,IAErBF,EAAQ9mB,UAAYgnB,EACpBC,EAAO,IAAIH,GAEThhB,GAAS0e,EAAQ1e,EAAOmhB,GACrBA,EAGT,IAAIC,EAA6B,4GACjC,SAASC,EAAgBC,GACvB,MAAO,KAAKhkB,KAAKgkB,IAAOA,EAAK,MAC1BA,EAAGC,eAAiBD,EAAGE,eAAiBJ,EAA2B9jB,KAAKgkB,IAE7E,SAASG,GAAWH,EAAII,GACtB,OAAKA,KACDA,EAAOC,OAAOjb,QAAQ,QAAU,GAAK2a,EAAgBC,KAClDI,EAAOpkB,KAAKgkB,GAFGD,EAAgBC,GAKxC,SAASM,GAAQjnB,GACf,IAAK,IAAIykB,KAAKzkB,EAAO,GAAIA,EAAIkkB,eAAeO,IAAMzkB,EAAIykB,GAAM,OAAO,EACnE,OAAO,EAQT,IAAIyC,GAAiB,64DACrB,SAASC,GAAgBR,GAAM,OAAOA,EAAGS,WAAW,IAAM,KAAOF,GAAevkB,KAAKgkB,GAGrF,SAASU,GAAmBzuB,EAAKktB,EAAKwB,GACpC,MAAQA,EAAM,EAAIxB,EAAM,EAAIA,EAAMltB,EAAIgC,SAAWusB,GAAgBvuB,EAAI2uB,OAAOzB,KAASA,GAAOwB,EAC5F,OAAOxB,EAMT,SAAS0B,GAAUC,EAAMC,EAAMC,GAI7B,IADA,IAAIL,EAAMI,EAAOC,GAAM,EAAI,IAClB,CACP,GAAID,GAAQC,EAAM,OAAOD,EACzB,IAAIE,GAAQF,EAAOC,GAAM,EAAGE,EAAMP,EAAM,EAAIj8B,KAAK2P,KAAK4sB,GAAQv8B,KAAK4P,MAAM2sB,GACzE,GAAIC,GAAOH,EAAQ,OAAOD,EAAKI,GAAOH,EAAOC,EACzCF,EAAKI,GAAQF,EAAKE,EACfH,EAAOG,EAAMP,GAmBxB,IAAIQ,GAAY,KAChB,SAASC,GAAcC,EAAOrB,EAAIsB,GAChC,IAAIC,EACJJ,GAAY,KACZ,IAAK,IAAIptB,EAAI,EAAGA,EAAIstB,EAAMptB,SAAUF,EAAG,CACrC,IAAIytB,EAAMH,EAAMttB,GAChB,GAAIytB,EAAIT,KAAOf,GAAMwB,EAAIR,GAAKhB,EAAM,OAAOjsB,EACvCytB,EAAIR,IAAMhB,IACRwB,EAAIT,MAAQS,EAAIR,IAAgB,UAAVM,EAAsBC,EAAQxtB,EACjDotB,GAAYptB,GAEjBytB,EAAIT,MAAQf,IACVwB,EAAIT,MAAQS,EAAIR,IAAgB,UAAVM,EAAsBC,EAAQxtB,EACjDotB,GAAYptB,GAGvB,OAAgB,MAATwtB,EAAgBA,EAAQJ,GA0BjC,IAAIM,GAAe,WAejB,IAAIC,EAAS,4CACTC,EAAY,SAAUC,EAAW,QAASC,EAAe,SAAUC,EAAc,OAErF,SAASC,EAASC,EAAOjB,EAAMC,GAC7B9nB,KAAK8oB,MAAQA,EACb9oB,KAAK6nB,KAAOA,EAAM7nB,KAAK8nB,GAAKA,EAG9B,OAAO,SAAS/uB,EAAKgwB,GACnB,IAAIC,EAAyB,OAAbD,EAAqB,IAAM,IAE3C,GAAkB,GAAdhwB,EAAIgC,QAA4B,OAAbguB,IAAuBP,EAAO1lB,KAAK/J,GAAQ,OAAO,EAEzE,IADA,IAtBgBkwB,EAsBZx4B,EAAMsI,EAAIgC,OAAQmuB,EAAQ,GACrBruB,EAAI,EAAGA,EAAIpK,IAAOoK,EACvBquB,EAAM/c,MAxBM8c,EAwBQlwB,EAAIwuB,WAAW1sB,KAvB3B,IAJC,2PAIuB6sB,OAAOuB,GAClC,MAASA,GAAQA,GAAQ,KAAgB,IACzC,MAASA,GAAQA,GAAQ,KAJlB,6PAI8CvB,OAAOuB,EAAO,MACnE,MAASA,GAAQA,GAAQ,KAAgB,IACzC,MAAUA,GAAQA,GAAQ,KAAiB,IACnC,MAARA,EAAyB,IACpB,KAuBd,IAAK,IAAIE,EAAM,EAAGC,EAAOJ,EAAWG,EAAM14B,IAAO04B,EAAK,CACpD,IAAI3b,EAAO0b,EAAMC,GACL,KAAR3b,EAAe0b,EAAMC,GAAOC,EACzBA,EAAO5b,EAQhB,IAAK,IAAI6b,EAAM,EAAGf,EAAMU,EAAWK,EAAM54B,IAAO44B,EAAK,CACnD,IAAIC,EAASJ,EAAMG,GACL,KAAVC,GAAwB,KAAPhB,EAAcY,EAAMG,GAAO,IACvCX,EAAS5lB,KAAKwmB,KAAWhB,EAAMgB,EAAsB,KAAVA,IAAiBJ,EAAMG,GAAO,MAMpF,IAAK,IAAIE,EAAM,EAAGC,EAASN,EAAM,GAAIK,EAAM94B,EAAM,IAAK84B,EAAK,CACzD,IAAIE,EAASP,EAAMK,GACL,KAAVE,GAA2B,KAAVD,GAAiC,KAAhBN,EAAMK,EAAI,GAAaL,EAAMK,GAAO,IACvD,KAAVE,GAAiBD,GAAUN,EAAMK,EAAI,IAC1B,KAAVC,GAA2B,KAAVA,IAAkBN,EAAMK,GAAOC,GAC1DA,EAASC,EAOX,IAAK,IAAIC,EAAM,EAAGA,EAAMj5B,IAAOi5B,EAAK,CAClC,IAAIC,EAAST,EAAMQ,GACnB,GAAc,KAAVC,EAAiBT,EAAMQ,GAAO,SAC7B,GAAc,KAAVC,EAAe,CACtB,IAAInG,OAAM,EACV,IAAKA,EAAMkG,EAAM,EAAGlG,EAAM/yB,GAAqB,KAAdy4B,EAAM1F,KAAeA,GAEtD,IADA,IAAInX,EAAWqd,GAAuB,KAAhBR,EAAMQ,EAAI,IAAelG,EAAM/yB,GAAqB,KAAdy4B,EAAM1F,GAAe,IAAM,IAC9EoG,EAAIF,EAAKE,EAAIpG,IAAOoG,EAAKV,EAAMU,GAAKvd,EAC7Cqd,EAAMlG,EAAM,GAOhB,IAAK,IAAIqG,EAAM,EAAGC,EAAQd,EAAWa,EAAMp5B,IAAOo5B,EAAK,CACrD,IAAIE,EAASb,EAAMW,GACN,KAATC,GAA0B,KAAVC,EAAiBb,EAAMW,GAAO,IACzCnB,EAAS5lB,KAAKinB,KAAWD,EAAQC,GAS5C,IAAK,IAAIC,EAAM,EAAGA,EAAMv5B,IAAOu5B,EAC7B,GAAIvB,EAAU3lB,KAAKomB,EAAMc,IAAO,CAC9B,IAAIC,OAAQ,EACZ,IAAKA,EAAQD,EAAM,EAAGC,EAAQx5B,GAAOg4B,EAAU3lB,KAAKomB,EAAMe,MAAWA,GAIrE,IAHA,IAAI5O,EAA6C,MAAnC2O,EAAMd,EAAMc,EAAI,GAAKhB,GAE/BkB,EAAY7O,IADwC,MAA3C4O,EAAQx5B,EAAMy4B,EAAMe,GAASjB,IACP3N,EAAS,IAAM,IAAO2N,EAChDmB,EAAMH,EAAKG,EAAMF,IAASE,EAAOjB,EAAMiB,GAAOD,EACvDF,EAAMC,EAAQ,EAUlB,IADA,IAAgBntB,EAAZqrB,EAAQ,GACHiC,EAAM,EAAGA,EAAM35B,GACtB,GAAIk4B,EAAa7lB,KAAKomB,EAAMkB,IAAO,CACjC,IAAI7G,EAAQ6G,EACZ,MAAOA,EAAKA,EAAM35B,GAAOk4B,EAAa7lB,KAAKomB,EAAMkB,MAASA,GAC1DjC,EAAMhc,KAAK,IAAI0c,EAAS,EAAGtF,EAAO6G,QAC7B,CACL,IAAInE,EAAMmE,EAAKC,EAAKlC,EAAMptB,OAAQuvB,EAAqB,OAAbvB,EAAqB,EAAI,EACnE,MAAOqB,EAAKA,EAAM35B,GAAqB,KAAdy4B,EAAMkB,KAAeA,GAC9C,IAAK,IAAIG,EAAMtE,EAAKsE,EAAMH,GACxB,GAAIxB,EAAY9lB,KAAKomB,EAAMqB,IAAO,CAC5BtE,EAAMsE,IAAOpC,EAAM1b,OAAO4d,EAAI,EAAG,IAAIxB,EAAS,EAAG5C,EAAKsE,IAAOF,GAAMC,GACvE,IAAIE,EAASD,EACb,MAAOA,EAAKA,EAAMH,GAAOxB,EAAY9lB,KAAKomB,EAAMqB,MAASA,GACzDpC,EAAM1b,OAAO4d,EAAI,EAAG,IAAIxB,EAAS,EAAG2B,EAAQD,IAC5CF,GAAMC,EACNrE,EAAMsE,QACGA,EAETtE,EAAMmE,GAAOjC,EAAM1b,OAAO4d,EAAI,EAAG,IAAIxB,EAAS,EAAG5C,EAAKmE,IAc9D,MAXiB,OAAbrB,IACoB,GAAlBZ,EAAM,GAAGW,QAAehsB,EAAI/D,EAAIgK,MAAM,WACxColB,EAAM,GAAGN,KAAO/qB,EAAE,GAAG/B,OACrBotB,EAAMsC,QAAQ,IAAI5B,EAAS,EAAG,EAAG/rB,EAAE,GAAG/B,UAEhB,GAApBurB,EAAI6B,GAAOW,QAAehsB,EAAI/D,EAAIgK,MAAM,WAC1CujB,EAAI6B,GAAOL,IAAMhrB,EAAE,GAAG/B,OACtBotB,EAAMhc,KAAK,IAAI0c,EAAS,EAAGp4B,EAAMqM,EAAE,GAAG/B,OAAQtK,MAI9B,OAAbs4B,EAAqBZ,EAAMuC,UAAYvC,GAhJ/B,GAuJnB,SAASwC,GAASC,EAAM7B,GACtB,IAAIZ,EAAQyC,EAAKzC,MAEjB,OADa,MAATA,IAAiBA,EAAQyC,EAAKzC,MAAQI,GAAaqC,EAAKhZ,KAAMmX,IAC3DZ,EAQT,IAAI0C,GAAa,GAEbC,GAAK,SAASC,EAASvd,EAAMjX,GAC/B,GAAIw0B,EAAQrf,iBACVqf,EAAQrf,iBAAiB8B,EAAMjX,GAAG,QAC7B,GAAIw0B,EAAQpf,YACjBof,EAAQpf,YAAY,KAAO6B,EAAMjX,OAC5B,CACL,IAAIiY,EAAMuc,EAAQC,YAAcD,EAAQC,UAAY,IACpDxc,EAAIhB,IAASgB,EAAIhB,IAASqd,IAAYzP,OAAO7kB,KAIjD,SAAS00B,GAAYF,EAASvd,GAC5B,OAAOud,EAAQC,WAAaD,EAAQC,UAAUxd,IAASqd,GAGzD,SAASK,GAAIH,EAASvd,EAAMjX,GAC1B,GAAIw0B,EAAQlf,oBACVkf,EAAQlf,oBAAoB2B,EAAMjX,GAAG,QAChC,GAAIw0B,EAAQjf,YACjBif,EAAQjf,YAAY,KAAO0B,EAAMjX,OAC5B,CACL,IAAIiY,EAAMuc,EAAQC,UAAWzE,EAAM/X,GAAOA,EAAIhB,GAC9C,GAAI+Y,EAAK,CACP,IAAI/Z,EAAQN,EAAQqa,EAAKhwB,GACrBiW,GAAS,IACTgC,EAAIhB,GAAQ+Y,EAAI3mB,MAAM,EAAG4M,GAAO4O,OAAOmL,EAAI3mB,MAAM4M,EAAQ,OAKnE,SAAS2e,GAAOJ,EAASvd,GACvB,IAAI4d,EAAWH,GAAYF,EAASvd,GACpC,GAAK4d,EAASrwB,OAEd,IADA,IAAI8F,EAAOvV,MAAMoU,UAAUE,MAAMM,KAAKpF,UAAW,GACxCD,EAAI,EAAGA,EAAIuwB,EAASrwB,SAAUF,EAAKuwB,EAASvwB,GAAGiG,MAAM,KAAMD,GAMtE,SAASwqB,GAAeC,EAAI5iB,EAAG6iB,GAI7B,MAHgB,iBAAL7iB,IACPA,EAAI,CAAC8E,KAAM9E,EAAGwI,eAAgB,WAAalR,KAAKwrB,kBAAmB,KACvEL,GAAOG,EAAIC,GAAY7iB,EAAE8E,KAAM8d,EAAI5iB,GAC5B+iB,GAAmB/iB,IAAMA,EAAEgjB,iBAGpC,SAASC,GAAqBL,GAC5B,IAAI/E,EAAM+E,EAAGN,WAAaM,EAAGN,UAAUY,eACvC,GAAKrF,EAEL,IADA,IAAIt5B,EAAMq+B,EAAGO,MAAMC,yBAA2BR,EAAGO,MAAMC,uBAAyB,IACvEjxB,EAAI,EAAGA,EAAI0rB,EAAIxrB,SAAUF,GAAkC,GAAzBqR,EAAQjf,EAAKs5B,EAAI1rB,KACxD5N,EAAIkf,KAAKoa,EAAI1rB,IAGnB,SAASkxB,GAAWhB,EAASvd,GAC3B,OAAOyd,GAAYF,EAASvd,GAAMzS,OAAS,EAK7C,SAASixB,GAAWC,GAClBA,EAAKvsB,UAAUorB,GAAK,SAAStd,EAAMjX,GAAIu0B,GAAG9qB,KAAMwN,EAAMjX,IACtD01B,EAAKvsB,UAAUwrB,IAAM,SAAS1d,EAAMjX,GAAI20B,GAAIlrB,KAAMwN,EAAMjX,IAM1D,SAAS21B,GAAiBxjB,GACpBA,EAAEwI,eAAkBxI,EAAEwI,iBACnBxI,EAAEyjB,aAAc,EAEzB,SAASC,GAAkB1jB,GACrBA,EAAEgU,gBAAmBhU,EAAEgU,kBACpBhU,EAAE2jB,cAAe,EAE1B,SAASZ,GAAmB/iB,GAC1B,OAA6B,MAAtBA,EAAE8iB,iBAA2B9iB,EAAE8iB,iBAAoC,GAAjB9iB,EAAEyjB,YAE7D,SAASG,GAAO5jB,GAAIwjB,GAAiBxjB,GAAI0jB,GAAkB1jB,GAE3D,SAAS6jB,GAAS7jB,GAAI,OAAOA,EAAE5P,QAAU4P,EAAE8jB,WAC3C,SAASC,GAAS/jB,GAChB,IAAIrZ,EAAIqZ,EAAEoV,MAOV,OANS,MAALzuB,IACa,EAAXqZ,EAAE6U,OAAcluB,EAAI,EACJ,EAAXqZ,EAAE6U,OAAcluB,EAAI,EACT,EAAXqZ,EAAE6U,SAAcluB,EAAI,IAE3BqyB,GAAOhZ,EAAEqC,SAAgB,GAAL1b,IAAUA,EAAI,GAC/BA,EAIT,IAQIq9B,GAeAC,GAvBAC,GAAc,WAGhB,GAAI/L,GAAMC,EAAa,EAAK,OAAO,EACnC,IAAI3iB,EAAMskB,EAAI,OACd,MAAO,cAAetkB,GAAO,aAAcA,EAL3B,GASlB,SAAS0uB,GAAiBC,GACxB,GAAqB,MAAjBJ,GAAuB,CACzB,IAAI5pB,EAAO2f,EAAI,OAAQ,KACvBD,EAAqBsK,EAASrK,EAAI,OAAQ,CAAC3f,EAAMgF,SAAS8R,eAAe,QAClC,GAAnCkT,EAAQzP,WAAWyC,eACnB4M,GAAgB5pB,EAAKiqB,aAAe,GAAKjqB,EAAKgd,aAAe,KAAOe,GAAMC,EAAa,IAE7F,IAAIjB,EAAO6M,GAAgBjK,EAAI,OAAQ,KACrCA,EAAI,OAAQ,IAAU,KAAM,yDAE9B,OADA5C,EAAK7R,aAAa,UAAW,IACtB6R,EAKT,SAASmN,GAAgBF,GACvB,GAAoB,MAAhBH,GAAwB,OAAOA,GACnC,IAAIM,EAAMzK,EAAqBsK,EAAShlB,SAAS8R,eAAe,QAC5DsT,EAAK/K,EAAM8K,EAAK,EAAG,GAAG5b,wBACtB8b,EAAKhL,EAAM8K,EAAK,EAAG,GAAG5b,wBAE1B,OADAkR,EAAeuK,MACVI,GAAMA,EAAGv3B,MAAQu3B,EAAGt3B,SAClB+2B,GAAgBQ,EAAGv3B,MAAQs3B,EAAGt3B,MAAQ,GAK/C,IA8BM8S,GA9BF0kB,GAA+C,GAA9B,QAAQnhB,MAAM,MAAMlR,OAAc,SAAUwpB,GAE/D,IADA,IAAI0B,EAAM,EAAGniB,EAAS,GAAIjF,EAAI0lB,EAAOxpB,OAC9BkrB,GAAOpnB,GAAG,CACf,IAAIwuB,EAAK9I,EAAOrY,QAAQ,KAAM+Z,IACnB,GAAPoH,IAAYA,EAAK9I,EAAOxpB,QAC5B,IAAI6vB,EAAOrG,EAAO3kB,MAAMqmB,EAA8B,MAAzB1B,EAAOmD,OAAO2F,EAAK,GAAaA,EAAK,EAAIA,GAClEC,EAAK1C,EAAK1e,QAAQ,OACX,GAAPohB,GACFxpB,EAAOqI,KAAKye,EAAKhrB,MAAM,EAAG0tB,IAC1BrH,GAAOqH,EAAK,IAEZxpB,EAAOqI,KAAKye,GACZ3E,EAAMoH,EAAK,GAGf,OAAOvpB,GACL,SAAUygB,GAAU,OAAOA,EAAOtY,MAAM,aAExCshB,GAAe7iB,OAAO8iB,aAAe,SAAUC,GACjD,IAAM,OAAOA,EAAG3I,gBAAkB2I,EAAG1I,aACrC,MAAMrc,GAAK,OAAO,IAChB,SAAU+kB,GACZ,IAAItL,EACJ,IAAKA,EAAQsL,EAAGC,cAAcC,UAAUrK,cACxC,MAAM5a,IACN,SAAKyZ,GAASA,EAAMzC,iBAAmB+N,IACe,GAA/CtL,EAAMyL,iBAAiB,aAAczL,IAG1C0L,GAEE,WADAnlB,GAAI+Z,EAAI,UAEZ/Z,GAAEsF,aAAa,SAAU,WACC,mBAAZtF,GAAEolB,QAGdC,GAAiB,KAUjBC,GAAQ,GAAIC,GAAY,GAK5B,SAASC,GAAWxV,EAAMyV,GACpBrzB,UAAUC,OAAS,IACnBozB,EAAKC,aAAe9iC,MAAMoU,UAAUE,MAAMM,KAAKpF,UAAW,IAC9DkzB,GAAMtV,GAAQyV,EAShB,SAASE,GAAYC,GACnB,GAAmB,iBAARA,GAAoBL,GAAU5J,eAAeiK,GACtDA,EAAOL,GAAUK,QACZ,GAAIA,GAA4B,iBAAbA,EAAK5V,MAAoBuV,GAAU5J,eAAeiK,EAAK5V,MAAO,CACtF,IAAI2P,EAAQ4F,GAAUK,EAAK5V,MACP,iBAAT2P,IAAqBA,EAAQ,CAAC3P,KAAM2P,KAC/CiG,EAAO7H,EAAU4B,EAAOiG,IACnB5V,KAAO2P,EAAM3P,SACb,IAAmB,iBAAR4V,GAAoB,0BAA0BxrB,KAAKwrB,GACnE,OAAOD,GAAY,mBACd,GAAmB,iBAARC,GAAoB,2BAA2BxrB,KAAKwrB,GACpE,OAAOD,GAAY,oBAErB,MAAmB,iBAARC,EAA2B,CAAC5V,KAAM4V,GAC/BA,GAAQ,CAAC5V,KAAM,QAK/B,SAAS6V,GAAQjgB,EAASggB,GACxBA,EAAOD,GAAYC,GACnB,IAAIE,EAAWR,GAAMM,EAAK5V,MAC1B,IAAK8V,EAAY,OAAOD,GAAQjgB,EAAS,cACzC,IAAImgB,EAAUD,EAASlgB,EAASggB,GAChC,GAAII,GAAerK,eAAeiK,EAAK5V,MAAO,CAC5C,IAAIiW,EAAOD,GAAeJ,EAAK5V,MAC/B,IAAK,IAAI0L,KAAQuK,EACVA,EAAKtK,eAAeD,KACrBqK,EAAQpK,eAAeD,KAASqK,EAAQ,IAAMrK,GAAQqK,EAAQrK,IAClEqK,EAAQrK,GAAQuK,EAAKvK,IAKzB,GAFAqK,EAAQ/V,KAAO4V,EAAK5V,KAChB4V,EAAKM,aAAcH,EAAQG,WAAaN,EAAKM,YAC7CN,EAAKO,UAAa,IAAK,IAAIC,KAAUR,EAAKO,UAC1CJ,EAAQK,GAAUR,EAAKO,UAAUC,GAErC,OAAOL,EAKT,IAAIC,GAAiB,GACrB,SAASK,GAAWZ,EAAMa,GAExB9K,EAAQ8K,EADGN,GAAerK,eAAe8J,GAAQO,GAAeP,GAASO,GAAeP,GAAQ,IAIlG,SAASc,GAAUd,EAAMe,GACvB,IAAc,IAAVA,EAAkB,OAAOA,EAC7B,GAAIf,EAAKc,UAAa,OAAOd,EAAKc,UAAUC,GAC5C,IAAIC,EAAS,GACb,IAAK,IAAIvK,KAAKsK,EAAO,CACnB,IAAIrmB,EAAMqmB,EAAMtK,GACZ/b,aAAevd,QAASud,EAAMA,EAAIuS,OAAO,KAC7C+T,EAAOvK,GAAK/b,EAEd,OAAOsmB,EAKT,SAASC,GAAUjB,EAAMe,GAEvB,IADA,IAAIG,EACGlB,EAAKiB,YACVC,EAAOlB,EAAKiB,UAAUF,KACTG,EAAKlB,MAAQA,GAC1Be,EAAQG,EAAKH,MACbf,EAAOkB,EAAKlB,KAEd,OAAOkB,GAAQ,CAAClB,KAAMA,EAAMe,MAAOA,GAGrC,SAASI,GAAWnB,EAAM30B,EAAIC,GAC5B,OAAO00B,EAAKmB,YAAanB,EAAKmB,WAAW91B,EAAIC,GAQ/C,IAAI81B,GAAe,SAAShL,EAAQC,EAASgL,GAC3CxvB,KAAKimB,IAAMjmB,KAAKujB,MAAQ,EACxBvjB,KAAKukB,OAASA,EACdvkB,KAAKwkB,QAAUA,GAAW,EAC1BxkB,KAAKyvB,cAAgBzvB,KAAK0vB,gBAAkB,EAC5C1vB,KAAK2vB,UAAY,EACjB3vB,KAAKwvB,WAAaA,GA2EpB,SAASI,GAAQ5a,EAAK4P,GAEpB,IADAA,GAAK5P,EAAI6a,OACD,GAAKjL,GAAK5P,EAAI8a,KAAQ,MAAM,IAAI3oB,MAAM,qBAAuByd,EAAI5P,EAAI6a,OAAS,qBAEtF,IADA,IAAIE,EAAQ/a,GACJ+a,EAAMC,OACZ,IAAK,IAAIn1B,EAAI,KAAMA,EAAG,CACpB,IAAIioB,EAAQiN,EAAME,SAASp1B,GAAItG,EAAKuuB,EAAMoN,YAC1C,GAAItL,EAAIrwB,EAAI,CAAEw7B,EAAQjN,EAAO,MAC7B8B,GAAKrwB,EAGT,OAAOw7B,EAAMC,MAAMpL,GAKrB,SAASuL,GAAWnb,EAAKuO,EAAOC,GAC9B,IAAI53B,EAAM,GAAIg5B,EAAIrB,EAAMqH,KAQxB,OAPA5V,EAAIob,KAAK7M,EAAMqH,KAAMpH,EAAIoH,KAAO,GAAG,SAAUA,GAC3C,IAAIhZ,EAAOgZ,EAAKhZ,KACZgT,GAAKpB,EAAIoH,OAAQhZ,EAAOA,EAAKhS,MAAM,EAAG4jB,EAAIsD,KAC1ClC,GAAKrB,EAAMqH,OAAQhZ,EAAOA,EAAKhS,MAAM2jB,EAAMuD,KAC/Cl7B,EAAIugB,KAAKyF,KACPgT,KAEGh5B,EAGT,SAASykC,GAASrb,EAAK6S,EAAMC,GAC3B,IAAIl8B,EAAM,GAEV,OADAopB,EAAIob,KAAKvI,EAAMC,GAAI,SAAU8C,GAAQh/B,EAAIugB,KAAKye,EAAKhZ,SAC5ChmB,EAKT,SAAS0kC,GAAiB1F,EAAM5d,GAC9B,IAAIwD,EAAOxD,EAAS4d,EAAK5d,OACzB,GAAIwD,EAAQ,IAAK,IAAIoU,EAAIgG,EAAMhG,EAAGA,EAAIA,EAAEre,OAAUqe,EAAE5X,QAAUwD,EAKhE,SAAS+f,GAAO3F,GACd,GAAmB,MAAfA,EAAKrkB,OAAkB,OAAO,KAElC,IADA,IAAI+hB,EAAMsC,EAAKrkB,OAAQiqB,EAAKtkB,EAAQoc,EAAI0H,MAAOpF,GACtCmF,EAAQzH,EAAI/hB,OAAQwpB,EAAOzH,EAAMyH,EAAOA,EAAQA,EAAMxpB,OAC7D,IAAK,IAAI1L,EAAI,EACPk1B,EAAME,SAASp1B,IAAMytB,IADRztB,EAEjB21B,GAAMT,EAAME,SAASp1B,GAAGq1B,YAG5B,OAAOM,EAAKlI,EAAIuH,MAKlB,SAASY,GAAaV,EAAOzwB,GAC3B,IAAIslB,EAAImL,EAAMF,MACda,EAAO,EAAG,CACR,IAAK,IAAIvH,EAAM,EAAGA,EAAM4G,EAAME,SAASl1B,SAAUouB,EAAK,CACpD,IAAIrG,EAAQiN,EAAME,SAAS9G,GAAMrC,EAAKhE,EAAM9V,OAC5C,GAAI1N,EAAIwnB,EAAI,CAAEiJ,EAAQjN,EAAO,SAAS4N,EACtCpxB,GAAKwnB,EACLlC,GAAK9B,EAAMoN,YAEb,OAAOtL,SACCmL,EAAMC,OAEhB,IADA,IAAIn1B,EAAI,EACDA,EAAIk1B,EAAMC,MAAMj1B,SAAUF,EAAG,CAClC,IAA2B81B,EAAhBZ,EAAMC,MAAMn1B,GAAcmS,OACrC,GAAI1N,EAAIqxB,EAAM,MACdrxB,GAAKqxB,EAEP,OAAO/L,EAAI/pB,EAGb,SAAS+1B,GAAO5b,EAAKnW,GAAI,OAAOA,GAAKmW,EAAI6a,OAAShxB,EAAImW,EAAI6a,MAAQ7a,EAAI8a,KAEtE,SAASe,GAAcviB,EAASzT,GAC9B,OAAOi2B,OAAOxiB,EAAQyiB,oBAAoBl2B,EAAIyT,EAAQ0iB,kBAIxD,SAASC,GAAIrG,EAAM9D,EAAIsB,GAGrB,QAFgB,IAAXA,IAAoBA,EAAS,QAE5BpoB,gBAAgBixB,IAAQ,OAAO,IAAIA,GAAIrG,EAAM9D,EAAIsB,GACvDpoB,KAAK4qB,KAAOA,EACZ5qB,KAAK8mB,GAAKA,EACV9mB,KAAKooB,OAASA,EAKhB,SAAS8I,GAAIplC,EAAGuD,GAAK,OAAOvD,EAAE8+B,KAAOv7B,EAAEu7B,MAAQ9+B,EAAEg7B,GAAKz3B,EAAEy3B,GAExD,SAASqK,GAAerlC,EAAGuD,GAAK,OAAOvD,EAAEs8B,QAAU/4B,EAAE+4B,QAAuB,GAAb8I,GAAIplC,EAAGuD,GAEtE,SAAS+hC,GAAQxhC,GAAI,OAAOqhC,GAAIrhC,EAAEg7B,KAAMh7B,EAAEk3B,IAC1C,SAASuK,GAAOvlC,EAAGuD,GAAK,OAAO6hC,GAAIplC,EAAGuD,GAAK,EAAIA,EAAIvD,EACnD,SAASwlC,GAAOxlC,EAAGuD,GAAK,OAAO6hC,GAAIplC,EAAGuD,GAAK,EAAIvD,EAAIuD,EAInD,SAASkiC,GAASvc,EAAK4P,GAAI,OAAOp5B,KAAKoP,IAAIoa,EAAI6a,MAAOrkC,KAAK6P,IAAIupB,EAAG5P,EAAI6a,MAAQ7a,EAAI8a,KAAO,IACzF,SAAS0B,GAAQxc,EAAKiR,GACpB,GAAIA,EAAI2E,KAAO5V,EAAI6a,MAAS,OAAOoB,GAAIjc,EAAI6a,MAAO,GAClD,IAAI4B,EAAOzc,EAAI6a,MAAQ7a,EAAI8a,KAAO,EAClC,OAAI7J,EAAI2E,KAAO6G,EAAeR,GAAIQ,EAAM7B,GAAQ5a,EAAKyc,GAAM7f,KAAK7W,QAGlE,SAAmBkrB,EAAKyL,GACtB,IAAI5K,EAAKb,EAAIa,GACb,OAAU,MAANA,GAAcA,EAAK4K,EAAkBT,GAAIhL,EAAI2E,KAAM8G,GAC9C5K,EAAK,EAAYmK,GAAIhL,EAAI2E,KAAM,GAC1B3E,EANP0L,CAAU1L,EAAK2J,GAAQ5a,EAAKiR,EAAI2E,MAAMhZ,KAAK7W,QAQpD,SAAS62B,GAAa5c,EAAKsQ,GAEzB,IADA,IAAI15B,EAAM,GACDiP,EAAI,EAAGA,EAAIyqB,EAAMvqB,OAAQF,IAAOjP,EAAIiP,GAAK22B,GAAQxc,EAAKsQ,EAAMzqB,IACrE,OAAOjP,EAjMT2jC,GAAa7vB,UAAUmyB,IAAM,WAAa,OAAO7xB,KAAKimB,KAAOjmB,KAAKukB,OAAOxpB,QACzEw0B,GAAa7vB,UAAUoyB,IAAM,WAAa,OAAO9xB,KAAKimB,KAAOjmB,KAAK2vB,WAClEJ,GAAa7vB,UAAUqyB,KAAO,WAAa,OAAO/xB,KAAKukB,OAAOmD,OAAO1nB,KAAKimB,WAAQv7B,GAClF6kC,GAAa7vB,UAAUsyB,KAAO,WAC5B,GAAIhyB,KAAKimB,IAAMjmB,KAAKukB,OAAOxpB,OACvB,OAAOiF,KAAKukB,OAAOmD,OAAO1nB,KAAKimB,QAErCsJ,GAAa7vB,UAAUuyB,IAAM,SAAUlvB,GACrC,IAAI+jB,EAAK9mB,KAAKukB,OAAOmD,OAAO1nB,KAAKimB,KAIjC,GAFoB,iBAATljB,EAA0B+jB,GAAM/jB,EAC/B+jB,IAAO/jB,EAAMD,KAAOC,EAAMD,KAAKgkB,GAAM/jB,EAAM+jB,IAClC,QAAV9mB,KAAKimB,IAAYa,GAE9ByI,GAAa7vB,UAAUwyB,SAAW,SAAUnvB,GAE1C,IADA,IAAIwgB,EAAQvjB,KAAKimB,IACVjmB,KAAKiyB,IAAIlvB,KAChB,OAAO/C,KAAKimB,IAAM1C,GAEpBgM,GAAa7vB,UAAUyyB,SAAW,WAEhC,IADA,IAAI5O,EAAQvjB,KAAKimB,IACV,aAAanjB,KAAK9C,KAAKukB,OAAOmD,OAAO1nB,KAAKimB,SAAWjmB,KAAKimB,IACjE,OAAOjmB,KAAKimB,IAAM1C,GAEpBgM,GAAa7vB,UAAU0yB,UAAY,WAAapyB,KAAKimB,IAAMjmB,KAAKukB,OAAOxpB,QACvEw0B,GAAa7vB,UAAU2yB,OAAS,SAAUvL,GACxC,IAAIuB,EAAQroB,KAAKukB,OAAOrY,QAAQ4a,EAAI9mB,KAAKimB,KACzC,GAAIoC,GAAS,EAAsB,OAAlBroB,KAAKimB,IAAMoC,GAAc,GAE5CkH,GAAa7vB,UAAU4yB,OAAS,SAAU1N,GAAI5kB,KAAKimB,KAAOrB,GAC1D2K,GAAa7vB,UAAU6yB,OAAS,WAK9B,OAJIvyB,KAAKyvB,cAAgBzvB,KAAKujB,QAC5BvjB,KAAK0vB,gBAAkBpL,EAAYtkB,KAAKukB,OAAQvkB,KAAKujB,MAAOvjB,KAAKwkB,QAASxkB,KAAKyvB,cAAezvB,KAAK0vB,iBACnG1vB,KAAKyvB,cAAgBzvB,KAAKujB,OAErBvjB,KAAK0vB,iBAAmB1vB,KAAK2vB,UAAYrL,EAAYtkB,KAAKukB,OAAQvkB,KAAK2vB,UAAW3vB,KAAKwkB,SAAW,IAE3G+K,GAAa7vB,UAAU8yB,YAAc,WACnC,OAAOlO,EAAYtkB,KAAKukB,OAAQ,KAAMvkB,KAAKwkB,UACxCxkB,KAAK2vB,UAAYrL,EAAYtkB,KAAKukB,OAAQvkB,KAAK2vB,UAAW3vB,KAAKwkB,SAAW,IAE/E+K,GAAa7vB,UAAUqD,MAAQ,SAAU0vB,EAASC,EAASC,GACzD,GAAsB,iBAAXF,EAOJ,CACL,IAAI1vB,EAAQ/C,KAAKukB,OAAO3kB,MAAMI,KAAKimB,KAAKljB,MAAM0vB,GAC9C,OAAI1vB,GAASA,EAAMyJ,MAAQ,EAAY,MACnCzJ,IAAqB,IAAZ2vB,IAAqB1yB,KAAKimB,KAAOljB,EAAM,GAAGhI,QAChDgI,GAVP,IAAI6vB,EAAQ,SAAU75B,GAAO,OAAO45B,EAAkB55B,EAAIiuB,cAAgBjuB,GAE1E,GAAI65B,EADS5yB,KAAKukB,OAAOsO,OAAO7yB,KAAKimB,IAAKwM,EAAQ13B,UAC7B63B,EAAMH,GAEzB,OADgB,IAAZC,IAAqB1yB,KAAKimB,KAAOwM,EAAQ13B,SACtC,GASbw0B,GAAa7vB,UAAU2iB,QAAU,WAAY,OAAOriB,KAAKukB,OAAO3kB,MAAMI,KAAKujB,MAAOvjB,KAAKimB,MACvFsJ,GAAa7vB,UAAUozB,eAAiB,SAAUlO,EAAGmO,GACnD/yB,KAAK2vB,WAAa/K,EAClB,IAAM,OAAOmO,IACb,QAAU/yB,KAAK2vB,WAAa/K,IAE9B2K,GAAa7vB,UAAUszB,UAAY,SAAUpO,GAC3C,IAAIqO,EAASjzB,KAAKwvB,WAClB,OAAOyD,GAAUA,EAAOD,UAAUpO,IAEpC2K,GAAa7vB,UAAUwzB,UAAY,WACjC,IAAID,EAASjzB,KAAKwvB,WAClB,OAAOyD,GAAUA,EAAOC,UAAUlzB,KAAKimB,MAgIzC,IAAIkN,GAAe,SAASjE,EAAO8D,GACjChzB,KAAKkvB,MAAQA,EACblvB,KAAKgzB,UAAYA,GAGfI,GAAU,SAASpe,EAAKka,EAAOtE,EAAMoI,GACvChzB,KAAKkvB,MAAQA,EACblvB,KAAKgV,IAAMA,EACXhV,KAAK4qB,KAAOA,EACZ5qB,KAAKqzB,aAAeL,GAAa,EACjChzB,KAAKszB,WAAa,KAClBtzB,KAAKuzB,aAAe,GAwCtB,SAASC,GAAclI,EAAIV,EAAM6I,EAASC,GAGxC,IAAIC,EAAK,CAACrI,EAAG4D,MAAM0E,SAAUC,EAAc,GAE3CC,GAAQxI,EAAIV,EAAKhZ,KAAM0Z,EAAGtW,IAAImZ,KAAMsF,GAAS,SAAUjQ,EAAKta,GAAS,OAAOyqB,EAAGxnB,KAAKqX,EAAKta,KACjF2qB,EAAaH,GAkCrB,IAjCA,IAAIxE,EAAQuE,EAAQvE,MAGhB6E,EAAO,SAAWt/B,GACpBg/B,EAAQH,WAAaK,EACrB,IAAIK,EAAU1I,EAAG4D,MAAM+E,SAASx/B,GAAIoG,EAAI,EAAGwvB,EAAK,EAChDoJ,EAAQvE,OAAQ,EAChB4E,GAAQxI,EAAIV,EAAKhZ,KAAMoiB,EAAQ7F,KAAMsF,GAAS,SAAUjQ,EAAKta,GAG3D,IAFA,IAAIqa,EAAQ1oB,EAELwvB,EAAK7G,GAAK,CACf,IAAI0Q,EAAQP,EAAG94B,GACXq5B,EAAQ1Q,GACRmQ,EAAGlnB,OAAO5R,EAAG,EAAG2oB,EAAKmQ,EAAG94B,EAAE,GAAIq5B,GAClCr5B,GAAK,EACLwvB,EAAK7+B,KAAK6P,IAAImoB,EAAK0Q,GAErB,GAAKhrB,EACL,GAAI8qB,EAAQG,OACVR,EAAGlnB,OAAO8W,EAAO1oB,EAAI0oB,EAAOC,EAAK,WAAata,GAC9CrO,EAAI0oB,EAAQ,OAEZ,KAAOA,EAAQ1oB,EAAG0oB,GAAS,EAAG,CAC5B,IAAI+E,EAAMqL,EAAGpQ,EAAM,GACnBoQ,EAAGpQ,EAAM,IAAM+E,EAAMA,EAAM,IAAM,IAAM,WAAapf,KAGvD2qB,GACHJ,EAAQvE,MAAQA,EAChBuE,EAAQH,WAAa,KACrBG,EAAQF,aAAe,GAGhB9+B,EAAI,EAAGA,EAAI62B,EAAG4D,MAAM+E,SAASl5B,SAAUtG,EAAGs/B,EAAMt/B,GAEzD,MAAO,CAAC2/B,OAAQT,EAAI3nB,QAAS6nB,EAAYQ,SAAWR,EAAYS,UAAYT,EAAc,MAG5F,SAASU,GAAcjJ,EAAIV,EAAM4J,GAC/B,IAAK5J,EAAKwJ,QAAUxJ,EAAKwJ,OAAO,IAAM9I,EAAG4D,MAAM0E,QAAS,CACtD,IAAIH,EAAUgB,GAAiBnJ,EAAIiF,GAAO3F,IACtC8J,EAAa9J,EAAKhZ,KAAK7W,OAASuwB,EAAGhd,QAAQqmB,oBAAsB1F,GAAU3D,EAAGtW,IAAImZ,KAAMsF,EAAQvE,OAChGprB,EAAS0vB,GAAclI,EAAIV,EAAM6I,GACjCiB,IAAcjB,EAAQvE,MAAQwF,GAClC9J,EAAKgK,WAAanB,EAAQxV,MAAMyW,GAChC9J,EAAKwJ,OAAStwB,EAAOswB,OACjBtwB,EAAOkI,QAAW4e,EAAKiK,aAAe/wB,EAAOkI,QACxC4e,EAAKiK,eAAgBjK,EAAKiK,aAAe,MAC9CL,IAAmBlJ,EAAGtW,IAAI8f,oBAC1BxJ,EAAGtW,IAAI+f,aAAevpC,KAAKoP,IAAI0wB,EAAGtW,IAAI+f,eAAgBzJ,EAAGtW,IAAI8f,oBAEnE,OAAOlK,EAAKwJ,OAGd,SAASK,GAAiBnJ,EAAI1G,EAAGoQ,GAC/B,IAAIhgB,EAAMsW,EAAGtW,IAAKpB,EAAU0X,EAAG1X,QAC/B,IAAKoB,EAAImZ,KAAKmB,WAAc,OAAO,IAAI8D,GAAQpe,GAAK,EAAM4P,GAC1D,IAAIrB,EA6HN,SAAuB+H,EAAI1G,EAAGoQ,GAG5B,IAFA,IAAIC,EAAWC,EAASlgB,EAAMsW,EAAGtW,IAC7BmgB,EAAMH,GAAW,EAAIpQ,GAAK0G,EAAGtW,IAAImZ,KAAKiB,UAAY,IAAO,KACpDzK,EAASC,EAAGD,EAASwQ,IAAOxQ,EAAQ,CAC3C,GAAIA,GAAU3P,EAAI6a,MAAS,OAAO7a,EAAI6a,MACtC,IAAIjF,EAAOgF,GAAQ5a,EAAK2P,EAAS,GAAIrC,EAAQsI,EAAKgK,WAClD,GAAItS,KAAW0S,GAAWrQ,GAAUrC,aAAiB6Q,GAAe7Q,EAAM0Q,UAAY,IAAMhe,EAAI+f,cAC5F,OAAOpQ,EACX,IAAIyQ,EAAW9Q,EAAYsG,EAAKhZ,KAAM,KAAM0Z,EAAGhd,QAAQkW,UACxC,MAAX0Q,GAAmBD,EAAYG,KACjCF,EAAUvQ,EAAS,EACnBsQ,EAAYG,GAGhB,OAAOF,EA3IKG,CAAc/J,EAAI1G,EAAGoQ,GAC7BM,EAAQ/R,EAAQvO,EAAI6a,OAASD,GAAQ5a,EAAKuO,EAAQ,GAAGqR,WACrDnB,EAAU6B,EAAQlC,GAAQmC,UAAUvgB,EAAKsgB,EAAO/R,GAAS,IAAI6P,GAAQpe,EAAKsa,GAAWta,EAAImZ,MAAO5K,GASpG,OAPAvO,EAAIob,KAAK7M,EAAOqB,GAAG,SAAUgG,GAC3B4K,GAAYlK,EAAIV,EAAKhZ,KAAM6hB,GAC3B,IAAIxN,EAAMwN,EAAQ7I,KAClBA,EAAKgK,WAAa3O,GAAOrB,EAAI,GAAKqB,EAAM,GAAK,GAAKA,GAAOrS,EAAQ6hB,UAAYxP,EAAMrS,EAAQ8hB,OAASjC,EAAQxV,OAAS,KACrHwV,EAAQkC,cAENX,IAAWhgB,EAAI+f,aAAetB,EAAQ7I,MACnC6I,EAMT,SAAS+B,GAAYlK,EAAI1Z,EAAM6hB,EAASmC,GACtC,IAAIzH,EAAO7C,EAAGtW,IAAImZ,KACd0H,EAAS,IAAItG,GAAa3d,EAAM0Z,EAAGhd,QAAQkW,QAASiP,GAGxD,IAFAoC,EAAOtS,MAAQsS,EAAO5P,IAAM2P,GAAW,EAC3B,IAARhkB,GAAckkB,GAAc3H,EAAMsF,EAAQvE,QACtC2G,EAAOhE,OACbkE,GAAU5H,EAAM0H,EAAQpC,EAAQvE,OAChC2G,EAAOtS,MAAQsS,EAAO5P,IAI1B,SAAS6P,GAAc3H,EAAMe,GAC3B,GAAIf,EAAK6H,UAAa,OAAO7H,EAAK6H,UAAU9G,GAC5C,GAAKf,EAAKiB,UAAV,CACA,IAAI2D,EAAQ3D,GAAUjB,EAAMe,GAC5B,OAAI6D,EAAM5E,KAAK6H,UAAoBjD,EAAM5E,KAAK6H,UAAUjD,EAAM7D,YAA9D,GAGF,SAAS6G,GAAU5H,EAAM0H,EAAQ3G,EAAO6D,GACtC,IAAK,IAAIl4B,EAAI,EAAGA,EAAI,GAAIA,IAAK,CACvBk4B,IAASA,EAAM,GAAK3D,GAAUjB,EAAMe,GAAOf,MAC/C,IAAIjlB,EAAQilB,EAAK8H,MAAMJ,EAAQ3G,GAC/B,GAAI2G,EAAO5P,IAAM4P,EAAOtS,MAAS,OAAOra,EAE1C,MAAM,IAAI/B,MAAM,QAAUgnB,EAAKzV,KAAO,8BA9IxC0a,GAAQ1zB,UAAUszB,UAAY,SAAUpO,GACtC,IAAIgG,EAAO5qB,KAAKgV,IAAI4a,QAAQ5vB,KAAK4qB,KAAOhG,GAExC,OADY,MAARgG,GAAgBhG,EAAI5kB,KAAKqzB,eAAgBrzB,KAAKqzB,aAAezO,GAC1DgG,GAGTwI,GAAQ1zB,UAAUwzB,UAAY,SAAUtO,GACtC,IAAK5kB,KAAKszB,WAAc,OAAO,KAC/B,KAAOtzB,KAAKszB,WAAWtzB,KAAKuzB,eAAiB3O,GACzC5kB,KAAKuzB,cAAgB,EACzB,IAAI/lB,EAAOxN,KAAKszB,WAAWtzB,KAAKuzB,aAAe,GAC/C,MAAO,CAAC/lB,KAAMA,GAAQA,EAAKnB,QAAQ,kBAAmB,IAC9CyjB,KAAM9vB,KAAKszB,WAAWtzB,KAAKuzB,cAAgB3O,IAGrDwO,GAAQ1zB,UAAUi2B,SAAW,WAC3B31B,KAAK4qB,OACD5qB,KAAKqzB,aAAe,GAAKrzB,KAAKqzB,gBAGpCD,GAAQmC,UAAY,SAAUvgB,EAAKsgB,EAAO1K,GACxC,OAAI0K,aAAiBnC,GACV,IAAIC,GAAQpe,EAAKia,GAAUja,EAAImZ,KAAMmH,EAAMpG,OAAQtE,EAAM0K,EAAMtC,WAE/D,IAAII,GAAQpe,EAAKia,GAAUja,EAAImZ,KAAMmH,GAAQ1K,IAG1DwI,GAAQ1zB,UAAUue,KAAO,SAAUlyB,GACjC,IAAImjC,GAAiB,IAATnjC,EAAiBkjC,GAAUjvB,KAAKgV,IAAImZ,KAAMnuB,KAAKkvB,OAASlvB,KAAKkvB,MACzE,OAAOlvB,KAAKqzB,aAAe,EAAI,IAAIF,GAAajE,EAAOlvB,KAAKqzB,cAAgBnE,GAoH9E,IAAIgH,GAAQ,SAASL,EAAQroB,EAAM0hB,GACjClvB,KAAKujB,MAAQsS,EAAOtS,MAAOvjB,KAAKwjB,IAAMqS,EAAO5P,IAC7CjmB,KAAKukB,OAASsR,EAAOxT,UACrBriB,KAAKwN,KAAOA,GAAQ,KACpBxN,KAAKkvB,MAAQA,GAIf,SAASiH,GAAU7K,EAAIrF,EAAK+O,EAASoB,GACnC,IAAmCltB,EAGoCmtB,EAHnErhB,EAAMsW,EAAGtW,IAAKmZ,EAAOnZ,EAAImZ,KAEzBvD,EAAOgF,GAAQ5a,GADnBiR,EAAMuL,GAAQxc,EAAKiR,IACS2E,MAAO6I,EAAUgB,GAAiBnJ,EAAIrF,EAAI2E,KAAMoK,GACxEa,EAAS,IAAItG,GAAa3E,EAAKhZ,KAAM0Z,EAAGhd,QAAQkW,QAASiP,GAE7D,IADI2C,IAAWC,EAAS,KAChBD,GAAWP,EAAO5P,IAAMA,EAAIa,MAAQ+O,EAAOhE,OACjDgE,EAAOtS,MAAQsS,EAAO5P,IACtB/c,EAAQ6sB,GAAU5H,EAAM0H,EAAQpC,EAAQvE,OACpCkH,GAAWC,EAAOlqB,KAAK,IAAI+pB,GAAML,EAAQ3sB,EAAO+lB,GAAUja,EAAImZ,KAAMsF,EAAQvE,SAElF,OAAOkH,EAAUC,EAAS,IAAIH,GAAML,EAAQ3sB,EAAOuqB,EAAQvE,OAG7D,SAASoH,GAAmB9oB,EAAM+oB,GAChC,GAAI/oB,EAAQ,OAAS,CACnB,IAAIgpB,EAAYhpB,EAAKzK,MAAM,qCAC3B,IAAKyzB,EAAa,MAClBhpB,EAAOA,EAAK5N,MAAM,EAAG42B,EAAUhqB,OAASgB,EAAK5N,MAAM42B,EAAUhqB,MAAQgqB,EAAU,GAAGz7B,QAClF,IAAIqpB,EAAOoS,EAAU,GAAK,UAAY,YAClB,MAAhBD,EAAOnS,GACPmS,EAAOnS,GAAQoS,EAAU,GACnB,IAAK7pB,OAAO,UAAa6pB,EAAU,GAAK,WAAa1zB,KAAKyzB,EAAOnS,MACvEmS,EAAOnS,IAAS,IAAMoS,EAAU,IAEtC,OAAOhpB,EAIT,SAASsmB,GAAQxI,EAAI1Z,EAAMuc,EAAMsF,EAASl9B,EAAGs9B,EAAaH,GACxD,IAAI+C,EAAetI,EAAKsI,aACJ,MAAhBA,IAAwBA,EAAenL,EAAGhd,QAAQmoB,cACtD,IACkEvtB,EAD9DwtB,EAAW,EAAGC,EAAW,KACzBd,EAAS,IAAItG,GAAa3d,EAAM0Z,EAAGhd,QAAQkW,QAASiP,GACpDV,EAAQzH,EAAGhd,QAAQsoB,cAAgB,CAAC,MAExC,IADY,IAARhlB,GAAc0kB,GAAmBR,GAAc3H,EAAMsF,EAAQvE,OAAQ2E,IACjEgC,EAAOhE,OAAO,CASpB,GARIgE,EAAO5P,IAAMqF,EAAGhd,QAAQqmB,oBAC1B8B,GAAe,EACX/C,GAAc8B,GAAYlK,EAAI1Z,EAAM6hB,EAASoC,EAAO5P,KACxD4P,EAAO5P,IAAMrU,EAAK7W,OAClBmO,EAAQ,MAERA,EAAQotB,GAAmBP,GAAU5H,EAAM0H,EAAQpC,EAAQvE,MAAO6D,GAAQc,GAExEd,EAAO,CACT,IAAI8D,EAAQ9D,EAAM,GAAGra,KACjBme,IAAS3tB,EAAQ,MAAQA,EAAQ2tB,EAAQ,IAAM3tB,EAAQ2tB,IAE7D,IAAKJ,GAAgBE,GAAYztB,EAAO,CACtC,KAAOwtB,EAAWb,EAAOtS,OAEvBhtB,EADAmgC,EAAWlrC,KAAK6P,IAAIw6B,EAAOtS,MAAOmT,EAAW,KACjCC,GAEdA,EAAWztB,EAEb2sB,EAAOtS,MAAQsS,EAAO5P,IAExB,KAAOyQ,EAAWb,EAAO5P,KAAK,CAI5B,IAAIA,EAAMz6B,KAAK6P,IAAIw6B,EAAO5P,IAAKyQ,EAAW,KAC1CngC,EAAE0vB,EAAK0Q,GACPD,EAAWzQ,GA4Cf,IAAI6Q,IAAmB,EAAOC,IAAoB,EAYlD,SAASC,GAAWC,EAAQpP,EAAMC,GAChC9nB,KAAKi3B,OAASA,EACdj3B,KAAK6nB,KAAOA,EAAM7nB,KAAK8nB,GAAKA,EAI9B,SAASoP,GAAiBC,EAAOF,GAC/B,GAAIE,EAAS,IAAK,IAAIt8B,EAAI,EAAGA,EAAIs8B,EAAMp8B,SAAUF,EAAG,CAClD,IAAIu8B,EAAOD,EAAMt8B,GACjB,GAAIu8B,EAAKH,QAAUA,EAAU,OAAOG,GAKxC,SAASC,GAAiBF,EAAOC,GAE/B,IADA,IAAIz6B,EACK9B,EAAI,EAAGA,EAAIs8B,EAAMp8B,SAAUF,EAC5Bs8B,EAAMt8B,IAAMu8B,IAASz6B,IAAMA,EAAI,KAAKwP,KAAKgrB,EAAMt8B,IACvD,OAAO8B,EA4CT,SAAS26B,GAAuBtiB,EAAKuiB,GACnC,GAAIA,EAAOC,KAAQ,OAAO,KAC1B,IAAIC,EAAW7G,GAAO5b,EAAKuiB,EAAO1P,KAAK+C,OAASgF,GAAQ5a,EAAKuiB,EAAO1P,KAAK+C,MAAM8M,YAC3EC,EAAU/G,GAAO5b,EAAKuiB,EAAOzP,GAAG8C,OAASgF,GAAQ5a,EAAKuiB,EAAOzP,GAAG8C,MAAM8M,YAC1E,IAAKD,IAAaE,EAAW,OAAO,KAEpC,IAAIC,EAAUL,EAAO1P,KAAKf,GAAI+Q,EAAQN,EAAOzP,GAAGhB,GAAIgR,EAA0C,GAA/B5G,GAAIqG,EAAO1P,KAAM0P,EAAOzP,IAEnF+H,EAxCN,SAA2BkI,EAAKH,EAASE,GACvC,IAAIE,EACJ,GAAID,EAAO,IAAK,IAAIl9B,EAAI,EAAGA,EAAIk9B,EAAIh9B,SAAUF,EAAG,CAC9C,IAAIu8B,EAAOW,EAAIl9B,GAAIo8B,EAASG,EAAKH,OAEjC,GADgC,MAAbG,EAAKvP,OAAiBoP,EAAOgB,cAAgBb,EAAKvP,MAAQ+P,EAAUR,EAAKvP,KAAO+P,IAC/ER,EAAKvP,MAAQ+P,GAA0B,YAAfX,EAAOzpB,QAAwBsqB,IAAaV,EAAKH,OAAOiB,YAAa,CAC/G,IAAIC,EAAuB,MAAXf,EAAKtP,KAAemP,EAAOmB,eAAiBhB,EAAKtP,IAAM8P,EAAUR,EAAKtP,GAAK8P,IACzFI,IAAOA,EAAK,KAAK7rB,KAAK,IAAI6qB,GAAWC,EAAQG,EAAKvP,KAAMsQ,EAAY,KAAOf,EAAKtP,MAGtF,OAAOkQ,EA8BKK,CAAkBZ,EAAUG,EAASE,GAC7CrG,EA7BN,SAA0BsG,EAAKF,EAAOC,GACpC,IAAIE,EACJ,GAAID,EAAO,IAAK,IAAIl9B,EAAI,EAAGA,EAAIk9B,EAAIh9B,SAAUF,EAAG,CAC9C,IAAIu8B,EAAOW,EAAIl9B,GAAIo8B,EAASG,EAAKH,OAEjC,GAD2B,MAAXG,EAAKtP,KAAemP,EAAOmB,eAAiBhB,EAAKtP,IAAM+P,EAAQT,EAAKtP,GAAK+P,IACxET,EAAKvP,MAAQgQ,GAAwB,YAAfZ,EAAOzpB,QAAwBsqB,GAAYV,EAAKH,OAAOiB,YAAa,CACzG,IAAII,EAA4B,MAAblB,EAAKvP,OAAiBoP,EAAOgB,cAAgBb,EAAKvP,MAAQgQ,EAAQT,EAAKvP,KAAOgQ,IAC/FG,IAAOA,EAAK,KAAK7rB,KAAK,IAAI6qB,GAAWC,EAAQqB,EAAe,KAAOlB,EAAKvP,KAAOgQ,EAChC,MAAXT,EAAKtP,GAAa,KAAOsP,EAAKtP,GAAK+P,KAG7E,OAAOG,EAkBIO,CAAiBZ,EAASE,EAAOC,GAGxCU,EAAiC,GAAtBjB,EAAO3lB,KAAK7W,OAAa0D,EAAS6nB,EAAIiR,EAAO3lB,MAAM7W,QAAUy9B,EAAWZ,EAAU,GACjG,GAAI/H,EAEF,IAAK,IAAIh1B,EAAI,EAAGA,EAAIg1B,EAAM90B,SAAUF,EAAG,CACrC,IAAIu8B,EAAOvH,EAAMh1B,GACjB,GAAe,MAAXu8B,EAAKtP,GAAY,CACnB,IAAIO,EAAQ6O,GAAiBzF,EAAM2F,EAAKH,QACnC5O,EACImQ,IAAYpB,EAAKtP,GAAiB,MAAZO,EAAMP,GAAa,KAAOO,EAAMP,GAAKrpB,GADtD24B,EAAKtP,GAAK8P,GAK9B,GAAInG,EAEF,IAAK,IAAItI,EAAM,EAAGA,EAAMsI,EAAK12B,SAAUouB,EAAK,CAC1C,IAAIsP,EAAShH,EAAKtI,GACD,MAAbsP,EAAO3Q,KAAc2Q,EAAO3Q,IAAMrpB,GACnB,MAAfg6B,EAAO5Q,KACKqP,GAAiBrH,EAAO4I,EAAOxB,UAE3CwB,EAAO5Q,KAAOppB,EACV+5B,IAAa3I,IAAUA,EAAQ,KAAK1jB,KAAKssB,KAG/CA,EAAO5Q,MAAQppB,EACX+5B,IAAa3I,IAAUA,EAAQ,KAAK1jB,KAAKssB,IAK/C5I,IAASA,EAAQ6I,GAAgB7I,IACjC4B,GAAQA,GAAQ5B,IAAS4B,EAAOiH,GAAgBjH,IAEpD,IAAIkH,EAAa,CAAC9I,GAClB,IAAK2I,EAAU,CAEb,IAAkCI,EAA9BC,EAAMtB,EAAO3lB,KAAK7W,OAAS,EAC/B,GAAI89B,EAAM,GAAKhJ,EACX,IAAK,IAAIxG,EAAM,EAAGA,EAAMwG,EAAM90B,SAAUsuB,EACjB,MAAjBwG,EAAMxG,GAAKvB,KACZ8Q,IAAeA,EAAa,KAAKzsB,KAAK,IAAI6qB,GAAWnH,EAAMxG,GAAK4N,OAAQ,KAAM,OACvF,IAAK,IAAI1N,EAAM,EAAGA,EAAMsP,IAAOtP,EAC3BoP,EAAWxsB,KAAKysB,GACpBD,EAAWxsB,KAAKslB,GAElB,OAAOkH,EAKT,SAASD,GAAgBvB,GACvB,IAAK,IAAIt8B,EAAI,EAAGA,EAAIs8B,EAAMp8B,SAAUF,EAAG,CACrC,IAAIu8B,EAAOD,EAAMt8B,GACA,MAAbu8B,EAAKvP,MAAgBuP,EAAKvP,MAAQuP,EAAKtP,KAAqC,IAA/BsP,EAAKH,OAAO6B,gBACzD3B,EAAM1qB,OAAO5R,IAAK,GAExB,OAAKs8B,EAAMp8B,OACJo8B,EADqB,KAkC9B,SAAS4B,GAAkBnO,GACzB,IAAIuM,EAAQvM,EAAK8M,YACjB,GAAKP,EAAL,CACA,IAAK,IAAIt8B,EAAI,EAAGA,EAAIs8B,EAAMp8B,SAAUF,EAChCs8B,EAAMt8B,GAAGo8B,OAAO+B,WAAWpO,GAC/BA,EAAK8M,YAAc,MAErB,SAASuB,GAAkBrO,EAAMuM,GAC/B,GAAKA,EAAL,CACA,IAAK,IAAIt8B,EAAI,EAAGA,EAAIs8B,EAAMp8B,SAAUF,EAChCs8B,EAAMt8B,GAAGo8B,OAAOiC,WAAWtO,GAC/BA,EAAK8M,YAAcP,GAKrB,SAASgC,GAAUlC,GAAU,OAAOA,EAAOgB,eAAiB,EAAI,EAChE,SAASmB,GAAWnC,GAAU,OAAOA,EAAOmB,eAAiB,EAAI,EAKjE,SAASiB,GAAwBvtC,EAAGuD,GAClC,IAAIiqC,EAAUxtC,EAAEkkC,MAAMj1B,OAAS1L,EAAE2gC,MAAMj1B,OACvC,GAAe,GAAXu+B,EAAgB,OAAOA,EAC3B,IAAIC,EAAOztC,EAAE0tC,OAAQC,EAAOpqC,EAAEmqC,OAC1BE,EAAUxI,GAAIqI,EAAK1R,KAAM4R,EAAK5R,OAASsR,GAAUrtC,GAAKqtC,GAAU9pC,GACpE,GAAIqqC,EAAW,OAAQA,EACvB,IAAIC,EAAQzI,GAAIqI,EAAKzR,GAAI2R,EAAK3R,KAAOsR,GAAWttC,GAAKstC,GAAW/pC,GAChE,OAAIsqC,GACGtqC,EAAE61B,GAAKp5B,EAAEo5B,GAKlB,SAAS0U,GAAoBhP,EAAMrH,GACjC,IAAiD8E,EAA7CwR,EAAM9C,IAAqBnM,EAAK8M,YACpC,GAAImC,EAAO,IAAK,IAAIC,OAAK,EAAUj/B,EAAI,EAAGA,EAAIg/B,EAAI9+B,SAAUF,GAC1Di/B,EAAKD,EAAIh/B,IACFo8B,OAAO8C,WAA0C,OAA5BxW,EAAQuW,EAAGjS,KAAOiS,EAAGhS,OAC3CO,GAASgR,GAAwBhR,EAAOyR,EAAG7C,QAAU,KACvD5O,EAAQyR,EAAG7C,QAEjB,OAAO5O,EAET,SAAS2R,GAAqBpP,GAAQ,OAAOgP,GAAoBhP,GAAM,GACvE,SAASqP,GAAmBrP,GAAQ,OAAOgP,GAAoBhP,GAAM,GAErE,SAASsP,GAAoBtP,EAAM9D,GACjC,IAAiDuB,EAA7CwR,EAAM9C,IAAqBnM,EAAK8M,YACpC,GAAImC,EAAO,IAAK,IAAIh/B,EAAI,EAAGA,EAAIg/B,EAAI9+B,SAAUF,EAAG,CAC9C,IAAIi/B,EAAKD,EAAIh/B,GACTi/B,EAAG7C,OAAO8C,YAAyB,MAAXD,EAAGjS,MAAgBiS,EAAGjS,KAAOf,KAAiB,MAATgT,EAAGhS,IAAcgS,EAAGhS,GAAKhB,MACpFuB,GAASgR,GAAwBhR,EAAOyR,EAAG7C,QAAU,KAAM5O,EAAQyR,EAAG7C,QAE9E,OAAO5O,EAMT,SAAS8R,GAA0BnlB,EAAKub,EAAQ1I,EAAMC,EAAImP,GACxD,IAAIrM,EAAOgF,GAAQ5a,EAAKub,GACpBsJ,EAAM9C,IAAqBnM,EAAK8M,YACpC,GAAImC,EAAO,IAAK,IAAIh/B,EAAI,EAAGA,EAAIg/B,EAAI9+B,SAAUF,EAAG,CAC9C,IAAIi/B,EAAKD,EAAIh/B,GACb,GAAKi/B,EAAG7C,OAAO8C,UAAf,CACA,IAAI1R,EAAQyR,EAAG7C,OAAOuC,KAAK,GACvBE,EAAUxI,GAAI7I,EAAMR,KAAMA,IAASsR,GAAUW,EAAG7C,QAAUkC,GAAUlC,GACpE0C,EAAQzI,GAAI7I,EAAMP,GAAIA,IAAOsR,GAAWU,EAAG7C,QAAUmC,GAAWnC,GACpE,KAAIyC,GAAW,GAAKC,GAAS,GAAKD,GAAW,GAAKC,GAAS,KACvDD,GAAW,IAAMI,EAAG7C,OAAOmB,gBAAkBnB,EAAOgB,cAAgB/G,GAAI7I,EAAMP,GAAID,IAAS,EAAIqJ,GAAI7I,EAAMP,GAAID,GAAQ,IACrH6R,GAAW,IAAMI,EAAG7C,OAAOmB,gBAAkBnB,EAAOgB,cAAgB/G,GAAI7I,EAAMR,KAAMC,IAAO,EAAIoJ,GAAI7I,EAAMR,KAAMC,GAAM,IACrH,OAAO,IAQf,SAASsS,GAAWxP,GAElB,IADA,IAAIyP,EACGA,EAASL,GAAqBpP,IACjCA,EAAOyP,EAAOb,MAAM,GAAG,GAAM5O,KACjC,OAAOA,EAuBT,SAAS0P,GAAatlB,EAAKulB,GACzB,IAAI3P,EAAOgF,GAAQ5a,EAAKulB,GAAQC,EAAMJ,GAAWxP,GACjD,OAAIA,GAAQ4P,EAAcD,EACnBhK,GAAOiK,GAKhB,SAASC,GAAgBzlB,EAAKulB,GAC5B,GAAIA,EAAQvlB,EAAI0lB,WAAc,OAAOH,EACrC,IAAgCF,EAA5BzP,EAAOgF,GAAQ5a,EAAKulB,GACxB,IAAKI,GAAa3lB,EAAK4V,GAAS,OAAO2P,EACvC,KAAOF,EAASJ,GAAmBrP,IAC/BA,EAAOyP,EAAOb,KAAK,GAAG,GAAM5O,KAChC,OAAO2F,GAAO3F,GAAQ,EAMxB,SAAS+P,GAAa3lB,EAAK4V,GACzB,IAAIiP,EAAM9C,IAAqBnM,EAAK8M,YACpC,GAAImC,EAAO,IAAK,IAAIC,OAAK,EAAUj/B,EAAI,EAAGA,EAAIg/B,EAAI9+B,SAAUF,EAE1D,IADAi/B,EAAKD,EAAIh/B,IACDo8B,OAAO8C,UAAf,CACA,GAAe,MAAXD,EAAGjS,KAAgB,OAAO,EAC9B,IAAIiS,EAAG7C,OAAO2D,YACC,GAAXd,EAAGjS,MAAaiS,EAAG7C,OAAOgB,eAAiB4C,GAAkB7lB,EAAK4V,EAAMkP,GACxE,OAAO,GAGf,SAASe,GAAkB7lB,EAAK4V,EAAMwM,GACpC,GAAe,MAAXA,EAAKtP,GAAY,CACnB,IAAItE,EAAM4T,EAAKH,OAAOuC,KAAK,GAAG,GAC9B,OAAOqB,GAAkB7lB,EAAKwO,EAAIoH,KAAMsM,GAAiB1T,EAAIoH,KAAK8M,YAAaN,EAAKH,SAEtF,GAAIG,EAAKH,OAAOmB,gBAAkBhB,EAAKtP,IAAM8C,EAAKhZ,KAAK7W,OACnD,OAAO,EACX,IAAK,IAAI++B,OAAK,EAAUj/B,EAAI,EAAGA,EAAI+vB,EAAK8M,YAAY38B,SAAUF,EAE5D,IADAi/B,EAAKlP,EAAK8M,YAAY78B,IACfo8B,OAAO8C,YAAcD,EAAG7C,OAAO2D,YAAcd,EAAGjS,MAAQuP,EAAKtP,KACtD,MAATgS,EAAGhS,IAAcgS,EAAGhS,IAAMsP,EAAKvP,QAC/BiS,EAAG7C,OAAOgB,eAAiBb,EAAKH,OAAOmB,iBACxCyC,GAAkB7lB,EAAK4V,EAAMkP,GAAO,OAAO,EAKnD,SAASgB,GAAaC,GAIpB,IADA,IAAIz7B,EAAI,EAAGywB,GAFXgL,EAAUX,GAAWW,IAEMx0B,OAClB1L,EAAI,EAAGA,EAAIk1B,EAAMC,MAAMj1B,SAAUF,EAAG,CAC3C,IAAI+vB,EAAOmF,EAAMC,MAAMn1B,GACvB,GAAI+vB,GAAQmQ,EAAW,MAChBz7B,GAAKsrB,EAAK5d,OAEnB,IAAK,IAAIpP,EAAImyB,EAAMxpB,OAAQ3I,EAAcA,GAAXmyB,EAAQnyB,GAAa2I,OACjD,IAAK,IAAI4iB,EAAM,EAAGA,EAAMvrB,EAAEqyB,SAASl1B,SAAUouB,EAAK,CAChD,IAAIb,EAAM1qB,EAAEqyB,SAAS9G,GACrB,GAAIb,GAAOyH,EAAS,MACbzwB,GAAKgpB,EAAItb,OAGpB,OAAO1N,EAMT,SAAS07B,GAAWpQ,GAClB,GAAmB,GAAfA,EAAK5d,OAAe,OAAO,EAE/B,IADA,IAA4BqtB,EAAxB5pC,EAAMm6B,EAAKhZ,KAAK7W,OAAgButB,EAAMsC,EACnCyP,EAASL,GAAqB1R,IAAM,CACzC,IAAID,EAAQgS,EAAOb,KAAK,GAAG,GAC3BlR,EAAMD,EAAMR,KAAK+C,KACjBn6B,GAAO43B,EAAMR,KAAKf,GAAKuB,EAAMP,GAAGhB,GAGlC,IADAwB,EAAMsC,EACCyP,EAASJ,GAAmB3R,IAAM,CACvC,IAAI2S,EAAUZ,EAAOb,KAAK,GAAG,GAC7B/oC,GAAO63B,EAAI1W,KAAK7W,OAASkgC,EAAQpT,KAAKf,GAEtCr2B,IADA63B,EAAM2S,EAAQnT,GAAG8C,MACNhZ,KAAK7W,OAASkgC,EAAQnT,GAAGhB,GAEtC,OAAOr2B,EAIT,SAASyqC,GAAY5P,GACnB,IAAIpvB,EAAIovB,EAAG1X,QAASoB,EAAMsW,EAAGtW,IAC7B9Y,EAAEi/B,QAAUvL,GAAQ5a,EAAKA,EAAI6a,OAC7B3zB,EAAEk/B,cAAgBJ,GAAW9+B,EAAEi/B,SAC/Bj/B,EAAEm/B,gBAAiB,EACnBrmB,EAAIob,MAAK,SAAUxF,GACjB,IAAIn6B,EAAMuqC,GAAWpQ,GACjBn6B,EAAMyL,EAAEk/B,gBACVl/B,EAAEk/B,cAAgB3qC,EAClByL,EAAEi/B,QAAUvQ,MASlB,IAAI0Q,GAAO,SAAS1pB,EAAM8lB,EAAa6D,GACrCv7B,KAAK4R,KAAOA,EACZqnB,GAAkBj5B,KAAM03B,GACxB13B,KAAKgN,OAASuuB,EAAiBA,EAAev7B,MAAQ,GAqBxD,SAASw7B,GAAY5Q,GACnBA,EAAKrkB,OAAS,KACdwyB,GAAkBnO,GApBpB0Q,GAAK57B,UAAU6wB,OAAS,WAAc,OAAOA,GAAOvwB,OACpDgsB,GAAWsP,IAyBX,IAAIG,GAAoB,GAAIC,GAA4B,GACxD,SAASC,GAAoBzyB,EAAOoF,GAClC,IAAKpF,GAAS,QAAQpG,KAAKoG,GAAU,OAAO,KAC5C,IAAI0yB,EAAQttB,EAAQsoB,aAAe8E,GAA4BD,GAC/D,OAAOG,EAAM1yB,KACV0yB,EAAM1yB,GAASA,EAAMmD,QAAQ,OAAQ,UAQ1C,SAASwvB,GAAiBvQ,EAAIwQ,GAI5B,IAAInZ,EAAUC,EAAK,OAAQ,KAAM,KAAM5B,EAAS,sBAAwB,MACpE+a,EAAU,CAACC,IAAKpZ,EAAK,MAAO,CAACD,GAAU,mBAAoBA,QAASA,EACzDuD,IAAK,EAAGD,IAAK,EAAGqF,GAAIA,EACpB2Q,eAAe,EACfC,YAAa5Q,EAAG6Q,UAAU,iBACzCL,EAAShP,QAAU,GAGnB,IAAK,IAAIjyB,EAAI,EAAGA,IAAMihC,EAASM,KAAON,EAASM,KAAKrhC,OAAS,GAAIF,IAAK,CACpE,IAAI+vB,EAAO/vB,EAAIihC,EAASM,KAAKvhC,EAAI,GAAKihC,EAASlR,KAAMzC,OAAQ,EAC7D4T,EAAQ9V,IAAM,EACd8V,EAAQM,SAAWC,GAGftP,GAAgB1B,EAAG1X,QAAQkZ,WAAa3E,EAAQwC,GAASC,EAAMU,EAAGtW,IAAI+T,cACtEgT,EAAQM,SAAWE,GAAkBR,EAAQM,SAAUlU,IAC3D4T,EAAQvtB,IAAM,GAEdguB,GAAkB5R,EAAMmR,EAASxH,GAAcjJ,EAAIV,EADzBkR,GAAYxQ,EAAG1X,QAAQ6oB,kBAAoBlM,GAAO3F,KAExEA,EAAKiK,eACHjK,EAAKiK,aAAaR,UAClB0H,EAAQ1H,QAAUjR,EAAYwH,EAAKiK,aAAaR,QAAS0H,EAAQ1H,SAAW,KAC5EzJ,EAAKiK,aAAaP,YAClByH,EAAQzH,UAAYlR,EAAYwH,EAAKiK,aAAaP,UAAWyH,EAAQzH,WAAa,MAI9D,GAAtByH,EAAQvtB,IAAIzT,QACZghC,EAAQvtB,IAAIrC,KAAK,EAAG,EAAG4vB,EAAQpZ,QAAQzU,YAAY2e,GAAiBvB,EAAG1X,QAAQkZ,WAG1E,GAALjyB,GACFihC,EAAShP,QAAQte,IAAMutB,EAAQvtB,IAC/BstB,EAAShP,QAAQ8O,MAAQ,MAE9BE,EAAShP,QAAQ4P,OAASZ,EAAShP,QAAQ4P,KAAO,KAAKvwB,KAAK4vB,EAAQvtB,MAC7DstB,EAAShP,QAAQ6P,SAAWb,EAAShP,QAAQ6P,OAAS,KAAKxwB,KAAK,KAKtE,GAAI6U,EAAQ,CACV,IAAIyQ,EAAOsK,EAAQpZ,QAAQia,WACvB,aAAa95B,KAAK2uB,EAAKvnB,YAAeunB,EAAKoL,eAAiBpL,EAAKoL,cAAc,cAC/Ed,EAAQpZ,QAAQzY,UAAY,oBAOlC,OAJAihB,GAAOG,EAAI,aAAcA,EAAIwQ,EAASlR,KAAMmR,EAAQC,KAChDD,EAAQC,IAAI9xB,YACZ6xB,EAAQzH,UAAYlR,EAAY2Y,EAAQC,IAAI9xB,UAAW6xB,EAAQzH,WAAa,KAEzEyH,EAGT,SAASe,GAA8BhW,GACrC,IAAImP,EAAQxT,EAAI,OAAQ,IAAU,kBAGlC,OAFAwT,EAAM8G,MAAQ,MAAQjW,EAAGS,WAAW,GAAGnoB,SAAS,IAChD62B,EAAMjoB,aAAa,aAAcioB,EAAM8G,OAChC9G,EAKT,SAASqG,GAAWP,EAASnqB,EAAM1I,EAAO8zB,EAAYC,EAAUpoB,EAAKqoB,GACnE,GAAKtrB,EAAL,CACA,IAEI+Q,EAFAwa,EAAcpB,EAAQG,YAiE5B,SAAqBtqB,EAAMwrB,GACzB,GAAIxrB,EAAK7W,OAAS,IAAM,KAAK+H,KAAK8O,GAAS,OAAOA,EAElD,IADA,IAAIyrB,EAAcD,EAAgBt5B,EAAS,GAClCjJ,EAAI,EAAGA,EAAI+W,EAAK7W,OAAQF,IAAK,CACpC,IAAIisB,EAAKlV,EAAK8V,OAAO7sB,GACX,KAANisB,IAAauW,GAAgBxiC,GAAK+W,EAAK7W,OAAS,GAA+B,IAA1B6W,EAAK2V,WAAW1sB,EAAI,KACzEisB,EAAK,KACThjB,GAAUgjB,EACVuW,EAAoB,KAANvW,EAEhB,OAAOhjB,EA3EiCo4B,CAAYtqB,EAAMmqB,EAAQE,eAAiBrqB,EAC/E0rB,EAAUvB,EAAQzQ,GAAG4D,MAAMqO,aAAcC,GAAW,EAExD,GAAKF,EAAQx6B,KAAK8O,GAMX,CACL+Q,EAAU7a,SAAS21B,yBAEnB,IADA,IAAIxX,EAAM,IACG,CACXqX,EAAQI,UAAYzX,EACpB,IAAInpB,EAAIwgC,EAAQ3c,KAAK/O,GACjBuU,EAAUrpB,EAAIA,EAAE0P,MAAQyZ,EAAMrU,EAAK7W,OAASkrB,EAChD,GAAIE,EAAS,CACX,IAAI8G,EAAMnlB,SAAS8R,eAAeujB,EAAYv9B,MAAMqmB,EAAKA,EAAME,IAC3DtF,GAAMC,EAAa,EAAK6B,EAAQzU,YAAYuU,EAAI,OAAQ,CAACwK,KACtDtK,EAAQzU,YAAY+e,GAC3B8O,EAAQvtB,IAAIrC,KAAK4vB,EAAQ9V,IAAK8V,EAAQ9V,IAAME,EAAS8G,GACrD8O,EAAQ7V,KAAOC,EACf4V,EAAQ9V,KAAOE,EAEjB,IAAKrpB,EAAK,MACVmpB,GAAOE,EAAU,EACjB,IAAIwX,OAAQ,EACZ,GAAY,MAAR7gC,EAAE,GAAY,CAChB,IAAI0nB,EAAUuX,EAAQzQ,GAAGhd,QAAQkW,QAASoZ,EAAWpZ,EAAUuX,EAAQ7V,IAAM1B,GAC7EmZ,EAAQhb,EAAQzU,YAAYuU,EAAI,OAAQ4D,EAASuX,GAAW,YACtD5vB,aAAa,OAAQ,gBAC3B2vB,EAAM3vB,aAAa,UAAW,MAC9B+tB,EAAQ7V,KAAO0X,MACE,MAAR9gC,EAAE,IAAsB,MAARA,EAAE,KAC3B6gC,EAAQhb,EAAQzU,YAAYuU,EAAI,OAAgB,MAAR3lB,EAAE,GAAa,IAAW,IAAU,oBACtEkR,aAAa,UAAWlR,EAAE,IAChCi/B,EAAQ7V,KAAO,KAEfyX,EAAQ5B,EAAQzQ,GAAGhd,QAAQuvB,uBAAuB/gC,EAAE,KAC9CkR,aAAa,UAAWlR,EAAE,IAC5B+jB,GAAMC,EAAa,EAAK6B,EAAQzU,YAAYuU,EAAI,OAAQ,CAACkb,KACtDhb,EAAQzU,YAAYyvB,GAC3B5B,EAAQ7V,KAAO,GAEjB6V,EAAQvtB,IAAIrC,KAAK4vB,EAAQ9V,IAAK8V,EAAQ9V,IAAM,EAAG0X,GAC/C5B,EAAQ9V,YAzCV8V,EAAQ7V,KAAOtU,EAAK7W,OACpB4nB,EAAU7a,SAAS8R,eAAeujB,GAClCpB,EAAQvtB,IAAIrC,KAAK4vB,EAAQ9V,IAAK8V,EAAQ9V,IAAMrU,EAAK7W,OAAQ4nB,GACrD9B,GAAMC,EAAa,IAAK0c,GAAW,GACvCzB,EAAQ9V,KAAOrU,EAAK7W,OAyCtB,GADAghC,EAAQE,cAA2D,IAA3CkB,EAAY5V,WAAW3V,EAAK7W,OAAS,GACzDmO,GAAS8zB,GAAcC,GAAYO,GAAY3oB,EAAK,CACtD,IAAIipB,EAAY50B,GAAS,GACrB8zB,IAAcc,GAAad,GAC3BC,IAAYa,GAAab,GAC7B,IAAIhH,EAAQxT,EAAI,OAAQ,CAACE,GAAUmb,EAAWjpB,GAC9C,GAAIqoB,EACF,IAAK,IAAIa,KAAQb,EAAkBA,EAAW7Y,eAAe0Z,IAAiB,SAARA,GAA2B,SAARA,GACrF9H,EAAMjoB,aAAa+vB,EAAMb,EAAWa,IAE1C,OAAOhC,EAAQpZ,QAAQzU,YAAY+nB,GAErC8F,EAAQpZ,QAAQzU,YAAYyU,IAoB9B,SAAS4Z,GAAkBxJ,EAAO5K,GAChC,OAAO,SAAU4T,EAASnqB,EAAM1I,EAAO8zB,EAAYC,EAAUpoB,EAAKqoB,GAChEh0B,EAAQA,EAAQA,EAAQ,mBAAqB,kBAE7C,IADA,IAAIqa,EAAQwY,EAAQ9V,IAAKzC,EAAMD,EAAQ3R,EAAK7W,SACnC,CAGP,IADA,IAAIijC,OAAO,EACFnjC,EAAI,EAAGA,EAAIstB,EAAMptB,WACxBijC,EAAO7V,EAAMttB,IACJitB,GAAKvE,GAASya,EAAKnW,MAAQtE,GAFJ1oB,KAIlC,GAAImjC,EAAKlW,IAAMtE,EAAO,OAAOuP,EAAMgJ,EAASnqB,EAAM1I,EAAO8zB,EAAYC,EAAUpoB,EAAKqoB,GACpFnK,EAAMgJ,EAASnqB,EAAKhS,MAAM,EAAGo+B,EAAKlW,GAAKvE,GAAQra,EAAO8zB,EAAY,KAAMnoB,EAAKqoB,GAC7EF,EAAa,KACbprB,EAAOA,EAAKhS,MAAMo+B,EAAKlW,GAAKvE,GAC5BA,EAAQya,EAAKlW,KAKnB,SAASmW,GAAmBlC,EAASjM,EAAMmH,EAAQiH,GACjD,IAAIC,GAAUD,GAAgBjH,EAAO2D,WACjCuD,GAAUpC,EAAQvtB,IAAIrC,KAAK4vB,EAAQ9V,IAAK8V,EAAQ9V,IAAM6J,EAAMqO,IAC3DD,GAAgBnC,EAAQzQ,GAAG1X,QAAQwqB,MAAMC,wBACvCF,IACDA,EAASpC,EAAQpZ,QAAQzU,YAAYpG,SAASC,cAAc,UAChEo2B,EAAOnwB,aAAa,YAAaipB,EAAO/R,KAEtCiZ,IACFpC,EAAQzQ,GAAG1X,QAAQwqB,MAAME,cAAcH,GACvCpC,EAAQpZ,QAAQzU,YAAYiwB,IAE9BpC,EAAQ9V,KAAO6J,EACfiM,EAAQE,eAAgB,EAK1B,SAASO,GAAkB5R,EAAMmR,EAAS3H,GACxC,IAAI+C,EAAQvM,EAAK8M,YAAa6G,EAAU3T,EAAKhZ,KAAMyY,EAAK,EACxD,GAAK8M,EAQL,IAFA,IAAqDjuB,EAAO2L,EACxC2pB,EAAWC,EAAcC,EAAgB3E,EAAWmD,EADpEzsC,EAAM8tC,EAAQxjC,OAAQkrB,EAAM,EAAGprB,EAAI,EAAG+W,EAAO,GAC7C+sB,EAAa,IACR,CACP,GAAIA,GAAc1Y,EAAK,CACrBuY,EAAYC,EAAeC,EAAiB7pB,EAAM,GAClDqoB,EAAa,KACbnD,EAAY,KAAM4E,EAAaloC,IAE/B,IADA,IAAImoC,EAAiB,GAAIC,OAAY,EAC5BjV,EAAI,EAAGA,EAAIuN,EAAMp8B,SAAU6uB,EAAG,CACrC,IAAIkQ,EAAK3C,EAAMvN,GAAI9sB,EAAIg9B,EAAG7C,OAC1B,GAAc,YAAVn6B,EAAE0Q,MAAsBssB,EAAGjS,MAAQ5B,GAAOnpB,EAAE89B,WAC9CgE,EAAezyB,KAAKrP,QACf,GAAIg9B,EAAGjS,MAAQ5B,IAAiB,MAAT6T,EAAGhS,IAAcgS,EAAGhS,GAAK7B,GAAOnpB,EAAEi9B,WAAaD,EAAGhS,IAAM7B,GAAO6T,EAAGjS,MAAQ5B,GAAM,CAY5G,GAXa,MAAT6T,EAAGhS,IAAcgS,EAAGhS,IAAM7B,GAAO0Y,EAAa7E,EAAGhS,KACnD6W,EAAa7E,EAAGhS,GAChB2W,EAAe,IAEb3hC,EAAEoN,YAAas0B,GAAa,IAAM1hC,EAAEoN,WACpCpN,EAAE+X,MAAOA,GAAOA,EAAMA,EAAM,IAAM,IAAM/X,EAAE+X,KAC1C/X,EAAEkgC,YAAclD,EAAGjS,MAAQ5B,IAAOyY,GAAkB,IAAM5hC,EAAEkgC,YAC5DlgC,EAAEmgC,UAAYnD,EAAGhS,IAAM6W,IAAeE,IAAcA,EAAY,KAAK1yB,KAAKrP,EAAEmgC,SAAUnD,EAAGhS,IAGzFhrB,EAAEigC,SAAUG,IAAeA,EAAa,KAAKH,MAAQjgC,EAAEigC,OACvDjgC,EAAEogC,WACJ,IAAK,IAAIa,KAAQjhC,EAAEogC,YACdA,IAAeA,EAAa,KAAKa,GAAQjhC,EAAEogC,WAAWa,GAEzDjhC,EAAEi9B,aAAeA,GAAaV,GAAwBU,EAAU9C,OAAQn6B,GAAK,KAC7Ei9B,EAAYD,QACPA,EAAGjS,KAAO5B,GAAO0Y,EAAa7E,EAAGjS,OAC1C8W,EAAa7E,EAAGjS,MAGpB,GAAIgX,EAAa,IAAK,IAAI1U,EAAM,EAAGA,EAAM0U,EAAU9jC,OAAQovB,GAAO,EAC1D0U,EAAU1U,EAAM,IAAMwU,IAAcF,GAAgB,IAAMI,EAAU1U,IAE5E,IAAK4P,GAAaA,EAAUlS,MAAQ5B,EAAO,IAAK,IAAIsE,EAAM,EAAGA,EAAMqU,EAAe7jC,SAAUwvB,EACxF0T,GAAmBlC,EAAS,EAAG6C,EAAerU,IAClD,GAAIwP,IAAcA,EAAUlS,MAAQ,IAAM5B,EAAK,CAG7C,GAFAgY,GAAmBlC,GAA0B,MAAhBhC,EAAUjS,GAAar3B,EAAM,EAAIspC,EAAUjS,IAAM7B,EAC3D8T,EAAU9C,OAA0B,MAAlB8C,EAAUlS,MAC3B,MAAhBkS,EAAUjS,GAAc,OACxBiS,EAAUjS,IAAM7B,IAAO8T,GAAY,IAG3C,GAAI9T,GAAOx1B,EAAO,MAGlB,IADA,IAAIquC,EAAOtzC,KAAK6P,IAAI5K,EAAKkuC,KACZ,CACX,GAAI/sB,EAAM,CACR,IAAI4R,EAAMyC,EAAMrU,EAAK7W,OACrB,IAAKg/B,EAAW,CACd,IAAIgF,EAAYvb,EAAMsb,EAAOltB,EAAKhS,MAAM,EAAGk/B,EAAO7Y,GAAOrU,EACzDmqB,EAAQM,SAASN,EAASgD,EAAW71B,EAAQA,EAAQs1B,EAAYA,EAChDE,EAAgBzY,EAAM8Y,EAAUhkC,QAAU4jC,EAAaF,EAAe,GAAI5pB,EAAKqoB,GAElG,GAAI1Z,GAAOsb,EAAM,CAACltB,EAAOA,EAAKhS,MAAMk/B,EAAO7Y,GAAMA,EAAM6Y,EAAM,MAC7D7Y,EAAMzC,EACNkb,EAAiB,GAEnB9sB,EAAO2sB,EAAQ3+B,MAAMyqB,EAAIA,EAAK+J,EAAOv5B,MACrCqO,EAAQyyB,GAAoBvH,EAAOv5B,KAAMkhC,EAAQzQ,GAAGhd,eAnEtD,IAAK,IAAI6a,EAAM,EAAGA,EAAMiL,EAAOr5B,OAAQouB,GAAK,EACxC4S,EAAQM,SAASN,EAASwC,EAAQ3+B,MAAMyqB,EAAIA,EAAK+J,EAAOjL,IAAOwS,GAAoBvH,EAAOjL,EAAI,GAAI4S,EAAQzQ,GAAGhd,UA2ErH,SAAS0wB,GAAShqB,EAAK4V,EAAM2P,GAE3Bv6B,KAAK4qB,KAAOA,EAEZ5qB,KAAKo8B,KAjbP,SAA6BxR,GAE3B,IADA,IAAIyP,EAAQrK,EACLqK,EAASJ,GAAmBrP,IACjCA,EAAOyP,EAAOb,KAAK,GAAG,GAAM5O,MAC1BoF,IAAUA,EAAQ,KAAK7jB,KAAKye,GAEhC,OAAOoF,EA2aKiP,CAAoBrU,GAEhC5qB,KAAK8vB,KAAO9vB,KAAKo8B,KAAO7L,GAAOjK,EAAItmB,KAAKo8B,OAAS7B,EAAQ,EAAI,EAC7Dv6B,KAAK6f,KAAO7f,KAAK4R,KAAO,KACxB5R,KAAKk/B,OAASvE,GAAa3lB,EAAK4V,GAIlC,SAASuU,GAAe7T,EAAIzD,EAAMC,GAEhC,IADA,IAAgBsX,EAAZ9Z,EAAQ,GACHW,EAAM4B,EAAM5B,EAAM6B,EAAI7B,EAAMmZ,EAAS,CAC5C,IAAIC,EAAO,IAAIL,GAAS1T,EAAGtW,IAAK4a,GAAQtE,EAAGtW,IAAKiR,GAAMA,GACtDmZ,EAAUnZ,EAAMoZ,EAAKvP,KACrBxK,EAAMnZ,KAAKkzB,GAEb,OAAO/Z,EAGT,IAAIga,GAAiB,KAwCjBC,GAAyB,KAS7B,SAASC,GAAYzU,EAASvd,GAC5B,IAAI+Y,EAAM0E,GAAYF,EAASvd,GAC/B,GAAK+Y,EAAIxrB,OAAT,CACA,IAAqD0kC,EAAjD5+B,EAAOvV,MAAMoU,UAAUE,MAAMM,KAAKpF,UAAW,GAC7CwkC,GACFG,EAAOH,GAAeI,iBACbH,GACTE,EAAOF,IAEPE,EAAOF,GAAyB,GAChCn+B,WAAWu+B,GAAmB,IAMhC,IAJA,IAAI5L,EAAO,SAAWl5B,GACpB4kC,EAAKtzB,MAAK,WAAc,OAAOoa,EAAI1rB,GAAGiG,MAAM,KAAMD,OAG3ChG,EAAI,EAAGA,EAAI0rB,EAAIxrB,SAAUF,EAChCk5B,EAAMl5B,IAGV,SAAS8kC,KACP,IAAIj+B,EAAU69B,GACdA,GAAyB,KACzB,IAAK,IAAI1kC,EAAI,EAAGA,EAAI6G,EAAQ3G,SAAUF,EAAK6G,EAAQ7G,KAMrD,SAAS+kC,GAAqBtU,EAAIwQ,EAAUvB,EAAOsF,GACjD,IAAK,IAAIjW,EAAI,EAAGA,EAAIkS,EAASgE,QAAQ/kC,OAAQ6uB,IAAK,CAChD,IAAIpc,EAAOsuB,EAASgE,QAAQlW,GAChB,QAARpc,EAAkBuyB,GAAezU,EAAIwQ,GACxB,UAARtuB,EAAoBwyB,GAAiB1U,EAAIwQ,EAAUvB,EAAOsF,GAClD,SAARryB,EAAmByyB,GAAkB3U,EAAIwQ,GACjC,UAARtuB,GAAoB0yB,GAAkB5U,EAAIwQ,EAAU+D,GAE/D/D,EAASgE,QAAU,KAKrB,SAASK,GAAkBrE,GAQzB,OAPIA,EAASjc,MAAQic,EAASlqB,OAC5BkqB,EAASjc,KAAO4C,EAAI,MAAO,KAAM,KAAM,sBACnCqZ,EAASlqB,KAAKoR,YACd8Y,EAASlqB,KAAKoR,WAAWod,aAAatE,EAASjc,KAAMic,EAASlqB,MAClEkqB,EAASjc,KAAK3R,YAAY4tB,EAASlqB,MAC/BiP,GAAMC,EAAa,IAAKgb,EAASjc,KAAK3W,MAAMuK,OAAS,IAEpDqoB,EAASjc,KAkBlB,SAASwgB,GAAe/U,EAAIwQ,GAC1B,IAAIwE,EAAMhV,EAAG1X,QAAQ6oB,iBACrB,OAAI6D,GAAOA,EAAI1V,MAAQkR,EAASlR,MAC9BU,EAAG1X,QAAQ6oB,iBAAmB,KAC9BX,EAAShP,QAAUwT,EAAIxT,QAChBwT,EAAIC,OAEN1E,GAAiBvQ,EAAIwQ,GAM9B,SAASiE,GAAezU,EAAIwQ,GAC1B,IAAI5Z,EAAM4Z,EAASlqB,KAAK1H,UACpBq2B,EAAQF,GAAe/U,EAAIwQ,GAC3BA,EAASlqB,MAAQkqB,EAASjc,OAAQic,EAASjc,KAAO0gB,EAAMvE,KAC5DF,EAASlqB,KAAKoR,WAAWod,aAAaG,EAAMvE,IAAKF,EAASlqB,MAC1DkqB,EAASlqB,KAAO2uB,EAAMvE,IAClBuE,EAAMlM,SAAWyH,EAASzH,SAAWkM,EAAMjM,WAAawH,EAASxH,WACnEwH,EAASzH,QAAUkM,EAAMlM,QACzByH,EAASxH,UAAYiM,EAAMjM,UAC3B2L,GAAkB3U,EAAIwQ,IACb5Z,IACT4Z,EAASlqB,KAAK1H,UAAYgY,GAI9B,SAAS+d,GAAkB3U,EAAIwQ,IA3C/B,SAA8BxQ,EAAIwQ,GAChC,IAAI5Z,EAAM4Z,EAASzH,QAAUyH,EAASzH,QAAU,KAAOyH,EAASlR,KAAKyJ,SAAW,IAAMyH,EAASlR,KAAKyJ,QAEpG,GADInS,IAAOA,GAAO,8BACd4Z,EAAShoB,WACPoO,EAAO4Z,EAAShoB,WAAW5J,UAAYgY,GACpC4Z,EAAShoB,WAAWkP,WAAW9D,YAAY4c,EAAShoB,YAAagoB,EAAShoB,WAAa,WACzF,GAAIoO,EAAK,CACd,IAAIse,EAAOL,GAAkBrE,GAC7BA,EAAShoB,WAAa0sB,EAAKhnB,aAAaiJ,EAAI,MAAO,KAAMP,GAAMse,EAAKnjB,YACpEiO,EAAG1X,QAAQwqB,MAAME,cAAcxC,EAAShoB,aAmC1C2sB,CAAqBnV,EAAIwQ,GACrBA,EAASlR,KAAK8V,UACdP,GAAkBrE,GAAU5xB,UAAY4xB,EAASlR,KAAK8V,UACjD5E,EAASjc,MAAQic,EAASlqB,OAC/BkqB,EAASjc,KAAK3V,UAAY,IAC9B,IAAIoqB,EAAYwH,EAASxH,UAAYwH,EAASxH,UAAY,KAAOwH,EAASlR,KAAK0J,WAAa,IAAMwH,EAASlR,KAAK0J,UAChHwH,EAASlqB,KAAK1H,UAAYoqB,GAAa,GAGzC,SAAS0L,GAAiB1U,EAAIwQ,EAAUvB,EAAOsF,GAS7C,GARI/D,EAAS6E,SACX7E,EAASjc,KAAKX,YAAY4c,EAAS6E,QACnC7E,EAAS6E,OAAS,MAEhB7E,EAAS8E,mBACX9E,EAASjc,KAAKX,YAAY4c,EAAS8E,kBACnC9E,EAAS8E,iBAAmB,MAE1B9E,EAASlR,KAAKiW,YAAa,CAC7B,IAAIL,EAAOL,GAAkBrE,GAC7BA,EAAS8E,iBAAmBne,EAAI,MAAO,KAAM,gCAAkCqZ,EAASlR,KAAKiW,YAC5D,UAAYvV,EAAGhd,QAAQwyB,YAAcjB,EAAKkB,UAAYlB,EAAKmB,kBAAoB,cAAiBnB,EAAqB,iBAAI,MAC1JvU,EAAG1X,QAAQwqB,MAAME,cAAcxC,EAAS8E,kBACxCJ,EAAKhnB,aAAasiB,EAAS8E,iBAAkB9E,EAASlqB,MAExD,IAAIqvB,EAAUnF,EAASlR,KAAKsW,cAC5B,GAAI5V,EAAGhd,QAAQ6yB,aAAeF,EAAS,CACrC,IAAIG,EAASjB,GAAkBrE,GAC3BuF,EAAavF,EAAS6E,OAASle,EAAI,MAAO,KAAM,4BAA8B,UAAY6I,EAAGhd,QAAQwyB,YAAcjB,EAAKkB,UAAYlB,EAAKmB,kBAAoB,MAUjK,GATA1V,EAAG1X,QAAQwqB,MAAME,cAAc+C,GAC/BD,EAAO5nB,aAAa6nB,EAAYvF,EAASlqB,MACrCkqB,EAASlR,KAAKiW,cACdQ,EAAWn3B,WAAa,IAAM4xB,EAASlR,KAAKiW,cAC5CvV,EAAGhd,QAAQ6yB,aAAiBF,GAAYA,EAAQ,4BAChDnF,EAASwF,WAAaD,EAAWnzB,YACjCuU,EAAI,MAAOoO,GAAcvF,EAAGhd,QAASisB,GACjC,8CACC,SAAYsF,EAAK0B,WAAW,0BAA6B,cAAiBjW,EAAG1X,QAAyB,kBAAI,QAC/GqtB,EAAW,IAAK,IAAIx4B,EAAI,EAAGA,EAAI6iB,EAAG1X,QAAQ4tB,YAAYzmC,SAAU0N,EAAG,CACrE,IAAIyc,EAAKoG,EAAG1X,QAAQ4tB,YAAY/4B,GAAGyB,UAAWme,EAAQ4Y,EAAQ5c,eAAea,IAAO+b,EAAQ/b,GACxFmD,GACAgZ,EAAWnzB,YAAYuU,EAAI,MAAO,CAAC4F,GAAQ,wBACjB,SAAYwX,EAAK0B,WAAWrc,GAAO,cAAiB2a,EAAK4B,YAAYvc,GAAO,SAKhH,SAASgb,GAAkB5U,EAAIwQ,EAAU+D,GACnC/D,EAAS4F,YAAa5F,EAAS4F,UAAY,MAE/C,IADA,IAAIC,EAAW1f,EAAU,yBAChBpC,EAAOic,EAASjc,KAAKxC,WAAY2U,OAAO,EAAUnS,EAAMA,EAAOmS,EACtEA,EAAOnS,EAAKlE,YACRgmB,EAAS7+B,KAAK+c,EAAK3V,YAAc4xB,EAASjc,KAAKX,YAAYW,GAEjE+hB,GAAkBtW,EAAIwQ,EAAU+D,GAIlC,SAASgC,GAAiBvW,EAAIwQ,EAAUvB,EAAOsF,GAC7C,IAAIU,EAAQF,GAAe/U,EAAIwQ,GAQ/B,OAPAA,EAASlqB,KAAOkqB,EAASjc,KAAO0gB,EAAMvE,IAClCuE,EAAMlM,UAAWyH,EAASzH,QAAUkM,EAAMlM,SAC1CkM,EAAMjM,YAAawH,EAASxH,UAAYiM,EAAMjM,WAElD2L,GAAkB3U,EAAIwQ,GACtBkE,GAAiB1U,EAAIwQ,EAAUvB,EAAOsF,GACtC+B,GAAkBtW,EAAIwQ,EAAU+D,GACzB/D,EAASjc,KAKlB,SAAS+hB,GAAkBtW,EAAIwQ,EAAU+D,GAEvC,GADAiC,GAAqBxW,EAAIwQ,EAASlR,KAAMkR,EAAU+D,GAAM,GACpD/D,EAASM,KAAQ,IAAK,IAAIvhC,EAAI,EAAGA,EAAIihC,EAASM,KAAKrhC,OAAQF,IAC3DinC,GAAqBxW,EAAIwQ,EAASM,KAAKvhC,GAAIihC,EAAU+D,GAAM,GAGjE,SAASiC,GAAqBxW,EAAIV,EAAMkR,EAAU+D,EAAMkC,GACtD,GAAKnX,EAAKoX,QAEV,IADA,IAAIxB,EAAOL,GAAkBrE,GACpBjhC,EAAI,EAAGonC,EAAKrX,EAAKoX,QAASnnC,EAAIonC,EAAGlnC,SAAUF,EAAG,CACrD,IAAIsjC,EAAS8D,EAAGpnC,GAAIglB,EAAO4C,EAAI,MAAO,CAAC0b,EAAOte,MAAO,yBAA2Bse,EAAOj0B,UAAY,IAAMi0B,EAAOj0B,UAAY,KACvHi0B,EAAO+D,mBAAqBriB,EAAK7R,aAAa,mBAAoB,QACvEm0B,GAAmBhE,EAAQte,EAAMic,EAAU+D,GAC3CvU,EAAG1X,QAAQwqB,MAAME,cAAcze,GAC3BkiB,GAAc5D,EAAOiE,MACrB5B,EAAKhnB,aAAaqG,EAAMic,EAAS6E,QAAU7E,EAASlqB,MAEpD4uB,EAAKtyB,YAAY2R,GACrB2f,GAAYrB,EAAQ,WAIxB,SAASgE,GAAmBhE,EAAQte,EAAMic,EAAU+D,GAClD,GAAI1B,EAAOkE,UAAW,EACvBvG,EAAS4F,YAAc5F,EAAS4F,UAAY,KAAKv1B,KAAK0T,GACnD,IAAI/S,EAAQ+yB,EAAKyC,aACjBziB,EAAK3W,MAAMvT,KAAOkqC,EAAKkB,SAAW,KAC7B5C,EAAOoE,cACVz1B,GAAS+yB,EAAKmB,iBACdnhB,EAAK3W,MAAMs5B,YAAc3C,EAAKmB,iBAAmB,MAEnDnhB,EAAK3W,MAAM4D,MAAQA,EAAQ,KAEzBqxB,EAAOoE,cACT1iB,EAAK3W,MAAMuK,OAAS,EACpBoM,EAAK3W,MAAMU,SAAW,WACjBu0B,EAAOkE,YAAaxiB,EAAK3W,MAAMsL,YAAcqrB,EAAKmB,iBAAmB,OAI9E,SAASyB,GAAatE,GACpB,GAAqB,MAAjBA,EAAOnxB,OAAkB,OAAOmxB,EAAOnxB,OAC3C,IAAIse,EAAK6S,EAAOnpB,IAAIsW,GACpB,IAAKA,EAAM,OAAO,EAClB,IAAKzI,EAAS/a,SAASoO,KAAMioB,EAAOte,MAAO,CACzC,IAAI6iB,EAAc,sBACdvE,EAAOoE,cACPG,GAAe,iBAAmBpX,EAAG1X,QAAQ+uB,QAAQ5V,YAAc,OACnEoR,EAAOkE,YACPK,GAAe,UAAYpX,EAAG1X,QAAQgvB,QAAQC,YAAc,OAChErgB,EAAqB8I,EAAG1X,QAAQkZ,QAASrK,EAAI,MAAO,CAAC0b,EAAOte,MAAO,KAAM6iB,IAE3E,OAAOvE,EAAOnxB,OAASmxB,EAAOte,KAAKmD,WAAWlD,aAIhD,SAASgjB,GAAclvB,EAASlL,GAC9B,IAAK,IAAIkc,EAAI2H,GAAS7jB,GAAIkc,GAAKhR,EAAQgvB,QAAShe,EAAIA,EAAE5B,WACpD,IAAK4B,GAAoB,GAAdA,EAAE7B,UAAuD,QAAtC6B,EAAEme,aAAa,qBACxCne,EAAE5B,YAAcpP,EAAQovB,OAASpe,GAAKhR,EAAQqvB,MAC/C,OAAO,EAMf,SAASC,GAAWtvB,GAAU,OAAOA,EAAQuvB,UAAU91B,UACvD,SAAS+1B,GAAYxvB,GAAU,OAAOA,EAAQqvB,MAAMnjB,aAAelM,EAAQuvB,UAAUrjB,aACrF,SAASujB,GAASzvB,GAChB,GAAIA,EAAQ0vB,eAAkB,OAAO1vB,EAAQ0vB,eAC7C,IAAI56B,EAAI8Z,EAAqB5O,EAAQkZ,QAASrK,EAAI,MAAO,IAAK,yBAC1DvZ,EAAQwB,OAAOmC,iBAAmBnC,OAAOmC,iBAAiBnE,GAAKA,EAAE66B,aACjEC,EAAO,CAAC7tC,KAAMsN,SAASiG,EAAMs5B,aAAc5sC,MAAOqN,SAASiG,EAAMu6B,eAErE,OADK1hC,MAAMyhC,EAAK7tC,OAAUoM,MAAMyhC,EAAK5tC,SAAUge,EAAQ0vB,eAAiBE,GACjEA,EAGT,SAASE,GAAUpY,GAAM,OAtjEP,GAsjE4BA,EAAG1X,QAAQ+vB,eACzD,SAASC,GAAatY,GACpB,OAAOA,EAAG1X,QAAQiwB,SAAShB,YAAca,GAAUpY,GAAMA,EAAG1X,QAAQkwB,SAEtE,SAASC,GAAczY,GACrB,OAAOA,EAAG1X,QAAQiwB,SAASG,aAAeN,GAAUpY,GAAMA,EAAG1X,QAAQqwB,UA4BvE,SAASC,GAAgBpI,EAAUlR,EAAM2P,GACvC,GAAIuB,EAASlR,MAAQA,EACjB,MAAO,CAACpc,IAAKstB,EAAShP,QAAQte,IAAKotB,MAAOE,EAAShP,QAAQ8O,OAC/D,IAAK,IAAI/gC,EAAI,EAAGA,EAAIihC,EAASM,KAAKrhC,OAAQF,IACtC,GAAIihC,EAASM,KAAKvhC,IAAM+vB,EACtB,MAAO,CAACpc,IAAKstB,EAAShP,QAAQ4P,KAAK7hC,GAAI+gC,MAAOE,EAAShP,QAAQ6P,OAAO9hC,IAC5E,IAAK,IAAIsuB,EAAM,EAAGA,EAAM2S,EAASM,KAAKrhC,OAAQouB,IAC1C,GAAIoH,GAAOuL,EAASM,KAAKjT,IAAQoR,EAC/B,MAAO,CAAC/rB,IAAKstB,EAAShP,QAAQ4P,KAAKvT,GAAMyS,MAAOE,EAAShP,QAAQ6P,OAAOxT,GAAM9N,QAAQ,GAkB9F,SAAS8oB,GAAY7Y,EAAIV,EAAM9D,EAAIsd,GACjC,OAAOC,GAAoB/Y,EAAIgZ,GAAsBhZ,EAAIV,GAAO9D,EAAIsd,GAItE,SAASG,GAAgBjZ,EAAIiP,GAC3B,GAAIA,GAASjP,EAAG1X,QAAQ6hB,UAAY8E,EAAQjP,EAAG1X,QAAQ8hB,OACnD,OAAOpK,EAAG1X,QAAQyrB,KAAKmF,GAAclZ,EAAIiP,IAC7C,IAAI+F,EAAMhV,EAAG1X,QAAQ6oB,iBACrB,OAAI6D,GAAO/F,GAAS+F,EAAI/F,OAASA,EAAQ+F,EAAI/F,MAAQ+F,EAAIxQ,KAC9CwQ,OADX,EASF,SAASgE,GAAsBhZ,EAAIV,GACjC,IAAI2P,EAAQhK,GAAO3F,GACfyU,EAAOkF,GAAgBjZ,EAAIiP,GAC3B8E,IAASA,EAAKztB,KAChBytB,EAAO,KACEA,GAAQA,EAAKS,UACtBF,GAAqBtU,EAAI+T,EAAM9E,EAAOkK,GAAcnZ,IACpDA,EAAGO,MAAM6Y,aAAc,GAEpBrF,IACDA,EAzCN,SAAmC/T,EAAIV,GAErC,IAAI2P,EAAQhK,GADZ3F,EAAOwP,GAAWxP,IAEdyU,EAAO/T,EAAG1X,QAAQ6oB,iBAAmB,IAAIuC,GAAS1T,EAAGtW,IAAK4V,EAAM2P,GACpE8E,EAAK9E,MAAQA,EACb,IAAIgG,EAAQlB,EAAKkB,MAAQ1E,GAAiBvQ,EAAI+T,GAG9C,OAFAA,EAAKztB,KAAO2uB,EAAMvE,IAClBxZ,EAAqB8I,EAAG1X,QAAQ+wB,YAAapE,EAAMvE,KAC5CqD,EAiCIuF,CAA0BtZ,EAAIV,IAEzC,IAAIyE,EAAO6U,GAAgB7E,EAAMzU,EAAM2P,GACvC,MAAO,CACL3P,KAAMA,EAAMyU,KAAMA,EAAMwF,KAAM,KAC9Br2B,IAAK6gB,EAAK7gB,IAAKotB,MAAOvM,EAAKuM,MAAOvgB,OAAQgU,EAAKhU,OAC/CypB,YAAY,GAMhB,SAAST,GAAoB/Y,EAAIyZ,EAAUje,EAAIsd,EAAMY,GAC/CD,EAAS1pB,SAAUyL,GAAM,GAC7B,IAA6BuB,EAAzB9nB,EAAMumB,GAAMsd,GAAQ,IAaxB,OAZIW,EAASnJ,MAAMvX,eAAe9jB,GAChC8nB,EAAQ0c,EAASnJ,MAAMr7B,IAElBwkC,EAASF,OACVE,EAASF,KAAOE,EAAS1F,KAAKztB,KAAKP,yBAClC0zB,EAASD,aA/FlB,SAA2BxZ,EAAIwQ,EAAU+I,GACvC,IAAII,EAAW3Z,EAAGhd,QAAQ42B,aACtBC,EAAWF,GAAYrB,GAAatY,GACxC,IAAKwQ,EAAShP,QAAQsY,SAAWH,GAAYnJ,EAAShP,QAAQhgB,OAASq4B,EAAU,CAC/E,IAAIC,EAAUtJ,EAAShP,QAAQsY,QAAU,GACzC,GAAIH,EAAU,CACZnJ,EAAShP,QAAQhgB,MAAQq4B,EAEzB,IADA,IAAIE,EAAQvJ,EAASlqB,KAAKyL,WAAWioB,iBAC5BzqC,EAAI,EAAGA,EAAIwqC,EAAMtqC,OAAS,EAAGF,IAAK,CACzC,IAAIytB,EAAM+c,EAAMxqC,GAAIm3B,EAAOqT,EAAMxqC,EAAI,GACjCrP,KAAKoN,IAAI0vB,EAAIzyB,OAASm8B,EAAKn8B,QAAU,GACrCuvC,EAAQj5B,MAAMmc,EAAIzyB,OAASm8B,EAAKl8B,KAAO,EAAI+uC,EAAK/uC,MAGxDsvC,EAAQj5B,KAAK04B,EAAKhvC,OAASgvC,EAAK/uC,MAkF9ByvC,CAAkBja,EAAIyZ,EAAS1F,KAAM0F,EAASF,MAC9CE,EAASD,YAAa,IAExBzc,EA0DJ,SAA0BiD,EAAIyZ,EAAUje,EAAIsd,GAC1C,IAGIS,EAHAW,EAAQC,GAAuBV,EAASv2B,IAAKsY,EAAIsd,GACjDvkB,EAAO2lB,EAAM3lB,KAAM0D,EAAQiiB,EAAMjiB,MAAOC,EAAMgiB,EAAMhiB,IAAKM,EAAW0hB,EAAM1hB,SAG9E,GAAqB,GAAjBjE,EAAKkD,SAAe,CACtB,IAAK,IAAIoG,EAAM,EAAGA,EAAM,EAAGA,IAAO,CAChC,KAAO5F,GAAS+D,GAAgByd,EAASna,KAAKhZ,KAAK8V,OAAO8d,EAAME,WAAaniB,OAAaA,EAC1F,KAAOiiB,EAAME,WAAaliB,EAAMgiB,EAAMG,UAAYre,GAAgByd,EAASna,KAAKhZ,KAAK8V,OAAO8d,EAAME,WAAaliB,OAAWA,EAK1H,IAHIqhB,EADAhkB,GAAMC,EAAa,GAAc,GAATyC,GAAcC,GAAOgiB,EAAMG,SAAWH,EAAME,WAC7D7lB,EAAKmD,WAAW3R,wBAEhBu0B,GAAczjB,EAAMtC,EAAM0D,EAAOC,GAAK8hB,iBAAkBlB,IAC1DzuC,MAAQkvC,EAAKjvC,OAAkB,GAAT2tB,EAAc,MAC7CC,EAAMD,EACNA,GAAgB,EAChBO,EAAW,QAETjD,GAAMC,EAAa,KAAM+jB,EAmCjC,SAAmC/X,EAAS+X,GAC1C,IAAKn6B,OAAOm7B,QAAgC,MAAtBA,OAAOC,aACzBD,OAAOC,aAAeD,OAAOE,aAvyDnC,SAA2BjZ,GACzB,GAAsB,MAAlBiB,GAA0B,OAAOA,GACrC,IAAIlO,EAAO2C,EAAqBsK,EAASrK,EAAI,OAAQ,MACjDujB,EAASnmB,EAAKxO,wBACd40B,EAAY9jB,EAAMtC,EAAM,EAAG,GAAGxO,wBAClC,OAAO0c,GAAiBviC,KAAKoN,IAAIotC,EAAOrwC,KAAOswC,EAAUtwC,MAAQ,EAkyDjBuwC,CAAkBpZ,GAC9D,OAAO+X,EACX,IAAIsB,EAASN,OAAOC,YAAcD,OAAOE,WACrCK,EAASP,OAAOQ,YAAcR,OAAOS,WACzC,MAAO,CAAC3wC,KAAMkvC,EAAKlvC,KAAOwwC,EAAQvwC,MAAOivC,EAAKjvC,MAAQuwC,EAC9CrwC,IAAK+uC,EAAK/uC,IAAMswC,EAAQvwC,OAAQgvC,EAAKhvC,OAASuwC,GA1ChBG,CAA0Bjb,EAAG1X,QAAQkZ,QAAS+X,QAC7E,CAEL,IAAIQ,EADA9hB,EAAQ,IAAKO,EAAWsgB,EAAO,SAG/BS,EADAvZ,EAAGhd,QAAQ42B,eAAiBG,EAAQxlB,EAAKylB,kBAAkBvqC,OAAS,EAC7DsqC,EAAc,SAARjB,EAAkBiB,EAAMtqC,OAAS,EAAI,GAE3C8kB,EAAKxO,wBAElB,GAAIwP,GAAMC,EAAa,IAAMyC,KAAWshB,IAASA,EAAKlvC,OAASkvC,EAAKjvC,OAAQ,CAC1E,IAAI4wC,EAAQ3mB,EAAKmD,WAAWsiB,iBAAiB,GAEzCT,EADA2B,EACO,CAAC7wC,KAAM6wC,EAAM7wC,KAAMC,MAAO4wC,EAAM7wC,KAAO8wC,GAAUnb,EAAG1X,SAAU9d,IAAK0wC,EAAM1wC,IAAKD,OAAQ2wC,EAAM3wC,QAE5F6wC,GAOb,IAJA,IAAIC,EAAO9B,EAAK/uC,IAAMivC,EAASF,KAAK/uC,IAAK8wC,EAAO/B,EAAKhvC,OAASkvC,EAASF,KAAK/uC,IACxEkyB,GAAO2e,EAAOC,GAAQ,EACtBxB,EAAUL,EAAS1F,KAAKvS,QAAQsY,QAChCvqC,EAAI,EACDA,EAAIuqC,EAAQrqC,OAAS,KACpBitB,EAAMod,EAAQvqC,IADSA,KAE/B,IAAI/E,EAAM+E,EAAIuqC,EAAQvqC,EAAI,GAAK,EAAGgsC,EAAMzB,EAAQvqC,GAC5CiJ,EAAS,CAACnO,MAAmB,SAAZmuB,EAAsB+gB,EAAKjvC,MAAQivC,EAAKlvC,MAAQovC,EAASF,KAAKlvC,KACrEC,OAAoB,QAAZkuB,EAAqB+gB,EAAKlvC,KAAOkvC,EAAKjvC,OAASmvC,EAASF,KAAKlvC,KACrEG,IAAKA,EAAKD,OAAQgxC,GAIhC,OAHKhC,EAAKlvC,MAASkvC,EAAKjvC,QAASkO,EAAOgjC,OAAQ,GAC3Cxb,EAAGhd,QAAQy4B,4BAA6BjjC,EAAO6iC,KAAOA,EAAM7iC,EAAOkjC,QAAUJ,GAE3E9iC,EA1GGmjC,CAAiB3b,EAAIyZ,EAAUje,EAAIsd,IAChC0C,QAAS/B,EAASnJ,MAAMr7B,GAAO8nB,IAErC,CAAC1yB,KAAM0yB,EAAM1yB,KAAMC,MAAOyyB,EAAMzyB,MAC/BE,IAAKkvC,EAAY3c,EAAMse,KAAOte,EAAMvyB,IACpCD,OAAQmvC,EAAY3c,EAAM2e,QAAU3e,EAAMxyB,QAGpD,IAsbIqxC,GAtbAR,GAAW,CAAC/wC,KAAM,EAAGC,MAAO,EAAGE,IAAK,EAAGD,OAAQ,GAEnD,SAAS4vC,GAAuBj3B,EAAKsY,EAAIsd,GAIvC,IAHA,IAAIvkB,EAAM0D,EAAOC,EAAKM,EAAUqjB,EAAQC,EAG/BvsC,EAAI,EAAGA,EAAI2T,EAAIzT,OAAQF,GAAK,EAcnC,GAbAssC,EAAS34B,EAAI3T,GACbusC,EAAO54B,EAAI3T,EAAI,GACXisB,EAAKqgB,GACP5jB,EAAQ,EAAGC,EAAM,EACjBM,EAAW,QACFgD,EAAKsgB,EAEd5jB,EAAc,GADdD,EAAQuD,EAAKqgB,IAEJtsC,GAAK2T,EAAIzT,OAAS,GAAK+rB,GAAMsgB,GAAQ54B,EAAI3T,EAAI,GAAKisB,KAE3DvD,GADAC,EAAM4jB,EAAOD,GACC,EACVrgB,GAAMsgB,IAAQtjB,EAAW,UAElB,MAATP,EAAe,CAIjB,GAHA1D,EAAOrR,EAAI3T,EAAI,GACXssC,GAAUC,GAAQhD,IAASvkB,EAAKqY,WAAa,OAAS,WACtDpU,EAAWsgB,GACH,QAARA,GAA2B,GAAT7gB,EAClB,KAAO1oB,GAAK2T,EAAI3T,EAAI,IAAM2T,EAAI3T,EAAI,IAAM2T,EAAI3T,EAAI,GAAGq9B,YACnDrY,EAAOrR,EAAe,GAAV3T,GAAK,IACjBipB,EAAW,OAEf,GAAY,SAARsgB,GAAmB7gB,GAAS6jB,EAAOD,EACnC,KAAOtsC,EAAI2T,EAAIzT,OAAS,GAAKyT,EAAI3T,EAAI,IAAM2T,EAAI3T,EAAI,KAAO2T,EAAI3T,EAAI,GAAGq9B,YACrErY,EAAOrR,GAAK3T,GAAK,GAAK,GACtBipB,EAAW,QAEf,MAGJ,MAAO,CAACjE,KAAMA,EAAM0D,MAAOA,EAAOC,IAAKA,EAAKM,SAAUA,EAAU4hB,WAAYyB,EAAQxB,SAAUyB,GAGhG,SAASxB,GAAcP,EAAOjB,GAC5B,IAAIS,EAAO6B,GACX,GAAY,QAARtC,EAAkB,IAAK,IAAIvpC,EAAI,EAAGA,EAAIwqC,EAAMtqC,SACzC8pC,EAAOQ,EAAMxqC,IAAIlF,MAAQkvC,EAAKjvC,MADmBiF,UAE7C,IAAK,IAAIsuB,EAAMkc,EAAMtqC,OAAS,EAAGouB,GAAO,IAC5C0b,EAAOQ,EAAMlc,IAAMxzB,MAAQkvC,EAAKjvC,MADeuzB,KAGtD,OAAO0b,EAkET,SAASwC,GAA6BvL,GACpC,GAAIA,EAAShP,UACXgP,EAAShP,QAAQ8O,MAAQ,GACzBE,EAAShP,QAAQsY,QAAU,KACvBtJ,EAASM,MAAQ,IAAK,IAAIvhC,EAAI,EAAGA,EAAIihC,EAASM,KAAKrhC,OAAQF,IAC3DihC,EAAShP,QAAQ6P,OAAO9hC,GAAK,GAIrC,SAASysC,GAA0Bhc,GACjCA,EAAG1X,QAAQ2zB,gBAAkB,KAC7BhlB,EAAe+I,EAAG1X,QAAQ+wB,aAC1B,IAAK,IAAI9pC,EAAI,EAAGA,EAAIywB,EAAG1X,QAAQyrB,KAAKtkC,OAAQF,IACxCwsC,GAA6B/b,EAAG1X,QAAQyrB,KAAKxkC,IAGnD,SAAS2sC,GAAYlc,GACnBgc,GAA0Bhc,GAC1BA,EAAG1X,QAAQ6zB,gBAAkBnc,EAAG1X,QAAQ8zB,iBAAmBpc,EAAG1X,QAAQ0vB,eAAiB,KAClFhY,EAAGhd,QAAQ42B,eAAgB5Z,EAAG1X,QAAQynB,gBAAiB,GAC5D/P,EAAG1X,QAAQ+zB,aAAe,KAG5B,SAASC,KAIP,OAAI1mB,GAAUM,IAAoB1Z,SAASoO,KAAK7E,wBAAwB1b,KAAOsN,SAAS4J,iBAAiB/E,SAASoO,MAAM1B,aACjH9J,OAAOm9B,cAAgB//B,SAASggC,iBAAmBhgC,SAASoO,MAAM6xB,WAE3E,SAASC,KACP,OAAI9mB,GAAUM,IAAoB1Z,SAASoO,KAAK7E,wBAAwBvb,IAAMmN,SAAS4J,iBAAiB/E,SAASoO,MAAMzB,YAChH/J,OAAOu9B,cAAgBngC,SAASggC,iBAAmBhgC,SAASoO,MAAMgyB,UAG3E,SAASC,GAAgBpN,GACvB,IAAI/tB,EAAS,EACb,GAAI+tB,EAAQiH,QAAW,IAAK,IAAInnC,EAAI,EAAGA,EAAIkgC,EAAQiH,QAAQjnC,SAAUF,EAASkgC,EAAQiH,QAAQnnC,GAAGunC,QAC7Fp1B,GAAUy1B,GAAa1H,EAAQiH,QAAQnnC,KAC3C,OAAOmS,EAOT,SAASo7B,GAAgB9c,EAAIyP,EAAS8J,EAAMpR,EAAS4U,GACnD,IAAKA,EAAgB,CACnB,IAAIr7B,EAASm7B,GAAgBpN,GAC7B8J,EAAK/uC,KAAOkX,EAAQ63B,EAAKhvC,QAAUmX,EAErC,GAAe,QAAXymB,EAAqB,OAAOoR,EAC3BpR,IAAWA,EAAU,SAC1B,IAAI6U,EAAOxN,GAAaC,GAGxB,GAFe,SAAXtH,EAAsB6U,GAAQpF,GAAW5X,EAAG1X,SACzC00B,GAAQhd,EAAG1X,QAAQ20B,WACX,QAAX9U,GAAgC,UAAXA,EAAqB,CAC5C,IAAI+U,EAAOld,EAAG1X,QAAQuvB,UAAU9xB,wBAChCi3B,GAAQE,EAAK1yC,KAAkB,UAAX29B,EAAsB,EAAIuU,MAC9C,IAAIS,EAAOD,EAAK7yC,MAAmB,UAAX89B,EAAsB,EAAImU,MAClD/C,EAAKlvC,MAAQ8yC,EAAM5D,EAAKjvC,OAAS6yC,EAGnC,OADA5D,EAAK/uC,KAAOwyC,EAAMzD,EAAKhvC,QAAUyyC,EAC1BzD,EAKT,SAAS6D,GAAgBpd,EAAIqd,EAAQlV,GACnC,GAAe,OAAXA,EAAoB,OAAOkV,EAC/B,IAAIhzC,EAAOgzC,EAAOhzC,KAAMG,EAAM6yC,EAAO7yC,IAErC,GAAe,QAAX29B,EACF99B,GAAQiyC,KACR9xC,GAAOkyC,UACF,GAAe,SAAXvU,IAAuBA,EAAS,CACzC,IAAImV,EAAWtd,EAAG1X,QAAQovB,MAAM3xB,wBAChC1b,GAAQizC,EAASjzC,KACjBG,GAAO8yC,EAAS9yC,IAGlB,IAAI+yC,EAAevd,EAAG1X,QAAQuvB,UAAU9xB,wBACxC,MAAO,CAAC1b,KAAMA,EAAOkzC,EAAalzC,KAAMG,IAAKA,EAAM+yC,EAAa/yC,KAGlE,SAASgzC,GAAWxd,EAAIrF,EAAKwN,EAASsH,EAASqJ,GAE7C,OADKrJ,IAAWA,EAAUnL,GAAQtE,EAAGtW,IAAKiR,EAAI2E,OACvCwd,GAAgB9c,EAAIyP,EAASoJ,GAAY7Y,EAAIyP,EAAS9U,EAAIa,GAAIsd,GAAO3Q,GAmB9E,SAASsV,GAAazd,EAAIrF,EAAKwN,EAASsH,EAASiO,EAAiBhE,GAGhE,SAASh/B,EAAI8gB,EAAIlxB,GACf,IAAIkH,EAAIunC,GAAoB/Y,EAAI0d,EAAiBliB,EAAIlxB,EAAQ,QAAU,OAAQovC,GAE/E,OADIpvC,EAASkH,EAAEnH,KAAOmH,EAAElH,MAAgBkH,EAAElH,MAAQkH,EAAEnH,KAC7CyyC,GAAgB9c,EAAIyP,EAASj+B,EAAG22B,GALzCsH,EAAUA,GAAWnL,GAAQtE,EAAGtW,IAAKiR,EAAI2E,MACpCoe,IAAmBA,EAAkB1E,GAAsBhZ,EAAIyP,IAMpE,IAAI5S,EAAQwC,GAASoQ,EAASzP,EAAGtW,IAAI+T,WAAYjC,EAAKb,EAAIa,GAAIsB,EAASnC,EAAImC,OAQ3E,GAPItB,GAAMiU,EAAQnpB,KAAK7W,QACrB+rB,EAAKiU,EAAQnpB,KAAK7W,OAClBqtB,EAAS,UACAtB,GAAM,IACfA,EAAK,EACLsB,EAAS,UAEND,EAAS,OAAOniB,EAAc,UAAVoiB,EAAqBtB,EAAK,EAAIA,EAAc,UAAVsB,GAE3D,SAAS6gB,EAAQniB,EAAIoiB,EAASx7C,GAE5B,OAAOsY,EAAItY,EAASo5B,EAAK,EAAIA,EADoB,GAAtCqB,EAAM+gB,GAAuBpgB,OACEp7B,GAE5C,IAAIw7C,EAAUhhB,GAAcC,EAAOrB,EAAIsB,GACnC+gB,EAAQlhB,GACRpf,EAAMogC,EAAQniB,EAAIoiB,EAAmB,UAAV9gB,GAE/B,OADa,MAAT+gB,IAAiBtgC,EAAIsgC,MAAQF,EAAQniB,EAAIqiB,EAAiB,UAAV/gB,IAC7Cvf,EAKT,SAASugC,GAAe9d,EAAIrF,GAC1B,IAAItwB,EAAO,EACXswB,EAAMuL,GAAQlG,EAAGtW,IAAKiR,GACjBqF,EAAGhd,QAAQ42B,eAAgBvvC,EAAO8wC,GAAUnb,EAAG1X,SAAWqS,EAAIa,IACnE,IAAIiU,EAAUnL,GAAQtE,EAAGtW,IAAKiR,EAAI2E,MAC9B90B,EAAMglC,GAAaC,GAAWmI,GAAW5X,EAAG1X,SAChD,MAAO,CAACje,KAAMA,EAAMC,MAAOD,EAAMG,IAAKA,EAAKD,OAAQC,EAAMilC,EAAQ/tB,QASnE,SAASq8B,GAAYze,EAAM9D,EAAIsB,EAAQkhB,EAASC,GAC9C,IAAItjB,EAAMgL,GAAIrG,EAAM9D,EAAIsB,GAGxB,OAFAnC,EAAIsjB,KAAOA,EACPD,IAAWrjB,EAAIqjB,QAAUA,GACtBrjB,EAKT,SAASujB,GAAWle,EAAI17B,EAAGC,GACzB,IAAImlB,EAAMsW,EAAGtW,IAEb,IADAnlB,GAAKy7B,EAAG1X,QAAQ20B,YACR,EAAK,OAAOc,GAAYr0B,EAAI6a,MAAO,EAAG,MAAO,GAAI,GACzD,IAAI0K,EAAQ9J,GAAazb,EAAKnlB,GAAI4hC,EAAOzc,EAAI6a,MAAQ7a,EAAI8a,KAAO,EAChE,GAAIyK,EAAQ9I,EACR,OAAO4X,GAAYr0B,EAAI6a,MAAQ7a,EAAI8a,KAAO,EAAGF,GAAQ5a,EAAKyc,GAAM7f,KAAK7W,OAAQ,KAAM,EAAG,GACtFnL,EAAI,IAAKA,EAAI,GAGjB,IADA,IAAImrC,EAAUnL,GAAQ5a,EAAKulB,KAClB,CACP,IAAIlS,EAAQohB,GAAgBne,EAAIyP,EAASR,EAAO3qC,EAAGC,GAC/CkqC,EAAYG,GAAoBa,EAAS1S,EAAMvB,IAAMuB,EAAMkhB,KAAO,GAAKlhB,EAAMihB,QAAU,EAAI,EAAI,IACnG,IAAKvP,EAAa,OAAO1R,EACzB,IAAIqhB,EAAW3P,EAAUP,KAAK,GAC9B,GAAIkQ,EAAS9e,MAAQ2P,EAAS,OAAOmP,EACrC3O,EAAUnL,GAAQ5a,EAAKulB,EAAQmP,EAAS9e,OAI5C,SAAS+e,GAAkBre,EAAIyP,EAASiO,EAAiBn5C,GACvDA,GAAKs4C,GAAgBpN,GACrB,IAAIvX,EAAMuX,EAAQnpB,KAAK7W,OACnB6uC,EAAQjiB,IAAU,SAAUb,GAAM,OAAOud,GAAoB/Y,EAAI0d,EAAiBliB,EAAK,GAAGjxB,QAAUhG,IAAM2zB,EAAK,GAEnH,MAAO,CAAComB,MAAOA,EAAOpmB,IADtBA,EAAMmE,IAAU,SAAUb,GAAM,OAAOud,GAAoB/Y,EAAI0d,EAAiBliB,GAAIhxB,IAAMjG,IAAM+5C,EAAOpmB,IAIzG,SAASqmB,GAAsBve,EAAIyP,EAASiO,EAAiBlwC,GAG3D,OAFKkwC,IAAmBA,EAAkB1E,GAAsBhZ,EAAIyP,IAE7D4O,GAAkBre,EAAIyP,EAASiO,EADtBZ,GAAgB9c,EAAIyP,EAASsJ,GAAoB/Y,EAAI0d,EAAiBlwC,GAAS,QAAQhD,KAMzG,SAASg0C,GAAW5tB,EAAKtsB,EAAGC,EAAG8F,GAC7B,QAAOumB,EAAIrmB,QAAUhG,KAAYqsB,EAAIpmB,IAAMjG,IAAY8F,EAAOumB,EAAIvmB,KAAOumB,EAAItmB,OAAShG,GAGxF,SAAS65C,GAAgBne,EAAIyP,EAASxK,EAAQ3gC,EAAGC,GAE/CA,GAAKirC,GAAaC,GAClB,IAAIiO,EAAkB1E,GAAsBhZ,EAAIyP,GAG5C0H,EAAe0F,GAAgBpN,GAC/B6O,EAAQ,EAAGpmB,EAAMuX,EAAQnpB,KAAK7W,OAAQgvC,GAAM,EAE5C5hB,EAAQwC,GAASoQ,EAASzP,EAAGtW,IAAI+T,WAGrC,GAAIZ,EAAO,CACT,IAAI6V,GAAQ1S,EAAGhd,QAAQ42B,aAAe8E,GAAwBC,IAChD3e,EAAIyP,EAASxK,EAAQyY,EAAiB7gB,EAAOv4B,EAAGC,GAM9D+5C,GALAG,EAAoB,GAAd/L,EAAKlV,OAKGkV,EAAKnW,KAAOmW,EAAKlW,GAAK,EACpCtE,EAAMumB,EAAM/L,EAAKlW,GAAKkW,EAAKnW,KAAO,EAMpC,IAYIqiB,EAAO9hB,EAZP+hB,EAAW,KAAMC,EAAY,KAC7BtjB,EAAKa,IAAU,SAAUb,GAC3B,IAAI5K,EAAMmoB,GAAoB/Y,EAAI0d,EAAiBliB,GAEnD,OADA5K,EAAIpmB,KAAO2sC,EAAcvmB,EAAIrmB,QAAU4sC,IAClCqH,GAAW5tB,EAAKtsB,EAAGC,GAAG,KACvBqsB,EAAIpmB,KAAOjG,GAAKqsB,EAAIvmB,MAAQ/F,IAC9Bu6C,EAAWrjB,EACXsjB,EAAYluB,IAEP,KACN0tB,EAAOpmB,GAES8lB,GAAU,EAE7B,GAAIc,EAAW,CAEb,IAAIC,EAASz6C,EAAIw6C,EAAUz0C,KAAOy0C,EAAUx0C,MAAQhG,EAAG06C,EAAUD,GAAUN,EAC3EjjB,EAAKqjB,GAAYG,EAAU,EAAI,GAC/BliB,EAASkiB,EAAU,QAAU,SAC7BJ,EAAQG,EAASD,EAAUz0C,KAAOy0C,EAAUx0C,UACvC,CAEAm0C,GAAQjjB,GAAMtD,GAAOsD,GAAM8iB,GAAU9iB,IAI1CsB,EAAe,GAANtB,EAAU,QAAUA,GAAMiU,EAAQnpB,KAAK7W,OAAS,SACtDspC,GAAoB/Y,EAAI0d,EAAiBliB,GAAMijB,EAAM,EAAI,IAAIl0C,OAAS4sC,GAAgB5yC,GAAMk6C,EAC7F,QAAU,SAGZ,IAAIpB,EAASI,GAAazd,EAAI2F,GAAIV,EAAQzJ,EAAIsB,GAAS,OAAQ2S,EAASiO,GACxEkB,EAAQvB,EAAOhzC,KACf2zC,EAAUz5C,EAAI84C,EAAO7yC,KAAO,EAAIjG,GAAK84C,EAAO9yC,OAAS,EAAI,EAI3D,OAAOwzC,GAAY9Y,EADnBzJ,EAAKU,GAAmBuT,EAAQnpB,KAAMkV,EAAI,GACXsB,EAAQkhB,EAAS15C,EAAIs6C,GAGtD,SAASD,GAAe3e,EAAIyP,EAASxK,EAAQyY,EAAiB7gB,EAAOv4B,EAAGC,GAKtE,IAAI2c,EAAQmb,IAAU,SAAU9sB,GAC9B,IAAImjC,EAAO7V,EAAMttB,GAAIkvC,EAAoB,GAAd/L,EAAKlV,MAChC,OAAOghB,GAAWf,GAAazd,EAAI2F,GAAIV,EAAQwZ,EAAM/L,EAAKlW,GAAKkW,EAAKnW,KAAMkiB,EAAM,SAAW,SAC5D,OAAQhP,EAASiO,GAAkBp5C,EAAGC,GAAG,KACvE,EAAGs4B,EAAMptB,OAAS,GACjBijC,EAAO7V,EAAM3b,GAIjB,GAAIA,EAAQ,EAAG,CACb,IAAIu9B,EAAoB,GAAd/L,EAAKlV,MACXvF,EAAQwlB,GAAazd,EAAI2F,GAAIV,EAAQwZ,EAAM/L,EAAKnW,KAAOmW,EAAKlW,GAAIiiB,EAAM,QAAU,UAC3D,OAAQhP,EAASiO,GACtCc,GAAWvmB,EAAO3zB,EAAGC,GAAG,IAAS0zB,EAAMztB,IAAMjG,IAC7CmuC,EAAO7V,EAAM3b,EAAQ,IAE3B,OAAOwxB,EAGT,SAASgM,GAAsB1e,EAAIyP,EAASwP,EAASvB,EAAiB7gB,EAAOv4B,EAAGC,GAQ9E,IAAI26C,EAAMb,GAAkBre,EAAIyP,EAASiO,EAAiBn5C,GACtD+5C,EAAQY,EAAIZ,MACZpmB,EAAMgnB,EAAIhnB,IACV,KAAK1gB,KAAKi4B,EAAQnpB,KAAK8V,OAAOlE,EAAM,KAAOA,IAE/C,IADA,IAAIwa,EAAO,KAAMyM,EAAc,KACtB5vC,EAAI,EAAGA,EAAIstB,EAAMptB,OAAQF,IAAK,CACrC,IAAI+C,EAAIuqB,EAAMttB,GACd,KAAI+C,EAAEiqB,MAAQrE,GAAO5lB,EAAEkqB,IAAM8hB,GAA7B,CACA,IACIc,EAAOrG,GAAoB/Y,EAAI0d,EADd,GAAXprC,EAAEkrB,MAC8Ct9B,KAAK6P,IAAImoB,EAAK5lB,EAAEkqB,IAAM,EAAIt8B,KAAKoP,IAAIgvC,EAAOhsC,EAAEiqB,OAAOjyB,MAGzGwI,EAAOssC,EAAO96C,EAAIA,EAAI86C,EAAO,IAAMA,EAAO96C,IACzCouC,GAAQyM,EAAcrsC,KACzB4/B,EAAOpgC,EACP6sC,EAAcrsC,IAOlB,OAJK4/B,IAAQA,EAAO7V,EAAMA,EAAMptB,OAAS,IAErCijC,EAAKnW,KAAO+hB,IAAS5L,EAAO,CAACnW,KAAM+hB,EAAO9hB,GAAIkW,EAAKlW,GAAIgB,MAAOkV,EAAKlV,QACnEkV,EAAKlW,GAAKtE,IAAOwa,EAAO,CAACnW,KAAMmW,EAAKnW,KAAMC,GAAItE,EAAKsF,MAAOkV,EAAKlV,QAC5DkV,EAKT,SAAS2M,GAAW/2B,GAClB,GAAgC,MAA5BA,EAAQ8zB,iBAA4B,OAAO9zB,EAAQ8zB,iBACvD,GAAmB,MAAfR,GAAqB,CACvBA,GAAczkB,EAAI,MAAO,KAAM,wBAG/B,IAAK,IAAI5nB,EAAI,EAAGA,EAAI,KAAMA,EACxBqsC,GAAYh5B,YAAYpG,SAAS8R,eAAe,MAChDstB,GAAYh5B,YAAYuU,EAAI,OAE9BykB,GAAYh5B,YAAYpG,SAAS8R,eAAe,MAElD4I,EAAqB5O,EAAQkZ,QAASoa,IACtC,IAAIl6B,EAASk6B,GAAYpnB,aAAe,GAGxC,OAFI9S,EAAS,IAAK4G,EAAQ8zB,iBAAmB16B,GAC7CuV,EAAe3O,EAAQkZ,SAChB9f,GAAU,EAInB,SAASy5B,GAAU7yB,GACjB,GAA+B,MAA3BA,EAAQ6zB,gBAA2B,OAAO7zB,EAAQ6zB,gBACtD,IAAImD,EAASnoB,EAAI,OAAQ,cACrBuZ,EAAMvZ,EAAI,MAAO,CAACmoB,GAAS,wBAC/BpoB,EAAqB5O,EAAQkZ,QAASkP,GACtC,IAAI6I,EAAO+F,EAAOv5B,wBAAyBvE,GAAS+3B,EAAKjvC,MAAQivC,EAAKlvC,MAAQ,GAE9E,OADImX,EAAQ,IAAK8G,EAAQ6zB,gBAAkB36B,GACpCA,GAAS,GAKlB,SAAS23B,GAAcnZ,GAGrB,IAFA,IAAIpvB,EAAIovB,EAAG1X,QAASje,EAAO,GAAImX,EAAQ,GACnCy0B,EAAarlC,EAAEymC,QAAQkI,WAClBjmB,EAAI1oB,EAAEymC,QAAQtlB,WAAYxiB,EAAI,EAAG+pB,EAAGA,EAAIA,EAAEjJ,cAAe9gB,EAAG,CACnE,IAAIqqB,EAAKoG,EAAG1X,QAAQ4tB,YAAY3mC,GAAGqP,UACnCvU,EAAKuvB,GAAMN,EAAExX,WAAawX,EAAEimB,WAAatJ,EACzCz0B,EAAMoY,GAAMN,EAAEie,YAEhB,MAAO,CAAC9B,SAAU+J,GAAqB5uC,GAC/B8kC,iBAAkB9kC,EAAEymC,QAAQ5V,YAC5BwU,WAAY5rC,EACZ8rC,YAAa30B,EACbw1B,aAAcpmC,EAAE0mC,QAAQC,aAMlC,SAASiI,GAAqBl3B,GAC5B,OAAOA,EAAQiwB,SAASxyB,wBAAwB1b,KAAOie,EAAQovB,MAAM3xB,wBAAwB1b,KAM/F,SAAS4lC,GAAejQ,GACtB,IAAIyf,EAAKJ,GAAWrf,EAAG1X,SAAUqxB,EAAW3Z,EAAGhd,QAAQ42B,aACnD8F,EAAU/F,GAAYz5C,KAAKoP,IAAI,EAAG0wB,EAAG1X,QAAQiwB,SAAShB,YAAc4D,GAAUnb,EAAG1X,SAAW,GAChG,OAAO,SAAUgX,GACf,GAAI+P,GAAarP,EAAGtW,IAAK4V,GAAS,OAAO,EAEzC,IAAIqgB,EAAgB,EACpB,GAAIrgB,EAAKoX,QAAW,IAAK,IAAInnC,EAAI,EAAGA,EAAI+vB,EAAKoX,QAAQjnC,OAAQF,IACvD+vB,EAAKoX,QAAQnnC,GAAGmS,SAAUi+B,GAAiBrgB,EAAKoX,QAAQnnC,GAAGmS,QAGjE,OAAIi4B,EACOgG,GAAiBz/C,KAAK2P,KAAKyvB,EAAKhZ,KAAK7W,OAASiwC,IAAY,GAAKD,EAE/DE,EAAgBF,GAI/B,SAASG,GAAoB5f,GAC3B,IAAItW,EAAMsW,EAAGtW,IAAKm2B,EAAM5P,GAAejQ,GACvCtW,EAAIob,MAAK,SAAUxF,GACjB,IAAIwgB,EAAYD,EAAIvgB,GAChBwgB,GAAaxgB,EAAK5d,QAAUsjB,GAAiB1F,EAAMwgB,MAS3D,SAASC,GAAa/f,EAAI5iB,EAAG4iC,EAASC,GACpC,IAAI33B,EAAU0X,EAAG1X,QACjB,IAAK03B,GAAyD,QAA9C/e,GAAS7jB,GAAGq6B,aAAa,kBAA+B,OAAO,KAE/E,IAAInzC,EAAGC,EAAGmT,EAAQ4Q,EAAQuvB,UAAU9xB,wBAEpC,IAAMzhB,EAAI8Y,EAAE2B,QAAUrH,EAAMrN,KAAM9F,EAAI6Y,EAAE4B,QAAUtH,EAAMlN,IACxD,MAAO4S,GAAK,OAAO,KACnB,IAAmCkiB,EAA/B+d,EAASa,GAAWle,EAAI17B,EAAGC,GAC/B,GAAI07C,GAAW5C,EAAOY,KAAO,IAAM3e,EAAOgF,GAAQtE,EAAGtW,IAAK2zB,EAAO/d,MAAMhZ,MAAM7W,QAAU4tC,EAAO7hB,GAAI,CAChG,IAAI0kB,EAAUlnB,EAAYsG,EAAMA,EAAK7vB,OAAQuwB,EAAGhd,QAAQkW,SAAWoG,EAAK7vB,OACxE4tC,EAAS1X,GAAI0X,EAAO/d,KAAMp/B,KAAKoP,IAAI,EAAGpP,KAAK8P,OAAO1L,EAAIyzC,GAAS/X,EAAG1X,SAASje,MAAQ8wC,GAAUnb,EAAG1X,UAAY43B,IAE9G,OAAO7C,EAKT,SAASnE,GAAclZ,EAAI1G,GACzB,GAAIA,GAAK0G,EAAG1X,QAAQ8hB,OAAU,OAAO,KAErC,IADA9Q,GAAK0G,EAAG1X,QAAQ6hB,UACR,EAAK,OAAO,KAEpB,IADA,IAAI4J,EAAO/T,EAAG1X,QAAQyrB,KACbxkC,EAAI,EAAGA,EAAIwkC,EAAKtkC,OAAQF,IAE/B,IADA+pB,GAAKya,EAAKxkC,GAAGi1B,MACL,EAAK,OAAOj1B,EAUxB,SAAS4wC,GAAUngB,EAAIzD,EAAMC,EAAI4jB,GACnB,MAAR7jB,IAAgBA,EAAOyD,EAAGtW,IAAI6a,OACxB,MAAN/H,IAAcA,EAAKwD,EAAGtW,IAAI6a,MAAQvE,EAAGtW,IAAI8a,MACxC4b,IAAWA,EAAU,GAE1B,IAAI93B,EAAU0X,EAAG1X,QAOjB,GANI83B,GAAW5jB,EAAKlU,EAAQ8hB,SACM,MAA7B9hB,EAAQ+3B,mBAA6B/3B,EAAQ+3B,kBAAoB9jB,KAClEjU,EAAQ+3B,kBAAoB9jB,GAEhCyD,EAAGO,MAAM+f,aAAc,EAEnB/jB,GAAQjU,EAAQ8hB,OACdqB,IAAqBuD,GAAahP,EAAGtW,IAAK6S,GAAQjU,EAAQ8hB,QAC1DmW,GAAUvgB,QACT,GAAIxD,GAAMlU,EAAQ6hB,SACnBsB,IAAqB0D,GAAgBnP,EAAGtW,IAAK8S,EAAK4jB,GAAW93B,EAAQ6hB,SACvEoW,GAAUvgB,IAEV1X,EAAQ6hB,UAAYiW,EACpB93B,EAAQ8hB,QAAUgW,QAEf,GAAI7jB,GAAQjU,EAAQ6hB,UAAY3N,GAAMlU,EAAQ8hB,OACnDmW,GAAUvgB,QACL,GAAIzD,GAAQjU,EAAQ6hB,SAAU,CACnC,IAAIqW,EAAMC,GAAiBzgB,EAAIxD,EAAIA,EAAK4jB,EAAS,GAC7CI,GACFl4B,EAAQyrB,KAAOzrB,EAAQyrB,KAAKz/B,MAAMksC,EAAIt/B,OACtCoH,EAAQ6hB,SAAWqW,EAAIvR,MACvB3mB,EAAQ8hB,QAAUgW,GAElBG,GAAUvgB,QAEP,GAAIxD,GAAMlU,EAAQ8hB,OAAQ,CAC/B,IAAIsW,EAAQD,GAAiBzgB,EAAIzD,EAAMA,GAAO,GAC1CmkB,GACFp4B,EAAQyrB,KAAOzrB,EAAQyrB,KAAKz/B,MAAM,EAAGosC,EAAMx/B,OAC3CoH,EAAQ8hB,OAASsW,EAAMzR,OAEvBsR,GAAUvgB,OAEP,CACL,IAAI2gB,EAASF,GAAiBzgB,EAAIzD,EAAMA,GAAO,GAC3CqkB,EAASH,GAAiBzgB,EAAIxD,EAAIA,EAAK4jB,EAAS,GAChDO,GAAUC,GACZt4B,EAAQyrB,KAAOzrB,EAAQyrB,KAAKz/B,MAAM,EAAGqsC,EAAOz/B,OACzC4O,OAAO+jB,GAAe7T,EAAI2gB,EAAO1R,MAAO2R,EAAO3R,QAC/Cnf,OAAOxH,EAAQyrB,KAAKz/B,MAAMssC,EAAO1/B,QACpCoH,EAAQ8hB,QAAUgW,GAElBG,GAAUvgB,GAId,IAAIgV,EAAM1sB,EAAQ6oB,iBACd6D,IACExY,EAAKwY,EAAI/F,MACT+F,EAAI/F,OAASmR,EACR7jB,EAAOyY,EAAI/F,MAAQ+F,EAAIxQ,OAC5Blc,EAAQ6oB,iBAAmB,OAMnC,SAAS0P,GAAc7gB,EAAIV,EAAMpd,GAC/B8d,EAAGO,MAAM+f,aAAc,EACvB,IAAIh4B,EAAU0X,EAAG1X,QAAS0sB,EAAMhV,EAAG1X,QAAQ6oB,iBAI3C,GAHI6D,GAAO1V,GAAQ0V,EAAI/F,OAAS3P,EAAO0V,EAAI/F,MAAQ+F,EAAIxQ,OACnDlc,EAAQ6oB,iBAAmB,QAE3B7R,EAAOhX,EAAQ6hB,UAAY7K,GAAQhX,EAAQ8hB,QAA/C,CACA,IAAIoG,EAAWloB,EAAQyrB,KAAKmF,GAAclZ,EAAIV,IAC9C,GAAqB,MAAjBkR,EAASjc,KAAb,CACA,IAAI0G,EAAMuV,EAASgE,UAAYhE,EAASgE,QAAU,KACvB,GAAvB5zB,EAAQqa,EAAK/Y,IAAe+Y,EAAIpa,KAAKqB,KAI3C,SAASq+B,GAAUvgB,GACjBA,EAAG1X,QAAQ6hB,SAAWnK,EAAG1X,QAAQ8hB,OAASpK,EAAGtW,IAAI6a,MACjDvE,EAAG1X,QAAQyrB,KAAO,GAClB/T,EAAG1X,QAAQ20B,WAAa,EAG1B,SAASwD,GAAiBzgB,EAAI8gB,EAAMC,EAAM5kB,GACxC,IAAqCjX,EAAjChE,EAAQg4B,GAAclZ,EAAI8gB,GAAa/M,EAAO/T,EAAG1X,QAAQyrB,KAC7D,IAAKtI,IAAqBsV,GAAQ/gB,EAAGtW,IAAI6a,MAAQvE,EAAGtW,IAAI8a,KACpD,MAAO,CAACtjB,MAAOA,EAAO+tB,MAAO8R,GAEjC,IADA,IAAIznB,EAAI0G,EAAG1X,QAAQ6hB,SACV56B,EAAI,EAAGA,EAAI2R,EAAO3R,IACvB+pB,GAAKya,EAAKxkC,GAAGi1B,KACjB,GAAIlL,GAAKwnB,EAAM,CACb,GAAI3kB,EAAM,EAAG,CACX,GAAIjb,GAAS6yB,EAAKtkC,OAAS,EAAK,OAAO,KACvCyV,EAAQoU,EAAIya,EAAK7yB,GAAOsjB,KAAQsc,EAChC5/B,SAEAgE,EAAOoU,EAAIwnB,EAEbA,GAAQ57B,EAAM67B,GAAQ77B,EAExB,KAAO8pB,GAAahP,EAAGtW,IAAKq3B,IAASA,GAAM,CACzC,GAAI7/B,IAAUib,EAAM,EAAI,EAAI4X,EAAKtkC,OAAS,GAAM,OAAO,KACvDsxC,GAAQ5kB,EAAM4X,EAAK7yB,GAASib,EAAM,EAAI,EAAI,IAAIqI,KAC9CtjB,GAASib,EAEX,MAAO,CAACjb,MAAOA,EAAO+tB,MAAO8R,GA0B/B,SAASC,GAAehhB,GAEtB,IADA,IAAI+T,EAAO/T,EAAG1X,QAAQyrB,KAAMkN,EAAQ,EAC3B1xC,EAAI,EAAGA,EAAIwkC,EAAKtkC,OAAQF,IAAK,CACpC,IAAIihC,EAAWuD,EAAKxkC,GACfihC,EAASoD,QAAYpD,EAASjc,OAAQic,EAASgE,WAAcyM,EAEpE,OAAOA,EAGT,SAASC,GAAgBlhB,GACvBA,EAAG1X,QAAQwqB,MAAMqO,cAAcnhB,EAAG1X,QAAQwqB,MAAMsO,oBAGlD,SAASA,GAAiBphB,EAAIqhB,QACX,IAAZA,IAAqBA,GAAU,GAMpC,IAJA,IAAI33B,EAAMsW,EAAGtW,IAAKlR,EAAS,GACvB8oC,EAAc9oC,EAAO+oC,QAAU/kC,SAAS21B,yBACxCqP,EAAchpC,EAAO6pB,UAAY7lB,SAAS21B,yBAErC5iC,EAAI,EAAGA,EAAIma,EAAI+3B,IAAIC,OAAOjyC,OAAQF,IACzC,GAAK8xC,GAAW9xC,GAAKma,EAAI+3B,IAAIE,UAA7B,CACA,IAAI9qB,EAAQnN,EAAI+3B,IAAIC,OAAOnyC,GAC3B,KAAIsnB,EAAM0F,OAAO+C,MAAQU,EAAG1X,QAAQ8hB,QAAUvT,EAAM2F,KAAK8C,KAAOU,EAAG1X,QAAQ6hB,UAA3E,CACA,IAAIsE,EAAY5X,EAAM+qB,SAClBnT,GAAazO,EAAGhd,QAAQ6+B,0BACxBC,GAAoB9hB,EAAInJ,EAAMjN,KAAM03B,GACnC7S,GACDsT,GAAmB/hB,EAAInJ,EAAO2qB,IAEpC,OAAOhpC,EAIT,SAASspC,GAAoB9hB,EAAIpW,EAAMqhB,GACrC,IAAItQ,EAAM8iB,GAAazd,EAAIpW,EAAM,MAAO,KAAM,MAAOoW,EAAGhd,QAAQy4B,2BAE5DlzB,EAAS0iB,EAAOroB,YAAYuU,EAAI,MAAO,IAAU,sBAKrD,GAJA5O,EAAO3K,MAAMvT,KAAOswB,EAAItwB,KAAO,KAC/Bke,EAAO3K,MAAMpT,IAAMmwB,EAAInwB,IAAM,KAC7B+d,EAAO3K,MAAM8D,OAASxhB,KAAKoP,IAAI,EAAGqrB,EAAIpwB,OAASowB,EAAInwB,KAAOw1B,EAAGhd,QAAQg/B,aAAe,KAEhFrnB,EAAIkjB,MAAO,CAEb,IAAIoE,EAAchX,EAAOroB,YAAYuU,EAAI,MAAO,IAAU,iDAC1D8qB,EAAYrkC,MAAM0K,QAAU,GAC5B25B,EAAYrkC,MAAMvT,KAAOswB,EAAIkjB,MAAMxzC,KAAO,KAC1C43C,EAAYrkC,MAAMpT,IAAMmwB,EAAIkjB,MAAMrzC,IAAM,KACxCy3C,EAAYrkC,MAAM8D,OAA8C,KAApCiZ,EAAIkjB,MAAMtzC,OAASowB,EAAIkjB,MAAMrzC,KAAa,MAI1E,SAAS03C,GAAU1hD,EAAGuD,GAAK,OAAOvD,EAAEgK,IAAMzG,EAAEyG,KAAOhK,EAAE6J,KAAOtG,EAAEsG,KAG9D,SAAS03C,GAAmB/hB,EAAInJ,EAAOoU,GACrC,IAAI3iB,EAAU0X,EAAG1X,QAASoB,EAAMsW,EAAGtW,IAC/By4B,EAAW3lC,SAAS21B,yBACpBrqB,EAAUiwB,GAAS/X,EAAG1X,SAAU85B,EAAWt6B,EAAQzd,KACnDg4C,EAAYniD,KAAKoP,IAAIgZ,EAAQg6B,WAAYhK,GAAatY,GAAM1X,EAAQovB,MAAM51B,YAAcgG,EAAQxd,MAChGi4C,EAA0B,OAAjB74B,EAAI+T,UAEjB,SAAS9vB,EAAItD,EAAMG,EAAKgX,EAAOjX,GACzBC,EAAM,IAAKA,EAAM,GACrBA,EAAMtK,KAAK8P,MAAMxF,GACjBD,EAASrK,KAAK8P,MAAMzF,GACpB43C,EAASv/B,YAAYuU,EAAI,MAAO,KAAM,sBAAwB,6BAA+B9sB,EAAO,0CAA4CG,EAAM,eAA0B,MAATgX,EAAgB6gC,EAAYh4C,EAAOmX,GAAS,8CAAgDjX,EAASC,GAAO,OAGrR,SAASg4C,EAAYljB,EAAMmjB,EAASC,GAClC,IAEIzqB,EAAOC,EAFPuX,EAAUnL,GAAQ5a,EAAK4V,GACvBqjB,EAAUlT,EAAQnpB,KAAK7W,OAE3B,SAAS4tC,EAAO7hB,EAAIsd,GAClB,OAAO0E,GAAWxd,EAAI2F,GAAIrG,EAAM9D,GAAK,MAAOiU,EAASqJ,GAGvD,SAAS8J,EAAMjoB,EAAKwB,EAAK0mB,GACvB,IAAIC,EAASvE,GAAsBve,EAAIyP,EAAS,KAAM9U,GAClD7B,EAAe,OAAPqD,IAA0B,SAAR0mB,GAAmB,OAAS,QAE1D,OAAOxF,EADU,SAARwF,EAAkBC,EAAOxE,MAAQwE,EAAO5qB,KAAO,KAAK1gB,KAAKi4B,EAAQnpB,KAAK8V,OAAO0mB,EAAO5qB,IAAM,IAAM,EAAI,GAC3FY,GAAMA,GAG1B,IAAI+D,EAAQwC,GAASoQ,EAAS/lB,EAAI+T,WAqClC,OAl3FJ,SAA6BZ,EAAON,EAAMC,EAAIvxB,GAC5C,IAAK4xB,EAAS,OAAO5xB,EAAEsxB,EAAMC,EAAI,MAAO,GAExC,IADA,IAAIO,GAAQ,EACHxtB,EAAI,EAAGA,EAAIstB,EAAMptB,SAAUF,EAAG,CACrC,IAAImjC,EAAO7V,EAAMttB,IACbmjC,EAAKnW,KAAOC,GAAMkW,EAAKlW,GAAKD,GAAQA,GAAQC,GAAMkW,EAAKlW,IAAMD,KAC/DtxB,EAAE/K,KAAKoP,IAAIojC,EAAKnW,KAAMA,GAAOr8B,KAAK6P,IAAI2iC,EAAKlW,GAAIA,GAAmB,GAAdkW,EAAKlV,MAAa,MAAQ,MAAOjuB,GACrFwtB,GAAQ,GAGPA,GAAS9xB,EAAEsxB,EAAMC,EAAI,OAo0FxBumB,CAAoBlmB,EAAO4lB,GAAW,EAAY,MAATC,EAAgBC,EAAUD,GAAO,SAAUnmB,EAAMC,EAAIL,EAAK5sB,GACjG,IAAIkvC,EAAa,OAAPtiB,EACN6mB,EAAU3F,EAAO9gB,EAAMkiB,EAAM,OAAS,SACtCwE,EAAQ5F,EAAO7gB,EAAK,EAAGiiB,EAAM,QAAU,QAEvCyE,EAAuB,MAAXT,GAA2B,GAARlmB,EAAW4mB,EAAmB,MAATT,GAAiBlmB,GAAMmmB,EAC3Epe,EAAa,GAALh1B,EAAQ42B,GAAQtJ,GAASttB,GAAKstB,EAAMptB,OAAS,EACzD,GAAIwzC,EAAMz4C,IAAMw4C,EAAQx4C,KAAO,EAAG,CAChC,IACI44C,GAAab,EAASY,EAAUD,IAAc/c,EAC9C97B,GAFYk4C,EAASW,EAAYC,IAAY5e,EAE3B6d,GAAY3D,EAAMuE,EAAUC,GAAO54C,KACrDC,EAAQ84C,EAAYf,GAAa5D,EAAMwE,EAAQD,GAAS14C,MAC5DqD,EAAItD,EAAM24C,EAAQx4C,IAAKF,EAAQD,EAAM24C,EAAQz4C,YACxC,CACL,IAAI84C,EAASC,EAAUC,EAASC,EAC5B/E,GACF4E,EAAUd,GAAUW,GAAa3e,EAAQ6d,EAAWY,EAAQ34C,KAC5Di5C,EAAWf,EAASF,EAAYO,EAAMrmB,EAAMJ,EAAK,UACjDonB,EAAUhB,EAASH,EAAWQ,EAAMpmB,EAAIL,EAAK,SAC7CqnB,EAAWjB,GAAUY,GAAWhd,EAAOkc,EAAYY,EAAM34C,QAEzD+4C,EAAWd,EAAoBK,EAAMrmB,EAAMJ,EAAK,UAA5BimB,EACpBkB,GAAYf,GAAUW,GAAa3e,EAAQ8d,EAAYW,EAAQ14C,MAC/Di5C,GAAWhB,GAAUY,GAAWhd,EAAOic,EAAWa,EAAM54C,KACxDm5C,EAAYjB,EAAqBK,EAAMpmB,EAAIL,EAAK,SAA3BkmB,GAEvB10C,EAAI01C,EAASL,EAAQx4C,IAAK84C,EAAWD,EAASL,EAAQz4C,QAClDy4C,EAAQz4C,OAAS04C,EAAMz4C,KAAOmD,EAAIy0C,EAAUY,EAAQz4C,OAAQ,KAAM04C,EAAMz4C,KAC5EmD,EAAI41C,EAASN,EAAMz4C,IAAKg5C,EAAWD,EAASN,EAAM14C,UAG/C0tB,GAASiqB,GAAUc,EAAS/qB,GAAS,KAAKA,EAAQ+qB,GACnDd,GAAUe,EAAOhrB,GAAS,IAAKA,EAAQgrB,KACtC/qB,GAAOgqB,GAAUc,EAAS9qB,GAAO,KAAKA,EAAM8qB,GAC7Cd,GAAUe,EAAO/qB,GAAO,IAAKA,EAAM+qB,MAElC,CAAChrB,MAAOA,EAAOC,IAAKA,GAG7B,IAAIurB,EAAQ5sB,EAAM0F,OAAQmnB,EAAM7sB,EAAM2F,KACtC,GAAIinB,EAAMnkB,MAAQokB,EAAIpkB,KACpBkjB,EAAYiB,EAAMnkB,KAAMmkB,EAAMjoB,GAAIkoB,EAAIloB,QACjC,CACL,IAAImoB,EAAWrf,GAAQ5a,EAAK+5B,EAAMnkB,MAAOskB,EAAStf,GAAQ5a,EAAKg6B,EAAIpkB,MAC/DukB,EAAc/U,GAAW6U,IAAa7U,GAAW8U,GACjDE,EAAUtB,EAAYiB,EAAMnkB,KAAMmkB,EAAMjoB,GAAIqoB,EAAcF,EAASr9B,KAAK7W,OAAS,EAAI,MAAMyoB,IAC3F6rB,EAAavB,EAAYkB,EAAIpkB,KAAMukB,EAAc,EAAI,KAAMH,EAAIloB,IAAIvD,MACnE4rB,IACEC,EAAQt5C,IAAMu5C,EAAWv5C,IAAM,GACjCmD,EAAIm2C,EAAQx5C,MAAOw5C,EAAQt5C,IAAK,KAAMs5C,EAAQv5C,QAC9CoD,EAAIy0C,EAAU2B,EAAWv5C,IAAKu5C,EAAW15C,KAAM05C,EAAWx5C,SAE1DoD,EAAIm2C,EAAQx5C,MAAOw5C,EAAQt5C,IAAKu5C,EAAW15C,KAAOy5C,EAAQx5C,MAAOw5C,EAAQv5C,SAGzEu5C,EAAQv5C,OAASw5C,EAAWv5C,KAC5BmD,EAAIy0C,EAAU0B,EAAQv5C,OAAQ,KAAMw5C,EAAWv5C,KAGrDygC,EAAOroB,YAAYu/B,GAIrB,SAAS6B,GAAahkB,GACpB,GAAKA,EAAG4D,MAAMqgB,QAAd,CACA,IAAI37B,EAAU0X,EAAG1X,QACjB47B,cAAc57B,EAAQ67B,SACtB,IAAI3kB,GAAK,EACTlX,EAAQ87B,UAAUxmC,MAAMymC,WAAa,GACjCrkB,EAAGhd,QAAQshC,gBAAkB,EAC7Bh8B,EAAQ67B,QAAUI,aAAY,WAAc,OAAOj8B,EAAQ87B,UAAUxmC,MAAMymC,YAAc7kB,GAAMA,GAAM,GAAK,WAC1GQ,EAAGhd,QAAQshC,iBACNtkB,EAAGhd,QAAQshC,gBAAkB,IAClCh8B,EAAQ87B,UAAUxmC,MAAMymC,WAAa,WAG3C,SAASG,GAAYxkB,GACdA,EAAG4D,MAAMqgB,UAAWjkB,EAAG1X,QAAQwqB,MAAMpgB,QAAS+xB,GAAQzkB,IAG7D,SAAS0kB,GAAe1kB,GACtBA,EAAG4D,MAAM+gB,mBAAoB,EAC7B7uC,YAAW,WAAkBkqB,EAAG4D,MAAM+gB,oBACpC3kB,EAAG4D,MAAM+gB,mBAAoB,EAC7Bx9B,GAAO6Y,MACJ,KAGP,SAASykB,GAAQzkB,EAAI5iB,GACf4iB,EAAG4D,MAAM+gB,oBAAqB3kB,EAAG4D,MAAM+gB,mBAAoB,GAEpC,YAAvB3kB,EAAGhd,QAAQ4hC,WACV5kB,EAAG4D,MAAMqgB,UACZpkB,GAAOG,EAAI,QAASA,EAAI5iB,GACxB4iB,EAAG4D,MAAMqgB,SAAU,EACnBxjC,EAASuf,EAAG1X,QAAQgvB,QAAS,sBAIxBtX,EAAGO,OAASP,EAAG1X,QAAQu8B,mBAAqB7kB,EAAGtW,IAAI+3B,MACtDzhB,EAAG1X,QAAQwqB,MAAMgS,QACbpvB,GAAU5f,YAAW,WAAc,OAAOkqB,EAAG1X,QAAQwqB,MAAMgS,OAAM,KAAU,KAEjF9kB,EAAG1X,QAAQwqB,MAAMiS,iBAEnBf,GAAahkB,IAEf,SAAS7Y,GAAO6Y,EAAI5iB,GACd4iB,EAAG4D,MAAM+gB,oBAET3kB,EAAG4D,MAAMqgB,UACXpkB,GAAOG,EAAI,OAAQA,EAAI5iB,GACvB4iB,EAAG4D,MAAMqgB,SAAU,EACnBntB,EAAQkJ,EAAG1X,QAAQgvB,QAAS,uBAE9B4M,cAAclkB,EAAG1X,QAAQ67B,SACzBruC,YAAW,WAAmBkqB,EAAG4D,MAAMqgB,UAAWjkB,EAAG1X,QAAQ08B,OAAQ,KAAY,MAKnF,SAASC,GAAwBjlB,GAG/B,IAFA,IAAI1X,EAAU0X,EAAG1X,QACb48B,EAAa58B,EAAQ68B,QAAQpjC,UACxBxS,EAAI,EAAGA,EAAI+Y,EAAQyrB,KAAKtkC,OAAQF,IAAK,CAC5C,IAAIytB,EAAM1U,EAAQyrB,KAAKxkC,GAAIoqC,EAAW3Z,EAAGhd,QAAQ42B,aAC7Cl4B,OAAS,EAAUF,EAAQ,EAC/B,IAAIwb,EAAI4W,OAAR,CACA,GAAIre,GAAMC,EAAa,EAAG,CACxB,IAAI+lB,EAAMve,EAAIzI,KAAKxS,UAAYib,EAAIzI,KAAKC,aACxC9S,EAAS65B,EAAM2J,EACfA,EAAa3J,MACR,CACL,IAAI3qB,EAAMoM,EAAIzI,KAAKxO,wBACnBrE,EAASkP,EAAIrmB,OAASqmB,EAAIpmB,KAGrBmvC,GAAY3c,EAAI1W,KAAKyL,aACtBvQ,EAAQwb,EAAI1W,KAAKyL,WAAWhM,wBAAwBzb,MAAQsmB,EAAIvmB,KAAO,GAE7E,IAAI6a,EAAO8X,EAAIsC,KAAK5d,OAASA,EAC7B,IAAIwD,EAAO,MAAQA,GAAQ,QACzB8f,GAAiBhI,EAAIsC,KAAM5d,GAC3B0jC,GAAmBpoB,EAAIsC,MACnBtC,EAAI8T,MAAQ,IAAK,IAAIxS,EAAI,EAAGA,EAAItB,EAAI8T,KAAKrhC,OAAQ6uB,IACjD8mB,GAAmBpoB,EAAI8T,KAAKxS,IAElC,GAAI9c,EAAQwe,EAAG1X,QAAQg6B,WAAY,CACjC,IAAI+C,EAAUnlD,KAAK2P,KAAK2R,EAAQ25B,GAAUnb,EAAG1X,UACzC+8B,EAAUrlB,EAAG1X,QAAQwnB,gBACvB9P,EAAG1X,QAAQwnB,cAAgBuV,EAC3BrlB,EAAG1X,QAAQunB,QAAU7S,EAAIsC,KACzBU,EAAG1X,QAAQynB,gBAAiB,MAQpC,SAASqV,GAAmB9lB,GAC1B,GAAIA,EAAKoX,QAAW,IAAK,IAAInnC,EAAI,EAAGA,EAAI+vB,EAAKoX,QAAQjnC,SAAUF,EAAG,CAChE,IAAIrJ,EAAIo5B,EAAKoX,QAAQnnC,GAAI0L,EAAS/U,EAAEquB,KAAKmD,WACrCzc,IAAU/U,EAAEwb,OAASzG,EAAOuZ,eAOpC,SAAS8wB,GAAah9B,EAASoB,EAAK67B,GAClC,IAAI/6C,EAAM+6C,GAA4B,MAAhBA,EAAS/6C,IAActK,KAAKoP,IAAI,EAAGi2C,EAAS/6C,KAAO8d,EAAQiwB,SAASqE,UAC1FpyC,EAAMtK,KAAK4P,MAAMtF,EAAMotC,GAAWtvB,IAClC,IAAI/d,EAASg7C,GAA+B,MAAnBA,EAASh7C,OAAiBg7C,EAASh7C,OAASC,EAAM8d,EAAQgvB,QAAQoB,aAEvFnc,EAAO4I,GAAazb,EAAKlf,GAAMgyB,EAAK2I,GAAazb,EAAKnf,GAG1D,GAAIg7C,GAAYA,EAASC,OAAQ,CAC/B,IAAIC,EAAaF,EAASC,OAAOjpB,KAAK+C,KAAMomB,EAAWH,EAASC,OAAOhpB,GAAG8C,KACtEmmB,EAAalpB,GACfA,EAAOkpB,EACPjpB,EAAK2I,GAAazb,EAAK8lB,GAAalL,GAAQ5a,EAAK+7B,IAAen9B,EAAQgvB,QAAQoB,eACvEx4C,KAAK6P,IAAI21C,EAAUh8B,EAAI0lB,aAAe5S,IAC/CD,EAAO4I,GAAazb,EAAK8lB,GAAalL,GAAQ5a,EAAKg8B,IAAap9B,EAAQgvB,QAAQoB,cAChFlc,EAAKkpB,GAGT,MAAO,CAACnpB,KAAMA,EAAMC,GAAIt8B,KAAKoP,IAAIktB,EAAID,EAAO,IAoE9C,SAASopB,GAAmB3lB,EAAIuZ,GAC9B,IAAIjxB,EAAU0X,EAAG1X,QAASs9B,EAAavG,GAAWrf,EAAG1X,SACjDixB,EAAK/uC,IAAM,IAAK+uC,EAAK/uC,IAAM,GAC/B,IAAIq7C,EAAY7lB,EAAGO,OAA+B,MAAtBP,EAAGO,MAAMqc,UAAoB5c,EAAGO,MAAMqc,UAAYt0B,EAAQiwB,SAASqE,UAC3FrC,EAAS9B,GAAczY,GAAKxnB,EAAS,GACrC+gC,EAAKhvC,OAASgvC,EAAK/uC,IAAM+vC,IAAUhB,EAAKhvC,OAASgvC,EAAK/uC,IAAM+vC,GAChE,IAAIuL,EAAY9lB,EAAGtW,IAAIhI,OAASo2B,GAAYxvB,GACxCy9B,EAAQxM,EAAK/uC,IAAMo7C,EAAYI,EAAWzM,EAAKhvC,OAASu7C,EAAYF,EACxE,GAAIrM,EAAK/uC,IAAMq7C,EACbrtC,EAAOokC,UAAYmJ,EAAQ,EAAIxM,EAAK/uC,SAC/B,GAAI+uC,EAAKhvC,OAASs7C,EAAYtL,EAAQ,CAC3C,IAAI0L,EAAS/lD,KAAK6P,IAAIwpC,EAAK/uC,KAAMw7C,EAAWF,EAAYvM,EAAKhvC,QAAUgwC,GACnE0L,GAAUJ,IAAartC,EAAOokC,UAAYqJ,GAGhD,IAAIC,EAAalmB,EAAGO,OAAgC,MAAvBP,EAAGO,MAAMkc,WAAqBzc,EAAGO,MAAMkc,WAAan0B,EAAQiwB,SAASkE,WAC9F0J,EAAU7N,GAAatY,IAAOA,EAAGhd,QAAQwyB,YAAcltB,EAAQ+uB,QAAQ5V,YAAc,GACrF2kB,EAAU7M,EAAKjvC,MAAQivC,EAAKlvC,KAAO87C,EAQvC,OAPIC,IAAW7M,EAAKjvC,MAAQivC,EAAKlvC,KAAO87C,GACpC5M,EAAKlvC,KAAO,GACZmO,EAAOikC,WAAa,EACflD,EAAKlvC,KAAO67C,EACjB1tC,EAAOikC,WAAav8C,KAAKoP,IAAI,EAAGiqC,EAAKlvC,MAAQ+7C,EAAU,EAAI,KACtD7M,EAAKjvC,MAAQ67C,EAAUD,EAAa,IACzC1tC,EAAOikC,WAAalD,EAAKjvC,OAAS87C,EAAU,EAAI,IAAMD,GACnD3tC,EAKT,SAAS6tC,GAAermB,EAAIx1B,GACf,MAAPA,IACJ87C,GAAmBtmB,GACnBA,EAAGO,MAAMqc,WAAmC,MAAtB5c,EAAGO,MAAMqc,UAAoB5c,EAAGtW,IAAIkzB,UAAY5c,EAAGO,MAAMqc,WAAapyC,GAK9F,SAAS+7C,GAAoBvmB,GAC3BsmB,GAAmBtmB,GACnB,IAAIhD,EAAMgD,EAAGwmB,YACbxmB,EAAGO,MAAMkmB,YAAc,CAAClqB,KAAMS,EAAKR,GAAIQ,EAAK0pB,OAAQ1mB,EAAGhd,QAAQ2jC,oBAGjE,SAASC,GAAe5mB,EAAI17B,EAAGC,GACpB,MAALD,GAAkB,MAALC,GAAa+hD,GAAmBtmB,GACxC,MAAL17B,IAAa07B,EAAGO,MAAMkc,WAAan4C,GAC9B,MAALC,IAAay7B,EAAGO,MAAMqc,UAAYr4C,GAYxC,SAAS+hD,GAAmBtmB,GAC1B,IAAInJ,EAAQmJ,EAAGO,MAAMkmB,YACjB5vB,IACFmJ,EAAGO,MAAMkmB,YAAc,KAEvBI,GAAoB7mB,EADT8d,GAAe9d,EAAInJ,EAAM0F,MAAYuhB,GAAe9d,EAAInJ,EAAM2F,IACvC3F,EAAM6vB,SAI5C,SAASG,GAAoB7mB,EAAIzD,EAAMC,EAAIkqB,GACzC,IAAII,EAAOnB,GAAmB3lB,EAAI,CAChC31B,KAAMnK,KAAK6P,IAAIwsB,EAAKlyB,KAAMmyB,EAAGnyB,MAC7BG,IAAKtK,KAAK6P,IAAIwsB,EAAK/xB,IAAKgyB,EAAGhyB,KAAOk8C,EAClCp8C,MAAOpK,KAAKoP,IAAIitB,EAAKjyB,MAAOkyB,EAAGlyB,OAC/BC,OAAQrK,KAAKoP,IAAIitB,EAAKhyB,OAAQiyB,EAAGjyB,QAAUm8C,IAE7CE,GAAe5mB,EAAI8mB,EAAKrK,WAAYqK,EAAKlK,WAK3C,SAASmK,GAAgB/mB,EAAIziB,GACvBrd,KAAKoN,IAAI0yB,EAAGtW,IAAIkzB,UAAYr/B,GAAO,IAClC2X,GAAS8xB,GAAoBhnB,EAAI,CAACx1B,IAAK+S,IAC5C0pC,GAAajnB,EAAIziB,GAAK,GAClB2X,GAAS8xB,GAAoBhnB,GACjCknB,GAAYlnB,EAAI,MAGlB,SAASinB,GAAajnB,EAAIziB,EAAK4pC,GAC7B5pC,EAAMrd,KAAKoP,IAAI,EAAGpP,KAAK6P,IAAIiwB,EAAG1X,QAAQiwB,SAAS6O,aAAepnB,EAAG1X,QAAQiwB,SAASG,aAAcn7B,KAC5FyiB,EAAG1X,QAAQiwB,SAASqE,WAAar/B,GAAQ4pC,KAC7CnnB,EAAGtW,IAAIkzB,UAAYr/B,EACnByiB,EAAG1X,QAAQ++B,WAAWJ,aAAa1pC,GAC/ByiB,EAAG1X,QAAQiwB,SAASqE,WAAar/B,IAAOyiB,EAAG1X,QAAQiwB,SAASqE,UAAYr/B,IAK9E,SAAS+pC,GAActnB,EAAIziB,EAAKgqC,EAAYJ,GAC1C5pC,EAAMrd,KAAKoP,IAAI,EAAGpP,KAAK6P,IAAIwN,EAAKyiB,EAAG1X,QAAQiwB,SAASiP,YAAcxnB,EAAG1X,QAAQiwB,SAAShB,eACjFgQ,EAAahqC,GAAOyiB,EAAGtW,IAAI+yB,WAAav8C,KAAKoN,IAAI0yB,EAAGtW,IAAI+yB,WAAal/B,GAAO,KAAO4pC,IACxFnnB,EAAGtW,IAAI+yB,WAAal/B,EACpBkqC,GAAkBznB,GACdA,EAAG1X,QAAQiwB,SAASkE,YAAcl/B,IAAOyiB,EAAG1X,QAAQiwB,SAASkE,WAAal/B,GAC9EyiB,EAAG1X,QAAQ++B,WAAWC,cAAc/pC,IAOtC,SAASmqC,GAAqB1nB,GAC5B,IAAIpvB,EAAIovB,EAAG1X,QAASq/B,EAAU/2C,EAAEymC,QAAQ5V,YACpCmmB,EAAO1nD,KAAK8P,MAAMgwB,EAAGtW,IAAIhI,OAASo2B,GAAY9X,EAAG1X,UACrD,MAAO,CACLowB,aAAc9nC,EAAE2nC,SAASG,aACzBmP,WAAYj3C,EAAE0mC,QAAQoB,aACtB8O,YAAa52C,EAAE2nC,SAASiP,YAAajQ,YAAa3mC,EAAE2nC,SAAShB,YAC7DuQ,UAAWl3C,EAAE0mC,QAAQC,YACrBwQ,QAAS/nB,EAAGhd,QAAQwyB,YAAcmS,EAAU,EAC5CK,UAAWJ,EACXR,aAAcQ,EAAOxP,GAAUpY,GAAMpvB,EAAE+nC,UACvCN,eAAgBznC,EAAEynC,eAClBlC,YAAawR,GAIjB,IAAIM,GAAmB,SAAS/N,EAAO7f,EAAQ2F,GAC7CtrB,KAAKsrB,GAAKA,EACV,IAAI7hB,EAAOzJ,KAAKyJ,KAAOgZ,EAAI,MAAO,CAACA,EAAI,MAAO,KAAM,KAAM,mBAAoB,yBAC1E+wB,EAAQxzC,KAAKwzC,MAAQ/wB,EAAI,MAAO,CAACA,EAAI,MAAO,KAAM,KAAM,kCAAmC,yBAC/FhZ,EAAKgqC,SAAWD,EAAMC,UAAY,EAClCjO,EAAM/7B,GAAO+7B,EAAMgO,GAEnB1oB,GAAGrhB,EAAM,UAAU,WACbA,EAAKu6B,cAAgBre,EAAOlc,EAAKy+B,UAAW,eAElDpd,GAAG0oB,EAAO,UAAU,WACdA,EAAM3Q,aAAeld,EAAO6tB,EAAMzL,WAAY,iBAGpD/nC,KAAK0zC,kBAAmB,EAEpB7yB,GAAMC,EAAa,IAAK9gB,KAAKwzC,MAAMtqC,MAAMyqC,UAAY3zC,KAAKyJ,KAAKP,MAAM0qC,SAAW,SAGtFL,GAAiB7zC,UAAUm0C,OAAS,SAAU/mB,GAC5C,IAAIgnB,EAAShnB,EAAQgmB,YAAchmB,EAAQ+V,YAAc,EACrDkR,EAASjnB,EAAQ4lB,aAAe5lB,EAAQkX,aAAe,EACvDgQ,EAASlnB,EAAQ6W,eAErB,GAAIoQ,EAAQ,CACV/zC,KAAKyJ,KAAKP,MAAM0K,QAAU,QAC1B5T,KAAKyJ,KAAKP,MAAMrT,OAASi+C,EAASE,EAAS,KAAO,IAClD,IAAIC,EAAcnnB,EAAQqmB,YAAcW,EAASE,EAAS,GAE1Dh0C,KAAKyJ,KAAK4T,WAAWnU,MAAM8D,OACzBxhB,KAAKoP,IAAI,EAAGkyB,EAAQ4lB,aAAe5lB,EAAQkX,aAAeiQ,GAAe,UAE3Ej0C,KAAKyJ,KAAKP,MAAM0K,QAAU,GAC1B5T,KAAKyJ,KAAK4T,WAAWnU,MAAM8D,OAAS,IAGtC,GAAI8mC,EAAQ,CACV9zC,KAAKwzC,MAAMtqC,MAAM0K,QAAU,QAC3B5T,KAAKwzC,MAAMtqC,MAAMtT,MAAQm+C,EAASC,EAAS,KAAO,IAClDh0C,KAAKwzC,MAAMtqC,MAAMvT,KAAOm3B,EAAQumB,QAAU,KAC1C,IAAIa,EAAapnB,EAAQsmB,UAAYtmB,EAAQumB,SAAWU,EAASC,EAAS,GAC1Eh0C,KAAKwzC,MAAMn2B,WAAWnU,MAAM4D,MAC1BthB,KAAKoP,IAAI,EAAGkyB,EAAQgmB,YAAchmB,EAAQ+V,YAAcqR,GAAc,UAExEl0C,KAAKwzC,MAAMtqC,MAAM0K,QAAU,GAC3B5T,KAAKwzC,MAAMn2B,WAAWnU,MAAM4D,MAAQ,IAQtC,OALK9M,KAAK0zC,kBAAoB5mB,EAAQkX,aAAe,IACrC,GAAVgQ,GAAeh0C,KAAKm0C,gBACxBn0C,KAAK0zC,kBAAmB,GAGnB,CAAC99C,MAAOm+C,EAASC,EAAS,EAAGn+C,OAAQi+C,EAASE,EAAS,IAGhET,GAAiB7zC,UAAUkzC,cAAgB,SAAU3sB,GAC/CjmB,KAAKwzC,MAAMzL,YAAc9hB,IAAOjmB,KAAKwzC,MAAMzL,WAAa9hB,GACxDjmB,KAAKo0C,cAAgBp0C,KAAKq0C,mBAAmBr0C,KAAKwzC,MAAOxzC,KAAKo0C,aAAc,UAGlFb,GAAiB7zC,UAAU6yC,aAAe,SAAUtsB,GAC9CjmB,KAAKyJ,KAAKy+B,WAAajiB,IAAOjmB,KAAKyJ,KAAKy+B,UAAYjiB,GACpDjmB,KAAKs0C,aAAet0C,KAAKq0C,mBAAmBr0C,KAAKyJ,KAAMzJ,KAAKs0C,YAAa,SAG/Ef,GAAiB7zC,UAAUy0C,cAAgB,WACzC,IAAI3iD,EAAIkwB,IAAQL,EAAqB,OAAS,OAC9CrhB,KAAKwzC,MAAMtqC,MAAM8D,OAAShN,KAAKyJ,KAAKP,MAAM4D,MAAQtb,EAClDwO,KAAKwzC,MAAMtqC,MAAMqrC,cAAgBv0C,KAAKyJ,KAAKP,MAAMqrC,cAAgB,OACjEv0C,KAAKo0C,aAAe,IAAInvB,EACxBjlB,KAAKs0C,YAAc,IAAIrvB,GAGzBsuB,GAAiB7zC,UAAU20C,mBAAqB,SAAUG,EAAKC,EAAOjnC,GACpEgnC,EAAItrC,MAAMqrC,cAAgB,OAc1BE,EAAMxnD,IAAI,KAbV,SAASynD,IAOP,IAAIx4B,EAAMs4B,EAAInjC,yBACI,QAAR7D,EAAiB1F,SAAS6sC,iBAAiBz4B,EAAItmB,MAAQ,GAAIsmB,EAAIpmB,IAAMomB,EAAIrmB,QAAU,GACvFiS,SAAS6sC,kBAAkBz4B,EAAItmB,MAAQsmB,EAAIvmB,MAAQ,EAAGumB,EAAIrmB,OAAS,KAC9D2+C,EAAOA,EAAItrC,MAAMqrC,cAAgB,OACrCE,EAAMxnD,IAAI,IAAMynD,OAK3BnB,GAAiB7zC,UAAUk1C,MAAQ,WACjC,IAAIruC,EAASvG,KAAKwzC,MAAMxwB,WACxBzc,EAAO2Y,YAAYlf,KAAKwzC,OACxBjtC,EAAO2Y,YAAYlf,KAAKyJ,OAG1B,IAAIorC,GAAiB,aAOrB,SAASC,GAAiBxpB,EAAIwB,GACvBA,IAAWA,EAAUkmB,GAAqB1nB,IAC/C,IAAIypB,EAAazpB,EAAG1X,QAAQkwB,SAAUkR,EAAc1pB,EAAG1X,QAAQqwB,UAC/DgR,GAAsB3pB,EAAIwB,GAC1B,IAAK,IAAIjyB,EAAI,EAAGA,EAAI,GAAKk6C,GAAczpB,EAAG1X,QAAQkwB,UAAYkR,GAAe1pB,EAAG1X,QAAQqwB,UAAWppC,IAC7Fk6C,GAAczpB,EAAG1X,QAAQkwB,UAAYxY,EAAGhd,QAAQ42B,cAChDqL,GAAwBjlB,GAC5B2pB,GAAsB3pB,EAAI0nB,GAAqB1nB,IAC/CypB,EAAazpB,EAAG1X,QAAQkwB,SAAUkR,EAAc1pB,EAAG1X,QAAQqwB,UAM/D,SAASgR,GAAsB3pB,EAAIwB,GACjC,IAAI5wB,EAAIovB,EAAG1X,QACPshC,EAAQh5C,EAAEy2C,WAAWkB,OAAO/mB,GAEhC5wB,EAAE8mC,MAAM95B,MAAMu6B,cAAgBvnC,EAAE4nC,SAAWoR,EAAMt/C,OAAS,KAC1DsG,EAAE8mC,MAAM95B,MAAMisC,eAAiBj5C,EAAE+nC,UAAYiR,EAAMr/C,QAAU,KAC7DqG,EAAEk5C,aAAalsC,MAAMmsC,aAAeH,EAAMr/C,OAAS,uBAE/Cq/C,EAAMt/C,OAASs/C,EAAMr/C,QACvBqG,EAAEo5C,gBAAgBpsC,MAAM0K,QAAU,QAClC1X,EAAEo5C,gBAAgBpsC,MAAM8D,OAASkoC,EAAMr/C,OAAS,KAChDqG,EAAEo5C,gBAAgBpsC,MAAM4D,MAAQooC,EAAMt/C,MAAQ,MACvCsG,EAAEo5C,gBAAgBpsC,MAAM0K,QAAU,GACvCshC,EAAMr/C,QAAUy1B,EAAGhd,QAAQinC,4BAA8BjqB,EAAGhd,QAAQwyB,aACtE5kC,EAAEs5C,aAAatsC,MAAM0K,QAAU,QAC/B1X,EAAEs5C,aAAatsC,MAAM8D,OAASkoC,EAAMr/C,OAAS,KAC7CqG,EAAEs5C,aAAatsC,MAAM4D,MAAQggB,EAAQ2U,YAAc,MAC5CvlC,EAAEs5C,aAAatsC,MAAM0K,QAAU,GApC1CihC,GAAen1C,UAAUm0C,OAAS,WAAc,MAAO,CAACh+C,OAAQ,EAAGD,MAAO,IAC1Ei/C,GAAen1C,UAAUkzC,cAAgB,aACzCiC,GAAen1C,UAAU6yC,aAAe,aACxCsC,GAAen1C,UAAUk1C,MAAQ,aAoCjC,IAAIa,GAAiB,CAAC,OAAUlC,GAAkB,KAAQsB,IAE1D,SAASa,GAAepqB,GAClBA,EAAG1X,QAAQ++B,aACbrnB,EAAG1X,QAAQ++B,WAAWiC,QAClBtpB,EAAG1X,QAAQ++B,WAAW5mC,UACtBqW,EAAQkJ,EAAG1X,QAAQgvB,QAAStX,EAAG1X,QAAQ++B,WAAW5mC,WAGxDuf,EAAG1X,QAAQ++B,WAAa,IAAI8C,GAAenqB,EAAGhd,QAAQqnC,iBAAgB,SAAU91B,GAC9EyL,EAAG1X,QAAQgvB,QAAQppB,aAAaqG,EAAMyL,EAAG1X,QAAQ0hC,iBAEjDxqB,GAAGjL,EAAM,aAAa,WAChByL,EAAG4D,MAAMqgB,SAAWnuC,YAAW,WAAc,OAAOkqB,EAAG1X,QAAQwqB,MAAMpgB,UAAY,MAEvF6B,EAAK7R,aAAa,iBAAkB,WACnC,SAAUiY,EAAKh2B,GACJ,cAARA,EAAwB2iD,GAActnB,EAAIrF,GACvCosB,GAAgB/mB,EAAIrF,KAC1BqF,GACCA,EAAG1X,QAAQ++B,WAAW5mC,UACtBA,EAASuf,EAAG1X,QAAQgvB,QAAStX,EAAG1X,QAAQ++B,WAAW5mC,UASzD,IAAI6pC,GAAW,EAEf,SAASC,GAAevqB,GAntDxB,IAAuBwqB,EAotDrBxqB,EAAGO,MAAQ,CACTP,GAAIA,EACJsgB,aAAa,EACboJ,YAAa1pB,EAAGtW,IAAIhI,OACpB03B,aAAa,EACbqR,YAAa,EACbC,QAAQ,EACRC,WAAY,KACZnqB,uBAAwB,KACxBoqB,qBAAsB,EACtBC,kBAAkB,EAClBC,eAAe,EACfrO,WAAY,KAAMG,UAAW,KAC7B6J,YAAa,KACb/zB,OAAO,EACPkH,KAAM0wB,IAnuDaE,EAquDPxqB,EAAGO,MApuDbyT,GACFA,GAAe+W,IAAIlqC,KAAK2pC,GAExBA,EAAGQ,UAAYhX,GAAiB,CAC9B+W,IAAK,CAACP,GACNpW,iBAAkB,IAmuDxB,SAAS6W,GAAajrB,GACpB,IAAIwqB,EAAKxqB,EAAGO,MACRiqB,GAhtDN,SAAyBA,EAAIU,GAC3B,IAAIC,EAAQX,EAAGQ,UACf,GAAKG,EAEL,KApBF,SAA6BA,GAG3B,IAAIC,EAAYD,EAAM/W,iBAAkB7kC,EAAI,EAC5C,EAAG,CACD,KAAOA,EAAI67C,EAAU37C,OAAQF,IACzB67C,EAAU77C,GAAGqF,KAAK,MACtB,IAAK,IAAI0pB,EAAI,EAAGA,EAAI6sB,EAAMJ,IAAIt7C,OAAQ6uB,IAAK,CACzC,IAAIksB,EAAKW,EAAMJ,IAAIzsB,GACnB,GAAIksB,EAAGhqB,uBACH,KAAOgqB,EAAGI,qBAAuBJ,EAAGhqB,uBAAuB/wB,QACzD+6C,EAAGhqB,uBAAuBgqB,EAAGI,wBAAwBh2C,KAAK,KAAM41C,EAAGxqB,WAEpEzwB,EAAI67C,EAAU37C,QAOjB47C,CAAoBF,GAC1B,QACEnX,GAAiB,KACjBkX,EAAMC,IAysDEG,CAAgBd,GAAI,SAAUW,GACtC,IAAK,IAAI57C,EAAI,EAAGA,EAAI47C,EAAMJ,IAAIt7C,OAAQF,IAClC47C,EAAMJ,IAAIx7C,GAAGywB,GAAGO,MAAQ,MAOhC,SAAuB4qB,GAErB,IADA,IAAIJ,EAAMI,EAAMJ,IACPx7C,EAAI,EAAGA,EAAIw7C,EAAIt7C,OAAQF,IAC5Bg8C,GAAgBR,EAAIx7C,IACxB,IAAK,IAAIsuB,EAAM,EAAGA,EAAMktB,EAAIt7C,OAAQouB,IAChC2tB,GAAgBT,EAAIltB,IACxB,IAAK,IAAIE,EAAM,EAAGA,EAAMgtB,EAAIt7C,OAAQsuB,IAChC0tB,GAAgBV,EAAIhtB,IACxB,IAAK,IAAIE,EAAM,EAAGA,EAAM8sB,EAAIt7C,OAAQwuB,IAChCytB,GAAgBX,EAAI9sB,IACxB,IAAK,IAAIG,EAAM,EAAGA,EAAM2sB,EAAIt7C,OAAQ2uB,IAChCutB,GAAoBZ,EAAI3sB,IAjB1BwtB,CAAcT,MAoBlB,SAASI,GAAgBf,GACvB,IAAIxqB,EAAKwqB,EAAGxqB,GAAI1X,EAAU0X,EAAG1X,SAmN/B,SAA6B0X,GAC3B,IAAI1X,EAAU0X,EAAG1X,SACZA,EAAQujC,mBAAqBvjC,EAAQiwB,SAAS9W,cACjDnZ,EAAQ+vB,eAAiB/vB,EAAQiwB,SAAS9W,YAAcnZ,EAAQiwB,SAAShB,YACzEjvB,EAAQwhC,aAAalsC,MAAM8D,OAAS02B,GAAUpY,GAAM,KACpD1X,EAAQovB,MAAM95B,MAAMkuC,cAAgBxjC,EAAQ+vB,eAAiB,KAC7D/vB,EAAQovB,MAAM95B,MAAMmuC,iBAAmB3T,GAAUpY,GAAM,KACvD1X,EAAQujC,mBAAoB,GAzN9BG,CAAoBhsB,GAChBwqB,EAAGM,eAAiBlb,GAAY5P,GAEpCwqB,EAAGyB,WAAazB,EAAGlK,aAAekK,EAAGpR,aAA+B,MAAhBoR,EAAG5N,WACrD4N,EAAG/D,cAAgB+D,EAAG/D,YAAYlqB,KAAK+C,KAAOhX,EAAQ6hB,UACnCqgB,EAAG/D,YAAYjqB,GAAG8C,MAAQhX,EAAQ8hB,SACrD9hB,EAAQynB,gBAAkB/P,EAAGhd,QAAQ42B,aACvC4Q,EAAGjC,OAASiC,EAAGyB,YACb,IAAIC,GAAclsB,EAAIwqB,EAAGyB,YAAc,CAACzhD,IAAKggD,EAAG5N,UAAW4I,OAAQgF,EAAG/D,aAAc+D,EAAGpR,aAG3F,SAASoS,GAAgBhB,GACvBA,EAAG2B,eAAiB3B,EAAGyB,YAAcG,GAAsB5B,EAAGxqB,GAAIwqB,EAAGjC,QAGvE,SAASkD,GAAgBjB,GACvB,IAAIxqB,EAAKwqB,EAAGxqB,GAAI1X,EAAU0X,EAAG1X,QACzBkiC,EAAG2B,gBAAkBlH,GAAwBjlB,GAEjDwqB,EAAG6B,WAAa3E,GAAqB1nB,GAKjC1X,EAAQynB,iBAAmB/P,EAAGhd,QAAQ42B,eACxC4Q,EAAG8B,cAAgBzT,GAAY7Y,EAAI1X,EAAQunB,QAASvnB,EAAQunB,QAAQvpB,KAAK7W,QAAQpF,KAAO,EACxF21B,EAAG1X,QAAQg6B,WAAakI,EAAG8B,cAC3B9B,EAAG6B,WAAW7E,YACZtnD,KAAKoP,IAAIgZ,EAAQiwB,SAAShB,YAAajvB,EAAQovB,MAAM51B,WAAa0oC,EAAG8B,cAAgBlU,GAAUpY,GAAMA,EAAG1X,QAAQkwB,UAClHgS,EAAG+B,cAAgBrsD,KAAKoP,IAAI,EAAGgZ,EAAQovB,MAAM51B,WAAa0oC,EAAG8B,cAAgBhU,GAAatY,MAGxFwqB,EAAG2B,gBAAkB3B,EAAGK,oBACxBL,EAAGgC,kBAAoBlkC,EAAQwqB,MAAMsO,oBAG3C,SAASsK,GAAgBlB,GACvB,IAAIxqB,EAAKwqB,EAAGxqB,GAEY,MAApBwqB,EAAG8B,gBACLtsB,EAAG1X,QAAQovB,MAAM95B,MAAM0qC,SAAWkC,EAAG8B,cAAgB,KACjD9B,EAAG+B,cAAgBvsB,EAAGtW,IAAI+yB,YAC1B6K,GAActnB,EAAI9/B,KAAK6P,IAAIiwB,EAAG1X,QAAQiwB,SAASkE,WAAY+N,EAAG+B,gBAAgB,GAClFvsB,EAAG1X,QAAQynB,gBAAiB,GAG9B,IAAI0c,EAAYjC,EAAG93B,OAAS83B,EAAG93B,OAASkF,IACpC4yB,EAAGgC,mBACHxsB,EAAG1X,QAAQwqB,MAAMqO,cAAcqJ,EAAGgC,kBAAmBC,IACrDjC,EAAG2B,gBAAkB3B,EAAGd,aAAe1pB,EAAGtW,IAAIhI,SAC9C8nC,GAAiBxpB,EAAIwqB,EAAG6B,YACxB7B,EAAG2B,gBACHO,GAAkB1sB,EAAIwqB,EAAG6B,YAEzB7B,EAAGK,kBAAoB7G,GAAahkB,GAEpCA,EAAG4D,MAAMqgB,SAAWuG,EAAGC,aACvBzqB,EAAG1X,QAAQwqB,MAAMgS,MAAM0F,EAAGE,QAC1B+B,GAAajI,GAAYgG,EAAGxqB,IAGlC,SAAS2rB,GAAoBnB,GAC3B,IAAIxqB,EAAKwqB,EAAGxqB,GAAI1X,EAAU0X,EAAG1X,QAASoB,EAAMsW,EAAGtW,IAE3C8gC,EAAG2B,gBAAkBQ,GAAkB3sB,EAAIwqB,EAAGjC,QAGvB,MAAvBjgC,EAAQskC,aAAwC,MAAhBpC,EAAG5N,WAAsC,MAAjB4N,EAAG/N,aAAsB+N,EAAG/D,cACpFn+B,EAAQskC,YAActkC,EAAQukC,YAAc,MAG5B,MAAhBrC,EAAG5N,WAAqBqK,GAAajnB,EAAIwqB,EAAG5N,UAAW4N,EAAGrD,aAEzC,MAAjBqD,EAAG/N,YAAsB6K,GAActnB,EAAIwqB,EAAG/N,YAAY,GAAM,GAEhE+N,EAAG/D,aAneT,SAA2BzmB,EAAIuZ,GAC7B,IAAIxZ,GAAeC,EAAI,wBAAvB,CAEA,IAAI1X,EAAU0X,EAAG1X,QAASsI,EAAMtI,EAAQovB,MAAM3xB,wBAAyB+mC,EAAW,KAGlF,GAFIvT,EAAK/uC,IAAMomB,EAAIpmB,IAAM,EAAKsiD,GAAW,EAChCvT,EAAKhvC,OAASqmB,EAAIpmB,KAAO4U,OAAO6L,aAAezO,SAASggC,gBAAgB9D,gBAAiBoU,GAAW,GAC7F,MAAZA,IAAqB92B,EAAS,CAChC,IAAI+2B,EAAa51B,EAAI,MAAO,IAAU,KAAO,uDAAyDoiB,EAAK/uC,IAAM8d,EAAQ20B,WAAarF,GAAW5X,EAAG1X,UAAY,0CAA4CixB,EAAKhvC,OAASgvC,EAAK/uC,IAAM4tC,GAAUpY,GAAM1X,EAAQqwB,WAAa,uCAA0CY,EAAS,KAAI,cAAiBr5C,KAAKoP,IAAI,EAAGiqC,EAAKjvC,MAAQivC,EAAKlvC,MAAS,OACzX21B,EAAG1X,QAAQuvB,UAAUj1B,YAAYmqC,GACjCA,EAAWC,eAAeF,GAC1B9sB,EAAG1X,QAAQuvB,UAAUjkB,YAAYm5B,KA4djCE,CAAkBjtB,EArdtB,SAA2BA,EAAIrF,EAAKzC,EAAKwuB,GAEvC,IAAInN,EADU,MAAVmN,IAAkBA,EAAS,GAE1B1mB,EAAGhd,QAAQ42B,cAAgBjf,GAAOzC,IAKrCA,EAAoB,WADpByC,EAAMA,EAAIa,GAAKmK,GAAIhL,EAAI2E,KAAoB,UAAd3E,EAAImC,OAAqBnC,EAAIa,GAAK,EAAIb,EAAIa,GAAI,SAAWb,GAC5EmC,OAAqB6I,GAAIhL,EAAI2E,KAAM3E,EAAIa,GAAK,EAAG,UAAYb,GAEvE,IAAK,IAAIuyB,EAAQ,EAAGA,EAAQ,EAAGA,IAAS,CACtC,IAAIC,GAAU,EACV9P,EAASI,GAAazd,EAAIrF,GAC1ByyB,EAAal1B,GAAOA,GAAOyC,EAAe8iB,GAAazd,EAAI9H,GAA1BmlB,EAKjCgQ,EAAY1H,GAAmB3lB,EAJnCuZ,EAAO,CAAClvC,KAAMnK,KAAK6P,IAAIstC,EAAOhzC,KAAM+iD,EAAU/iD,MACtCG,IAAKtK,KAAK6P,IAAIstC,EAAO7yC,IAAK4iD,EAAU5iD,KAAOk8C,EAC3Cp8C,MAAOpK,KAAKoP,IAAI+tC,EAAOhzC,KAAM+iD,EAAU/iD,MACvCE,OAAQrK,KAAKoP,IAAI+tC,EAAO9yC,OAAQ6iD,EAAU7iD,QAAUm8C,IAExD4G,EAAWttB,EAAGtW,IAAIkzB,UAAW2Q,EAAYvtB,EAAGtW,IAAI+yB,WASpD,GAR2B,MAAvB4Q,EAAUzQ,YACZmK,GAAgB/mB,EAAIqtB,EAAUzQ,WAC1B18C,KAAKoN,IAAI0yB,EAAGtW,IAAIkzB,UAAY0Q,GAAY,IAAKH,GAAU,IAEjC,MAAxBE,EAAU5Q,aACZ6K,GAActnB,EAAIqtB,EAAU5Q,YACxBv8C,KAAKoN,IAAI0yB,EAAGtW,IAAI+yB,WAAa8Q,GAAa,IAAKJ,GAAU,KAE1DA,EAAW,MAElB,OAAO5T,EAqbMiU,CAAkBxtB,EAAIkG,GAAQxc,EAAK8gC,EAAG/D,YAAYlqB,MAChC2J,GAAQxc,EAAK8gC,EAAG/D,YAAYjqB,IAAKguB,EAAG/D,YAAYC,SAM/E,IAAI9S,EAAS4W,EAAGiD,mBAAoBC,EAAWlD,EAAGmD,qBAClD,GAAI/Z,EAAU,IAAK,IAAIrkC,EAAI,EAAGA,EAAIqkC,EAAOnkC,SAAUF,EAC1CqkC,EAAOrkC,GAAGm1B,MAAMj1B,QAAUowB,GAAO+T,EAAOrkC,GAAI,QACrD,GAAIm+C,EAAY,IAAK,IAAI7vB,EAAM,EAAGA,EAAM6vB,EAASj+C,SAAUouB,EACnD6vB,EAAS7vB,GAAK6G,MAAMj1B,QAAUowB,GAAO6tB,EAAS7vB,GAAM,UAExDvV,EAAQgvB,QAAQ9iB,eAChB9K,EAAIkzB,UAAY5c,EAAG1X,QAAQiwB,SAASqE,WAGpC4N,EAAGG,YACH9qB,GAAOG,EAAI,UAAWA,EAAIwqB,EAAGG,YAC7BH,EAAGjC,QACHiC,EAAGjC,OAAOqF,SAIhB,SAASC,GAAQ7tB,EAAI/0B,GACnB,GAAI+0B,EAAGO,MAAS,OAAOt1B,IACvBs/C,GAAevqB,GACf,IAAM,OAAO/0B,IACb,QAAUggD,GAAajrB,IAGzB,SAAS8tB,GAAU9tB,EAAI/0B,GACrB,OAAO,WACL,GAAI+0B,EAAGO,MAAS,OAAOt1B,EAAEuK,MAAMwqB,EAAIxwB,WACnC+6C,GAAevqB,GACf,IAAM,OAAO/0B,EAAEuK,MAAMwqB,EAAIxwB,WACzB,QAAUy7C,GAAajrB,KAK3B,SAAS+tB,GAAS9iD,GAChB,OAAO,WACL,GAAIyJ,KAAK6rB,MAAS,OAAOt1B,EAAEuK,MAAMd,KAAMlF,WACvC+6C,GAAe71C,MACf,IAAM,OAAOzJ,EAAEuK,MAAMd,KAAMlF,WAC3B,QAAUy7C,GAAav2C,QAG3B,SAASs5C,GAAY/iD,GACnB,OAAO,WACL,IAAI+0B,EAAKtrB,KAAKsrB,GACd,IAAKA,GAAMA,EAAGO,MAAS,OAAOt1B,EAAEuK,MAAMd,KAAMlF,WAC5C+6C,GAAevqB,GACf,IAAM,OAAO/0B,EAAEuK,MAAMd,KAAMlF,WAC3B,QAAUy7C,GAAajrB,KAM3B,SAASknB,GAAYlnB,EAAInG,GACnBmG,EAAGtW,IAAI8f,kBAAoBxJ,EAAG1X,QAAQ8hB,QACtCpK,EAAG4D,MAAMqqB,UAAUtsD,IAAIk4B,EAAM1kB,EAAK+4C,GAAiBluB,IAGzD,SAASkuB,GAAgBluB,GACvB,IAAItW,EAAMsW,EAAGtW,IACb,KAAIA,EAAI8f,mBAAqBxJ,EAAG1X,QAAQ8hB,QAAxC,CACA,IAAIlS,GAAO,IAAI+B,KAAO+F,EAAGhd,QAAQmrC,SAC7BhmB,EAAUgB,GAAiBnJ,EAAItW,EAAI8f,mBACnC4kB,EAAe,GAEnB1kC,EAAIob,KAAKqD,EAAQ7I,KAAMp/B,KAAK6P,IAAI2Z,EAAI6a,MAAQ7a,EAAI8a,KAAMxE,EAAG1X,QAAQ8hB,OAAS,MAAM,SAAU9K,GACxF,GAAI6I,EAAQ7I,MAAQU,EAAG1X,QAAQ6hB,SAAU,CACvC,IAAIkkB,EAAY/uB,EAAKwJ,OACjBM,EAAa9J,EAAKhZ,KAAK7W,OAASuwB,EAAGhd,QAAQqmB,mBAAqB1F,GAAUja,EAAImZ,KAAMsF,EAAQvE,OAAS,KACrG0qB,EAAcpmB,GAAclI,EAAIV,EAAM6I,GAAS,GAC/CiB,IAAcjB,EAAQvE,MAAQwF,GAClC9J,EAAKwJ,OAASwlB,EAAYxlB,OAC1B,IAAIylB,EAASjvB,EAAKiK,aAAcilB,EAASF,EAAY5tC,QACjD8tC,EAAUlvB,EAAKiK,aAAeilB,EACzBD,IAAUjvB,EAAKiK,aAAe,MAGvC,IAFA,IAAIklB,GAAYJ,GAAaA,EAAU5+C,QAAU6vB,EAAKwJ,OAAOr5B,QAC3D8+C,GAAUC,KAAYD,IAAWC,GAAUD,EAAOxlB,SAAWylB,EAAOzlB,SAAWwlB,EAAOvlB,WAAawlB,EAAOxlB,WACnGz5B,EAAI,GAAIk/C,GAAYl/C,EAAI8+C,EAAU5+C,SAAUF,EAAKk/C,EAAWJ,EAAU9+C,IAAM+vB,EAAKwJ,OAAOv5B,GAC7Fk/C,GAAYL,EAAavtC,KAAKsnB,EAAQ7I,MAC1CA,EAAKgK,WAAanB,EAAQxV,OAC1BwV,EAAQkC,gBAEJ/K,EAAKhZ,KAAK7W,QAAUuwB,EAAGhd,QAAQqmB,oBAC/Ba,GAAYlK,EAAIV,EAAKhZ,KAAM6hB,GAC/B7I,EAAKgK,WAAanB,EAAQ7I,KAAO,GAAK,EAAI6I,EAAQxV,OAAS,KAC3DwV,EAAQkC,WAEV,IAAK,IAAIpQ,KAAO/B,EAEd,OADAgvB,GAAYlnB,EAAIA,EAAGhd,QAAQ0rC,YACpB,KAGXhlC,EAAI8f,kBAAoBrB,EAAQ7I,KAChC5V,EAAI+f,aAAevpC,KAAKoP,IAAIoa,EAAI+f,aAActB,EAAQ7I,MAClD8uB,EAAa3+C,QAAUo+C,GAAQ7tB,GAAI,WACrC,IAAK,IAAIzwB,EAAI,EAAGA,EAAI6+C,EAAa3+C,OAAQF,IACrCsxC,GAAc7gB,EAAIouB,EAAa7+C,GAAI,YAM3C,IAAI28C,GAAgB,SAASlsB,EAAIulB,EAAUoJ,GACzC,IAAIrmC,EAAU0X,EAAG1X,QAEjB5T,KAAK6wC,SAAWA,EAEhB7wC,KAAKk6C,QAAUtJ,GAAah9B,EAAS0X,EAAGtW,IAAK67B,GAC7C7wC,KAAKm6C,gBAAkBvmC,EAAQgvB,QAAQ7V,YACvC/sB,KAAKo6C,cAAgBxmC,EAAQgvB,QAAQoB,aACrChkC,KAAKsiC,aAAe1uB,EAAQgvB,QAAQC,YACpC7iC,KAAKq6C,gBAAkBzW,GAAatY,GACpCtrB,KAAKi6C,MAAQA,EACbj6C,KAAK6/B,KAAO4E,GAAcnZ,GAC1BtrB,KAAKs6C,OAAS,IAwDhB,SAAS5C,GAAsBpsB,EAAIuoB,GACjC,IAAIjgC,EAAU0X,EAAG1X,QAASoB,EAAMsW,EAAGtW,IAEnC,GAAI6+B,EAAOsG,eAET,OADAtO,GAAUvgB,IACH,EAIT,IAAKuoB,EAAOoG,OACRpG,EAAOqG,QAAQryB,MAAQjU,EAAQ6hB,UAAYoe,EAAOqG,QAAQpyB,IAAMlU,EAAQ8hB,SAC1C,MAA7B9hB,EAAQ+3B,mBAA6B/3B,EAAQ+3B,mBAAqB/3B,EAAQ8hB,SAC3E9hB,EAAQ2mC,cAAgB3mC,EAAQyrB,MAA8B,GAAtBiN,GAAehhB,GACvD,OAAO,EAEPkvB,GAA2BlvB,KAC7BugB,GAAUvgB,GACVuoB,EAAOhU,KAAO4E,GAAcnZ,IAI9B,IAAI9H,EAAMxO,EAAI6a,MAAQ7a,EAAI8a,KACtBjI,EAAOr8B,KAAKoP,IAAIi5C,EAAOqG,QAAQryB,KAAOyD,EAAGhd,QAAQmsC,eAAgBzlC,EAAI6a,OACrE/H,EAAKt8B,KAAK6P,IAAImoB,EAAKqwB,EAAOqG,QAAQpyB,GAAKwD,EAAGhd,QAAQmsC,gBAClD7mC,EAAQ6hB,SAAW5N,GAAQA,EAAOjU,EAAQ6hB,SAAW,KAAM5N,EAAOr8B,KAAKoP,IAAIoa,EAAI6a,MAAOjc,EAAQ6hB,WAC9F7hB,EAAQ8hB,OAAS5N,GAAMlU,EAAQ8hB,OAAS5N,EAAK,KAAMA,EAAKt8B,KAAK6P,IAAImoB,EAAK5P,EAAQ8hB,SAC9EqB,KACFlP,EAAOyS,GAAahP,EAAGtW,IAAK6S,GAC5BC,EAAK2S,GAAgBnP,EAAGtW,IAAK8S,IAG/B,IAAI4yB,EAAY7yB,GAAQjU,EAAQ6hB,UAAY3N,GAAMlU,EAAQ8hB,QACxD9hB,EAAQ+mC,gBAAkB9G,EAAOuG,eAAiBxmC,EAAQgnC,eAAiB/G,EAAOvR,cAn+BtF,SAAoBhX,EAAIzD,EAAMC,GAC5B,IAAIlU,EAAU0X,EAAG1X,QACE,GADcA,EAAQyrB,KAChCtkC,QAAe8sB,GAAQjU,EAAQ8hB,QAAU5N,GAAMlU,EAAQ6hB,UAC9D7hB,EAAQyrB,KAAOF,GAAe7T,EAAIzD,EAAMC,GACxClU,EAAQ6hB,SAAW5N,IAEfjU,EAAQ6hB,SAAW5N,EACnBjU,EAAQyrB,KAAOF,GAAe7T,EAAIzD,EAAMjU,EAAQ6hB,UAAUra,OAAOxH,EAAQyrB,MACpEzrB,EAAQ6hB,SAAW5N,IACxBjU,EAAQyrB,KAAOzrB,EAAQyrB,KAAKz/B,MAAM4kC,GAAclZ,EAAIzD,KACxDjU,EAAQ6hB,SAAW5N,EACfjU,EAAQ8hB,OAAS5N,EACjBlU,EAAQyrB,KAAOzrB,EAAQyrB,KAAKjkB,OAAO+jB,GAAe7T,EAAI1X,EAAQ8hB,OAAQ5N,IACjElU,EAAQ8hB,OAAS5N,IACtBlU,EAAQyrB,KAAOzrB,EAAQyrB,KAAKz/B,MAAM,EAAG4kC,GAAclZ,EAAIxD,MAE7DlU,EAAQ8hB,OAAS5N,EAo9BjB+yB,CAAWvvB,EAAIzD,EAAMC,GAErBlU,EAAQ20B,WAAazN,GAAalL,GAAQtE,EAAGtW,IAAKpB,EAAQ6hB,WAE1DnK,EAAG1X,QAAQqvB,MAAM/5B,MAAMpT,IAAM8d,EAAQ20B,WAAa,KAElD,IAAIuS,EAAWxO,GAAehhB,GAC9B,IAAKovB,GAAyB,GAAZI,IAAkBjH,EAAOoG,OAASrmC,EAAQ2mC,cAAgB3mC,EAAQyrB,OAClD,MAA7BzrB,EAAQ+3B,mBAA6B/3B,EAAQ+3B,mBAAqB/3B,EAAQ8hB,QAC3E,OAAO,EAIX,IAAIqlB,EA/EN,SAA2BzvB,GACzB,GAAIA,EAAG0vB,WAAc,OAAO,KAC5B,IAAIC,EAAS/3B,IACb,IAAK+3B,IAAWp4B,EAASyI,EAAG1X,QAAQ68B,QAASwK,GAAW,OAAO,KAC/D,IAAIn3C,EAAS,CAACof,UAAW+3B,GACzB,GAAIvwC,OAAO8iB,aAAc,CACvB,IAAIuf,EAAMriC,OAAO8iB,eACbuf,EAAImO,YAAcnO,EAAIhtC,QAAU8iB,EAASyI,EAAG1X,QAAQ68B,QAAS1D,EAAImO,cACnEp3C,EAAOo3C,WAAanO,EAAImO,WACxBp3C,EAAOq3C,aAAepO,EAAIoO,aAC1Br3C,EAAOs3C,UAAYrO,EAAIqO,UACvBt3C,EAAOu3C,YAActO,EAAIsO,aAG7B,OAAOv3C,EAiEWw3C,CAAkBhwB,GAuBpC,OAtBIwvB,EAAW,IAAKlnC,EAAQ68B,QAAQvnC,MAAM0K,QAAU,QA0EtD,SAAsB0X,EAAIiwB,EAAmB1b,GAC3C,IAAIjsB,EAAU0X,EAAG1X,QAASutB,EAAc7V,EAAGhd,QAAQ6yB,YAC/C5lB,EAAY3H,EAAQ68B,QAASnoB,EAAM/M,EAAU8B,WAEjD,SAASm+B,EAAG37B,GACV,IAAImS,EAAOnS,EAAKlE,YAMhB,OAJIqF,GAAUU,GAAO4J,EAAG1X,QAAQ6nC,oBAAsB57B,EAClDA,EAAK3W,MAAM0K,QAAU,OAErBiM,EAAKmD,WAAW9D,YAAYW,GACzBmS,EAMT,IAHA,IAAIqN,EAAOzrB,EAAQyrB,KAAM9E,EAAQ3mB,EAAQ6hB,SAGhC56B,EAAI,EAAGA,EAAIwkC,EAAKtkC,OAAQF,IAAK,CACpC,IAAIihC,EAAWuD,EAAKxkC,GACpB,GAAIihC,EAASoD,aAAe,GAAKpD,EAASjc,MAAQic,EAASjc,KAAKmD,YAAczH,EAGvE,CACL,KAAO+M,GAAOwT,EAASjc,MAAQyI,EAAMkzB,EAAGlzB,GACxC,IAAIozB,EAAeva,GAAoC,MAArBoa,GAChCA,GAAqBhhB,GAASuB,EAASwF,WACrCxF,EAASgE,UACP5zB,EAAQ4vB,EAASgE,QAAS,WAAa,IAAK4b,GAAe,GAC/D9b,GAAqBtU,EAAIwQ,EAAUvB,EAAOsF,IAExC6b,IACFn5B,EAAeuZ,EAASwF,YACxBxF,EAASwF,WAAWpzB,YAAYpG,SAAS8R,eAAeiX,GAAcvF,EAAGhd,QAASisB,MAEpFjS,EAAMwT,EAASjc,KAAKlE,gBAfmE,CACvF,IAAIkE,EAAOgiB,GAAiBvW,EAAIwQ,EAAUvB,EAAOsF,GACjDtkB,EAAU/B,aAAaqG,EAAMyI,GAe/BiS,GAASuB,EAAShM,KAEpB,KAAOxH,GAAOA,EAAMkzB,EAAGlzB,GA/GvBqzB,CAAarwB,EAAI1X,EAAQ+3B,kBAAmBkI,EAAOhU,MAC/Cib,EAAW,IAAKlnC,EAAQ68B,QAAQvnC,MAAM0K,QAAU,IACpDA,EAAQ2mC,aAAe3mC,EAAQyrB,KAlEjC,SAA0Buc,GACxB,GAAKA,GAAaA,EAAS14B,WAAa04B,EAAS14B,WAAaA,MAC9D04B,EAAS14B,UAAUlF,QACf49B,EAASV,YAAcr4B,EAAS/a,SAASoO,KAAM0lC,EAASV,aAAer4B,EAAS/a,SAASoO,KAAM0lC,EAASR,YAAY,CACtH,IAAIrO,EAAMriC,OAAO8iB,eAAgBrL,EAAQra,SAASwb,cAClDnB,EAAMuB,OAAOk4B,EAASV,WAAYU,EAAST,cAC3Ch5B,EAAM2B,UAAS,GACfipB,EAAI8O,kBACJ9O,EAAI+O,SAAS35B,GACb4qB,EAAIhtC,OAAO67C,EAASR,UAAWQ,EAASP,cA4D1CU,CAAiBhB,GAIjBx4B,EAAe3O,EAAQ87B,WACvBntB,EAAe3O,EAAQooC,cACvBpoC,EAAQ+uB,QAAQz5B,MAAM8D,OAAS4G,EAAQovB,MAAM95B,MAAMyqC,UAAY,EAE3D+G,IACF9mC,EAAQ+mC,eAAiB9G,EAAOuG,cAChCxmC,EAAQgnC,cAAgB/G,EAAOvR,aAC/BkQ,GAAYlnB,EAAI,MAGlB1X,EAAQ+3B,kBAAoB,MAErB,EAGT,SAASsM,GAAkB3sB,EAAIuoB,GAG7B,IAFA,IAAIhD,EAAWgD,EAAOhD,SAEbhhB,GAAQ,GAAOA,GAAQ,EAAO,CACrC,GAAKA,GAAUvE,EAAGhd,QAAQ42B,cAAgB2O,EAAOwG,iBAAmBzW,GAAatY,GAStEuE,IACTgkB,EAAOqG,QAAUtJ,GAAatlB,EAAG1X,QAAS0X,EAAGtW,IAAK67B,SAHlD,GALIA,GAA4B,MAAhBA,EAAS/6C,MACrB+6C,EAAW,CAAC/6C,IAAKtK,KAAK6P,IAAIiwB,EAAGtW,IAAIhI,OAASo2B,GAAY9X,EAAG1X,SAAWmwB,GAAczY,GAAKulB,EAAS/6C,OAGpG+9C,EAAOqG,QAAUtJ,GAAatlB,EAAG1X,QAAS0X,EAAGtW,IAAK67B,GAC9CgD,EAAOqG,QAAQryB,MAAQyD,EAAG1X,QAAQ6hB,UAAYoe,EAAOqG,QAAQpyB,IAAMwD,EAAG1X,QAAQ8hB,OAC9E,MAIN,IAAKgiB,GAAsBpsB,EAAIuoB,GAAW,MAC1CtD,GAAwBjlB,GACxB,IAAIqsB,EAAa3E,GAAqB1nB,GACtCkhB,GAAgBlhB,GAChBwpB,GAAiBxpB,EAAIqsB,GACrBK,GAAkB1sB,EAAIqsB,GACtB9D,EAAOoG,OAAQ,EAGjBpG,EAAO1oB,OAAOG,EAAI,SAAUA,GACxBA,EAAG1X,QAAQ6hB,UAAYnK,EAAG1X,QAAQqoC,kBAAoB3wB,EAAG1X,QAAQ8hB,QAAUpK,EAAG1X,QAAQsoC,iBACxFrI,EAAO1oB,OAAOG,EAAI,iBAAkBA,EAAIA,EAAG1X,QAAQ6hB,SAAUnK,EAAG1X,QAAQ8hB,QACxEpK,EAAG1X,QAAQqoC,iBAAmB3wB,EAAG1X,QAAQ6hB,SAAUnK,EAAG1X,QAAQsoC,eAAiB5wB,EAAG1X,QAAQ8hB,QAI9F,SAAS4c,GAAoBhnB,EAAIulB,GAC/B,IAAIgD,EAAS,IAAI2D,GAAclsB,EAAIulB,GACnC,GAAI6G,GAAsBpsB,EAAIuoB,GAAS,CACrCtD,GAAwBjlB,GACxB2sB,GAAkB3sB,EAAIuoB,GACtB,IAAI8D,EAAa3E,GAAqB1nB,GACtCkhB,GAAgBlhB,GAChBwpB,GAAiBxpB,EAAIqsB,GACrBK,GAAkB1sB,EAAIqsB,GACtB9D,EAAOqF,UAiDX,SAASiD,GAAkBvoC,GACzB,IAAI9G,EAAQ8G,EAAQ+uB,QAAQ5V,YAC5BnZ,EAAQovB,MAAM95B,MAAMsL,WAAa1H,EAAQ,KAG3C,SAASkrC,GAAkB1sB,EAAIwB,GAC7BxB,EAAG1X,QAAQovB,MAAM95B,MAAMyqC,UAAY7mB,EAAQwmB,UAAY,KACvDhoB,EAAG1X,QAAQwhC,aAAalsC,MAAMpT,IAAMg3B,EAAQwmB,UAAY,KACxDhoB,EAAG1X,QAAQ+uB,QAAQz5B,MAAM8D,OAAU8f,EAAQwmB,UAAYhoB,EAAG1X,QAAQqwB,UAAYP,GAAUpY,GAAO,KAKjG,SAASynB,GAAkBznB,GACzB,IAAI1X,EAAU0X,EAAG1X,QAASyrB,EAAOzrB,EAAQyrB,KACzC,GAAKzrB,EAAQwoC,cAAkBxoC,EAAQ+uB,QAAQtlB,YAAeiO,EAAGhd,QAAQwyB,YAAzE,CAGA,IAFA,IAAIub,EAAOvR,GAAqBl3B,GAAWA,EAAQiwB,SAASkE,WAAazc,EAAGtW,IAAI+yB,WAC5EkL,EAAUr/B,EAAQ+uB,QAAQ5V,YAAap3B,EAAO0mD,EAAO,KAChDxhD,EAAI,EAAGA,EAAIwkC,EAAKtkC,OAAQF,IAAO,IAAKwkC,EAAKxkC,GAAGqkC,OAAQ,CACvD5T,EAAGhd,QAAQwyB,cACTzB,EAAKxkC,GAAG8lC,SACRtB,EAAKxkC,GAAG8lC,OAAOz3B,MAAMvT,KAAOA,GAC5B0pC,EAAKxkC,GAAG+lC,mBACRvB,EAAKxkC,GAAG+lC,iBAAiB13B,MAAMvT,KAAOA,IAE5C,IAAI2mD,EAAQjd,EAAKxkC,GAAG6mC,UACpB,GAAI4a,EAAS,IAAK,IAAI1yB,EAAI,EAAGA,EAAI0yB,EAAMvhD,OAAQ6uB,IAC3C0yB,EAAM1yB,GAAG1gB,MAAMvT,KAAOA,EAExB21B,EAAGhd,QAAQwyB,cACXltB,EAAQ+uB,QAAQz5B,MAAMvT,KAAQ0mD,EAAOpJ,EAAW,OAMtD,SAASuH,GAA2BlvB,GAClC,IAAKA,EAAGhd,QAAQ6yB,YAAe,OAAO,EACtC,IAAInsB,EAAMsW,EAAGtW,IAAKyc,EAAOZ,GAAcvF,EAAGhd,QAAS0G,EAAI6a,MAAQ7a,EAAI8a,KAAO,GAAIlc,EAAU0X,EAAG1X,QAC3F,GAAI6d,EAAK12B,QAAU6Y,EAAQ+zB,aAAc,CACvC,IAAI7kC,EAAO8Q,EAAQkZ,QAAQ5e,YAAYuU,EAAI,MAAO,CAACA,EAAI,MAAOgP,IACnB,gDACvC8qB,EAASz5C,EAAKua,WAAW0P,YAAa3Z,EAAUtQ,EAAKiqB,YAAcwvB,EAOvE,OANA3oC,EAAQ4oC,WAAWtzC,MAAM4D,MAAQ,GACjC8G,EAAQ6oC,kBAAoBjxD,KAAKoP,IAAI2hD,EAAQ3oC,EAAQ4oC,WAAWzvB,YAAc3Z,GAAW,EACzFQ,EAAQ8oC,aAAe9oC,EAAQ6oC,kBAAoBrpC,EACnDQ,EAAQ+zB,aAAe/zB,EAAQ6oC,kBAAoBhrB,EAAK12B,QAAU,EAClE6Y,EAAQ4oC,WAAWtzC,MAAM4D,MAAQ8G,EAAQ8oC,aAAe,KACxDP,GAAkB7wB,EAAG1X,UACd,EAET,OAAO,EAGT,SAAS+oC,GAAWha,EAASxB,GAE3B,IADA,IAAIr9B,EAAS,GAAI84C,GAAiB,EACzB/hD,EAAI,EAAGA,EAAI8nC,EAAQ5nC,OAAQF,IAAK,CACvC,IAAI6d,EAAOiqB,EAAQ9nC,GAAIqO,EAAQ,KAE/B,GADmB,iBAARwP,IAAoBxP,EAAQwP,EAAKxP,MAAOwP,EAAOA,EAAKxO,WACnD,0BAARwO,EAAkC,CACpC,IAAKyoB,EAAe,SACbyb,GAAiB,EAE1B94C,EAAOqI,KAAK,CAACjC,UAAWwO,EAAMxP,MAAOA,IAGvC,OADIi4B,IAAgByb,GAAkB94C,EAAOqI,KAAK,CAACjC,UAAW,yBAA0BhB,MAAO,OACxFpF,EAKT,SAAS+4C,GAAcjpC,GACrB,IAAI+uB,EAAU/uB,EAAQ+uB,QAASma,EAAQlpC,EAAQ4tB,YAC/Cjf,EAAeogB,GACf/uB,EAAQ4oC,WAAa,KACrB,IAAK,IAAI3hD,EAAI,EAAGA,EAAIiiD,EAAM/hD,SAAUF,EAAG,CACrC,IAAI2vC,EAAMsS,EAAMjiD,GACZqP,EAAYsgC,EAAItgC,UAChBhB,EAAQshC,EAAIthC,MACZ6zC,EAAOpa,EAAQz0B,YAAYuU,EAAI,MAAO,KAAM,qBAAuBvY,IACnEhB,IAAS6zC,EAAK7zC,MAAM8K,QAAU9K,GACjB,0BAAbgB,IACF0J,EAAQ4oC,WAAaO,EACrBA,EAAK7zC,MAAM4D,OAAS8G,EAAQ8oC,cAAgB,GAAK,MAGrD/Z,EAAQz5B,MAAM0K,QAAUkpC,EAAM/hD,OAAS,GAAK,OAC5CohD,GAAkBvoC,GAGpB,SAASopC,GAAc1xB,GACrBuxB,GAAcvxB,EAAG1X,SACjB63B,GAAUngB,GACVynB,GAAkBznB,GAOpB,SAAS2xB,GAAQzX,EAAOxwB,EAAKopB,EAAO9vB,GAClC,IAAIpS,EAAI8D,KACRA,KAAKo+B,MAAQA,EAGbliC,EAAEo5C,gBAAkB7yB,EAAI,MAAO,KAAM,+BACrCvmB,EAAEo5C,gBAAgBtnC,aAAa,iBAAkB,QAGjD9R,EAAEs5C,aAAe/yB,EAAI,MAAO,KAAM,4BAClCvmB,EAAEs5C,aAAaxnC,aAAa,iBAAkB,QAE9C9R,EAAEu0C,QAAU7tB,EAAK,MAAO,KAAM,mBAE9B1mB,EAAE8/C,aAAev5B,EAAI,MAAO,KAAM,KAAM,kCACxCvmB,EAAEwzC,UAAYjtB,EAAI,MAAO,KAAM,sBAE/BvmB,EAAE4wB,QAAUrK,EAAI,MAAO,KAAM,sBAE7BvmB,EAAEyoC,YAAcliB,EAAI,MAAO,KAAM,sBAEjCvmB,EAAEinC,UAAYvgB,EAAK,MAAO,CAAC1mB,EAAE4wB,QAAS5wB,EAAEyoC,YAAazoC,EAAE8/C,aAAc9/C,EAAEwzC,UAAWxzC,EAAEu0C,SAClE,KAAM,qCACxB,IAAIzgB,EAAQpN,EAAK,MAAO,CAAC1mB,EAAEinC,WAAY,oBAEvCjnC,EAAE+mC,MAAQxgB,EAAI,MAAO,CAACuN,GAAQ,KAAM,sBAEpC9zB,EAAE8mC,MAAQvgB,EAAI,MAAO,CAACvmB,EAAE+mC,OAAQ,oBAChC/mC,EAAE0xC,WAAa,KAIf1xC,EAAEk5C,aAAe3yB,EAAI,MAAO,KAAM,KAAM,iDAExCvmB,EAAEymC,QAAUlgB,EAAI,MAAO,KAAM,sBAC7BvmB,EAAEsgD,WAAa,KAEftgD,EAAE2nC,SAAWphB,EAAI,MAAO,CAACvmB,EAAE8mC,MAAO9mC,EAAEk5C,aAAcl5C,EAAEymC,SAAU,qBAC9DzmC,EAAE2nC,SAAS71B,aAAa,WAAY,MAEpC9R,EAAE0mC,QAAUngB,EAAI,MAAO,CAACvmB,EAAEo5C,gBAAiBp5C,EAAEs5C,aAAct5C,EAAE2nC,UAAW,cAGpEhjB,GAAMC,EAAa,IAAK5kB,EAAEymC,QAAQz5B,MAAMuK,QAAU,EAAGvX,EAAE2nC,SAAS36B,MAAMu6B,aAAe,GACpFziB,GAAYR,GAASiB,IAAWvlB,EAAE2nC,SAASqZ,WAAY,GAExD1X,IACEA,EAAMt3B,YAAes3B,EAAMt3B,YAAYhS,EAAE0mC,SACtC4C,EAAMtpC,EAAE0mC,UAIjB1mC,EAAEu5B,SAAWv5B,EAAEw5B,OAAS1gB,EAAI6a,MAC5B3zB,EAAE+/C,iBAAmB//C,EAAEggD,eAAiBlnC,EAAI6a,MAE5C3zB,EAAEmjC,KAAO,GACTnjC,EAAEq+C,aAAe,KAGjBr+C,EAAEugC,iBAAmB,KAErBvgC,EAAEqsC,WAAa,EACfrsC,EAAEy+C,eAAiBz+C,EAAE0+C,cAAgB,EACrC1+C,EAAEyvC,kBAAoB,KAEtBzvC,EAAEynC,eAAiBznC,EAAE+nC,UAAY/nC,EAAE4nC,SAAW,EAC9C5nC,EAAEi7C,mBAAoB,EAItBj7C,EAAEwgD,aAAexgD,EAAEugD,kBAAoBvgD,EAAEyrC,aAAe,KAIxDzrC,EAAEkgD,cAAe,EAEjBlgD,EAAEurC,gBAAkBvrC,EAAEwrC,iBAAmBxrC,EAAEonC,eAAiB,KAI5DpnC,EAAEi/B,QAAU,KACZj/B,EAAEk/B,cAAgB,EAClBl/B,EAAEm/B,gBAAiB,EAGnBn/B,EAAEihD,QAAUjhD,EAAEkhD,QAAUlhD,EAAEg8C,YAAch8C,EAAEi8C,YAAc,KAGxDj8C,EAAEo0C,OAAQ,EAIVp0C,EAAEi0C,kBAAoB,KAEtBj0C,EAAEmhD,YAAc,KAEhBnhD,EAAEslC,YAAcmb,GAAWruC,EAAQq0B,QAASr0B,EAAQ6yB,aACpD0b,GAAc3gD,GAEdkiC,EAAMxzB,KAAK1O,GA9Zbs7C,GAAc93C,UAAUyrB,OAAS,SAAUJ,EAASvd,GAC9Cue,GAAWhB,EAASvd,IACpBxN,KAAKs6C,OAAOnuC,KAAKrR,YAEvB08C,GAAc93C,UAAUw5C,OAAS,WAC/B,IAAK,IAAIr+C,EAAI,EAAGA,EAAImF,KAAKs6C,OAAOv/C,OAAQF,IACpCswB,GAAOrqB,MAAM,KAAMd,KAAKs6C,OAAOz/C,KAsarC,IAAIyiD,GAAe,EAAGC,GAAqB,KAU3C,SAASC,GAAgB90C,GACvB,IAAI+0C,EAAK/0C,EAAEg1C,YAAaC,EAAKj1C,EAAEk1C,YAI/B,OAHU,MAANH,GAAc/0C,EAAEm1C,QAAUn1C,EAAEzY,MAAQyY,EAAEo1C,kBAAmBL,EAAK/0C,EAAEm1C,QAC1D,MAANF,GAAcj1C,EAAEm1C,QAAUn1C,EAAEzY,MAAQyY,EAAEq1C,cAAiBJ,EAAKj1C,EAAEm1C,OACnD,MAANF,IAAcA,EAAKj1C,EAAEs1C,YACvB,CAACpuD,EAAG6tD,EAAI5tD,EAAG8tD,GAEpB,SAASM,GAAiBv1C,GACxB,IAAIlE,EAAQg5C,GAAgB90C,GAG5B,OAFAlE,EAAM5U,GAAK2tD,GACX/4C,EAAM3U,GAAK0tD,GACJ/4C,EAGT,SAAS05C,GAAc5yB,EAAI5iB,GACzB,IAAIlE,EAAQg5C,GAAgB90C,GAAI+0C,EAAKj5C,EAAM5U,EAAG+tD,EAAKn5C,EAAM3U,EAErD+jB,EAAU0X,EAAG1X,QAAS+R,EAAS/R,EAAQiwB,SAEvCsa,EAAax4B,EAAOmtB,YAAcntB,EAAOkd,YACzCub,EAAaz4B,EAAO+sB,aAAe/sB,EAAOqe,aAC9C,GAAMyZ,GAAMU,GAAcR,GAAMS,EAAhC,CAMA,GAAIT,GAAMj8B,GAAOV,EACf0P,EAAO,IAAK,IAAIpI,EAAM5f,EAAE5P,OAAQumC,EAAOzrB,EAAQyrB,KAAM/W,GAAO3C,EAAQ2C,EAAMA,EAAItF,WAC5E,IAAK,IAAInoB,EAAI,EAAGA,EAAIwkC,EAAKtkC,OAAQF,IAC/B,GAAIwkC,EAAKxkC,GAAGglB,MAAQyI,EAAK,CACvBgD,EAAG1X,QAAQ6nC,mBAAqBnzB,EAChC,MAAMoI,EAYd,GAAI+sB,IAAOj9B,IAAUW,GAAgC,MAAtBo8B,GAW7B,OAVII,GAAMS,GACN/L,GAAgB/mB,EAAI9/B,KAAKoP,IAAI,EAAG+qB,EAAOuiB,UAAYyV,EAAKJ,KAC5D3K,GAActnB,EAAI9/B,KAAKoP,IAAI,EAAG+qB,EAAOoiB,WAAa0V,EAAKF,OAKlDI,GAAOA,GAAMS,IACdlyB,GAAiBxjB,QACrBkL,EAAQskC,YAAc,MAMxB,GAAIyF,GAA4B,MAAtBJ,GAA4B,CACpC,IAAIc,EAASV,EAAKJ,GACdznD,EAAMw1B,EAAGtW,IAAIkzB,UAAWrB,EAAM/wC,EAAM8d,EAAQgvB,QAAQoB,aACpDqa,EAAS,EAAKvoD,EAAMtK,KAAKoP,IAAI,EAAG9E,EAAMuoD,EAAS,IAC5CxX,EAAMr7C,KAAK6P,IAAIiwB,EAAGtW,IAAIhI,OAAQ65B,EAAMwX,EAAS,IACpD/L,GAAoBhnB,EAAI,CAACx1B,IAAKA,EAAKD,OAAQgxC,IAGzCyW,GAAe,KACU,MAAvB1pC,EAAQskC,aACVtkC,EAAQskC,YAAcvyB,EAAOoiB,WAAYn0B,EAAQukC,YAAcxyB,EAAOuiB,UACtEt0B,EAAQupC,QAAUM,EAAI7pC,EAAQwpC,QAAUO,EACxCv8C,YAAW,WACT,GAA2B,MAAvBwS,EAAQskC,YAAZ,CACA,IAAIoG,EAAS34B,EAAOoiB,WAAan0B,EAAQskC,YACrCqG,EAAS54B,EAAOuiB,UAAYt0B,EAAQukC,YACpCqG,EAAUD,GAAU3qC,EAAQwpC,SAAWmB,EAAS3qC,EAAQwpC,SACzDkB,GAAU1qC,EAAQupC,SAAWmB,EAAS1qC,EAAQupC,QACjDvpC,EAAQskC,YAActkC,EAAQukC,YAAc,KACvCqG,IACLjB,IAAsBA,GAAqBD,GAAekB,IAAWlB,GAAe,KAClFA,OACD,OAEH1pC,EAAQupC,SAAWM,EAAI7pC,EAAQwpC,SAAWO,KAzF5C98B,EAAM08B,IAAsB,IACvB/8B,EAAS+8B,GAAqB,GAC9Br8B,EAAUq8B,IAAsB,GAChCn8B,IAAUm8B,IAAsB,EAAE,GAgG3C,IAAIkB,GAAY,SAASzR,EAAQC,GAC/BjtC,KAAKgtC,OAASA,EACdhtC,KAAKitC,UAAYA,GAGnBwR,GAAU/+C,UAAUitC,QAAU,WAAc,OAAO3sC,KAAKgtC,OAAOhtC,KAAKitC,YAEpEwR,GAAU/+C,UAAUg/C,OAAS,SAAUvV,GACrC,GAAIA,GAASnpC,KAAQ,OAAO,EAC5B,GAAImpC,EAAM8D,WAAajtC,KAAKitC,WAAa9D,EAAM6D,OAAOjyC,QAAUiF,KAAKgtC,OAAOjyC,OAAU,OAAO,EAC7F,IAAK,IAAIF,EAAI,EAAGA,EAAImF,KAAKgtC,OAAOjyC,OAAQF,IAAK,CAC3C,IAAI8jD,EAAO3+C,KAAKgtC,OAAOnyC,GAAI+jD,EAAQzV,EAAM6D,OAAOnyC,GAChD,IAAKs2B,GAAewtB,EAAK/T,OAAQgU,EAAMhU,UAAYzZ,GAAewtB,EAAKzpC,KAAM0pC,EAAM1pC,MAAS,OAAO,EAErG,OAAO,GAGTupC,GAAU/+C,UAAUm/C,SAAW,WAE7B,IADA,IAAIjzD,EAAM,GACDiP,EAAI,EAAGA,EAAImF,KAAKgtC,OAAOjyC,OAAQF,IACpCjP,EAAIiP,GAAK,IAAIikD,GAAM1tB,GAAQpxB,KAAKgtC,OAAOnyC,GAAG+vC,QAASxZ,GAAQpxB,KAAKgtC,OAAOnyC,GAAGqa,OAC9E,OAAO,IAAIupC,GAAU7yD,EAAKoU,KAAKitC,YAGjCwR,GAAU/+C,UAAUq/C,kBAAoB,WACtC,IAAK,IAAIlkD,EAAI,EAAGA,EAAImF,KAAKgtC,OAAOjyC,OAAQF,IACpC,IAAKmF,KAAKgtC,OAAOnyC,GAAGqyC,QAAW,OAAO,EAC1C,OAAO,GAGTuR,GAAU/+C,UAAUmjB,SAAW,SAAUoD,EAAKzC,GACvCA,IAAOA,EAAMyC,GAClB,IAAK,IAAIprB,EAAI,EAAGA,EAAImF,KAAKgtC,OAAOjyC,OAAQF,IAAK,CAC3C,IAAIsnB,EAAQniB,KAAKgtC,OAAOnyC,GACxB,GAAIq2B,GAAI1N,EAAKrB,EAAM0F,SAAW,GAAKqJ,GAAIjL,EAAK9D,EAAM2F,OAAS,EACvD,OAAOjtB,EAEb,OAAQ,GAGV,IAAIikD,GAAQ,SAASlU,EAAQ11B,GAC3BlV,KAAK4qC,OAASA,EAAQ5qC,KAAKkV,KAAOA,GAUpC,SAAS8pC,GAAmB1zB,EAAI0hB,EAAQC,GACtC,IAAIgS,EAAW3zB,GAAMA,EAAGhd,QAAQ4wC,mBAC5BC,EAAOnS,EAAOC,GAClBD,EAAOoS,MAAK,SAAUtzD,EAAGuD,GAAK,OAAO6hC,GAAIplC,EAAE+7B,OAAQx4B,EAAEw4B,WACrDolB,EAAY/gC,EAAQ8gC,EAAQmS,GAC5B,IAAK,IAAItkD,EAAI,EAAGA,EAAImyC,EAAOjyC,OAAQF,IAAK,CACtC,IAAIytB,EAAM0kB,EAAOnyC,GAAIuuB,EAAO4jB,EAAOnyC,EAAI,GACnC2V,EAAO0gB,GAAI9H,EAAKtB,KAAMQ,EAAIT,QAC9B,GAAIo3B,IAAa32B,EAAI4kB,QAAU18B,EAAO,EAAIA,GAAQ,EAAG,CACnD,IAAIqX,EAAOyJ,GAAOlI,EAAKvB,OAAQS,EAAIT,QAASC,EAAKuJ,GAAOjI,EAAKtB,KAAMQ,EAAIR,MACnEu3B,EAAMj2B,EAAK8jB,QAAU5kB,EAAIT,QAAUS,EAAIpT,KAAOkU,EAAKvB,QAAUuB,EAAKlU,KAClEra,GAAKoyC,KAAeA,EACxBD,EAAOvgC,SAAS5R,EAAG,EAAG,IAAIikD,GAAMO,EAAMv3B,EAAKD,EAAMw3B,EAAMx3B,EAAOC,KAGlE,OAAO,IAAI22B,GAAUzR,EAAQC,GAG/B,SAASqS,GAAgB1U,EAAQ11B,GAC/B,OAAO,IAAIupC,GAAU,CAAC,IAAIK,GAAMlU,EAAQ11B,GAAQ01B,IAAU,GAK5D,SAAS2U,GAAUhoB,GACjB,OAAKA,EAAO3lB,KACLqf,GAAIsG,EAAO1P,KAAK+C,KAAO2M,EAAO3lB,KAAK7W,OAAS,EACxCurB,EAAIiR,EAAO3lB,MAAM7W,QAAgC,GAAtBw8B,EAAO3lB,KAAK7W,OAAcw8B,EAAO1P,KAAKf,GAAK,IAFtDyQ,EAAOzP,GAOpC,SAAS03B,GAAgBv5B,EAAKsR,GAC5B,GAAIrG,GAAIjL,EAAKsR,EAAO1P,MAAQ,EAAK,OAAO5B,EACxC,GAAIiL,GAAIjL,EAAKsR,EAAOzP,KAAO,EAAK,OAAOy3B,GAAUhoB,GAEjD,IAAI3M,EAAO3E,EAAI2E,KAAO2M,EAAO3lB,KAAK7W,QAAUw8B,EAAOzP,GAAG8C,KAAO2M,EAAO1P,KAAK+C,MAAQ,EAAG9D,EAAKb,EAAIa,GAE7F,OADIb,EAAI2E,MAAQ2M,EAAOzP,GAAG8C,OAAQ9D,GAAMy4B,GAAUhoB,GAAQzQ,GAAKyQ,EAAOzP,GAAGhB,IAClEmK,GAAIrG,EAAM9D,GAGnB,SAAS24B,GAAsBzqC,EAAKuiB,GAElC,IADA,IAAI3rC,EAAM,GACDiP,EAAI,EAAGA,EAAIma,EAAI+3B,IAAIC,OAAOjyC,OAAQF,IAAK,CAC9C,IAAIsnB,EAAQnN,EAAI+3B,IAAIC,OAAOnyC,GAC3BjP,EAAIugB,KAAK,IAAI2yC,GAAMU,GAAgBr9B,EAAMyoB,OAAQrT,GAC9BioB,GAAgBr9B,EAAMjN,KAAMqiB,KAEjD,OAAOynB,GAAmBhqC,EAAIsW,GAAI1/B,EAAKopB,EAAI+3B,IAAIE,WAGjD,SAASyS,GAAUz5B,EAAK8R,EAAKC,GAC3B,OAAI/R,EAAI2E,MAAQmN,EAAInN,KACTqG,GAAI+G,EAAGpN,KAAM3E,EAAIa,GAAKiR,EAAIjR,GAAKkR,EAAGlR,IAElCmK,GAAI+G,EAAGpN,MAAQ3E,EAAI2E,KAAOmN,EAAInN,MAAO3E,EAAIa,IA0BtD,SAAS64B,GAASr0B,GAChBA,EAAGtW,IAAImZ,KAAOI,GAAQjD,EAAGhd,QAASgd,EAAGtW,IAAI4qC,YACzCC,GAAev0B,GAGjB,SAASu0B,GAAev0B,GACtBA,EAAGtW,IAAIob,MAAK,SAAUxF,GAChBA,EAAKgK,aAAchK,EAAKgK,WAAa,MACrChK,EAAKwJ,SAAUxJ,EAAKwJ,OAAS,SAEnC9I,EAAGtW,IAAI+f,aAAezJ,EAAGtW,IAAI8f,kBAAoBxJ,EAAGtW,IAAI6a,MACxD2iB,GAAYlnB,EAAI,KAChBA,EAAG4D,MAAM0E,UACLtI,EAAGO,OAAS4f,GAAUngB,GAQ5B,SAASw0B,GAAkB9qC,EAAKuiB,GAC9B,OAAyB,GAAlBA,EAAO1P,KAAKf,IAA2B,GAAhByQ,EAAOzP,GAAGhB,IAA+B,IAApBR,EAAIiR,EAAO3lB,SAC1DoD,EAAIsW,IAAMtW,EAAIsW,GAAGhd,QAAQyxC,uBAI/B,SAASC,GAAUhrC,EAAKuiB,EAAQG,EAAa6D,GAC3C,SAAS0kB,EAASr7B,GAAI,OAAO8S,EAAcA,EAAY9S,GAAK,KAC5D,SAASivB,EAAOjpB,EAAMhZ,EAAMulB,IAr8F9B,SAAoBvM,EAAMhZ,EAAM8lB,EAAa6D,GAC3C3Q,EAAKhZ,KAAOA,EACRgZ,EAAKgK,aAAchK,EAAKgK,WAAa,MACrChK,EAAKwJ,SAAUxJ,EAAKwJ,OAAS,MACf,MAAdxJ,EAAKzC,QAAiByC,EAAKzC,MAAQ,MACvC4Q,GAAkBnO,GAClBqO,GAAkBrO,EAAM8M,GACxB,IAAI0T,EAAY7P,EAAiBA,EAAe3Q,GAAQ,EACpDwgB,GAAaxgB,EAAK5d,QAAUsjB,GAAiB1F,EAAMwgB,GA87FrD8U,CAAWt1B,EAAMhZ,EAAMulB,EAAOoE,GAC9BiE,GAAY5U,EAAM,SAAUA,EAAM2M,GAEpC,SAAS4oB,EAAS58B,EAAOC,GAEvB,IADA,IAAI1f,EAAS,GACJjJ,EAAI0oB,EAAO1oB,EAAI2oB,IAAO3oB,EAC3BiJ,EAAOqI,KAAK,IAAImvB,GAAK1pB,EAAK/W,GAAIolD,EAASplD,GAAI0gC,IAC/C,OAAOz3B,EAGT,IAAI+jB,EAAO0P,EAAO1P,KAAMC,EAAKyP,EAAOzP,GAAIlW,EAAO2lB,EAAO3lB,KAClDwuC,EAAYxwB,GAAQ5a,EAAK6S,EAAK+C,MAAO8P,EAAW9K,GAAQ5a,EAAK8S,EAAG8C,MAChEy1B,EAAW/5B,EAAI1U,GAAO0uC,EAAYL,EAASruC,EAAK7W,OAAS,GAAIwlD,EAASz4B,EAAG8C,KAAO/C,EAAK+C,KAGzF,GAAI2M,EAAOC,KACTxiB,EAAIwrC,OAAO,EAAGL,EAAS,EAAGvuC,EAAK7W,SAC/Bia,EAAI6G,OAAOjK,EAAK7W,OAAQia,EAAI8a,KAAOle,EAAK7W,aACnC,GAAI+kD,GAAkB9qC,EAAKuiB,GAAS,CAGzC,IAAIkpB,EAAQN,EAAS,EAAGvuC,EAAK7W,OAAS,GACtC84C,EAAOnZ,EAAUA,EAAS9oB,KAAM0uC,GAC5BC,GAAUvrC,EAAI6G,OAAOgM,EAAK+C,KAAM21B,GAChCE,EAAM1lD,QAAUia,EAAIwrC,OAAO34B,EAAK+C,KAAM61B,QACrC,GAAIL,GAAa1lB,EACtB,GAAmB,GAAf9oB,EAAK7W,OACP84C,EAAOuM,EAAWA,EAAUxuC,KAAKhS,MAAM,EAAGioB,EAAKf,IAAMu5B,EAAWD,EAAUxuC,KAAKhS,MAAMkoB,EAAGhB,IAAKw5B,OACxF,CACL,IAAII,EAAUP,EAAS,EAAGvuC,EAAK7W,OAAS,GACxC2lD,EAAQv0C,KAAK,IAAImvB,GAAK+kB,EAAWD,EAAUxuC,KAAKhS,MAAMkoB,EAAGhB,IAAKw5B,EAAW/kB,IACzEsY,EAAOuM,EAAWA,EAAUxuC,KAAKhS,MAAM,EAAGioB,EAAKf,IAAMlV,EAAK,GAAIquC,EAAS,IACvEjrC,EAAIwrC,OAAO34B,EAAK+C,KAAO,EAAG81B,QAEvB,GAAmB,GAAf9uC,EAAK7W,OACd84C,EAAOuM,EAAWA,EAAUxuC,KAAKhS,MAAM,EAAGioB,EAAKf,IAAMlV,EAAK,GAAK8oB,EAAS9oB,KAAKhS,MAAMkoB,EAAGhB,IAAKm5B,EAAS,IACpGjrC,EAAI6G,OAAOgM,EAAK+C,KAAO,EAAG21B,OACrB,CACL1M,EAAOuM,EAAWA,EAAUxuC,KAAKhS,MAAM,EAAGioB,EAAKf,IAAMlV,EAAK,GAAIquC,EAAS,IACvEpM,EAAOnZ,EAAU2lB,EAAW3lB,EAAS9oB,KAAKhS,MAAMkoB,EAAGhB,IAAKw5B,GACxD,IAAIK,EAAUR,EAAS,EAAGvuC,EAAK7W,OAAS,GACpCwlD,EAAS,GAAKvrC,EAAI6G,OAAOgM,EAAK+C,KAAO,EAAG21B,EAAS,GACrDvrC,EAAIwrC,OAAO34B,EAAK+C,KAAO,EAAG+1B,GAG5BnhB,GAAYxqB,EAAK,SAAUA,EAAKuiB,GAIlC,SAASqpB,GAAW5rC,EAAKze,EAAGsqD,IAC1B,SAASC,EAAU9rC,EAAK+rC,EAAMC,GAC5B,GAAIhsC,EAAIisC,OAAU,IAAK,IAAIpmD,EAAI,EAAGA,EAAIma,EAAIisC,OAAOlmD,SAAUF,EAAG,CAC5D,IAAIqmD,EAAMlsC,EAAIisC,OAAOpmD,GACrB,GAAIqmD,EAAIlsC,KAAO+rC,EAAf,CACA,IAAII,EAASH,GAAcE,EAAIF,WAC3BH,IAAmBM,IACvB5qD,EAAE2qD,EAAIlsC,IAAKmsC,GACXL,EAAUI,EAAIlsC,IAAKA,EAAKmsC,MAG5BL,CAAU9rC,EAAK,MAAM,GAIvB,SAASosC,GAAU91B,EAAItW,GACrB,GAAIA,EAAIsW,GAAM,MAAM,IAAInkB,MAAM,oCAC9BmkB,EAAGtW,IAAMA,EACTA,EAAIsW,GAAKA,EACT4f,GAAoB5f,GACpBq0B,GAASr0B,GACT+1B,GAAkB/1B,GACbA,EAAGhd,QAAQ42B,cAAgBhK,GAAY5P,GAC5CA,EAAGhd,QAAQ6f,KAAOnZ,EAAI4qC,WACtBnU,GAAUngB,GAGZ,SAAS+1B,GAAkB/1B,IACN,OAApBA,EAAGtW,IAAI+T,UAAqBhd,EAAWqW,GAASkJ,EAAG1X,QAAQ68B,QAAS,kBAUrE,SAAS6Q,GAAQC,GAIfvhD,KAAKwhD,KAAO,GAAIxhD,KAAKyhD,OAAS,GAC9BzhD,KAAK0hD,UAAYjrD,IAGjBuJ,KAAK2hD,YAAc3hD,KAAK4hD,YAAc,EACtC5hD,KAAK6hD,OAAS7hD,KAAK8hD,UAAY,KAC/B9hD,KAAK+hD,WAAa/hD,KAAKgiD,cAAgB,KAEvChiD,KAAKiiD,WAAajiD,KAAKkiD,cAAgBX,GAAY,EAKrD,SAASY,GAAwBntC,EAAKuiB,GACpC,IAAI6qB,EAAa,CAACv6B,KAAMuJ,GAAQmG,EAAO1P,MAAOC,GAAIy3B,GAAUhoB,GAAS3lB,KAAMue,GAAWnb,EAAKuiB,EAAO1P,KAAM0P,EAAOzP,KAG/G,OAFAu6B,GAAiBrtC,EAAKotC,EAAY7qB,EAAO1P,KAAK+C,KAAM2M,EAAOzP,GAAG8C,KAAO,GACrEg2B,GAAW5rC,GAAK,SAAUA,GAAO,OAAOqtC,GAAiBrtC,EAAKotC,EAAY7qB,EAAO1P,KAAK+C,KAAM2M,EAAOzP,GAAG8C,KAAO,MAAO,GAC7Gw3B,EAKT,SAASE,GAAqBh9B,GAC5B,KAAOA,EAAMvqB,QACAurB,EAAIhB,GACN0nB,QAAU1nB,EAAMi9B,MAsB7B,SAASC,GAAmBxtC,EAAKuiB,EAAQkrB,EAAUC,GACjD,IAAIC,EAAO3tC,EAAI4tC,QACfD,EAAKlB,OAAO1mD,OAAS,EACrB,IAAsButB,EAClBmJ,EADAtM,GAAQ,IAAII,KAGhB,IAAKo9B,EAAKd,QAAUa,GACfC,EAAKZ,YAAcxqB,EAAO1R,QAAU0R,EAAO1R,SACd,KAA3B0R,EAAO1R,OAAO6B,OAAO,IAAai7B,EAAKhB,YAAcx8B,GAAQnQ,EAAIsW,GAAKtW,EAAIsW,GAAGhd,QAAQu0C,kBAAoB,MAC/E,KAA3BtrB,EAAO1R,OAAO6B,OAAO,OACtBY,EAzBP,SAAyBq6B,EAAM1I,GAC7B,OAAIA,GACFqI,GAAqBK,EAAKnB,MACnBl7B,EAAIq8B,EAAKnB,OACPmB,EAAKnB,KAAKzmD,SAAWurB,EAAIq8B,EAAKnB,MAAMxU,OACtC1mB,EAAIq8B,EAAKnB,MACPmB,EAAKnB,KAAKzmD,OAAS,IAAM4nD,EAAKnB,KAAKmB,EAAKnB,KAAKzmD,OAAS,GAAGiyC,QAClE2V,EAAKnB,KAAKe,MACHj8B,EAAIq8B,EAAKnB,YAFX,EAmBIsB,CAAgBH,EAAMA,EAAKd,QAAUa,IAE9CjxB,EAAOnL,EAAIgC,EAAIwX,SACoB,GAA/B5O,GAAIqG,EAAO1P,KAAM0P,EAAOzP,KAAyC,GAA7BoJ,GAAIqG,EAAO1P,KAAM4J,EAAK3J,IAG5D2J,EAAK3J,GAAKy3B,GAAUhoB,GAGpBjP,EAAIwX,QAAQ3zB,KAAKg2C,GAAwBntC,EAAKuiB,QAE3C,CAEL,IAAIlc,EAASiL,EAAIq8B,EAAKnB,MAMtB,IALKnmC,GAAWA,EAAO2xB,QACnB+V,GAAuB/tC,EAAI+3B,IAAK4V,EAAKnB,MACzCl5B,EAAM,CAACwX,QAAS,CAACqiB,GAAwBntC,EAAKuiB,IACvC0qB,WAAYU,EAAKV,YACxBU,EAAKnB,KAAKr1C,KAAKmc,GACRq6B,EAAKnB,KAAKzmD,OAAS4nD,EAAKjB,WAC7BiB,EAAKnB,KAAKlR,QACLqS,EAAKnB,KAAK,GAAGxU,QAAU2V,EAAKnB,KAAKlR,QAG1CqS,EAAKnB,KAAKr1C,KAAKs2C,GACfE,EAAKV,aAAeU,EAAKT,cACzBS,EAAKhB,YAAcgB,EAAKf,YAAcz8B,EACtCw9B,EAAKd,OAASc,EAAKb,UAAYY,EAC/BC,EAAKZ,WAAaY,EAAKX,cAAgBzqB,EAAO1R,OAEzC4L,GAAQtG,GAAOnW,EAAK,gBAgB3B,SAASguC,GAAsBhuC,EAAK+3B,EAAK2V,EAAMp0C,GAC7C,IAAIq0C,EAAO3tC,EAAI4tC,QAAS/8B,EAASvX,GAAWA,EAAQuX,OAMhD68B,GAAQC,EAAKb,WACZj8B,GAAU88B,EAAKX,eAAiBn8B,IAC/B88B,EAAKhB,aAAegB,EAAKf,aAAee,EAAKZ,YAAcl8B,GAtBnE,SAAmC7Q,EAAK6Q,EAAQuD,EAAM2jB,GACpD,IAAIjmB,EAAKjB,EAAO6B,OAAO,GACvB,MAAa,KAANZ,GACC,KAANA,GACAsC,EAAK4jB,OAAOjyC,QAAUgyC,EAAIC,OAAOjyC,QACjCquB,EAAK21B,qBAAuBhS,EAAIgS,qBAChC,IAAIx5B,KAAOvQ,EAAI4tC,QAAQhB,cAAgB5sC,EAAIsW,GAAKtW,EAAIsW,GAAGhd,QAAQu0C,kBAAoB,KAiB/EI,CAA0BjuC,EAAK6Q,EAAQS,EAAIq8B,EAAKnB,MAAOzU,IACzD4V,EAAKnB,KAAKmB,EAAKnB,KAAKzmD,OAAS,GAAKgyC,EAElCgW,GAAuBhW,EAAK4V,EAAKnB,MAErCmB,EAAKf,aAAe,IAAIr8B,KACxBo9B,EAAKX,cAAgBn8B,EACrB88B,EAAKb,UAAYY,EACbp0C,IAAiC,IAAtBA,EAAQ40C,WACnBZ,GAAqBK,EAAKlB,QAGhC,SAASsB,GAAuBhW,EAAKoW,GACnC,IAAIrtD,EAAMwwB,EAAI68B,GACRrtD,GAAOA,EAAIk3C,QAAUl3C,EAAI4oD,OAAO3R,IAClCoW,EAAKh3C,KAAK4gC,GAIhB,SAASsV,GAAiBrtC,EAAKuiB,EAAQ1P,EAAMC,GAC3C,IAAIs7B,EAAW7rB,EAAO,SAAWviB,EAAIkQ,IAAKN,EAAI,EAC9C5P,EAAIob,KAAK5kC,KAAKoP,IAAIoa,EAAI6a,MAAOhI,GAAOr8B,KAAK6P,IAAI2Z,EAAI6a,MAAQ7a,EAAI8a,KAAMhI,IAAK,SAAU8C,GAC5EA,EAAK8M,eACJ0rB,IAAaA,EAAW7rB,EAAO,SAAWviB,EAAIkQ,IAAM,KAAKN,GAAKgG,EAAK8M,eACtE9S,KAMN,SAASy+B,GAAmBlsB,GAC1B,IAAKA,EAAS,OAAO,KAErB,IADA,IAAIvrC,EACKiP,EAAI,EAAGA,EAAIs8B,EAAMp8B,SAAUF,EAC9Bs8B,EAAMt8B,GAAGo8B,OAAOqsB,kBAA0B13D,IAAOA,EAAMurC,EAAMv3B,MAAM,EAAG/E,IACjEjP,GAAOA,EAAIugB,KAAKgrB,EAAMt8B,IAEjC,OAAQjP,EAAcA,EAAImP,OAASnP,EAAM,KAA3BurC,EAiBhB,SAASosB,GAAcvuC,EAAKuiB,GAC1B,IAAIQ,EAdN,SAAqB/iB,EAAKuiB,GACxB,IAAIlP,EAAQkP,EAAO,SAAWviB,EAAIkQ,IAClC,IAAKmD,EAAS,OAAO,KAErB,IADA,IAAI2P,EAAK,GACAn9B,EAAI,EAAGA,EAAI08B,EAAO3lB,KAAK7W,SAAUF,EACtCm9B,EAAG7rB,KAAKk3C,GAAmBh7B,EAAMxtB,KACrC,OAAOm9B,EAQGwrB,CAAYxuC,EAAKuiB,GACvBksB,EAAYnsB,GAAuBtiB,EAAKuiB,GAC5C,IAAKQ,EAAO,OAAO0rB,EACnB,IAAKA,EAAa,OAAO1rB,EAEzB,IAAK,IAAIl9B,EAAI,EAAGA,EAAIk9B,EAAIh9B,SAAUF,EAAG,CACnC,IAAI6oD,EAAS3rB,EAAIl9B,GAAI8oD,EAAaF,EAAU5oD,GAC5C,GAAI6oD,GAAUC,EACZxsB,EAAO,IAAK,IAAIvN,EAAI,EAAGA,EAAI+5B,EAAW5oD,SAAU6uB,EAAG,CAEjD,IADA,IAAIwN,EAAOusB,EAAW/5B,GACbnhB,EAAI,EAAGA,EAAIi7C,EAAO3oD,SAAU0N,EACjC,GAAIi7C,EAAOj7C,GAAGwuB,QAAUG,EAAKH,OAAU,SAASE,EACpDusB,EAAOv3C,KAAKirB,QAELusB,IACT5rB,EAAIl9B,GAAK8oD,GAGb,OAAO5rB,EAKT,SAAS6rB,GAAiBtJ,EAAQuJ,EAAUC,GAE1C,IADA,IAAI/3D,EAAO,GACF8O,EAAI,EAAGA,EAAIy/C,EAAOv/C,SAAUF,EAAG,CACtC,IAAI0Q,EAAQ+uC,EAAOz/C,GACnB,GAAI0Q,EAAMyhC,OACRjhD,EAAKogB,KAAK23C,EAAiBrF,GAAU/+C,UAAUm/C,SAAS3+C,KAAKqL,GAASA,OADxE,CAIA,IAAIu0B,EAAUv0B,EAAMu0B,QAASikB,EAAa,GAC1Ch4D,EAAKogB,KAAK,CAAC2zB,QAASikB,IACpB,IAAK,IAAIn6B,EAAI,EAAGA,EAAIkW,EAAQ/kC,SAAU6uB,EAAG,CACvC,IAAI2N,EAASuI,EAAQlW,GAAI9sB,OAAI,EAE7B,GADAinD,EAAW53C,KAAK,CAAC0b,KAAM0P,EAAO1P,KAAMC,GAAIyP,EAAOzP,GAAIlW,KAAM2lB,EAAO3lB,OAC5DiyC,EAAY,IAAK,IAAIz/B,KAAQmT,GAAcz6B,EAAIsnB,EAAKrhB,MAAM,mBACxDmJ,EAAQ23C,EAAU/hC,OAAOhlB,EAAE,MAAQ,IACrCwpB,EAAIy9B,GAAY3/B,GAAQmT,EAAOnT,UACxBmT,EAAOnT,MAKtB,OAAOr4B,EAWT,SAASi4D,GAAY7hC,EAAOjN,EAAMi0B,EAAOppC,GACvC,GAAIA,EAAQ,CACV,IAAI6qC,EAASzoB,EAAMyoB,OACnB,GAAIzB,EAAO,CACT,IAAI8a,EAAY/yB,GAAIhc,EAAM01B,GAAU,EAChCqZ,GAAc/yB,GAAIiY,EAAOyB,GAAU,GACrCA,EAAS11B,EACTA,EAAOi0B,GACE8a,GAAc/yB,GAAIhc,EAAMi0B,GAAS,IAC1Cj0B,EAAOi0B,GAGX,OAAO,IAAI2V,GAAMlU,EAAQ11B,GAEzB,OAAO,IAAI4pC,GAAM3V,GAASj0B,EAAMA,GAKpC,SAASgvC,GAAgBlvC,EAAKE,EAAMi0B,EAAO76B,EAASvO,GACpC,MAAVA,IAAkBA,EAASiV,EAAIsW,KAAOtW,EAAIsW,GAAG1X,QAAQ08B,OAASt7B,EAAIjV,SACtEokD,GAAanvC,EAAK,IAAIypC,GAAU,CAACuF,GAAYhvC,EAAI+3B,IAAIJ,UAAWz3B,EAAMi0B,EAAOppC,IAAU,GAAIuO,GAK7F,SAAS81C,GAAiBpvC,EAAKqvC,EAAO/1C,GAGpC,IAFA,IAAI1iB,EAAM,GACNmU,EAASiV,EAAIsW,KAAOtW,EAAIsW,GAAG1X,QAAQ08B,OAASt7B,EAAIjV,QAC3ClF,EAAI,EAAGA,EAAIma,EAAI+3B,IAAIC,OAAOjyC,OAAQF,IACvCjP,EAAIiP,GAAKmpD,GAAYhvC,EAAI+3B,IAAIC,OAAOnyC,GAAIwpD,EAAMxpD,GAAI,KAAMkF,GAE5DokD,GAAanvC,EADAgqC,GAAmBhqC,EAAIsW,GAAI1/B,EAAKopB,EAAI+3B,IAAIE,WAC3B3+B,GAI5B,SAASg2C,GAAoBtvC,EAAKna,EAAGsnB,EAAO7T,GAC1C,IAAI0+B,EAASh4B,EAAI+3B,IAAIC,OAAOptC,MAAM,GAClCotC,EAAOnyC,GAAKsnB,EACZgiC,GAAanvC,EAAKgqC,GAAmBhqC,EAAIsW,GAAI0hB,EAAQh4B,EAAI+3B,IAAIE,WAAY3+B,GAI3E,SAASi2C,GAAmBvvC,EAAK41B,EAAQ11B,EAAM5G,GAC7C61C,GAAanvC,EAAKsqC,GAAgB1U,EAAQ11B,GAAO5G,GAsBnD,SAASk2C,GAA2BxvC,EAAK+3B,EAAKz+B,GAC5C,IAAIkzC,EAAOxsC,EAAI4tC,QAAQpB,KAAM/vB,EAAOnL,EAAIk7B,GACpC/vB,GAAQA,EAAKub,QACfwU,EAAKA,EAAKzmD,OAAS,GAAKgyC,EACxB0X,GAAmBzvC,EAAK+3B,EAAKz+B,IAE7B61C,GAAanvC,EAAK+3B,EAAKz+B,GAK3B,SAAS61C,GAAanvC,EAAK+3B,EAAKz+B,GAC9Bm2C,GAAmBzvC,EAAK+3B,EAAKz+B,GAC7B00C,GAAsBhuC,EAAKA,EAAI+3B,IAAK/3B,EAAIsW,GAAKtW,EAAIsW,GAAGO,MAAM3G,GAAKzgB,IAAK6J,GAGtE,SAASm2C,GAAmBzvC,EAAK+3B,EAAKz+B,IAChCyd,GAAW/W,EAAK,0BAA4BA,EAAIsW,IAAMS,GAAW/W,EAAIsW,GAAI,4BACzEyhB,EAnCN,SAA+B/3B,EAAK+3B,EAAKz+B,GACvC,IAAInO,EAAM,CACR6sC,OAAQD,EAAIC,OACZ6G,OAAQ,SAAS7G,GACfhtC,KAAKgtC,OAAS,GACd,IAAK,IAAInyC,EAAI,EAAGA,EAAImyC,EAAOjyC,OAAQF,IAC/BmF,KAAKgtC,OAAOnyC,GAAK,IAAIikD,GAAMttB,GAAQxc,EAAKg4B,EAAOnyC,GAAG+vC,QACzBpZ,GAAQxc,EAAKg4B,EAAOnyC,GAAGqa,QAEtD2Q,OAAQvX,GAAWA,EAAQuX,QAI7B,OAFAsF,GAAOnW,EAAK,wBAAyBA,EAAK7U,GACtC6U,EAAIsW,IAAMH,GAAOnW,EAAIsW,GAAI,wBAAyBtW,EAAIsW,GAAInrB,GAC1DA,EAAI6sC,QAAUD,EAAIC,OAAiBgS,GAAmBhqC,EAAIsW,GAAInrB,EAAI6sC,OAAQ7sC,EAAI6sC,OAAOjyC,OAAS,GACpFgyC,EAqBJ2X,CAAsB1vC,EAAK+3B,EAAKz+B,IAE1C,IAAI81B,EAAO91B,GAAWA,EAAQ81B,OAC3BlT,GAAI6b,EAAIJ,UAAUz3B,KAAMF,EAAI+3B,IAAIJ,UAAUz3B,MAAQ,GAAK,EAAI,GAC9DyvC,GAAkB3vC,EAAK4vC,GAAsB5vC,EAAK+3B,EAAK3I,GAAM,IAEvD91B,IAA8B,IAAnBA,EAAQqX,SAAqB3Q,EAAIsW,IAC9CumB,GAAoB78B,EAAIsW,IAG9B,SAASq5B,GAAkB3vC,EAAK+3B,GAC1BA,EAAI2R,OAAO1pC,EAAI+3B,OAEnB/3B,EAAI+3B,IAAMA,EAEN/3B,EAAIsW,KACNtW,EAAIsW,GAAGO,MAAMkqB,YAAc,EAC3B/gC,EAAIsW,GAAGO,MAAMsqB,kBAAmB,EAChCxqB,GAAqB3W,EAAIsW,KAE3BkU,GAAYxqB,EAAK,iBAAkBA,IAKrC,SAAS6vC,GAAiB7vC,GACxB2vC,GAAkB3vC,EAAK4vC,GAAsB5vC,EAAKA,EAAI+3B,IAAK,MAAM,IAKnE,SAAS6X,GAAsB5vC,EAAK+3B,EAAK3I,EAAM0gB,GAE7C,IADA,IAAIl5D,EACKiP,EAAI,EAAGA,EAAIkyC,EAAIC,OAAOjyC,OAAQF,IAAK,CAC1C,IAAIsnB,EAAQ4qB,EAAIC,OAAOnyC,GACnBk9B,EAAMgV,EAAIC,OAAOjyC,QAAUia,EAAI+3B,IAAIC,OAAOjyC,QAAUia,EAAI+3B,IAAIC,OAAOnyC,GACnEkqD,EAAYC,GAAWhwC,EAAKmN,EAAMyoB,OAAQ7S,GAAOA,EAAI6S,OAAQxG,EAAM0gB,GACnEG,EAAUD,GAAWhwC,EAAKmN,EAAMjN,KAAM6iB,GAAOA,EAAI7iB,KAAMkvB,EAAM0gB,IAC7Dl5D,GAAOm5D,GAAa5iC,EAAMyoB,QAAUqa,GAAW9iC,EAAMjN,QAClDtpB,IAAOA,EAAMmhD,EAAIC,OAAOptC,MAAM,EAAG/E,IACtCjP,EAAIiP,GAAK,IAAIikD,GAAMiG,EAAWE,IAGlC,OAAOr5D,EAAMozD,GAAmBhqC,EAAIsW,GAAI1/B,EAAKmhD,EAAIE,WAAaF,EAGhE,SAASmY,GAAgBlwC,EAAKiR,EAAKk/B,EAAQ19B,EAAKq9B,GAC9C,IAAIl6B,EAAOgF,GAAQ5a,EAAKiR,EAAI2E,MAC5B,GAAIA,EAAK8M,YAAe,IAAK,IAAI78B,EAAI,EAAGA,EAAI+vB,EAAK8M,YAAY38B,SAAUF,EAAG,CACxE,IAAIi/B,EAAKlP,EAAK8M,YAAY78B,GAAIiC,EAAIg9B,EAAG7C,OAKjCmuB,EAAqB,eAAgBtoD,GAAMA,EAAEuoD,WAAavoD,EAAEm7B,cAC5DqtB,EAAsB,gBAAiBxoD,GAAMA,EAAEyoD,YAAczoD,EAAEs7B,eAEnE,IAAgB,MAAX0B,EAAGjS,OAAiBu9B,EAAoBtrB,EAAGjS,MAAQ5B,EAAIa,GAAKgT,EAAGjS,KAAO5B,EAAIa,OACjE,MAATgT,EAAGhS,KAAew9B,EAAqBxrB,EAAGhS,IAAM7B,EAAIa,GAAKgT,EAAGhS,GAAK7B,EAAIa,KAAM,CAC9E,GAAIg+B,IACF35B,GAAOruB,EAAG,qBACNA,EAAEwmD,mBAAmB,CACvB,GAAK14B,EAAK8M,YACL,GAAG78B,EAAG,SADc,MAI7B,IAAKiC,EAAE0oD,OAAU,SAEjB,GAAIL,EAAQ,CACV,IAAIpvD,EAAO+G,EAAE08B,KAAK/R,EAAM,EAAI,GAAK,GAAIjX,OAAO,EAG5C,IAFIiX,EAAM,EAAI69B,EAAqBF,KAC/BrvD,EAAO0vD,GAAQzwC,EAAKjf,GAAO0xB,EAAK1xB,GAAQA,EAAK60B,MAAQ3E,EAAI2E,KAAOA,EAAO,OACvE70B,GAAQA,EAAK60B,MAAQ3E,EAAI2E,OAASpa,EAAO0gB,GAAIn7B,EAAMovD,MAAa19B,EAAM,EAAIjX,EAAO,EAAIA,EAAO,GAC5F,OAAO00C,GAAgBlwC,EAAKjf,EAAMkwB,EAAKwB,EAAKq9B,GAGlD,IAAI9uD,EAAM8G,EAAE08B,KAAK/R,EAAM,GAAK,EAAI,GAGhC,OAFIA,EAAM,EAAI29B,EAAoBE,KAC9BtvD,EAAMyvD,GAAQzwC,EAAKhf,EAAKyxB,EAAKzxB,EAAI40B,MAAQ3E,EAAI2E,KAAOA,EAAO,OACxD50B,EAAMkvD,GAAgBlwC,EAAKhf,EAAKiwB,EAAKwB,EAAKq9B,GAAY,MAGjE,OAAO7+B,EAIT,SAAS++B,GAAWhwC,EAAKiR,EAAKk/B,EAAQ/gB,EAAM0gB,GAC1C,IAAIr9B,EAAM2c,GAAQ,EACd/b,EAAQ68B,GAAgBlwC,EAAKiR,EAAKk/B,EAAQ19B,EAAKq9B,KAC7CA,GAAYI,GAAgBlwC,EAAKiR,EAAKk/B,EAAQ19B,GAAK,IACrDy9B,GAAgBlwC,EAAKiR,EAAKk/B,GAAS19B,EAAKq9B,KACtCA,GAAYI,GAAgBlwC,EAAKiR,EAAKk/B,GAAS19B,GAAK,GAC1D,OAAKY,IACHrT,EAAI0wC,UAAW,EACRz0B,GAAIjc,EAAI6a,MAAO,IAK1B,SAAS41B,GAAQzwC,EAAKiR,EAAKwB,EAAKmD,GAC9B,OAAInD,EAAM,GAAe,GAAVxB,EAAIa,GACbb,EAAI2E,KAAO5V,EAAI6a,MAAgB2B,GAAQxc,EAAKic,GAAIhL,EAAI2E,KAAO,IACjD,KACLnD,EAAM,GAAKxB,EAAIa,KAAO8D,GAAQgF,GAAQ5a,EAAKiR,EAAI2E,OAAOhZ,KAAK7W,OAChEkrB,EAAI2E,KAAO5V,EAAI6a,MAAQ7a,EAAI8a,KAAO,EAAYmB,GAAIhL,EAAI2E,KAAO,EAAG,GACtD,KAEP,IAAIqG,GAAIhL,EAAI2E,KAAM3E,EAAIa,GAAKW,GAItC,SAASk+B,GAAUr6B,GACjBA,EAAG64B,aAAalzB,GAAI3F,EAAG80B,YAAa,GAAInvB,GAAI3F,EAAGoP,YAAahV,GAM9D,SAASkgC,GAAa5wC,EAAKuiB,EAAQsc,GACjC,IAAI1zC,EAAM,CACR0lD,UAAU,EACVh+B,KAAM0P,EAAO1P,KACbC,GAAIyP,EAAOzP,GACXlW,KAAM2lB,EAAO3lB,KACbiU,OAAQ0R,EAAO1R,OACfigC,OAAQ,WAAc,OAAO3lD,EAAI0lD,UAAW,IAW9C,OATIhS,IAAU1zC,EAAI0zC,OAAS,SAAUhsB,EAAMC,EAAIlW,EAAMiU,GAC/CgC,IAAQ1nB,EAAI0nB,KAAO2J,GAAQxc,EAAK6S,IAChCC,IAAM3nB,EAAI2nB,GAAK0J,GAAQxc,EAAK8S,IAC5BlW,IAAQzR,EAAIyR,KAAOA,QACRlnB,IAAXm7B,IAAwB1lB,EAAI0lB,OAASA,KAE3CsF,GAAOnW,EAAK,eAAgBA,EAAK7U,GAC7B6U,EAAIsW,IAAMH,GAAOnW,EAAIsW,GAAI,eAAgBtW,EAAIsW,GAAInrB,GAEjDA,EAAI0lD,UACF7wC,EAAIsW,KAAMtW,EAAIsW,GAAGO,MAAMkqB,YAAc,GAClC,MAEF,CAACluB,KAAM1nB,EAAI0nB,KAAMC,GAAI3nB,EAAI2nB,GAAIlW,KAAMzR,EAAIyR,KAAMiU,OAAQ1lB,EAAI0lB,QAKlE,SAASkgC,GAAW/wC,EAAKuiB,EAAQyuB,GAC/B,GAAIhxC,EAAIsW,GAAI,CACV,IAAKtW,EAAIsW,GAAGO,MAAS,OAAOutB,GAAUpkC,EAAIsW,GAAIy6B,GAAlB3M,CAA8BpkC,EAAKuiB,EAAQyuB,GACvE,GAAIhxC,EAAIsW,GAAG4D,MAAM+2B,cAAiB,OAGpC,KAAIl6B,GAAW/W,EAAK,iBAAmBA,EAAIsW,IAAMS,GAAW/W,EAAIsW,GAAI,mBAClEiM,EAASquB,GAAa5wC,EAAKuiB,GAAQ,IADrC,CAOA,IAAItrB,EAAQ6qB,KAAqBkvB,GAlvHnC,SAA8BhxC,EAAK6S,EAAMC,GACvC,IAAImZ,EAAU,KAQd,GAPAjsB,EAAIob,KAAKvI,EAAK+C,KAAM9C,EAAG8C,KAAO,GAAG,SAAUA,GACzC,GAAIA,EAAK8M,YAAe,IAAK,IAAI78B,EAAI,EAAGA,EAAI+vB,EAAK8M,YAAY38B,SAAUF,EAAG,CACxE,IAAIqrD,EAAOt7B,EAAK8M,YAAY78B,GAAGo8B,QAC3BivB,EAAKhW,UAAcjP,IAAsC,GAA3B/0B,EAAQ+0B,EAASilB,KAC9CjlB,IAAYA,EAAU,KAAK90B,KAAK+5C,QAGpCjlB,EAAW,OAAO,KAEvB,IADA,IAAIklB,EAAQ,CAAC,CAACt+B,KAAMA,EAAMC,GAAIA,IACrBjtB,EAAI,EAAGA,EAAIomC,EAAQlmC,SAAUF,EAEpC,IADA,IAAIurD,EAAKnlB,EAAQpmC,GAAIiC,EAAIspD,EAAG5sB,KAAK,GACxB5P,EAAI,EAAGA,EAAIu8B,EAAMprD,SAAU6uB,EAAG,CACrC,IAAIhsB,EAAIuoD,EAAMv8B,GACd,KAAIsH,GAAItzB,EAAEkqB,GAAIhrB,EAAE+qB,MAAQ,GAAKqJ,GAAItzB,EAAEiqB,KAAM/qB,EAAEgrB,IAAM,GAAjD,CACA,IAAIu+B,EAAW,CAACz8B,EAAG,GAAI08B,EAAQp1B,GAAItzB,EAAEiqB,KAAM/qB,EAAE+qB,MAAO0+B,EAAMr1B,GAAItzB,EAAEkqB,GAAIhrB,EAAEgrB,KAClEw+B,EAAQ,IAAMF,EAAGnuB,gBAAkBquB,IACnCD,EAASl6C,KAAK,CAAC0b,KAAMjqB,EAAEiqB,KAAMC,GAAIhrB,EAAE+qB,QACnC0+B,EAAM,IAAMH,EAAGhuB,iBAAmBmuB,IAClCF,EAASl6C,KAAK,CAAC0b,KAAM/qB,EAAEgrB,GAAIA,GAAIlqB,EAAEkqB,KACrCq+B,EAAM15C,OAAO3L,MAAMqlD,EAAOE,GAC1Bz8B,GAAKy8B,EAAStrD,OAAS,GAG3B,OAAOorD,EAytH4CK,CAAqBxxC,EAAKuiB,EAAO1P,KAAM0P,EAAOzP,IACjG,GAAI7b,EACF,IAAK,IAAIpR,EAAIoR,EAAMlR,OAAS,EAAGF,GAAK,IAAKA,EACrC4rD,GAAgBzxC,EAAK,CAAC6S,KAAM5b,EAAMpR,GAAGgtB,KAAMC,GAAI7b,EAAMpR,GAAGitB,GAAIlW,KAAM/W,EAAI,CAAC,IAAM08B,EAAO3lB,KAAMiU,OAAQ0R,EAAO1R,cAE7G4gC,GAAgBzxC,EAAKuiB,IAIzB,SAASkvB,GAAgBzxC,EAAKuiB,GAC5B,GAA0B,GAAtBA,EAAO3lB,KAAK7W,QAAiC,IAAlBw8B,EAAO3lB,KAAK,IAA2C,GAA/Bsf,GAAIqG,EAAO1P,KAAM0P,EAAOzP,IAA/E,CACA,IAAI26B,EAAWhD,GAAsBzqC,EAAKuiB,GAC1CirB,GAAmBxtC,EAAKuiB,EAAQkrB,EAAUztC,EAAIsW,GAAKtW,EAAIsW,GAAGO,MAAM3G,GAAKzgB,KAErEiiD,GAAoB1xC,EAAKuiB,EAAQkrB,EAAUnrB,GAAuBtiB,EAAKuiB,IACvE,IAAIovB,EAAU,GAEd/F,GAAW5rC,GAAK,SAAUA,EAAKgsC,GACxBA,IAAgD,GAAlC90C,EAAQy6C,EAAS3xC,EAAI4tC,WACtCgE,GAAW5xC,EAAI4tC,QAASrrB,GACxBovB,EAAQx6C,KAAK6I,EAAI4tC,UAEnB8D,GAAoB1xC,EAAKuiB,EAAQ,KAAMD,GAAuBtiB,EAAKuiB,QAKvE,SAASsvB,GAAsB7xC,EAAKxH,EAAMs5C,GACxC,IAAIC,EAAW/xC,EAAIsW,IAAMtW,EAAIsW,GAAG4D,MAAM+2B,cACtC,IAAIc,GAAaD,EAAjB,CAQA,IANA,IAAwBv7C,EAApBo3C,EAAO3tC,EAAI4tC,QAAgBH,EAAWztC,EAAI+3B,IAC1C5lB,EAAiB,QAAR3Z,EAAiBm1C,EAAKnB,KAAOmB,EAAKlB,OAAQ0B,EAAe,QAAR31C,EAAiBm1C,EAAKlB,OAASkB,EAAKnB,KAI9F3mD,EAAI,EACDA,EAAIssB,EAAOpsB,SAChBwQ,EAAQ4b,EAAOtsB,GACXisD,GAAqBv7C,EAAMyhC,QAAWzhC,EAAMmzC,OAAO1pC,EAAI+3B,KAAQxhC,EAAMyhC,QAFjDnyC,KAK1B,GAAIA,GAAKssB,EAAOpsB,OAAhB,CAGA,IAFA4nD,EAAKZ,WAAaY,EAAKX,cAAgB,OAE9B,CAEP,KADAz2C,EAAQ4b,EAAOo7B,OACLvV,OAOH,IAAI+Z,EAET,YADA5/B,EAAOhb,KAAKZ,GAEL,MARP,GADAw3C,GAAuBx3C,EAAO43C,GAC1B2D,IAAuBv7C,EAAMmzC,OAAO1pC,EAAI+3B,KAE1C,YADAoX,GAAanvC,EAAKzJ,EAAO,CAAC23C,WAAW,IAGvCT,EAAWl3C,EASf,IAAIy7C,EAAc,GAClBjE,GAAuBN,EAAUU,GACjCA,EAAKh3C,KAAK,CAAC2zB,QAASknB,EAAa/E,WAAYU,EAAKV,aAClDU,EAAKV,WAAa12C,EAAM02C,cAAgBU,EAAKT,cA6B7C,IA3BA,IAAI+E,EAASl7B,GAAW/W,EAAK,iBAAmBA,EAAIsW,IAAMS,GAAW/W,EAAIsW,GAAI,gBAEzEyI,EAAO,SAAWl5B,GACpB,IAAI08B,EAAShsB,EAAMu0B,QAAQjlC,GAE3B,GADA08B,EAAO1R,OAASrY,EACZy5C,IAAWrB,GAAa5wC,EAAKuiB,GAAQ,GAEvC,OADApQ,EAAOpsB,OAAS,EACT,GAGTisD,EAAY76C,KAAKg2C,GAAwBntC,EAAKuiB,IAE9C,IAAIjV,EAAQznB,EAAI4kD,GAAsBzqC,EAAKuiB,GAAUjR,EAAIa,GACzDu/B,GAAoB1xC,EAAKuiB,EAAQjV,EAAOihC,GAAcvuC,EAAKuiB,KACtD18B,GAAKma,EAAIsW,IAAMtW,EAAIsW,GAAGgtB,eAAe,CAACzwB,KAAM0P,EAAO1P,KAAMC,GAAIy3B,GAAUhoB,KAC5E,IAAIovB,EAAU,GAGd/F,GAAW5rC,GAAK,SAAUA,EAAKgsC,GACxBA,IAAgD,GAAlC90C,EAAQy6C,EAAS3xC,EAAI4tC,WACtCgE,GAAW5xC,EAAI4tC,QAASrrB,GACxBovB,EAAQx6C,KAAK6I,EAAI4tC,UAEnB8D,GAAoB1xC,EAAKuiB,EAAQ,KAAMgsB,GAAcvuC,EAAKuiB,QAIrDpO,EAAM5d,EAAMu0B,QAAQ/kC,OAAS,EAAGouB,GAAO,IAAKA,EAAK,CACxD,IAAI7M,EAAWyX,EAAM5K,GAErB,GAAK7M,EAAW,OAAOA,EAAS3sB,KAMpC,SAASu3D,GAASlyC,EAAKxZ,GACrB,GAAgB,GAAZA,IACJwZ,EAAI6a,OAASr0B,EACbwZ,EAAI+3B,IAAM,IAAI0R,GAAUjwC,EAAIwG,EAAI+3B,IAAIC,QAAQ,SAAU7qB,GAAS,OAAO,IAAI28B,GACxE7tB,GAAI9O,EAAMyoB,OAAOhgB,KAAOpvB,EAAU2mB,EAAMyoB,OAAO9jB,IAC/CmK,GAAI9O,EAAMjN,KAAK0V,KAAOpvB,EAAU2mB,EAAMjN,KAAK4R,QACtC9R,EAAI+3B,IAAIE,WACXj4B,EAAIsW,IAAI,CACVmgB,GAAUz2B,EAAIsW,GAAItW,EAAI6a,MAAO7a,EAAI6a,MAAQr0B,EAAUA,GACnD,IAAK,IAAIU,EAAI8Y,EAAIsW,GAAG1X,QAAS/U,EAAI3C,EAAEu5B,SAAU52B,EAAI3C,EAAEw5B,OAAQ72B,IACvDstC,GAAcn3B,EAAIsW,GAAIzsB,EAAG,WAMjC,SAAS6nD,GAAoB1xC,EAAKuiB,EAAQkrB,EAAUtrB,GAClD,GAAIniB,EAAIsW,KAAOtW,EAAIsW,GAAGO,MAClB,OAAOutB,GAAUpkC,EAAIsW,GAAIo7B,GAAlBtN,CAAuCpkC,EAAKuiB,EAAQkrB,EAAUtrB,GAEzE,GAAII,EAAOzP,GAAG8C,KAAO5V,EAAI6a,MACvBq3B,GAASlyC,EAAKuiB,EAAO3lB,KAAK7W,OAAS,GAAKw8B,EAAOzP,GAAG8C,KAAO2M,EAAO1P,KAAK+C,YAGvE,KAAI2M,EAAO1P,KAAK+C,KAAO5V,EAAI0lB,YAA3B,CAGA,GAAInD,EAAO1P,KAAK+C,KAAO5V,EAAI6a,MAAO,CAChC,IAAIygB,EAAQ/Y,EAAO3lB,KAAK7W,OAAS,GAAKia,EAAI6a,MAAQ0H,EAAO1P,KAAK+C,MAC9Ds8B,GAASlyC,EAAKs7B,GACd/Y,EAAS,CAAC1P,KAAMoJ,GAAIjc,EAAI6a,MAAO,GAAI/H,GAAImJ,GAAIsG,EAAOzP,GAAG8C,KAAO0lB,EAAO/Y,EAAOzP,GAAGhB,IACnElV,KAAM,CAAC0U,EAAIiR,EAAO3lB,OAAQiU,OAAQ0R,EAAO1R,QAErD,IAAI4L,EAAOzc,EAAI0lB,WACXnD,EAAOzP,GAAG8C,KAAO6G,IACnB8F,EAAS,CAAC1P,KAAM0P,EAAO1P,KAAMC,GAAImJ,GAAIQ,EAAM7B,GAAQ5a,EAAKyc,GAAM7f,KAAK7W,QACzD6W,KAAM,CAAC2lB,EAAO3lB,KAAK,IAAKiU,OAAQ0R,EAAO1R,SAGnD0R,EAAO4vB,QAAUh3B,GAAWnb,EAAKuiB,EAAO1P,KAAM0P,EAAOzP,IAEhD26B,IAAYA,EAAWhD,GAAsBzqC,EAAKuiB,IACnDviB,EAAIsW,GAUV,SAAqCA,EAAIiM,EAAQJ,GAC/C,IAAIniB,EAAMsW,EAAGtW,IAAKpB,EAAU0X,EAAG1X,QAASiU,EAAO0P,EAAO1P,KAAMC,EAAKyP,EAAOzP,GAEpEs/B,GAAqB,EAAOC,EAAkBx/B,EAAK+C,KAClDU,EAAGhd,QAAQ42B,eACdmiB,EAAkB92B,GAAO6J,GAAWxK,GAAQ5a,EAAK6S,EAAK+C,QACtD5V,EAAIob,KAAKi3B,EAAiBv/B,EAAG8C,KAAO,GAAG,SAAUA,GAC/C,GAAIA,GAAQhX,EAAQunB,QAElB,OADAisB,GAAqB,GACd,MAKTpyC,EAAI+3B,IAAIlqB,SAAS0U,EAAO1P,KAAM0P,EAAOzP,KAAO,GAC5C6D,GAAqBL,GAEzB00B,GAAUhrC,EAAKuiB,EAAQJ,EAAOoE,GAAejQ,IAExCA,EAAGhd,QAAQ42B,eACdlwB,EAAIob,KAAKi3B,EAAiBx/B,EAAK+C,KAAO2M,EAAO3lB,KAAK7W,QAAQ,SAAU6vB,GAClE,IAAIn6B,EAAMuqC,GAAWpQ,GACjBn6B,EAAMmjB,EAAQwnB,gBAChBxnB,EAAQunB,QAAUvQ,EAClBhX,EAAQwnB,cAAgB3qC,EACxBmjB,EAAQynB,gBAAiB,EACzB+rB,GAAqB,MAGrBA,IAAsB97B,EAAGO,MAAMuqB,eAAgB,IA/kIvD,SAAyBphC,EAAK4P,GAE5B,GADA5P,EAAI+f,aAAevpC,KAAK6P,IAAI2Z,EAAI+f,aAAcnQ,KAC1C5P,EAAI8f,kBAAoBlQ,EAAI,IAAhC,CAEA,IADA,IAAIrB,EAAQvO,EAAI6a,MACPjF,EAAOhG,EAAI,EAAGgG,EAAOrH,EAAOqH,IAAQ,CAC3C,IAAI0K,EAAQ1F,GAAQ5a,EAAK4V,GAAMgK,WAI/B,GAAIU,MAAYA,aAAiBnC,KAAiBvI,EAAO0K,EAAMtC,UAAYpO,GAAI,CAC7ErB,EAAQqH,EAAO,EACf,OAGJ5V,EAAI8f,kBAAoBtpC,KAAK6P,IAAI2Z,EAAI8f,kBAAmBvR,IAokIxD+jC,CAAgBtyC,EAAK6S,EAAK+C,MAC1B4nB,GAAYlnB,EAAI,KAEhB,IAAIogB,EAAUnU,EAAO3lB,KAAK7W,QAAU+sB,EAAG8C,KAAO/C,EAAK+C,MAAQ,EAEvD2M,EAAOC,KACPiU,GAAUngB,GACLzD,EAAK+C,MAAQ9C,EAAG8C,MAA8B,GAAtB2M,EAAO3lB,KAAK7W,QAAgB+kD,GAAkBx0B,EAAGtW,IAAKuiB,GAGnFkU,GAAUngB,EAAIzD,EAAK+C,KAAM9C,EAAG8C,KAAO,EAAG8gB,GAFtCS,GAAc7gB,EAAIzD,EAAK+C,KAAM,QAIjC,IAAI28B,EAAiBx7B,GAAWT,EAAI,WAAYk8B,EAAgBz7B,GAAWT,EAAI,UAC/E,GAAIk8B,GAAiBD,EAAgB,CACnC,IAAIpnD,EAAM,CACR0nB,KAAMA,EAAMC,GAAIA,EAChBlW,KAAM2lB,EAAO3lB,KACbu1C,QAAS5vB,EAAO4vB,QAChBthC,OAAQ0R,EAAO1R,QAEb2hC,GAAiBhoB,GAAYlU,EAAI,SAAUA,EAAInrB,GAC/ConD,IAAmBj8B,EAAGO,MAAMoqB,aAAe3qB,EAAGO,MAAMoqB,WAAa,KAAK9pC,KAAKhM,GAEjFmrB,EAAG1X,QAAQu8B,kBAAoB,KAjEjBsX,CAA4BzyC,EAAIsW,GAAIiM,EAAQJ,GACnD6oB,GAAUhrC,EAAKuiB,EAAQJ,GAC9BstB,GAAmBzvC,EAAKytC,EAAU/8B,GAE9B1Q,EAAI0wC,UAAYV,GAAWhwC,EAAKic,GAAIjc,EAAIorC,YAAa,MACrDprC,EAAI0wC,UAAW,IA+DrB,SAASgC,GAAa1yC,EAAKiU,EAAMpB,EAAMC,EAAIjC,GACzC,IAAI8hC,EAEC7/B,IAAMA,EAAKD,GACZqJ,GAAIpJ,EAAID,GAAQ,IAA2BA,GAArB8/B,EAAS,CAAC7/B,EAAID,IAAqB,GAAIC,EAAK6/B,EAAO,IAC1D,iBAAR1+B,IAAoBA,EAAOjU,EAAI4yC,WAAW3+B,IACrD88B,GAAW/wC,EAAK,CAAC6S,KAAMA,EAAMC,GAAIA,EAAIlW,KAAMqX,EAAMpD,OAAQA,IAK3D,SAASgiC,GAAoB5hC,EAAK4B,EAAMC,EAAItX,GACtCsX,EAAK7B,EAAI2E,KACX3E,EAAI2E,MAAQpa,EACHqX,EAAO5B,EAAI2E,OACpB3E,EAAI2E,KAAO/C,EACX5B,EAAIa,GAAK,GAWb,SAASghC,GAAgBxiC,EAAOuC,EAAMC,EAAItX,GACxC,IAAK,IAAI3V,EAAI,EAAGA,EAAIyqB,EAAMvqB,SAAUF,EAAG,CACrC,IAAII,EAAMqqB,EAAMzqB,GAAIktD,GAAK,EACzB,GAAI9sD,EAAI+xC,OAAR,CACO/xC,EAAI+sD,UAAU/sD,EAAMqqB,EAAMzqB,GAAKI,EAAI4jD,YAAgBmJ,QAAS,GACjE,IAAK,IAAIp+B,EAAI,EAAGA,EAAI3uB,EAAI+xC,OAAOjyC,OAAQ6uB,IACrCi+B,GAAoB5sD,EAAI+xC,OAAOpjB,GAAGghB,OAAQ/iB,EAAMC,EAAItX,GACpDq3C,GAAoB5sD,EAAI+xC,OAAOpjB,GAAG1U,KAAM2S,EAAMC,EAAItX,OAJtD,CAQA,IAAK,IAAI2Z,EAAM,EAAGA,EAAMlvB,EAAI6kC,QAAQ/kC,SAAUovB,EAAK,CACjD,IAAI7B,EAAMrtB,EAAI6kC,QAAQ3V,GACtB,GAAIrC,EAAKQ,EAAIT,KAAK+C,KAChBtC,EAAIT,KAAOoJ,GAAI3I,EAAIT,KAAK+C,KAAOpa,EAAM8X,EAAIT,KAAKf,IAC9CwB,EAAIR,GAAKmJ,GAAI3I,EAAIR,GAAG8C,KAAOpa,EAAM8X,EAAIR,GAAGhB,SACnC,GAAIe,GAAQS,EAAIR,GAAG8C,KAAM,CAC9Bm9B,GAAK,EACL,OAGCA,IACHziC,EAAM7Y,OAAO,EAAG5R,EAAI,GACpBA,EAAI,KAKV,SAAS+rD,GAAWjE,EAAMprB,GACxB,IAAI1P,EAAO0P,EAAO1P,KAAK+C,KAAM9C,EAAKyP,EAAOzP,GAAG8C,KAAMpa,EAAO+mB,EAAO3lB,KAAK7W,QAAU+sB,EAAKD,GAAQ,EAC5FigC,GAAgBnF,EAAKnB,KAAM35B,EAAMC,EAAItX,GACrCs3C,GAAgBnF,EAAKlB,OAAQ55B,EAAMC,EAAItX,GAMzC,SAASy3C,GAAWjzC,EAAKkzC,EAAQC,EAAYrS,GAC3C,IAAItlB,EAAK03B,EAAQt9B,EAAOs9B,EAGxB,MAFqB,iBAAVA,EAAsBt9B,EAAOgF,GAAQ5a,EAAKuc,GAASvc,EAAKkzC,IAC5D13B,EAAKD,GAAO23B,GACT,MAAN13B,EAAqB,MACrBslB,EAAGlrB,EAAM4F,IAAOxb,EAAIsW,IAAM6gB,GAAcn3B,EAAIsW,GAAIkF,EAAI23B,GACjDv9B,GAgBT,SAASw9B,GAAUp4B,GACjBhwB,KAAKgwB,MAAQA,EACbhwB,KAAKuG,OAAS,KAEd,IADA,IAAIyG,EAAS,EACJnS,EAAI,EAAGA,EAAIm1B,EAAMj1B,SAAUF,EAClCm1B,EAAMn1B,GAAG0L,OAASvG,KAClBgN,GAAUgjB,EAAMn1B,GAAGmS,OAErBhN,KAAKgN,OAASA,EAqChB,SAASq7C,GAAYp4B,GACnBjwB,KAAKiwB,SAAWA,EAEhB,IADA,IAAIH,EAAO,EAAG9iB,EAAS,EACdnS,EAAI,EAAGA,EAAIo1B,EAASl1B,SAAUF,EAAG,CACxC,IAAIisB,EAAKmJ,EAASp1B,GAClBi1B,GAAQhJ,EAAGoJ,YAAaljB,GAAU8Z,EAAG9Z,OACrC8Z,EAAGvgB,OAASvG,KAEdA,KAAK8vB,KAAOA,EACZ9vB,KAAKgN,OAASA,EACdhN,KAAKuG,OAAS,KApgChBu4C,GAAMp/C,UAAUmoB,KAAO,WAAc,OAAOyJ,GAAOtxB,KAAK4qC,OAAQ5qC,KAAKkV,OACrE4pC,GAAMp/C,UAAUooB,GAAK,WAAc,OAAOuJ,GAAOrxB,KAAK4qC,OAAQ5qC,KAAKkV,OACnE4pC,GAAMp/C,UAAUwtC,MAAQ,WAAc,OAAOltC,KAAKkV,KAAK0V,MAAQ5qB,KAAK4qC,OAAOhgB,MAAQ5qB,KAAKkV,KAAK4R,IAAM9mB,KAAK4qC,OAAO9jB,IAs9B/GshC,GAAU1oD,UAAY,CACpBwwB,UAAW,WAAa,OAAOlwB,KAAKgwB,MAAMj1B,QAG1CutD,YAAa,SAASj+B,EAAIzF,GACxB,IAAK,IAAI/pB,EAAIwvB,EAAI3hB,EAAI2hB,EAAKzF,EAAG/pB,EAAI6N,IAAK7N,EAAG,CACvC,IAAI+vB,EAAO5qB,KAAKgwB,MAAMn1B,GACtBmF,KAAKgN,QAAU4d,EAAK5d,OACpBwuB,GAAY5Q,GACZ4U,GAAY5U,EAAM,UAEpB5qB,KAAKgwB,MAAMvjB,OAAO4d,EAAIzF,IAIxBd,SAAU,SAASkM,GACjBA,EAAM7jB,KAAKrL,MAAMkvB,EAAOhwB,KAAKgwB,QAK/Bu4B,YAAa,SAASl+B,EAAI2F,EAAOhjB,GAC/BhN,KAAKgN,QAAUA,EACfhN,KAAKgwB,MAAQhwB,KAAKgwB,MAAMpwB,MAAM,EAAGyqB,GAAIjP,OAAO4U,GAAO5U,OAAOpb,KAAKgwB,MAAMpwB,MAAMyqB,IAC3E,IAAK,IAAIxvB,EAAI,EAAGA,EAAIm1B,EAAMj1B,SAAUF,EAAKm1B,EAAMn1B,GAAG0L,OAASvG,MAI7DwoD,MAAO,SAASn+B,EAAIzF,EAAGkxB,GACrB,IAAK,IAAIptC,EAAI2hB,EAAKzF,EAAGyF,EAAK3hB,IAAK2hB,EAC3B,GAAIyrB,EAAG91C,KAAKgwB,MAAM3F,IAAQ,OAAO,IAiBzCg+B,GAAY3oD,UAAY,CACtBwwB,UAAW,WAAa,OAAOlwB,KAAK8vB,MAEpCw4B,YAAa,SAASj+B,EAAIzF,GACxB5kB,KAAK8vB,MAAQlL,EACb,IAAK,IAAI/pB,EAAI,EAAGA,EAAImF,KAAKiwB,SAASl1B,SAAUF,EAAG,CAC7C,IAAIioB,EAAQ9iB,KAAKiwB,SAASp1B,GAAItG,EAAKuuB,EAAMoN,YACzC,GAAI7F,EAAK91B,EAAI,CACX,IAAIinD,EAAKhwD,KAAK6P,IAAIupB,EAAGrwB,EAAK81B,GAAKo+B,EAAY3lC,EAAM9V,OAIjD,GAHA8V,EAAMwlC,YAAYj+B,EAAImxB,GACtBx7C,KAAKgN,QAAUy7C,EAAY3lC,EAAM9V,OAC7BzY,GAAMinD,IAAMx7C,KAAKiwB,SAASxjB,OAAO5R,IAAK,GAAIioB,EAAMvc,OAAS,MAC5C,IAAZqe,GAAK42B,GAAY,MACtBnxB,EAAK,OACEA,GAAM91B,EAIjB,GAAIyL,KAAK8vB,KAAOlL,EAAI,KACf5kB,KAAKiwB,SAASl1B,OAAS,KAAOiF,KAAKiwB,SAAS,aAAcm4B,KAAa,CAC1E,IAAIp4B,EAAQ,GACZhwB,KAAK8jB,SAASkM,GACdhwB,KAAKiwB,SAAW,CAAC,IAAIm4B,GAAUp4B,IAC/BhwB,KAAKiwB,SAAS,GAAG1pB,OAASvG,OAI9B8jB,SAAU,SAASkM,GACjB,IAAK,IAAIn1B,EAAI,EAAGA,EAAImF,KAAKiwB,SAASl1B,SAAUF,EAAKmF,KAAKiwB,SAASp1B,GAAGipB,SAASkM,IAG7Eu4B,YAAa,SAASl+B,EAAI2F,EAAOhjB,GAC/BhN,KAAK8vB,MAAQE,EAAMj1B,OACnBiF,KAAKgN,QAAUA,EACf,IAAK,IAAInS,EAAI,EAAGA,EAAImF,KAAKiwB,SAASl1B,SAAUF,EAAG,CAC7C,IAAIioB,EAAQ9iB,KAAKiwB,SAASp1B,GAAItG,EAAKuuB,EAAMoN,YACzC,GAAI7F,GAAM91B,EAAI,CAEZ,GADAuuB,EAAMylC,YAAYl+B,EAAI2F,EAAOhjB,GACzB8V,EAAMkN,OAASlN,EAAMkN,MAAMj1B,OAAS,GAAI,CAI1C,IADA,IAAI2tD,EAAY5lC,EAAMkN,MAAMj1B,OAAS,GAAK,GACjCkrB,EAAMyiC,EAAWziC,EAAMnD,EAAMkN,MAAMj1B,QAAS,CACnD,IAAI4tD,EAAO,IAAIP,GAAUtlC,EAAMkN,MAAMpwB,MAAMqmB,EAAKA,GAAO,KACvDnD,EAAM9V,QAAU27C,EAAK37C,OACrBhN,KAAKiwB,SAASxjB,SAAS5R,EAAG,EAAG8tD,GAC7BA,EAAKpiD,OAASvG,KAEhB8iB,EAAMkN,MAAQlN,EAAMkN,MAAMpwB,MAAM,EAAG8oD,GACnC1oD,KAAK4oD,aAEP,MAEFv+B,GAAM91B,IAKVq0D,WAAY,WACV,KAAI5oD,KAAKiwB,SAASl1B,QAAU,IAA5B,CACA,IAAI8tD,EAAK7oD,KACT,EAAG,CACD,IACI8oD,EAAU,IAAIT,GADJQ,EAAG54B,SAASxjB,OAAOo8C,EAAG54B,SAASl1B,OAAS,EAAG,IAEzD,GAAK8tD,EAAGtiD,OAKF,CACJsiD,EAAG/4B,MAAQg5B,EAAQh5B,KACnB+4B,EAAG77C,QAAU87C,EAAQ97C,OACrB,IAAI+7C,EAAU78C,EAAQ28C,EAAGtiD,OAAO0pB,SAAU44B,GAC1CA,EAAGtiD,OAAO0pB,SAASxjB,OAAOs8C,EAAU,EAAG,EAAGD,OAT5B,CACd,IAAI/8D,EAAO,IAAIs8D,GAAYQ,EAAG54B,UAC9BlkC,EAAKwa,OAASsiD,EACdA,EAAG54B,SAAW,CAAClkC,EAAM+8D,GACrBD,EAAK98D,EAOP+8D,EAAQviD,OAASsiD,EAAGtiD,aACbsiD,EAAG54B,SAASl1B,OAAS,IAC9B8tD,EAAGtiD,OAAOqiD,eAGZJ,MAAO,SAASn+B,EAAIzF,EAAGkxB,GACrB,IAAK,IAAIj7C,EAAI,EAAGA,EAAImF,KAAKiwB,SAASl1B,SAAUF,EAAG,CAC7C,IAAIioB,EAAQ9iB,KAAKiwB,SAASp1B,GAAItG,EAAKuuB,EAAMoN,YACzC,GAAI7F,EAAK91B,EAAI,CACX,IAAIy0D,EAAOx9D,KAAK6P,IAAIupB,EAAGrwB,EAAK81B,GAC5B,GAAIvH,EAAM0lC,MAAMn+B,EAAI2+B,EAAMlT,GAAO,OAAO,EACxC,GAAmB,IAAdlxB,GAAKokC,GAAc,MACxB3+B,EAAK,OACEA,GAAM91B,KAOrB,IAAI00D,GAAa,SAASj0C,EAAK6K,EAAMvR,GACnC,GAAIA,EAAW,IAAK,IAAII,KAAOJ,EAAeA,EAAQ+V,eAAe3V,KACjE1O,KAAK0O,GAAOJ,EAAQI,IACxB1O,KAAKgV,IAAMA,EACXhV,KAAK6f,KAAOA,GAqCd,SAASqpC,GAA6B59B,EAAIV,EAAMpa,GAC1CsqB,GAAalQ,IAAUU,EAAGO,OAASP,EAAGO,MAAMqc,WAAc5c,EAAGtW,IAAIkzB,YACjEyJ,GAAermB,EAAI9a,GApCzBy4C,GAAWvpD,UAAUk1C,MAAQ,WAC3B,IAAItpB,EAAKtrB,KAAKgV,IAAIsW,GAAI2W,EAAKjiC,KAAK4qB,KAAKoX,QAASpX,EAAO5qB,KAAK4qB,KAAM4F,EAAKD,GAAO3F,GAC5E,GAAU,MAAN4F,GAAeyR,EAAnB,CACA,IAAK,IAAIpnC,EAAI,EAAGA,EAAIonC,EAAGlnC,SAAUF,EAASonC,EAAGpnC,IAAMmF,MAAQiiC,EAAGx1B,OAAO5R,IAAK,GACrEonC,EAAGlnC,SAAU6vB,EAAKoX,QAAU,MACjC,IAAIh1B,EAASy1B,GAAaziC,MAC1BswB,GAAiB1F,EAAMp/B,KAAKoP,IAAI,EAAGgwB,EAAK5d,OAASA,IAC7Cse,IACF6tB,GAAQ7tB,GAAI,WACV49B,GAA6B59B,EAAIV,GAAO5d,GACxCm/B,GAAc7gB,EAAIkF,EAAI,aAExBgP,GAAYlU,EAAI,oBAAqBA,EAAItrB,KAAMwwB,MAInDy4B,GAAWvpD,UAAU+4C,QAAU,WAC3B,IAAI0Q,EAASnpD,KAEXopD,EAAOppD,KAAKgN,OAAQse,EAAKtrB,KAAKgV,IAAIsW,GAAIV,EAAO5qB,KAAK4qB,KACtD5qB,KAAKgN,OAAS,KACd,IAAIwD,EAAOiyB,GAAaziC,MAAQopD,EAC3B54C,IACAmqB,GAAa36B,KAAKgV,IAAK4V,IAAS0F,GAAiB1F,EAAMA,EAAK5d,OAASwD,GACtE8a,GACF6tB,GAAQ7tB,GAAI,WACVA,EAAGO,MAAM6Y,aAAc,EACvBwkB,GAA6B59B,EAAIV,EAAMpa,GACvCgvB,GAAYlU,EAAI,oBAAqBA,EAAI69B,EAAQ54B,GAAO3F,SAI9DoB,GAAWi9B,IA2CX,IAAII,GAAe,EAEfC,GAAa,SAASt0C,EAAKxH,GAC7BxN,KAAKgwB,MAAQ,GACbhwB,KAAKwN,KAAOA,EACZxN,KAAKgV,IAAMA,EACXhV,KAAKklB,KAAOmkC,IAkHd,SAASE,GAASv0C,EAAK6S,EAAMC,EAAIxZ,EAASd,GAIxC,GAAIc,GAAWA,EAAQ6yC,OAAU,OA2FnC,SAAwBnsC,EAAK6S,EAAMC,EAAIxZ,EAASd,IAC9Cc,EAAU4V,EAAQ5V,IACV6yC,QAAS,EACjB,IAAIlgB,EAAU,CAACsoB,GAASv0C,EAAK6S,EAAMC,EAAIxZ,EAASd,IAAQm/B,EAAU1L,EAAQ,GACtE9C,EAAS7vB,EAAQssB,WAQrB,OAPAgmB,GAAW5rC,GAAK,SAAUA,GACpBmpB,IAAU7vB,EAAQssB,WAAauD,EAAOqrB,WAAU,IACpDvoB,EAAQ90B,KAAKo9C,GAASv0C,EAAKwc,GAAQxc,EAAK6S,GAAO2J,GAAQxc,EAAK8S,GAAKxZ,EAASd,IAC1E,IAAK,IAAI3S,EAAI,EAAGA,EAAIma,EAAIisC,OAAOlmD,SAAUF,EACrC,GAAIma,EAAIisC,OAAOpmD,GAAG4uD,SAAY,OAClC9c,EAAUrmB,EAAI2a,MAET,IAAIyoB,GAAiBzoB,EAAS0L,GAvGGgd,CAAe30C,EAAK6S,EAAMC,EAAIxZ,EAASd,GAE/E,GAAIwH,EAAIsW,KAAOtW,EAAIsW,GAAGO,MAAS,OAAOutB,GAAUpkC,EAAIsW,GAAIi+B,GAAlBnQ,CAA4BpkC,EAAK6S,EAAMC,EAAIxZ,EAASd,GAE1F,IAAIypB,EAAS,IAAIqyB,GAAWt0C,EAAKxH,GAAOgD,EAAO0gB,GAAIrJ,EAAMC,GAGzD,GAFIxZ,GAAW4V,EAAQ5V,EAAS2oB,GAAQ,GAEpCzmB,EAAO,GAAa,GAARA,IAAuC,IAA1BymB,EAAO6B,eAChC,OAAO7B,EAQX,GAPIA,EAAO2yB,eAET3yB,EAAO8C,WAAY,EACnB9C,EAAO2D,WAAahY,EAAK,OAAQ,CAACqU,EAAO2yB,cAAe,qBACnDt7C,EAAQ4zB,mBAAqBjL,EAAO2D,WAAW5sB,aAAa,mBAAoB,QACjFM,EAAQ4pB,aAAcjB,EAAO2D,WAAW1C,YAAa,IAEvDjB,EAAO8C,UAAW,CACpB,GAAII,GAA0BnlB,EAAK6S,EAAK+C,KAAM/C,EAAMC,EAAImP,IACpDpP,EAAK+C,MAAQ9C,EAAG8C,MAAQuP,GAA0BnlB,EAAK8S,EAAG8C,KAAM/C,EAAMC,EAAImP,GAC1E,MAAM,IAAI9vB,MAAM,oEAniJtB4vB,IAAoB,EAuiJhBE,EAAO4yB,cACPrH,GAAmBxtC,EAAK,CAAC6S,KAAMA,EAAMC,GAAIA,EAAIjC,OAAQ,YAAa7Q,EAAI+3B,IAAKtoC,KAE/E,IAAsC2xC,EAAlC0T,EAAUjiC,EAAK+C,KAAMU,EAAKtW,EAAIsW,GA0BlC,GAzBAtW,EAAIob,KAAK05B,EAAShiC,EAAG8C,KAAO,GAAG,SAAUA,GACnCU,GAAM2L,EAAO8C,YAAczO,EAAGhd,QAAQ42B,cAAgB9K,GAAWxP,IAASU,EAAG1X,QAAQunB,UACrFib,GAAgB,GAChBnf,EAAO8C,WAAa+vB,GAAWjiC,EAAK+C,MAAQ0F,GAAiB1F,EAAM,GAphJ3E,SAAuBA,EAAMwM,GAC3BxM,EAAK8M,YAAc9M,EAAK8M,YAAc9M,EAAK8M,YAAYtc,OAAO,CAACgc,IAAS,CAACA,GACzEA,EAAKH,OAAOiC,WAAWtO,GAmhJrBm/B,CAAcn/B,EAAM,IAAIoM,GAAWC,EACA6yB,GAAWjiC,EAAK+C,KAAO/C,EAAKf,GAAK,KACjCgjC,GAAWhiC,EAAG8C,KAAO9C,EAAGhB,GAAK,SAC9DgjC,KAGA7yB,EAAO8C,WAAa/kB,EAAIob,KAAKvI,EAAK+C,KAAM9C,EAAG8C,KAAO,GAAG,SAAUA,GAC7D+P,GAAa3lB,EAAK4V,IAAS0F,GAAiB1F,EAAM,MAGpDqM,EAAO+yB,cAAgBl/B,GAAGmM,EAAQ,qBAAqB,WAAc,OAAOA,EAAO2d,WAEnF3d,EAAOiZ,WA/jJXpZ,IAAmB,GAikJb9hB,EAAI4tC,QAAQpB,KAAKzmD,QAAUia,EAAI4tC,QAAQnB,OAAO1mD,SAC9Cia,EAAIi1C,gBAENhzB,EAAO8C,YACT9C,EAAO/R,KAAOmkC,GACdpyB,EAAOuuB,QAAS,GAEdl6B,EAAI,CAGN,GADI8qB,IAAiB9qB,EAAGO,MAAMuqB,eAAgB,GAC1Cnf,EAAO8C,UACP0R,GAAUngB,EAAIzD,EAAK+C,KAAM9C,EAAG8C,KAAO,QAClC,GAAIqM,EAAO/sB,WAAa+sB,EAAO+F,YAAc/F,EAAOgG,UAAYhG,EAAOpiB,KACnEoiB,EAAOiG,YAAcjG,EAAO8F,MACjC,IAAK,IAAIliC,EAAIgtB,EAAK+C,KAAM/vB,GAAKitB,EAAG8C,KAAM/vB,IAAOsxC,GAAc7gB,EAAIzwB,EAAG,QAClEo8B,EAAOuuB,QAAUX,GAAiBv5B,EAAGtW,KACzCwqB,GAAYlU,EAAI,cAAeA,EAAI2L,GAErC,OAAOA,EAjLTqyB,GAAW5pD,UAAUk1C,MAAQ,WAC3B,IAAI50C,KAAKsjD,kBAAT,CACA,IAAIh4B,EAAKtrB,KAAKgV,IAAIsW,GAAI4+B,EAAS5+B,IAAOA,EAAGO,MAEzC,GADIq+B,GAAUrU,GAAevqB,GACzBS,GAAW/rB,KAAM,SAAU,CAC7B,IAAIqoB,EAAQroB,KAAKw5B,OACbnR,GAASmX,GAAYx/B,KAAM,QAASqoB,EAAMR,KAAMQ,EAAMP,IAG5D,IADA,IAAIzsB,EAAM,KAAMT,EAAM,KACbC,EAAI,EAAGA,EAAImF,KAAKgwB,MAAMj1B,SAAUF,EAAG,CAC1C,IAAI+vB,EAAO5qB,KAAKgwB,MAAMn1B,GAClBu8B,EAAOF,GAAiBtM,EAAK8M,YAAa13B,MAC1CsrB,IAAOtrB,KAAK+5B,UAAaoS,GAAc7gB,EAAIiF,GAAO3F,GAAO,QACpDU,IACQ,MAAX8L,EAAKtP,KAAcltB,EAAM21B,GAAO3F,IACnB,MAAbwM,EAAKvP,OAAgBxsB,EAAMk1B,GAAO3F,KAExCA,EAAK8M,YAAcL,GAAiBzM,EAAK8M,YAAaN,GACrC,MAAbA,EAAKvP,MAAgB7nB,KAAK+5B,YAAcY,GAAa36B,KAAKgV,IAAK4V,IAASU,GACxEgF,GAAiB1F,EAAM+f,GAAWrf,EAAG1X,UAE3C,GAAI0X,GAAMtrB,KAAK+5B,YAAczO,EAAGhd,QAAQ42B,aAAgB,IAAK,IAAI/b,EAAM,EAAGA,EAAMnpB,KAAKgwB,MAAMj1B,SAAUouB,EAAK,CACxG,IAAIghC,EAAS/vB,GAAWp6B,KAAKgwB,MAAM7G,IAAO14B,EAAMuqC,GAAWmvB,GACvD15D,EAAM66B,EAAG1X,QAAQwnB,gBACnB9P,EAAG1X,QAAQunB,QAAUgvB,EACrB7+B,EAAG1X,QAAQwnB,cAAgB3qC,EAC3B66B,EAAG1X,QAAQynB,gBAAiB,GAIrB,MAAPhgC,GAAeiwB,GAAMtrB,KAAK+5B,WAAa0R,GAAUngB,EAAIjwB,EAAKT,EAAM,GACpEoF,KAAKgwB,MAAMj1B,OAAS,EACpBiF,KAAKsjD,mBAAoB,EACrBtjD,KAAKwlD,QAAUxlD,KAAKgV,IAAI0wC,WAC1B1lD,KAAKgV,IAAI0wC,UAAW,EAChBp6B,GAAMu5B,GAAiBv5B,EAAGtW,MAE5BsW,GAAMkU,GAAYlU,EAAI,gBAAiBA,EAAItrB,KAAM3E,EAAKT,GACtDsvD,GAAU3T,GAAajrB,GACvBtrB,KAAKuG,QAAUvG,KAAKuG,OAAOquC,UAQjC0U,GAAW5pD,UAAU85B,KAAO,SAAU2U,EAAMpT,GAE1C,IAAIlT,EAAMC,EADE,MAARqmB,GAA6B,YAAbnuC,KAAKwN,OAAsB2gC,EAAO,GAEtD,IAAK,IAAItzC,EAAI,EAAGA,EAAImF,KAAKgwB,MAAMj1B,SAAUF,EAAG,CAC1C,IAAI+vB,EAAO5qB,KAAKgwB,MAAMn1B,GAClBu8B,EAAOF,GAAiBtM,EAAK8M,YAAa13B,MAC9C,GAAiB,MAAbo3B,EAAKvP,OACPA,EAAOoJ,GAAI8J,EAAUnQ,EAAO2F,GAAO3F,GAAOwM,EAAKvP,OAClC,GAATsmB,GAAc,OAAOtmB,EAE3B,GAAe,MAAXuP,EAAKtP,KACPA,EAAKmJ,GAAI8J,EAAUnQ,EAAO2F,GAAO3F,GAAOwM,EAAKtP,IACjC,GAARqmB,GAAa,OAAOrmB,EAG5B,OAAOD,GAAQ,CAACA,KAAMA,EAAMC,GAAIA,IAKlCwhC,GAAW5pD,UAAU+4C,QAAU,WAC3B,IAAI0Q,EAASnpD,KAEXimB,EAAMjmB,KAAKw5B,MAAM,GAAG,GAAO2E,EAASn+B,KAAMsrB,EAAKtrB,KAAKgV,IAAIsW,GACvDrF,GAAQqF,GACb6tB,GAAQ7tB,GAAI,WACV,IAAIV,EAAO3E,EAAI2E,KAAM2P,EAAQhK,GAAOtK,EAAI2E,MACpCyU,EAAOkF,GAAgBjZ,EAAIiP,GAM/B,GALI8E,IACFgI,GAA6BhI,GAC7B/T,EAAGO,MAAMsqB,iBAAmB7qB,EAAGO,MAAM6Y,aAAc,GAErDpZ,EAAGO,MAAMuqB,eAAgB,GACpBzb,GAAawD,EAAOnpB,IAAK4V,IAA0B,MAAjBuT,EAAOnxB,OAAgB,CAC5D,IAAIy7C,EAAYtqB,EAAOnxB,OACvBmxB,EAAOnxB,OAAS,KAChB,IAAIo9C,EAAU3nB,GAAatE,GAAUsqB,EACjC2B,GACA95B,GAAiB1F,EAAMA,EAAK5d,OAASo9C,GAE3C5qB,GAAYlU,EAAI,gBAAiBA,EAAI69B,OAIzCG,GAAW5pD,UAAUw5B,WAAa,SAAUtO,GAC1C,IAAK5qB,KAAKgwB,MAAMj1B,QAAUiF,KAAKgV,IAAIsW,GAAI,CACrC,IAAIwqB,EAAK91C,KAAKgV,IAAIsW,GAAGO,MAChBiqB,EAAGiD,qBAA+D,GAAzC7sC,EAAQ4pC,EAAGiD,mBAAoB/4C,QACxD81C,EAAGmD,uBAAyBnD,EAAGmD,qBAAuB,KAAK9sC,KAAKnM,MAEvEA,KAAKgwB,MAAM7jB,KAAKye,IAGlB0+B,GAAW5pD,UAAUs5B,WAAa,SAAUpO,GAE1C,GADA5qB,KAAKgwB,MAAMvjB,OAAOP,EAAQlM,KAAKgwB,MAAOpF,GAAO,IACxC5qB,KAAKgwB,MAAMj1B,QAAUiF,KAAKgV,IAAIsW,GAAI,CACrC,IAAIwqB,EAAK91C,KAAKgV,IAAIsW,GAAGO,OACnBiqB,EAAGiD,qBAAuBjD,EAAGiD,mBAAqB,KAAK5sC,KAAKnM,QAGlEgsB,GAAWs9B,IA8EX,IAAII,GAAmB,SAASzoB,EAAS0L,GACvC3sC,KAAKihC,QAAUA,EACfjhC,KAAK2sC,QAAUA,EACf,IAAK,IAAI9xC,EAAI,EAAGA,EAAIomC,EAAQlmC,SAAUF,EAClComC,EAAQpmC,GAAG0L,OAASvG,MA+B1B,SAASqqD,GAAkBr1C,GACzB,OAAOA,EAAIs1C,UAAUr5B,GAAIjc,EAAI6a,MAAO,GAAI7a,EAAIwc,QAAQP,GAAIjc,EAAI0lB,cAAc,SAAU59B,GAAK,OAAOA,EAAEyJ,UAepG,SAASgkD,GAAoBtpB,GAa3B,IAZA,IAAIlN,EAAO,SAAWl5B,GACpB,IAAIo8B,EAASgK,EAAQpmC,GAAIomD,EAAS,CAAChqB,EAAO0V,QAAQ33B,KAClD4rC,GAAW3pB,EAAO0V,QAAQ33B,KAAK,SAAU9Y,GAAK,OAAO+kD,EAAO90C,KAAKjQ,MACjE,IAAK,IAAI0tB,EAAI,EAAGA,EAAIqN,EAAOgK,QAAQlmC,OAAQ6uB,IAAK,CAC9C,IAAI4gC,EAAYvzB,EAAOgK,QAAQrX,IACQ,GAAnC1d,EAAQ+0C,EAAQuJ,EAAUx1C,OAC5Bw1C,EAAUjkD,OAAS,KACnB0wB,EAAOgK,QAAQx0B,OAAOmd,IAAK,MAKxB/uB,EAAI,EAAGA,EAAIomC,EAAQlmC,OAAQF,IAAKk5B,EAAMl5B,GAzDjD6uD,GAAiBhqD,UAAUk1C,MAAQ,WACjC,IAAI50C,KAAKsjD,kBAAT,CACAtjD,KAAKsjD,mBAAoB,EACzB,IAAK,IAAIzoD,EAAI,EAAGA,EAAImF,KAAKihC,QAAQlmC,SAAUF,EACvCmF,KAAKihC,QAAQpmC,GAAG+5C,QACpBpV,GAAYx/B,KAAM,WAGpB0pD,GAAiBhqD,UAAU85B,KAAO,SAAU2U,EAAMpT,GAChD,OAAO/6B,KAAK2sC,QAAQnT,KAAK2U,EAAMpT,IAEjC/O,GAAW09B,IAiDX,IAAIe,GAAY,EACZC,GAAM,SAAS94C,EAAMuc,EAAMiyB,EAAWuK,EAAS5hC,GACjD,KAAM/oB,gBAAgB0qD,IAAQ,OAAO,IAAIA,GAAI94C,EAAMuc,EAAMiyB,EAAWuK,EAAS5hC,GAC5D,MAAbq3B,IAAqBA,EAAY,GAErCiI,GAAYnoD,KAAKF,KAAM,CAAC,IAAIooD,GAAU,CAAC,IAAI9sB,GAAK,GAAI,UACpDt7B,KAAK6vB,MAAQuwB,EACbpgD,KAAKkoC,UAAYloC,KAAK+nC,WAAa,EACnC/nC,KAAK0lD,UAAW,EAChB1lD,KAAK4qD,gBAAkB,EACvB5qD,KAAK+0B,aAAe/0B,KAAK80B,kBAAoBsrB,EAC7C,IAAI78B,EAAQ0N,GAAImvB,EAAW,GAC3BpgD,KAAK+sC,IAAMuS,GAAgB/7B,GAC3BvjB,KAAK4iD,QAAU,IAAItB,GAAQ,MAC3BthD,KAAKklB,KAAOulC,GACZzqD,KAAK4/C,WAAazxB,EAClBnuB,KAAK2qD,QAAUA,EACf3qD,KAAK+oB,UAA0B,OAAbA,EAAsB,MAAQ,MAChD/oB,KAAKD,QAAS,EAEK,iBAAR6R,IAAoBA,EAAO5R,KAAK4nD,WAAWh2C,IACtDouC,GAAUhgD,KAAM,CAAC6nB,KAAMtE,EAAOuE,GAAIvE,EAAO3R,KAAMA,IAC/CuyC,GAAankD,KAAMs/C,GAAgB/7B,GAAQmC,IAG7CglC,GAAIhrD,UAAY+mB,EAAU4hC,GAAY3oD,UAAW,CAC/CyC,YAAauoD,GAKbt6B,KAAM,SAASvI,EAAMC,EAAIguB,GACnBA,EAAM91C,KAAKwoD,MAAM3gC,EAAO7nB,KAAK6vB,MAAO/H,EAAKD,EAAMiuB,GAC5C91C,KAAKwoD,MAAMxoD,KAAK6vB,MAAO7vB,KAAK6vB,MAAQ7vB,KAAK8vB,KAAMjI,IAIxD24B,OAAQ,SAASn2B,EAAI2F,GAEnB,IADA,IAAIhjB,EAAS,EACJnS,EAAI,EAAGA,EAAIm1B,EAAMj1B,SAAUF,EAAKmS,GAAUgjB,EAAMn1B,GAAGmS,OAC5DhN,KAAKuoD,YAAYl+B,EAAKrqB,KAAK6vB,MAAOG,EAAOhjB,IAE3C6O,OAAQ,SAASwO,EAAIzF,GAAK5kB,KAAKsoD,YAAYj+B,EAAKrqB,KAAK6vB,MAAOjL,IAK5Dxc,SAAU,SAASuiD,GACjB,IAAI36B,EAAQK,GAASrwB,KAAMA,KAAK6vB,MAAO7vB,KAAK6vB,MAAQ7vB,KAAK8vB,MACzD,OAAgB,IAAZ66B,EAA4B36B,EACzBA,EAAM5jB,KAAKu+C,GAAW3qD,KAAK6qD,kBAEpC58C,SAAUqrC,IAAY,SAASrwB,GAC7B,IAAInzB,EAAMm7B,GAAIjxB,KAAK6vB,MAAO,GAAI4B,EAAOzxB,KAAK6vB,MAAQ7vB,KAAK8vB,KAAO,EAC9Di2B,GAAW/lD,KAAM,CAAC6nB,KAAM/xB,EAAKgyB,GAAImJ,GAAIQ,EAAM7B,GAAQ5vB,KAAMyxB,GAAM7f,KAAK7W,QAClD6W,KAAM5R,KAAK4nD,WAAW3+B,GAAOpD,OAAQ,WAAY2R,MAAM,IAAO,GAC5Ex3B,KAAKsrB,IAAM4mB,GAAelyC,KAAKsrB,GAAI,EAAG,GAC1C64B,GAAankD,KAAMs/C,GAAgBxpD,GAAM4vB,MAE3CgiC,aAAc,SAASz+B,EAAMpB,EAAMC,EAAIjC,GAGrC6hC,GAAa1nD,KAAMipB,EAFnBpB,EAAO2J,GAAQxxB,KAAM6nB,GACrBC,EAAKA,EAAK0J,GAAQxxB,KAAM8nB,GAAMD,EACKhC,IAErCilC,SAAU,SAASjjC,EAAMC,EAAI6iC,GAC3B,IAAI36B,EAAQG,GAAWnwB,KAAMwxB,GAAQxxB,KAAM6nB,GAAO2J,GAAQxxB,KAAM8nB,IAChE,OAAgB,IAAZ6iC,EAA4B36B,EACzBA,EAAM5jB,KAAKu+C,GAAW3qD,KAAK6qD,kBAGpCj7B,QAAS,SAAShF,GAAO,IAAI/rB,EAAImB,KAAK+qD,cAAcngC,GAAO,OAAO/rB,GAAKA,EAAE+S,MAEzEm5C,cAAe,SAASngC,GAAO,GAAIgG,GAAO5wB,KAAM4qB,GAAS,OAAOgF,GAAQ5vB,KAAM4qB,IAC9EogC,cAAe,SAASpgC,GAAO,OAAO2F,GAAO3F,IAE7CqgC,yBAA0B,SAASrgC,GAEjC,MADmB,iBAARA,IAAoBA,EAAOgF,GAAQ5vB,KAAM4qB,IAC7CwP,GAAWxP,IAGpBsgC,UAAW,WAAY,OAAOlrD,KAAK8vB,MACnCswB,UAAW,WAAY,OAAOpgD,KAAK6vB,OACnC6K,SAAU,WAAY,OAAO16B,KAAK6vB,MAAQ7vB,KAAK8vB,KAAO,GAEtD0B,QAAS,SAASvL,GAAM,OAAOuL,GAAQxxB,KAAMimB,IAE7C6rB,UAAW,SAASvuB,GAClB,IAAIpB,EAAQniB,KAAK+sC,IAAIJ,UAKrB,OAJa,MAATppB,GAA0B,QAATA,EAAyBpB,EAAMjN,KAClC,UAATqO,EAA2BpB,EAAMyoB,OACxB,OAATrnB,GAA2B,MAATA,IAA2B,IAAVA,EAAyBpB,EAAM2F,KAC9D3F,EAAM0F,QAGrBsjC,eAAgB,WAAa,OAAOnrD,KAAK+sC,IAAIC,QAC7C+R,kBAAmB,WAAY,OAAO/+C,KAAK+sC,IAAIgS,qBAE/CqM,UAAW9R,IAAY,SAAS1uB,EAAM9D,EAAIxY,GACxCi2C,GAAmBvkD,KAAMwxB,GAAQxxB,KAAqB,iBAAR4qB,EAAmBqG,GAAIrG,EAAM9D,GAAM,GAAK8D,GAAO,KAAMtc,MAErG61C,aAAc7K,IAAY,SAAS1O,EAAQ11B,EAAM5G,GAC/Ci2C,GAAmBvkD,KAAMwxB,GAAQxxB,KAAM4qC,GAASpZ,GAAQxxB,KAAMkV,GAAQ01B,GAASt8B,MAEjF41C,gBAAiB5K,IAAY,SAASpkC,EAAMi0B,EAAO76B,GACjD41C,GAAgBlkD,KAAMwxB,GAAQxxB,KAAMkV,GAAOi0B,GAAS3X,GAAQxxB,KAAMmpC,GAAQ76B,MAE5E81C,iBAAkB9K,IAAY,SAAS+K,EAAO/1C,GAC5C81C,GAAiBpkD,KAAM4xB,GAAa5xB,KAAMqkD,GAAQ/1C,MAEpD+8C,mBAAoB/R,IAAY,SAAS/iD,EAAG+X,GAE1C81C,GAAiBpkD,KAAM4xB,GAAa5xB,KADxBwO,EAAIxO,KAAK+sC,IAAIC,OAAQz2C,IACiB+X,MAEpDg9C,cAAehS,IAAY,SAAStM,EAAQL,EAASr+B,GACnD,GAAK0+B,EAAOjyC,OAAZ,CAEA,IADA,IAAInP,EAAM,GACDiP,EAAI,EAAGA,EAAImyC,EAAOjyC,OAAQF,IAC/BjP,EAAIiP,GAAK,IAAIikD,GAAMttB,GAAQxxB,KAAMgtC,EAAOnyC,GAAG+vC,QAC1BpZ,GAAQxxB,KAAMgtC,EAAOnyC,GAAGqa,OAC9B,MAAXy3B,IAAmBA,EAAUnhD,KAAK6P,IAAI2xC,EAAOjyC,OAAS,EAAGiF,KAAK+sC,IAAIE,YACtEkX,GAAankD,KAAMg/C,GAAmBh/C,KAAKsrB,GAAI1/B,EAAK+gD,GAAUr+B,OAEhEi9C,aAAcjS,IAAY,SAAS1O,EAAQ11B,EAAM5G,GAC/C,IAAI0+B,EAAShtC,KAAK+sC,IAAIC,OAAOptC,MAAM,GACnCotC,EAAO7gC,KAAK,IAAI2yC,GAAMttB,GAAQxxB,KAAM4qC,GAASpZ,GAAQxxB,KAAMkV,GAAQ01B,KACnEuZ,GAAankD,KAAMg/C,GAAmBh/C,KAAKsrB,GAAI0hB,EAAQA,EAAOjyC,OAAS,GAAIuT,MAG7Ekf,aAAc,SAASm9B,GAErB,IADA,IAA8B36B,EAA1Bgd,EAAShtC,KAAK+sC,IAAIC,OACbnyC,EAAI,EAAGA,EAAImyC,EAAOjyC,OAAQF,IAAK,CACtC,IAAIkyC,EAAM5c,GAAWnwB,KAAMgtC,EAAOnyC,GAAGgtB,OAAQmlB,EAAOnyC,GAAGitB,MACvDkI,EAAQA,EAAQA,EAAM5U,OAAO2xB,GAAOA,EAEtC,OAAgB,IAAZ4d,EAA4B36B,EAClBA,EAAM5jB,KAAKu+C,GAAW3qD,KAAK6qD,kBAE3CW,cAAe,SAASb,GAEtB,IADA,IAAIxE,EAAQ,GAAInZ,EAAShtC,KAAK+sC,IAAIC,OACzBnyC,EAAI,EAAGA,EAAImyC,EAAOjyC,OAAQF,IAAK,CACtC,IAAIkyC,EAAM5c,GAAWnwB,KAAMgtC,EAAOnyC,GAAGgtB,OAAQmlB,EAAOnyC,GAAGitB,OACvC,IAAZ6iC,IAAqB5d,EAAMA,EAAI3gC,KAAKu+C,GAAW3qD,KAAK6qD,kBACxD1E,EAAMtrD,GAAKkyC,EAEb,OAAOoZ,GAETsF,iBAAkB,SAASxiC,EAAMnF,EAAU+B,GAEzC,IADA,IAAI6lC,EAAM,GACD7wD,EAAI,EAAGA,EAAImF,KAAK+sC,IAAIC,OAAOjyC,OAAQF,IACxC6wD,EAAI7wD,GAAKouB,EACbjpB,KAAK2rD,kBAAkBD,EAAK5nC,EAAU+B,GAAU,WAElD8lC,kBAAmBrS,IAAY,SAASrwB,EAAMnF,EAAU+B,GAEtD,IADA,IAAIia,EAAU,GAAIiN,EAAM/sC,KAAK+sC,IACpBlyC,EAAI,EAAGA,EAAIkyC,EAAIC,OAAOjyC,OAAQF,IAAK,CAC1C,IAAIsnB,EAAQ4qB,EAAIC,OAAOnyC,GACvBilC,EAAQjlC,GAAK,CAACgtB,KAAM1F,EAAM0F,OAAQC,GAAI3F,EAAM2F,KAAMlW,KAAM5R,KAAK4nD,WAAW3+B,EAAKpuB,IAAKgrB,OAAQA,GAG5F,IADA,IAAI+lC,EAAS9nC,GAAwB,OAAZA,GAzhD7B,SAA4B9O,EAAK8qB,EAAS+rB,GAGxC,IAFA,IAAIjgE,EAAM,GACNkgE,EAAU76B,GAAIjc,EAAI6a,MAAO,GAAIk8B,EAAUD,EAClCjxD,EAAI,EAAGA,EAAIilC,EAAQ/kC,OAAQF,IAAK,CACvC,IAAI08B,EAASuI,EAAQjlC,GACjBgtB,EAAO63B,GAAUnoB,EAAO1P,KAAMikC,EAASC,GACvCjkC,EAAK43B,GAAUH,GAAUhoB,GAASu0B,EAASC,GAG/C,GAFAD,EAAUv0B,EAAOzP,GACjBikC,EAAUjkC,EACE,UAAR+jC,EAAkB,CACpB,IAAI1pC,EAAQnN,EAAI+3B,IAAIC,OAAOnyC,GAAIwkD,EAAMnuB,GAAI/O,EAAMjN,KAAMiN,EAAMyoB,QAAU,EACrEh/C,EAAIiP,GAAK,IAAIikD,GAAMO,EAAMv3B,EAAKD,EAAMw3B,EAAMx3B,EAAOC,QAEjDl8B,EAAIiP,GAAK,IAAIikD,GAAMj3B,EAAMA,GAG7B,OAAO,IAAI42B,GAAU7yD,EAAKopB,EAAI+3B,IAAIE,WAygDc+e,CAAmBhsD,KAAM8/B,EAAShc,GACvEqF,EAAM2W,EAAQ/kC,OAAS,EAAGouB,GAAO,EAAGA,IACzC48B,GAAW/lD,KAAM8/B,EAAQ3W,IACzByiC,EAAUpH,GAA2BxkD,KAAM4rD,GACtC5rD,KAAKsrB,IAAMumB,GAAoB7xC,KAAKsrB,OAE/C2gC,KAAM3S,IAAY,WAAYuN,GAAsB7mD,KAAM,WAC1DksD,KAAM5S,IAAY,WAAYuN,GAAsB7mD,KAAM,WAC1DmsD,cAAe7S,IAAY,WAAYuN,GAAsB7mD,KAAM,QAAQ,MAC3EosD,cAAe9S,IAAY,WAAYuN,GAAsB7mD,KAAM,QAAQ,MAE3EqsD,aAAc,SAASxjD,GAAM7I,KAAKD,OAAS8I,GAC3CyjD,aAAc,WAAY,OAAOtsD,KAAKD,QAEtCwsD,YAAa,WAEX,IADA,IAAI5J,EAAO3iD,KAAK4iD,QAASpB,EAAO,EAAGC,EAAS,EACnC5mD,EAAI,EAAGA,EAAI8nD,EAAKnB,KAAKzmD,OAAQF,IAAY8nD,EAAKnB,KAAK3mD,GAAGmyC,UAAYwU,EAC3E,IAAK,IAAIr4B,EAAM,EAAGA,EAAMw5B,EAAKlB,OAAO1mD,OAAQouB,IAAcw5B,EAAKlB,OAAOt4B,GAAK6jB,UAAYyU,EACvF,MAAO,CAACwK,KAAMzK,EAAM0K,KAAMzK,IAE5BwI,aAAc,WACZ,IAAId,EAASnpD,KAEbA,KAAK4iD,QAAU,IAAItB,GAAQthD,KAAK4iD,QAAQV,eACxCtB,GAAW5gD,MAAM,SAAUgV,GAAO,OAAOA,EAAI4tC,QAAUuG,EAAOvG,WAAY,IAG5E4J,UAAW,WACTxsD,KAAK4qD,gBAAkB5qD,KAAKysD,kBAAiB,IAE/CA,iBAAkB,SAASC,GAGzB,OAFIA,IACA1sD,KAAK4iD,QAAQf,OAAS7hD,KAAK4iD,QAAQd,UAAY9hD,KAAK4iD,QAAQb,WAAa,MACtE/hD,KAAK4iD,QAAQX,YAEtB0K,QAAS,SAAUC,GACjB,OAAO5sD,KAAK4iD,QAAQX,aAAe2K,GAAO5sD,KAAK4qD,kBAGjDiC,WAAY,WACV,MAAO,CAACrL,KAAMoC,GAAiB5jD,KAAK4iD,QAAQpB,MACpCC,OAAQmC,GAAiB5jD,KAAK4iD,QAAQnB,UAEhDqL,WAAY,SAASC,GACnB,IAAIpK,EAAO3iD,KAAK4iD,QAAU,IAAItB,GAAQthD,KAAK4iD,QAAQV,eACnDS,EAAKnB,KAAOoC,GAAiBmJ,EAASvL,KAAK5hD,MAAM,GAAI,MAAM,GAC3D+iD,EAAKlB,OAASmC,GAAiBmJ,EAAStL,OAAO7hD,MAAM,GAAI,MAAM,IAGjEotD,gBAAiB1T,IAAY,SAAS1uB,EAAMqiC,EAAUnoD,GACpD,OAAOmjD,GAAWjoD,KAAM4qB,EAAM,UAAU,SAAUA,GAChD,IAAIqW,EAAUrW,EAAKsW,gBAAkBtW,EAAKsW,cAAgB,IAG1D,OAFAD,EAAQgsB,GAAYnoD,GACfA,GAASsiB,GAAQ6Z,KAAYrW,EAAKsW,cAAgB,OAChD,QAIXgsB,YAAa5T,IAAY,SAAS2T,GAChC,IAAI9D,EAASnpD,KAEbA,KAAKowB,MAAK,SAAUxF,GACdA,EAAKsW,eAAiBtW,EAAKsW,cAAc+rB,IAC3ChF,GAAWkB,EAAQv+B,EAAM,UAAU,WAGjC,OAFAA,EAAKsW,cAAc+rB,GAAY,KAC3B7lC,GAAQwD,EAAKsW,iBAAkBtW,EAAKsW,cAAgB,OACjD,WAMfisB,SAAU,SAASviC,GACjB,IAAIhG,EACJ,GAAmB,iBAARgG,EAAkB,CAC3B,IAAKgG,GAAO5wB,KAAM4qB,GAAS,OAAO,KAGlC,GAFAhG,EAAIgG,IACJA,EAAOgF,GAAQ5vB,KAAM4qB,IACR,OAAO,UAGpB,GAAS,OADThG,EAAI2L,GAAO3F,IACM,OAAO,KAE1B,MAAO,CAACA,KAAMhG,EAAGsjC,OAAQt9B,EAAMhZ,KAAMgZ,EAAKhZ,KAAMsvB,cAAetW,EAAKsW,cAC5D5M,UAAW1J,EAAK0J,UAAWD,QAASzJ,EAAKyJ,QAASqM,UAAW9V,EAAK8V,UAClEsB,QAASpX,EAAKoX,UAGxBorB,aAAc9T,IAAY,SAAS4O,EAAQmF,EAAOnrC,GAChD,OAAO+lC,GAAWjoD,KAAMkoD,EAAiB,UAATmF,EAAoB,SAAW,SAAS,SAAUziC,GAChF,IAAIxG,EAAgB,QAATipC,EAAkB,YACT,cAATA,EAAwB,UACf,UAATA,EAAoB,cAAgB,YAC/C,GAAKziC,EAAKxG,GACL,IAAInC,EAAUC,GAAKpf,KAAK8nB,EAAKxG,IAAU,OAAO,EAC5CwG,EAAKxG,IAAS,IAAMlC,OAFR0I,EAAKxG,GAAQlC,EAGhC,OAAO,QAGXorC,gBAAiBhU,IAAY,SAAS4O,EAAQmF,EAAOnrC,GACnD,OAAO+lC,GAAWjoD,KAAMkoD,EAAiB,UAATmF,EAAoB,SAAW,SAAS,SAAUziC,GAChF,IAAIxG,EAAgB,QAATipC,EAAkB,YACT,cAATA,EAAwB,UACf,UAATA,EAAoB,cAAgB,YAC3C/kC,EAAMsC,EAAKxG,GACf,IAAKkE,EAAO,OAAO,EACd,GAAW,MAAPpG,EAAe0I,EAAKxG,GAAQ,SAChC,CACH,IAAIiE,EAAQC,EAAIvlB,MAAMkf,EAAUC,IAChC,IAAKmG,EAAS,OAAO,EACrB,IAAI7E,EAAM6E,EAAM7b,MAAQ6b,EAAM,GAAGttB,OACjC6vB,EAAKxG,GAAQkE,EAAI1oB,MAAM,EAAGyoB,EAAM7b,QAAW6b,EAAM7b,OAASgX,GAAO8E,EAAIvtB,OAAc,IAAL,IAAYutB,EAAI1oB,MAAM4jB,IAAQ,KAE9G,OAAO,QAIX+pC,cAAejU,IAAY,SAAS4O,EAAQroC,EAAMvR,GAChD,OA9jBJ,SAAuB0G,EAAKkzC,EAAQroC,EAAMvR,GACxC,IAAI6vB,EAAS,IAAI8qB,GAAWj0C,EAAK6K,EAAMvR,GACnCgd,EAAKtW,EAAIsW,GAgBb,OAfIA,GAAM6S,EAAOkE,YAAa/W,EAAG1X,QAAQwoC,cAAe,GACxD6L,GAAWjzC,EAAKkzC,EAAQ,UAAU,SAAUt9B,GAC1C,IAAIoX,EAAUpX,EAAKoX,UAAYpX,EAAKoX,QAAU,IAI9C,GAHuB,MAAnB7D,EAAOqvB,SAAoBxrB,EAAQ71B,KAAKgyB,GACrC6D,EAAQv1B,OAAOjhB,KAAK6P,IAAI2mC,EAAQjnC,OAAS,EAAGvP,KAAKoP,IAAI,EAAGujC,EAAOqvB,WAAY,EAAGrvB,GACrFA,EAAOvT,KAAOA,EACVU,IAAOqP,GAAa3lB,EAAK4V,GAAO,CAClC,IAAI6iC,EAAe3yB,GAAalQ,GAAQ5V,EAAIkzB,UAC5C5X,GAAiB1F,EAAMA,EAAK5d,OAASy1B,GAAatE,IAC9CsvB,GAAgB9b,GAAermB,EAAI6S,EAAOnxB,QAC9Cse,EAAGO,MAAM6Y,aAAc,EAEzB,OAAO,KAELpZ,GAAMkU,GAAYlU,EAAI,kBAAmBA,EAAI6S,EAAyB,iBAAV+pB,EAAqBA,EAAS33B,GAAO23B,IAC9F/pB,EA4iBEovB,CAAcvtD,KAAMkoD,EAAQroC,EAAMvR,MAE3Co/C,iBAAkB,SAASvvB,GAAUA,EAAOyW,SAE5C2U,SAAU,SAAS1hC,EAAMC,EAAIxZ,GAC3B,OAAOi7C,GAASvpD,KAAMwxB,GAAQxxB,KAAM6nB,GAAO2J,GAAQxxB,KAAM8nB,GAAKxZ,EAASA,GAAWA,EAAQd,MAAQ,UAEpGmgD,YAAa,SAAS1nC,EAAK3X,GACzB,IAAIs/C,EAAW,CAAChE,aAAct7C,IAAgC,MAApBA,EAAQyU,SAAmBzU,EAAQ6vB,OAAS7vB,GACtE4pB,WAAY5pB,GAAWA,EAAQ4pB,WAC/BY,gBAAgB,EAAOqoB,OAAQ7yC,GAAWA,EAAQ6yC,OAClDjf,kBAAmB5zB,GAAWA,EAAQ4zB,mBAEtD,OAAOqnB,GAASvpD,KADhBimB,EAAMuL,GAAQxxB,KAAMimB,GACOA,EAAK2nC,EAAU,aAE5CC,YAAa,SAAS5nC,GAEpB,IAAIgb,EAAU,GAAI9J,EAAQvH,GAAQ5vB,MADlCimB,EAAMuL,GAAQxxB,KAAMimB,IACwB2E,MAAM8M,YAClD,GAAIP,EAAS,IAAK,IAAIt8B,EAAI,EAAGA,EAAIs8B,EAAMp8B,SAAUF,EAAG,CAClD,IAAIu8B,EAAOD,EAAMt8B,IACC,MAAbu8B,EAAKvP,MAAgBuP,EAAKvP,MAAQ5B,EAAIa,MAC3B,MAAXsQ,EAAKtP,IAAcsP,EAAKtP,IAAM7B,EAAIa,KACnCma,EAAQ90B,KAAKirB,EAAKH,OAAO1wB,QAAU6wB,EAAKH,QAE9C,OAAOgK,GAETqpB,UAAW,SAASziC,EAAMC,EAAIm/B,GAC5Bp/B,EAAO2J,GAAQxxB,KAAM6nB,GAAOC,EAAK0J,GAAQxxB,KAAM8nB,GAC/C,IAAIO,EAAQ,GAAIkI,EAAS1I,EAAK+C,KAa9B,OAZA5qB,KAAKowB,KAAKvI,EAAK+C,KAAM9C,EAAG8C,KAAO,GAAG,SAAUA,GAC1C,IAAIuM,EAAQvM,EAAK8M,YACjB,GAAIP,EAAS,IAAK,IAAIt8B,EAAI,EAAGA,EAAIs8B,EAAMp8B,OAAQF,IAAK,CAClD,IAAIu8B,EAAOD,EAAMt8B,GACA,MAAXu8B,EAAKtP,IAAcyI,GAAU1I,EAAK+C,MAAQ/C,EAAKf,IAAMsQ,EAAKtP,IAC7C,MAAbsP,EAAKvP,MAAgB0I,GAAU1I,EAAK+C,MACvB,MAAbwM,EAAKvP,MAAgB0I,GAAUzI,EAAG8C,MAAQwM,EAAKvP,MAAQC,EAAGhB,IAC1DmgC,IAAUA,EAAO7vB,EAAKH,SACxB5O,EAAMlc,KAAKirB,EAAKH,OAAO1wB,QAAU6wB,EAAKH,UAE1C1G,KAEGlI,GAETylC,YAAa,WACX,IAAI7sB,EAAU,GAMd,OALAjhC,KAAKowB,MAAK,SAAUxF,GAClB,IAAIiP,EAAMjP,EAAK8M,YACf,GAAImC,EAAO,IAAK,IAAIh/B,EAAI,EAAGA,EAAIg/B,EAAI9+B,SAAUF,EACtB,MAAfg/B,EAAIh/B,GAAGgtB,MAAgBoZ,EAAQ90B,KAAK0tB,EAAIh/B,GAAGo8B,WAE9CgK,GAGT8sB,aAAc,SAAS7iC,GACrB,IAAIpE,EAAIyJ,EAASvwB,KAAK6vB,MAAOm+B,EAAUhuD,KAAK6qD,gBAAgB9vD,OAO5D,OANAiF,KAAKowB,MAAK,SAAUxF,GAClB,IAAIr2B,EAAKq2B,EAAKhZ,KAAK7W,OAASizD,EAC5B,GAAIz5D,EAAK22B,EAAiB,OAAVpE,EAAKoE,GAAY,EACjCA,GAAO32B,IACLg8B,KAEGiB,GAAQxxB,KAAMixB,GAAIV,EAAQzJ,KAEnCmnC,aAAc,SAAUtlB,GAEtB,IAAIn8B,GADJm8B,EAASnX,GAAQxxB,KAAM2oC,IACJ7hB,GACnB,GAAI6hB,EAAO/d,KAAO5qB,KAAK6vB,OAAS8Y,EAAO7hB,GAAK,EAAK,OAAO,EACxD,IAAIknC,EAAUhuD,KAAK6qD,gBAAgB9vD,OAInC,OAHAiF,KAAKowB,KAAKpwB,KAAK6vB,MAAO8Y,EAAO/d,MAAM,SAAUA,GAC3Cpe,GAASoe,EAAKhZ,KAAK7W,OAASizD,KAEvBxhD,GAGTzgB,KAAM,SAASmiE,GACb,IAAIl5C,EAAM,IAAI01C,GAAIr6B,GAASrwB,KAAMA,KAAK6vB,MAAO7vB,KAAK6vB,MAAQ7vB,KAAK8vB,MAC7C9vB,KAAK4/C,WAAY5/C,KAAK6vB,MAAO7vB,KAAK2qD,QAAS3qD,KAAK+oB,WAQlE,OAPA/T,EAAIkzB,UAAYloC,KAAKkoC,UAAWlzB,EAAI+yB,WAAa/nC,KAAK+nC,WACtD/yB,EAAI+3B,IAAM/sC,KAAK+sC,IACf/3B,EAAIjV,QAAS,EACTmuD,IACFl5C,EAAI4tC,QAAQlB,UAAY1hD,KAAK4iD,QAAQlB,UACrC1sC,EAAI83C,WAAW9sD,KAAK6sD,eAEf73C,GAGTm5C,UAAW,SAAS7/C,GACbA,IAAWA,EAAU,IAC1B,IAAIuZ,EAAO7nB,KAAK6vB,MAAO/H,EAAK9nB,KAAK6vB,MAAQ7vB,KAAK8vB,KAC1B,MAAhBxhB,EAAQuZ,MAAgBvZ,EAAQuZ,KAAOA,IAAQA,EAAOvZ,EAAQuZ,MAChD,MAAdvZ,EAAQwZ,IAAcxZ,EAAQwZ,GAAKA,IAAMA,EAAKxZ,EAAQwZ,IAC1D,IAAI/7B,EAAO,IAAI2+D,GAAIr6B,GAASrwB,KAAM6nB,EAAMC,GAAKxZ,EAAQ6f,MAAQnuB,KAAK4/C,WAAY/3B,EAAM7nB,KAAK2qD,QAAS3qD,KAAK+oB,WAKvG,OAJIza,EAAQ0yC,aAAcj1D,EAAK62D,QAAU5iD,KAAK4iD,UAC1C5iD,KAAKihD,SAAWjhD,KAAKihD,OAAS,KAAK90C,KAAK,CAAC6I,IAAKjpB,EAAMi1D,WAAY1yC,EAAQ0yC,aAC5Ej1D,EAAKk1D,OAAS,CAAC,CAACjsC,IAAKhV,KAAMypD,UAAU,EAAMzI,WAAY1yC,EAAQ0yC,aA/YnE,SAA2BhsC,EAAKisB,GAC9B,IAAK,IAAIpmC,EAAI,EAAGA,EAAIomC,EAAQlmC,OAAQF,IAAK,CACvC,IAAIo8B,EAASgK,EAAQpmC,GAAIorB,EAAMgR,EAAOuC,OAClC40B,EAAQp5C,EAAIwc,QAAQvL,EAAI4B,MAAOwmC,EAAMr5C,EAAIwc,QAAQvL,EAAI6B,IACzD,GAAIoJ,GAAIk9B,EAAOC,GAAM,CACnB,IAAIC,EAAU/E,GAASv0C,EAAKo5C,EAAOC,EAAKp3B,EAAO0V,QAAS1V,EAAO0V,QAAQn/B,MACvEypB,EAAOgK,QAAQ90B,KAAKmiD,GACpBA,EAAQ/nD,OAAS0wB,IAyYnBs3B,CAAkBxiE,EAAMs+D,GAAkBrqD,OACnCjU,GAETyiE,UAAW,SAASrlB,GAElB,GADIA,aAAiBslB,KAActlB,EAAQA,EAAMn0B,KAC7ChV,KAAKihD,OAAU,IAAK,IAAIpmD,EAAI,EAAGA,EAAImF,KAAKihD,OAAOlmD,SAAUF,EAE3D,GADWmF,KAAKihD,OAAOpmD,GACdma,KAAOm0B,EAAhB,CACAnpC,KAAKihD,OAAOx0C,OAAO5R,EAAG,GACtBsuC,EAAMqlB,UAAUxuD,MAChBuqD,GAAoBF,GAAkBrqD,OACtC,MAGF,GAAImpC,EAAMyZ,SAAW5iD,KAAK4iD,QAAS,CACjC,IAAI8L,EAAW,CAACvlB,EAAMjkB,IACtB07B,GAAWzX,GAAO,SAAUn0B,GAAO,OAAO05C,EAASviD,KAAK6I,EAAIkQ,OAAQ,GACpEikB,EAAMyZ,QAAU,IAAItB,GAAQ,MAC5BnY,EAAMyZ,QAAQpB,KAAOoC,GAAiB5jD,KAAK4iD,QAAQpB,KAAMkN,GACzDvlB,EAAMyZ,QAAQnB,OAASmC,GAAiB5jD,KAAK4iD,QAAQnB,OAAQiN,KAGjEC,eAAgB,SAASp4D,GAAIqqD,GAAW5gD,KAAMzJ,IAE9Cg4B,QAAS,WAAY,OAAOvuB,KAAKmuB,MACjCygC,UAAW,WAAY,OAAO5uD,KAAKsrB,IAEnCs8B,WAAY,SAAS7uD,GACnB,OAAIiH,KAAK2qD,QAAkB5xD,EAAIkT,MAAMjM,KAAK2qD,SACnCv9B,GAAer0B,IAExB8xD,cAAe,WAAa,OAAO7qD,KAAK2qD,SAAW,MAEnDkE,aAAcvV,IAAY,SAAU7xB,GA7oDtC,IAA0B6D,EA8oDX,OAAP7D,IAAgBA,EAAM,OACtBA,GAAOznB,KAAK+oB,YAChB/oB,KAAK+oB,UAAYtB,EACjBznB,KAAKowB,MAAK,SAAUxF,GAAQ,OAAOA,EAAKzC,MAAQ,QAC5CnoB,KAAKsrB,IAjpDX6tB,GADwB7tB,EAkpDUtrB,KAAKsrB,IAjpD3B,WACV+1B,GAAkB/1B,GAClBmgB,GAAUngB,YAopDdo/B,GAAIhrD,UAAUovD,SAAWpE,GAAIhrD,UAAU0wB,KAIvC,IAAI2+B,GAAW,EAEf,SAASC,GAAOtmD,GACd,IAAI4iB,EAAKtrB,KAET,GADAivD,GAAgB3jC,IACZD,GAAeC,EAAI5iB,KAAMo6B,GAAcxX,EAAG1X,QAASlL,GAAvD,CAEAwjB,GAAiBxjB,GACbmY,IAAMkuC,IAAY,IAAIxpC,MAC1B,IAAIU,EAAMolB,GAAa/f,EAAI5iB,GAAG,GAAOwmD,EAAQxmD,EAAEymD,aAAaD,MAC5D,GAAKjpC,IAAOqF,EAAG8jC,aAGf,GAAIF,GAASA,EAAMn0D,QAAU2P,OAAO2kD,YAAc3kD,OAAO4kD,KAkCvD,IAjCA,IAAI1qC,EAAIsqC,EAAMn0D,OAAQ6W,EAAOtmB,MAAMs5B,GAAIhiB,EAAO,EAC1C2sD,EAAsC,aAClC3sD,GAAQgiB,GACZw0B,GAAU9tB,GAAI,WAEZ,IAAIiM,EAAS,CAAC1P,KADd5B,EAAMuL,GAAQlG,EAAGtW,IAAKiR,GACG6B,GAAI7B,EACfrU,KAAM0Z,EAAGtW,IAAI4yC,WACTh2C,EAAKq1C,QAAO,SAAU72D,GAAK,OAAY,MAALA,KAAcgc,KAAKkf,EAAGtW,IAAI61C,kBAChEhlC,OAAQ,SACtBkgC,GAAWz6B,EAAGtW,IAAKuiB,GACnBitB,GAA2Bl5B,EAAGtW,IAAKsqC,GAAgB9tB,GAAQlG,EAAGtW,IAAKiR,GAAMuL,GAAQlG,EAAGtW,IAAKuqC,GAAUhoB,QAPrG6hB,IAWAoW,EAAmB,SAAUC,EAAM50D,GACrC,GAAIywB,EAAGhd,QAAQohD,qBAC2C,GAAtDxjD,EAAQof,EAAGhd,QAAQohD,mBAAoBD,EAAKjiD,MAC9C+hD,QAFF,CAKA,IAAII,EAAS,IAAIN,WACjBM,EAAOC,QAAU,WAAc,OAAOL,KACtCI,EAAOE,OAAS,WACd,IAAIltC,EAAUgtC,EAAO7rD,OACjB,0BAA0BhB,KAAK6f,KAInC/Q,EAAK/W,GAAK8nB,GAHR4sC,KAMJI,EAAOG,WAAWL,KAEX50D,EAAI,EAAGA,EAAIq0D,EAAMn0D,OAAQF,IAAO20D,EAAiBN,EAAMr0D,GAAIA,OAC/D,CAEL,GAAIywB,EAAG4D,MAAM6gC,cAAgBzkC,EAAGtW,IAAI+3B,IAAIlqB,SAASoD,IAAQ,EAIvD,OAHAqF,EAAG4D,MAAM6gC,aAAarnD,QAEtBtH,YAAW,WAAc,OAAOkqB,EAAG1X,QAAQwqB,MAAMpgB,UAAY,IAG/D,IACE,IAAIgyC,EAAStnD,EAAEymD,aAAac,QAAQ,QACpC,GAAID,EAAQ,CACV,IAAIE,EAIJ,GAHI5kC,EAAG4D,MAAM6gC,eAAiBzkC,EAAG4D,MAAM6gC,aAAahkE,OAChDmkE,EAAW5kC,EAAG6/B,kBAClB1G,GAAmBn5B,EAAGtW,IAAKsqC,GAAgBr5B,EAAKA,IAC5CiqC,EAAY,IAAK,IAAI/mC,EAAM,EAAGA,EAAM+mC,EAASn1D,SAAUouB,EACvDu+B,GAAap8B,EAAGtW,IAAK,GAAIk7C,EAAS/mC,GAAKyhB,OAAQslB,EAAS/mC,GAAKjU,KAAM,QACvEoW,EAAGmgC,iBAAiBuE,EAAQ,SAAU,SACtC1kC,EAAG1X,QAAQwqB,MAAMpgB,SAGrB,MAAMtV,OAuCV,SAASumD,GAAgB3jC,GACnBA,EAAG1X,QAAQu8C,aACb7kC,EAAG1X,QAAQuvB,UAAUjkB,YAAYoM,EAAG1X,QAAQu8C,YAC5C7kC,EAAG1X,QAAQu8C,WAAa,MAQ5B,SAASC,GAAkB75D,GACzB,GAAKuR,SAASuoD,uBAAd,CAEA,IADA,IAAIC,EAAUxoD,SAASuoD,uBAAuB,cAAeE,EAAU,GAC9D11D,EAAI,EAAGA,EAAIy1D,EAAQv1D,OAAQF,IAAK,CACvC,IAAIywB,EAAKglC,EAAQz1D,GAAG4zD,WAChBnjC,GAAMilC,EAAQpkD,KAAKmf,GAErBilC,EAAQx1D,QAAUw1D,EAAQ,GAAGnX,WAAU,WACzC,IAAK,IAAIv+C,EAAI,EAAGA,EAAI01D,EAAQx1D,OAAQF,IAAOtE,EAAEg6D,EAAQ11D,QAIzD,IAAI21D,IAAoB,EACxB,SAASC,KAKT,IAEMC,EANAF,KAOJ1lC,GAAGpgB,OAAQ,UAAU,WACA,MAAfgmD,IAAuBA,EAActvD,YAAW,WAClDsvD,EAAc,KACdN,GAAkBv3C,MACjB,SAGLiS,GAAGpgB,OAAQ,QAAQ,WAAc,OAAO0lD,GAAkB39C,OAZ1D+9C,IAAoB,GAetB,SAAS33C,GAASyS,GAChB,IAAIpvB,EAAIovB,EAAG1X,QAEX1X,EAAEurC,gBAAkBvrC,EAAEwrC,iBAAmBxrC,EAAEonC,eAAiB,KAC5DpnC,EAAEi7C,mBAAoB,EACtB7rB,EAAGqlC,UAeL,IAZA,IAAIC,GAAW,CACbC,EAAG,QAASC,EAAG,YAAaC,EAAG,MAAOC,GAAI,QAASC,GAAI,QAASC,GAAI,OAAQC,GAAI,MAChFC,GAAI,QAASC,GAAI,WAAYC,GAAI,MAAOC,GAAI,QAASC,GAAI,SAAUC,GAAI,WAAYC,GAAI,MACvFC,GAAI,OAAQC,GAAI,OAAQC,GAAI,KAAMC,GAAI,QAASC,GAAI,OAAQC,GAAI,YAAaC,GAAI,SAChFC,GAAI,SAAUC,GAAI,IAAKC,GAAI,IAAKC,GAAI,MAAOC,GAAI,MAAOC,GAAI,MAC1DC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,aACvDC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,IAAKC,IAAK,KAC/FC,IAAK,IAAKC,IAAK,IAAKC,MAAO,KAAMC,MAAO,OAAQC,MAAO,OAAQC,MAAO,QAASC,MAAO,SACtFC,MAAO,OAAQC,MAAO,MAAOC,MAAO,SAAUC,MAAO,WAAYC,MAAO,UAIjEt5D,GAAI,EAAGA,GAAI,GAAIA,KAAO+1D,GAAS/1D,GAAI,IAAM+1D,GAAS/1D,GAAI,IAAMi2B,OAAOj2B,IAE5E,IAAK,IAAIsuB,GAAM,GAAIA,IAAO,GAAIA,KAASynC,GAASznC,IAAO2H,OAAOsjC,aAAajrC,IAE3E,IAAK,IAAIE,GAAM,EAAGA,IAAO,GAAIA,KAASunC,GAASvnC,GAAM,KAAOunC,GAASvnC,GAAM,OAAS,IAAMA,GAE1F,IAAIgrC,GAAS,GA6Cb,SAASC,GAAiB57C,GACxB,IAEI67C,EAAKC,EAAMlkB,EAAOmkB,EAFlBtO,EAAQztC,EAAKzM,MAAM,UACvByM,EAAOytC,EAAMA,EAAMprD,OAAS,GAE5B,IAAK,IAAIF,EAAI,EAAGA,EAAIsrD,EAAMprD,OAAS,EAAGF,IAAK,CACzC,IAAI65D,EAAMvO,EAAMtrD,GAChB,GAAI,kBAAkBiI,KAAK4xD,GAAQD,GAAM,OACpC,GAAI,YAAY3xD,KAAK4xD,GAAQH,GAAM,OACnC,GAAI,sBAAsBzxD,KAAK4xD,GAAQF,GAAO,MAC9C,KAAI,cAAc1xD,KAAK4xD,GACrB,MAAM,IAAIvtD,MAAM,+BAAiCutD,GADpBpkB,GAAQ,GAO9C,OAJIikB,IAAO77C,EAAO,OAASA,GACvB87C,IAAQ97C,EAAO,QAAUA,GACzB+7C,IAAO/7C,EAAO,OAASA,GACvB43B,IAAS53B,EAAO,SAAWA,GACxBA,EAQT,SAASi8C,GAAgBC,GACvB,IAAI7oE,EAAO,GACX,IAAK,IAAI8oE,KAAWD,EAAU,GAAIA,EAAOvwC,eAAewwC,GAAU,CAChE,IAAI/vD,EAAQ8vD,EAAOC,GACnB,GAAI,mCAAmC/xD,KAAK+xD,GAAY,SACxD,GAAa,OAAT/vD,EAAgB,QAAS8vD,EAAOC,GAAU,SAG9C,IADA,IAAIv0D,EAAOkO,EAAIqmD,EAAQ5oD,MAAM,KAAMqoD,IAC1Bz5D,EAAI,EAAGA,EAAIyF,EAAKvF,OAAQF,IAAK,CACpC,IAAIgO,OAAM,EAAU6P,OAAO,EACvB7d,GAAKyF,EAAKvF,OAAS,GACrB2d,EAAOpY,EAAK8L,KAAK,KACjBvD,EAAM/D,IAEN4T,EAAOpY,EAAKV,MAAM,EAAG/E,EAAI,GAAGuR,KAAK,KACjCvD,EAAM,OAER,IAAIugB,EAAOr9B,EAAK2sB,GAChB,GAAK0Q,GACA,GAAIA,GAAQvgB,EAAO,MAAM,IAAI1B,MAAM,6BAA+BuR,QAD1D3sB,EAAK2sB,GAAQ7P,SAGrB+rD,EAAOC,GAEhB,IAAK,IAAIzwC,KAAQr4B,EAAQ6oE,EAAOxwC,GAAQr4B,EAAKq4B,GAC7C,OAAOwwC,EAGT,SAASE,GAAUv0D,EAAKiO,EAAK05C,EAAQz0B,GAEnC,IAAIpL,GADJ7Z,EAAMumD,GAAUvmD,IACAtO,KAAOsO,EAAItO,KAAKK,EAAKkzB,GAAWjlB,EAAIjO,GACpD,IAAc,IAAV8nB,EAAmB,MAAO,UAC9B,GAAc,QAAVA,EAAmB,MAAO,QAC9B,GAAa,MAATA,GAAiB6/B,EAAO7/B,GAAU,MAAO,UAE7C,GAAI7Z,EAAIwmD,YAAa,CACnB,GAAuD,kBAAnD30D,OAAOX,UAAUN,SAASc,KAAKsO,EAAIwmD,aACnC,OAAOF,GAAUv0D,EAAKiO,EAAIwmD,YAAa9M,EAAQz0B,GACnD,IAAK,IAAI54B,EAAI,EAAGA,EAAI2T,EAAIwmD,YAAYj6D,OAAQF,IAAK,CAC/C,IAAIiJ,EAASgxD,GAAUv0D,EAAKiO,EAAIwmD,YAAYn6D,GAAIqtD,EAAQz0B,GACxD,GAAI3vB,EAAU,OAAOA,IAO3B,SAASmxD,GAAcnwD,GACrB,IAAI4T,EAAuB,iBAAT5T,EAAoBA,EAAQ8rD,GAAS9rD,EAAMqG,SAC7D,MAAe,QAARuN,GAA0B,OAARA,GAAyB,SAARA,GAA2B,OAARA,EAG/D,SAASw8C,GAAiBx8C,EAAMnN,EAAO4pD,GACrC,IAAIzuC,EAAOhO,EAKX,OAJInN,EAAMP,QAAkB,OAAR0b,IAAiBhO,EAAO,OAASA,IAChDqJ,EAAcxW,EAAML,QAAUK,EAAMR,UAAoB,QAAR2b,IAAkBhO,EAAO,QAAUA,IACnFqJ,EAAcxW,EAAMR,QAAUQ,EAAML,UAAoB,OAARwb,IAAiBhO,EAAO,OAASA,IACjFy8C,GAAW5pD,EAAMN,UAAoB,SAARyb,IAAmBhO,EAAO,SAAWA,GAChEA,EAIT,SAAS08C,GAAQ7pD,EAAO4pD,GACtB,GAAIh0C,GAA2B,IAAjB5V,EAAMJ,SAAiBI,EAAY,KAAK,OAAO,EAC7D,IAAImN,EAAOk4C,GAASrlD,EAAMJ,SAC1B,OAAY,MAARuN,IAAgBnN,EAAM8pD,cAGL,GAAjB9pD,EAAMJ,SAAgBI,EAAM0d,OAAQvQ,EAAOnN,EAAM0d,MAC9CisC,GAAiBx8C,EAAMnN,EAAO4pD,IAGvC,SAASJ,GAAUlsD,GACjB,MAAqB,iBAAPA,EAAkBwrD,GAAOxrD,GAAOA,EAKhD,SAASysD,GAAoBhqC,EAAIiqC,GAI/B,IAHA,IAAIvoB,EAAS1hB,EAAGtW,IAAI+3B,IAAIC,OAAQwoB,EAAO,GAG9B36D,EAAI,EAAGA,EAAImyC,EAAOjyC,OAAQF,IAAK,CAEtC,IADA,IAAI46D,EAASF,EAAQvoB,EAAOnyC,IACrB26D,EAAKz6D,QAAUm2B,GAAIukC,EAAO5tC,KAAMvB,EAAIkvC,GAAM1tC,KAAO,GAAG,CACzD,IAAI4tC,EAAWF,EAAKjT,MACpB,GAAIrxB,GAAIwkC,EAAS7tC,KAAM4tC,EAAO5tC,MAAQ,EAAG,CACvC4tC,EAAO5tC,KAAO6tC,EAAS7tC,KACvB,OAGJ2tC,EAAKrpD,KAAKspD,GAGZtc,GAAQ7tB,GAAI,WACV,IAAK,IAAIzwB,EAAI26D,EAAKz6D,OAAS,EAAGF,GAAK,EAAGA,IAClC6sD,GAAap8B,EAAGtW,IAAK,GAAIwgD,EAAK36D,GAAGgtB,KAAM2tC,EAAK36D,GAAGitB,GAAI,WACvD+pB,GAAoBvmB,MAIxB,SAASqqC,GAAkB/qC,EAAM9D,EAAIW,GACnC,IAAI3uB,EAAS0uB,GAAmBoD,EAAKhZ,KAAMkV,EAAKW,EAAKA,GACrD,OAAO3uB,EAAS,GAAKA,EAAS8xB,EAAKhZ,KAAK7W,OAAS,KAAOjC,EAG1D,SAAS88D,GAAchrC,EAAMrH,EAAOkE,GAClC,IAAIX,EAAK6uC,GAAkB/qC,EAAMrH,EAAMuD,GAAIW,GAC3C,OAAa,MAANX,EAAa,KAAO,IAAImK,GAAI1N,EAAMqH,KAAM9D,EAAIW,EAAM,EAAI,QAAU,UAGzE,SAASouC,GAAUC,EAAUxqC,EAAIyP,EAASxK,EAAQ9I,GAChD,GAAIquC,EAAU,CACY,OAApBxqC,EAAGtW,IAAI+T,YAAsBtB,GAAOA,GACxC,IAAIU,EAAQwC,GAASoQ,EAASzP,EAAGtW,IAAI+T,WACrC,GAAIZ,EAAO,CACT,IAGIrB,EAHAkX,EAAOvW,EAAM,EAAInB,EAAI6B,GAASA,EAAM,GAEpCC,EADsBX,EAAM,IAAqB,GAAduW,EAAKlV,OACV,QAAU,SAQ5C,GAAIkV,EAAKlV,MAAQ,GAAyB,OAApBwC,EAAGtW,IAAI+T,UAAoB,CAC/C,IAAIgtC,EAAOzxB,GAAsBhZ,EAAIyP,GACrCjU,EAAKW,EAAM,EAAIsT,EAAQnpB,KAAK7W,OAAS,EAAI,EACzC,IAAIi7D,EAAY3xB,GAAoB/Y,EAAIyqC,EAAMjvC,GAAIhxB,IAClDgxB,EAAKa,IAAU,SAAUb,GAAM,OAAOud,GAAoB/Y,EAAIyqC,EAAMjvC,GAAIhxB,KAAOkgE,IAAevuC,EAAM,IAAqB,GAAduW,EAAKlV,OAAckV,EAAKnW,KAAOmW,EAAKlW,GAAK,EAAGhB,GACzI,UAAVsB,IAAsBtB,EAAK6uC,GAAkB56B,EAASjU,EAAI,SACvDA,EAAKW,EAAM,EAAIuW,EAAKlW,GAAKkW,EAAKnW,KACvC,OAAO,IAAIoJ,GAAIV,EAAQzJ,EAAIsB,IAG/B,OAAO,IAAI6I,GAAIV,EAAQ9I,EAAM,EAAIsT,EAAQnpB,KAAK7W,OAAS,EAAG0sB,EAAM,EAAI,SAAW,SA1MjF4sC,GAAO4B,MAAQ,CACb,KAAQ,aAAc,MAAS,cAAe,GAAM,WAAY,KAAQ,aACxE,IAAO,YAAa,KAAQ,mBAAoB,OAAU,WAAY,SAAY,aAClF,OAAU,eAAgB,UAAa,gBAAiB,kBAAmB,gBAC3E,IAAO,aAAc,YAAa,aAClC,MAAS,mBAAoB,OAAU,kBACvC,IAAO,mBAKT5B,GAAO6B,UAAY,CACjB,SAAU,YAAa,SAAU,aAAc,SAAU,OAAQ,eAAgB,OAAQ,SAAU,OACnG,YAAa,aAAc,WAAY,WAAY,UAAW,WAAY,YAAa,aACvF,YAAa,cAAe,aAAc,eAAgB,WAAY,cAAe,YAAa,YAClG,iBAAkB,iBAAkB,cAAe,gBAAiB,SAAU,OAAQ,SAAU,OAChG,SAAU,WAAY,eAAgB,WAAY,eAAgB,UAAW,eAAgB,aAC7F,SAAU,aAAc,SAAU,aAClC,SAAU,gBAAiB,eAAgB,gBAAiB,QAAS,gBACrE,YAAe,SAGjB7B,GAAO8B,OAAS,CACd,SAAU,cAAe,SAAU,aAAc,SAAU,WAAY,SAAU,aACjF,QAAS,cAAe,QAAS,aAAc,SAAU,cAAe,SAAU,YAClF,SAAU,aAAc,eAAgB,WAAY,SAAU,eAAgB,SAAU,gBACxF,QAAS,eAAgB,gBAAiB,gBAAiB,SAAU,WAAY,SAAU,iBAC3F,SAAU,YAEZ9B,GAAO+B,WAAa,CAClB,QAAS,YAAa,QAAS,aAAc,QAAS,OAAQ,cAAe,OAAQ,QAAS,OAC9F,WAAY,aAAc,SAAU,aAAc,UAAW,WAAY,WAAY,WAAY,WAAY,cAC7G,YAAa,eAAgB,WAAY,aAAc,YAAa,cAAe,gBAAiB,iBACpG,qBAAsB,gBAAiB,aAAc,gBAAiB,QAAS,OAAQ,QAAS,OAChG,QAAS,WAAY,cAAe,WAAY,YAAa,UAAW,kBAAmB,aAC3F,QAAS,aAAc,QAAS,aAAc,gBAAiB,qBAAsB,aAAc,sBACnG,QAAS,gBAAiB,cAAe,gBAAiB,UAAW,aAAc,YAAa,WAChG,YAAe,CAAC,QAAS,WAE3B/B,GAAgB,QAAI3yC,EAAM2yC,GAAO+B,WAAa/B,GAAO6B,UA6OrD,IAAIG,GAAW,CACb1Q,UAAWA,GACX2Q,gBAAiB,SAAUhrC,GAAM,OAAOA,EAAG64B,aAAa74B,EAAGwmB,UAAU,UAAWxmB,EAAGwmB,UAAU,QAASpsB,IACtG6wC,SAAU,SAAUjrC,GAAM,OAAOgqC,GAAoBhqC,GAAI,SAAUnJ,GACjE,GAAIA,EAAM+qB,QAAS,CACjB,IAAIz8C,EAAMm/B,GAAQtE,EAAGtW,IAAKmN,EAAMjN,KAAK0V,MAAMhZ,KAAK7W,OAChD,OAAIonB,EAAMjN,KAAK4R,IAAMr2B,GAAO0xB,EAAMjN,KAAK0V,KAAOU,EAAGoP,WACtC,CAAC7S,KAAM1F,EAAMjN,KAAM4S,GAAImJ,GAAI9O,EAAMjN,KAAK0V,KAAO,EAAG,IAEhD,CAAC/C,KAAM1F,EAAMjN,KAAM4S,GAAImJ,GAAI9O,EAAMjN,KAAK0V,KAAMn6B,IAEvD,MAAO,CAACo3B,KAAM1F,EAAM0F,OAAQC,GAAI3F,EAAM2F,UAG1C0uC,WAAY,SAAUlrC,GAAM,OAAOgqC,GAAoBhqC,GAAI,SAAUnJ,GAAS,MAAO,CACnF0F,KAAMoJ,GAAI9O,EAAM0F,OAAO+C,KAAM,GAC7B9C,GAAI0J,GAAQlG,EAAGtW,IAAKic,GAAI9O,EAAM2F,KAAK8C,KAAO,EAAG,SAE/C6rC,YAAa,SAAUnrC,GAAM,OAAOgqC,GAAoBhqC,GAAI,SAAUnJ,GAAS,MAAO,CACpF0F,KAAMoJ,GAAI9O,EAAM0F,OAAO+C,KAAM,GAAI9C,GAAI3F,EAAM0F,YAE7C6uC,mBAAoB,SAAUprC,GAAM,OAAOgqC,GAAoBhqC,GAAI,SAAUnJ,GAC3E,IAAIrsB,EAAMw1B,EAAGwd,WAAW3mB,EAAMjN,KAAM,OAAOpf,IAAM,EAEjD,MAAO,CAAC+xB,KADMyD,EAAGke,WAAW,CAAC7zC,KAAM,EAAGG,IAAKA,GAAM,OAC1BgyB,GAAI3F,EAAM0F,YAEnC8uC,oBAAqB,SAAUrrC,GAAM,OAAOgqC,GAAoBhqC,GAAI,SAAUnJ,GAC5E,IAAIrsB,EAAMw1B,EAAGwd,WAAW3mB,EAAMjN,KAAM,OAAOpf,IAAM,EAC7C8gE,EAAWtrC,EAAGke,WAAW,CAAC7zC,KAAM21B,EAAG1X,QAAQ68B,QAAQ1jB,YAAc,IAAKj3B,IAAKA,GAAM,OACrF,MAAO,CAAC+xB,KAAM1F,EAAM0F,OAAQC,GAAI8uC,OAElC3K,KAAM,SAAU3gC,GAAM,OAAOA,EAAG2gC,QAChCC,KAAM,SAAU5gC,GAAM,OAAOA,EAAG4gC,QAChCC,cAAe,SAAU7gC,GAAM,OAAOA,EAAG6gC,iBACzCC,cAAe,SAAU9gC,GAAM,OAAOA,EAAG8gC,iBACzCyK,WAAY,SAAUvrC,GAAM,OAAOA,EAAG44B,gBAAgBjzB,GAAI3F,EAAG80B,YAAa,KAC1E0W,SAAU,SAAUxrC,GAAM,OAAOA,EAAG44B,gBAAgBjzB,GAAI3F,EAAGoP,cAC3Dq8B,YAAa,SAAUzrC,GAAM,OAAOA,EAAG+/B,oBAAmB,SAAUlpC,GAAS,OAAOwN,GAAUrE,EAAInJ,EAAMjN,KAAK0V,QAC3G,CAAC/E,OAAQ,QAASue,KAAM,KAE1B4yB,iBAAkB,SAAU1rC,GAAM,OAAOA,EAAG+/B,oBAAmB,SAAUlpC,GAAS,OAAO80C,GAAe3rC,EAAInJ,EAAMjN,QAChH,CAAC2Q,OAAQ,QAASue,KAAM,KAE1B8yB,UAAW,SAAU5rC,GAAM,OAAOA,EAAG+/B,oBAAmB,SAAUlpC,GAAS,OAwG7E,SAAiBmJ,EAAIiP,GACnB,IAAI3P,EAAOgF,GAAQtE,EAAGtW,IAAKulB,GACvB4vB,EAv5KN,SAAuBv/B,GAErB,IADA,IAAIyP,EACGA,EAASJ,GAAmBrP,IAC/BA,EAAOyP,EAAOb,KAAK,GAAG,GAAM5O,KAChC,OAAOA,EAm5KMusC,CAAcvsC,GAE3B,OADIu/B,GAAUv/B,IAAQ2P,EAAQhK,GAAO45B,IAC9B0L,IAAU,EAAMvqC,EAAIV,EAAM2P,GAAQ,GA5GyC68B,CAAQ9rC,EAAInJ,EAAMjN,KAAK0V,QACvG,CAAC/E,OAAQ,QAASue,MAAO,KAE3BizB,YAAa,SAAU/rC,GAAM,OAAOA,EAAG+/B,oBAAmB,SAAUlpC,GAClE,IAAIrsB,EAAMw1B,EAAGyd,aAAa5mB,EAAMjN,KAAM,OAAOpf,IAAM,EACnD,OAAOw1B,EAAGke,WAAW,CAAC7zC,KAAM21B,EAAG1X,QAAQ68B,QAAQ1jB,YAAc,IAAKj3B,IAAKA,GAAM,SAC5EgwB,IACHwxC,WAAY,SAAUhsC,GAAM,OAAOA,EAAG+/B,oBAAmB,SAAUlpC,GACjE,IAAIrsB,EAAMw1B,EAAGyd,aAAa5mB,EAAMjN,KAAM,OAAOpf,IAAM,EACnD,OAAOw1B,EAAGke,WAAW,CAAC7zC,KAAM,EAAGG,IAAKA,GAAM,SACzCgwB,IACHyxC,gBAAiB,SAAUjsC,GAAM,OAAOA,EAAG+/B,oBAAmB,SAAUlpC,GACtE,IAAIrsB,EAAMw1B,EAAGyd,aAAa5mB,EAAMjN,KAAM,OAAOpf,IAAM,EAC/CmwB,EAAMqF,EAAGke,WAAW,CAAC7zC,KAAM,EAAGG,IAAKA,GAAM,OAC7C,OAAImwB,EAAIa,GAAKwE,EAAGsE,QAAQ3J,EAAI2E,MAAMjG,OAAO,MAAgBsyC,GAAe3rC,EAAInJ,EAAMjN,MAC3E+Q,IACNH,IACH0xC,SAAU,SAAUlsC,GAAM,OAAOA,EAAGmsC,OAAO,EAAG,SAC9CC,WAAY,SAAUpsC,GAAM,OAAOA,EAAGmsC,MAAM,EAAG,SAC/CE,SAAU,SAAUrsC,GAAM,OAAOA,EAAGmsC,OAAO,EAAG,SAC9CG,WAAY,SAAUtsC,GAAM,OAAOA,EAAGmsC,MAAM,EAAG,SAC/CI,WAAY,SAAUvsC,GAAM,OAAOA,EAAGwsC,OAAO,EAAG,SAChDC,YAAa,SAAUzsC,GAAM,OAAOA,EAAGwsC,MAAM,EAAG,SAChDE,aAAc,SAAU1sC,GAAM,OAAOA,EAAGwsC,OAAO,EAAG,WAClDG,cAAe,SAAU3sC,GAAM,OAAOA,EAAGwsC,MAAM,EAAG,WAClDI,WAAY,SAAU5sC,GAAM,OAAOA,EAAGwsC,OAAO,EAAG,SAChDK,aAAc,SAAU7sC,GAAM,OAAOA,EAAGwsC,MAAM,EAAG,UACjDM,YAAa,SAAU9sC,GAAM,OAAOA,EAAGwsC,OAAO,EAAG,UACjDO,YAAa,SAAU/sC,GAAM,OAAOA,EAAGwsC,MAAM,EAAG,SAChDQ,cAAe,SAAUhtC,GAAM,OAAOA,EAAGitC,SAAS,EAAG,SACrDC,aAAc,SAAUltC,GAAM,OAAOA,EAAGitC,QAAQ,EAAG,SACnDE,cAAe,SAAUntC,GAAM,OAAOA,EAAGitC,SAAS,EAAG,SACrDG,aAAc,SAAUptC,GAAM,OAAOA,EAAGitC,QAAQ,EAAG,SACnDI,eAAgB,SAAUrtC,GAAM,OAAOA,EAAGitC,SAAS,EAAG,UACtDK,cAAe,SAAUttC,GAAM,OAAOA,EAAGitC,QAAQ,EAAG,UACpDM,WAAY,SAAUvtC,GAAM,OAAOA,EAAGwtC,gBAAgB,UACtDC,WAAY,SAAUztC,GAAM,OAAOA,EAAGwtC,gBAAgB,QACtDE,WAAY,SAAU1tC,GAAM,OAAOA,EAAGwtC,gBAAgB,aACtDG,UAAW,SAAU3tC,GAAM,OAAOA,EAAGmgC,iBAAiB,OACtDyN,cAAe,SAAU5tC,GAEvB,IADA,IAAI6tC,EAAS,GAAInsB,EAAS1hB,EAAG6/B,iBAAkB3mC,EAAU8G,EAAGhd,QAAQkW,QAC3D3pB,EAAI,EAAGA,EAAImyC,EAAOjyC,OAAQF,IAAK,CACtC,IAAIorB,EAAM+mB,EAAOnyC,GAAGgtB,OAChB3B,EAAM5B,EAAYgH,EAAGsE,QAAQ3J,EAAI2E,MAAO3E,EAAIa,GAAItC,GACpD20C,EAAOhtD,KAAKka,EAAS7B,EAAU0B,EAAM1B,IAEvC8G,EAAGqgC,kBAAkBwN,IAEvBC,WAAY,SAAU9tC,GAChBA,EAAGyzB,oBAAuBzzB,EAAGwtC,gBAAgB,OAC1CxtC,EAAG+tC,YAAY,cASxBC,eAAgB,SAAUhuC,GAAM,OAAO6tB,GAAQ7tB,GAAI,WAEjD,IADA,IAAI0hB,EAAS1hB,EAAG6/B,iBAAkBS,EAAS,GAClC/wD,EAAI,EAAGA,EAAImyC,EAAOjyC,OAAQF,IACjC,GAAKmyC,EAAOnyC,GAAGqyC,QAAf,CACA,IAAI5kB,EAAM0kB,EAAOnyC,GAAGqa,KAAM0V,EAAOgF,GAAQtE,EAAGtW,IAAKsT,EAAIsC,MAAMhZ,KAC3D,GAAIgZ,EAEF,GADItC,EAAIxB,IAAM8D,EAAK7vB,SAAUutB,EAAM,IAAI2I,GAAI3I,EAAIsC,KAAMtC,EAAIxB,GAAK,IAC1DwB,EAAIxB,GAAK,EACXwB,EAAM,IAAI2I,GAAI3I,EAAIsC,KAAMtC,EAAIxB,GAAK,GACjCwE,EAAGo8B,aAAa98B,EAAKlD,OAAOY,EAAIxB,GAAK,GAAK8D,EAAKlD,OAAOY,EAAIxB,GAAK,GAC/CmK,GAAI3I,EAAIsC,KAAMtC,EAAIxB,GAAK,GAAIwB,EAAK,mBAC3C,GAAIA,EAAIsC,KAAOU,EAAGtW,IAAI6a,MAAO,CAClC,IAAIzG,EAAOwG,GAAQtE,EAAGtW,IAAKsT,EAAIsC,KAAO,GAAGhZ,KACrCwX,IACFd,EAAM,IAAI2I,GAAI3I,EAAIsC,KAAM,GACxBU,EAAGo8B,aAAa98B,EAAKlD,OAAO,GAAK4D,EAAGtW,IAAI61C,gBACxBzhC,EAAK1B,OAAO0B,EAAKruB,OAAS,GAC1Bk2B,GAAI3I,EAAIsC,KAAO,EAAGxB,EAAKruB,OAAS,GAAIutB,EAAK,eAI/DsjC,EAAOz/C,KAAK,IAAI2yC,GAAMx2B,EAAKA,IAE7BgD,EAAGggC,cAAcM,OAEnB2N,iBAAkB,SAAUjuC,GAAM,OAAO6tB,GAAQ7tB,GAAI,WAEnD,IADA,IAAIkuC,EAAOluC,EAAG6/B,iBACLtwD,EAAI2+D,EAAKz+D,OAAS,EAAGF,GAAK,EAAGA,IAClCywB,EAAGo8B,aAAap8B,EAAGtW,IAAI61C,gBAAiB2O,EAAK3+D,GAAG+vC,OAAQ4uB,EAAK3+D,GAAGqa,KAAM,UAC1EskD,EAAOluC,EAAG6/B,iBACV,IAAK,IAAIhiC,EAAM,EAAGA,EAAMqwC,EAAKz+D,OAAQouB,IACjCmC,EAAGmuC,WAAWD,EAAKrwC,GAAKtB,OAAO+C,KAAM,MAAM,GAC/CinB,GAAoBvmB,OAEtBouC,SAAU,SAAUpuC,GAAM,OAAOA,EAAGmgC,iBAAiB,KAAM,UAC3DkO,gBAAiB,SAAUruC,GAAM,OAAOA,EAAGquC,oBAI7C,SAAShqC,GAAUrE,EAAIiP,GACrB,IAAI3P,EAAOgF,GAAQtE,EAAGtW,IAAKulB,GACvB4vB,EAAS/vB,GAAWxP,GAExB,OADIu/B,GAAUv/B,IAAQ2P,EAAQhK,GAAO45B,IAC9B0L,IAAU,EAAMvqC,EAAI6+B,EAAQ5vB,EAAO,GAQ5C,SAAS08B,GAAe3rC,EAAIrF,GAC1B,IAAI1C,EAAQoM,GAAUrE,EAAIrF,EAAI2E,MAC1BA,EAAOgF,GAAQtE,EAAGtW,IAAKuO,EAAMqH,MAC7BzC,EAAQwC,GAASC,EAAMU,EAAGtW,IAAI+T,WAClC,IAAKZ,GAA2B,GAAlBA,EAAM,GAAGW,MAAY,CACjC,IAAI8wC,EAAapuE,KAAKoP,IAAI2oB,EAAMuD,GAAI8D,EAAKhZ,KAAK+S,OAAO,OACjDk1C,EAAO5zC,EAAI2E,MAAQrH,EAAMqH,MAAQ3E,EAAIa,IAAM8yC,GAAc3zC,EAAIa,GACjE,OAAOmK,GAAI1N,EAAMqH,KAAMivC,EAAO,EAAID,EAAYr2C,EAAM6E,QAEtD,OAAO7E,EAIT,SAASu2C,GAAgBxuC,EAAIyuC,EAAOC,GAClC,GAAoB,iBAATD,KACTA,EAAQ1D,GAAS0D,IACH,OAAO,EAIvBzuC,EAAG1X,QAAQwqB,MAAM67B,eACjB,IAAIC,EAAY5uC,EAAG1X,QAAQ08B,MAAOkR,GAAO,EACzC,IACMl2B,EAAG8jC,eAAgB9jC,EAAG4D,MAAM+2B,eAAgB,GAC5C+T,IAAa1uC,EAAG1X,QAAQ08B,OAAQ,GACpCkR,EAAOuY,EAAMzuC,IAAO7F,EACpB,QACA6F,EAAG1X,QAAQ08B,MAAQ4pB,EACnB5uC,EAAG4D,MAAM+2B,eAAgB,EAE3B,OAAOzE,EAeT,IAAI2Y,GAAU,IAAIl1C,EAElB,SAASm1C,GAAY9uC,EAAI5S,EAAMhQ,EAAGw/C,GAChC,IAAImS,EAAM/uC,EAAG4D,MAAMorC,OACnB,GAAID,EAAK,CACP,GAAIpF,GAAcv8C,GAAS,MAAO,UAUlC,GATI,MAAM5V,KAAK4V,GACX4S,EAAG4D,MAAMorC,OAAS,KAElBH,GAAQltE,IAAI,IAAI,WACZq+B,EAAG4D,MAAMorC,QAAUD,IACrB/uC,EAAG4D,MAAMorC,OAAS,KAClBhvC,EAAG1X,QAAQwqB,MAAMgS,YAGnBmqB,GAAiBjvC,EAAI+uC,EAAM,IAAM3hD,EAAMhQ,EAAGw/C,GAAW,OAAO,EAElE,OAAOqS,GAAiBjvC,EAAI5S,EAAMhQ,EAAGw/C,GAGvC,SAASqS,GAAiBjvC,EAAI5S,EAAMhQ,EAAGw/C,GACrC,IAAIpkD,EAjCN,SAA4BwnB,EAAI5S,EAAMwvC,GACpC,IAAK,IAAIrtD,EAAI,EAAGA,EAAIywB,EAAG4D,MAAMsrC,QAAQz/D,OAAQF,IAAK,CAChD,IAAIiJ,EAASgxD,GAAUp8C,EAAM4S,EAAG4D,MAAMsrC,QAAQ3/D,GAAIqtD,EAAQ58B,GAC1D,GAAIxnB,EAAU,OAAOA,EAEvB,OAAQwnB,EAAGhd,QAAQmsD,WAAa3F,GAAUp8C,EAAM4S,EAAGhd,QAAQmsD,UAAWvS,EAAQ58B,IACzEwpC,GAAUp8C,EAAM4S,EAAGhd,QAAQ+lD,OAAQnM,EAAQ58B,GA2BnCovC,CAAmBpvC,EAAI5S,EAAMwvC,GAY1C,MAVc,SAAVpkD,IACAwnB,EAAG4D,MAAMorC,OAAS5hD,GACR,WAAV5U,GACA07B,GAAYlU,EAAI,aAAcA,EAAI5S,EAAMhQ,GAE9B,WAAV5E,GAAiC,SAAVA,IACzBooB,GAAiBxjB,GACjB4mC,GAAahkB,MAGNxnB,EAIX,SAAS62D,GAAiBrvC,EAAI5iB,GAC5B,IAAIgQ,EAAO08C,GAAQ1sD,GAAG,GACtB,QAAKgQ,IAEDhQ,EAAEuC,WAAaqgB,EAAG4D,MAAMorC,OAInBF,GAAY9uC,EAAI,SAAW5S,EAAMhQ,GAAG,SAAUrZ,GAAK,OAAOyqE,GAAgBxuC,EAAIj8B,GAAG,OACjF+qE,GAAY9uC,EAAI5S,EAAMhQ,GAAG,SAAUrZ,GACjC,GAAgB,iBAALA,EAAgB,WAAWyT,KAAKzT,GAAKA,EAAEurE,OAC9C,OAAOd,GAAgBxuC,EAAIj8B,MAGjC+qE,GAAY9uC,EAAI5S,EAAMhQ,GAAG,SAAUrZ,GAAK,OAAOyqE,GAAgBxuC,EAAIj8B,OAS9E,IAAIwrE,GAAiB,KACrB,SAASC,GAAUpyD,GACjB,IAAI4iB,EAAKtrB,KAET,GADAsrB,EAAGO,MAAM7N,MAAQkF,KACbmI,GAAeC,EAAI5iB,GAAvB,CAEImY,GAAMC,EAAa,IAAmB,IAAbpY,EAAEyC,UAAiBzC,EAAEyjB,aAAc,GAChE,IAAIlD,EAAOvgB,EAAEyC,QACbmgB,EAAG1X,QAAQ08B,MAAgB,IAARrnB,GAAcvgB,EAAEuC,SACnC,IAAI8vD,EAAUJ,GAAiBrvC,EAAI5iB,GAC/ByY,IACF05C,GAAiBE,EAAU9xC,EAAO,KAE7B8xC,GAAmB,IAAR9xC,GAAe4E,MAAiBnM,EAAMhZ,EAAEwC,QAAUxC,EAAEqC,UAChEugB,EAAGmgC,iBAAiB,GAAI,KAAM,QAEhCjrC,IAAUkB,IAAQq5C,GAAmB,IAAR9xC,GAAcvgB,EAAEuC,WAAavC,EAAEqC,SAAWjD,SAASuxD,aAChFvxD,SAASuxD,YAAY,OAGb,IAARpwC,GAAe,2BAA2BnmB,KAAKwoB,EAAG1X,QAAQ68B,QAAQvmC,YAIxE,SAAuBohB,GACrB,IAAImlB,EAAUnlB,EAAG1X,QAAQ68B,QAGzB,SAAS74C,EAAG8Q,GACO,IAAbA,EAAEyC,SAAkBzC,EAAEsC,SACxBoX,EAAQquB,EAAS,wBACjBvlB,GAAIpjB,SAAU,QAASlQ,GACvBszB,GAAIpjB,SAAU,YAAalQ,IAN/BmU,EAAS0kC,EAAS,wBASlB3lB,GAAGhjB,SAAU,QAASlQ,GACtBkzB,GAAGhjB,SAAU,YAAalQ,GAftBojE,CAAc1vC,IAkBpB,SAAS2vC,GAAQvyD,GACE,IAAbA,EAAEyC,UAAiBnL,KAAKgV,IAAI+3B,IAAIuD,OAAQ,GAC5CjlB,GAAerrB,KAAM0I,GAGvB,SAASwyD,GAAWxyD,GAClB,IAAI4iB,EAAKtrB,KACT,KAAI8iC,GAAcxX,EAAG1X,QAASlL,IAAM2iB,GAAeC,EAAI5iB,IAAMA,EAAEqC,UAAYrC,EAAEsC,QAAU0W,GAAOhZ,EAAEwC,SAAhG,CACA,IAAIC,EAAUzC,EAAEyC,QAASC,EAAW1C,EAAE0C,SACtC,GAAI+V,GAAUhW,GAAW0vD,GAA6D,OAA5CA,GAAiB,UAAM3uC,GAAiBxjB,GAClF,IAAKyY,GAAYzY,EAAEoV,SAASpV,EAAEoV,MAAQ,MAAQ68C,GAAiBrvC,EAAI5iB,GAAnE,CACA,IAAIoe,EAAKgK,OAAOsjC,aAAyB,MAAZhpD,EAAmBD,EAAUC,GAEhD,MAAN0b,IAxDN,SAA2BwE,EAAI5iB,EAAGoe,GAChC,OAAOszC,GAAY9uC,EAAI,IAAMxE,EAAK,IAAKpe,GAAG,SAAUrZ,GAAK,OAAOyqE,GAAgBxuC,EAAIj8B,GAAG,MAwDnF8rE,CAAkB7vC,EAAI5iB,EAAGoe,IAC7BwE,EAAG1X,QAAQwqB,MAAM88B,WAAWxyD,MAG9B,IAaI0yD,GAAWC,GAXXC,GAAY,SAASn2C,EAAMc,EAAK1I,GAClCvd,KAAKmlB,KAAOA,EACZnlB,KAAKimB,IAAMA,EACXjmB,KAAKud,OAASA,GA8BhB,SAASg+C,GAAY7yD,GACnB,IAAI4iB,EAAKtrB,KAAM4T,EAAU0X,EAAG1X,QAC5B,KAAIyX,GAAeC,EAAI5iB,IAAMkL,EAAQypC,aAAezpC,EAAQwqB,MAAMo9B,iBAIlE,GAHA5nD,EAAQwqB,MAAM67B,eACdrmD,EAAQ08B,MAAQ5nC,EAAEuC,SAEd63B,GAAclvB,EAASlL,GACpBsY,IAGHpN,EAAQiwB,SAASqZ,WAAY,EAC7B97C,YAAW,WAAc,OAAOwS,EAAQiwB,SAASqZ,WAAY,IAAS,WAI1E,IAAIue,GAAcnwC,EAAI5iB,GAAtB,CACA,IAAIud,EAAMolB,GAAa/f,EAAI5iB,GAAI6U,EAASkP,GAAS/jB,GAAIgzD,EAASz1C,EArChE,SAAqBA,EAAK1I,GACxB,IAAIo+C,GAAO,IAAIp2C,KACf,OAAI81C,IAAmBA,GAAgBO,QAAQD,EAAK11C,EAAK1I,IACvD69C,GAAYC,GAAkB,KACvB,UACED,IAAaA,GAAUQ,QAAQD,EAAK11C,EAAK1I,IAClD89C,GAAkB,IAAIC,GAAUK,EAAK11C,EAAK1I,GAC1C69C,GAAY,KACL,WAEPA,GAAY,IAAIE,GAAUK,EAAK11C,EAAK1I,GACpC89C,GAAkB,KACX,UAyB2DQ,CAAY51C,EAAK1I,GAAU,SAC/F7S,OAAOsT,QAGO,GAAVT,GAAe+N,EAAG4D,MAAM4sC,eACxBxwC,EAAG4D,MAAM4sC,cAAcpzD,GAEvBud,GAcN,SAA4BqF,EAAI/N,EAAQ0I,EAAKy1C,EAAQnwD,GACnD,IAAImN,EAAO,QAKX,MAJc,UAAVgjD,EAAsBhjD,EAAO,SAAWA,EACzB,UAAVgjD,IAAsBhjD,EAAO,SAAWA,GAG1C0hD,GAAY9uC,EAAK4pC,GAFxBx8C,GAAkB,GAAV6E,EAAc,OAAmB,GAAVA,EAAc,SAAW,SAAW7E,EAEpBnN,GAAQA,GAAO,SAAUwuD,GAEtE,GADoB,iBAATA,IAAqBA,EAAQ1D,GAAS0D,KAC5CA,EAAS,OAAO,EACrB,IAAIvY,GAAO,EACX,IACMl2B,EAAG8jC,eAAgB9jC,EAAG4D,MAAM+2B,eAAgB,GAChDzE,EAAOuY,EAAMzuC,EAAIrF,IAAQR,EACzB,QACA6F,EAAG4D,MAAM+2B,eAAgB,EAE3B,OAAOzE,KA9BEua,CAAmBzwC,EAAI/N,EAAQ0I,EAAKy1C,EAAQhzD,KAEzC,GAAV6U,EACE0I,EA4CR,SAAwBqF,EAAIrF,EAAKy1C,EAAQnwD,GACnCsV,EAAMzf,WAAWX,EAAKqvC,GAAaxkB,GAAK,GACrCA,EAAGO,MAAM7N,MAAQkF,IAExB,IAEsB84C,EAFlBC,EAjBN,SAAwB3wC,EAAIowC,EAAQnwD,GAClC,IAAI2wD,EAAS5wC,EAAG6Q,UAAU,kBACtBr3B,EAAQo3D,EAASA,EAAO5wC,EAAIowC,EAAQnwD,GAAS,GACjD,GAAkB,MAAdzG,EAAMq3D,KAAc,CACtB,IAAIt3B,EAAOljB,EAAWpW,EAAMN,UAAYM,EAAML,QAAUK,EAAMP,OAC9DlG,EAAMq3D,KAAOt3B,EAAO,YAAwB,UAAV62B,EAAqB,OAAmB,UAAVA,EAAqB,OAAS,OAKhG,OAHoB,MAAhB52D,EAAM/E,QAAkBurB,EAAGtW,IAAIjV,UAAU+E,EAAM/E,OAASurB,EAAGtW,IAAIjV,QAAUwL,EAAMN,UAC/D,MAAhBnG,EAAMs3D,SAAkBt3D,EAAMs3D,OAAS16C,EAAMnW,EAAML,QAAUK,EAAMR,SAC/C,MAApBjG,EAAMu3D,aAAsBv3D,EAAMu3D,aAAe36C,EAAMnW,EAAMP,OAASO,EAAMR,UACzEjG,EAOQw3D,CAAehxC,EAAIowC,EAAQnwD,GAEtCwhC,EAAMzhB,EAAGtW,IAAI+3B,IACbzhB,EAAGhd,QAAQiuD,UAAY3vC,KAAgBtB,EAAG8jC,cAChC,UAAVsM,IAAuBM,EAAYjvB,EAAIlqB,SAASoD,KAAS,IACxDiL,IAAK8qC,EAAYjvB,EAAIC,OAAOgvB,IAAYn0C,OAAQ5B,GAAO,GAAKA,EAAIsjB,KAAO,KACvErY,GAAI8qC,EAAUl0C,KAAM7B,GAAO,GAAKA,EAAIsjB,KAAO,GAQlD,SAA6Bje,EAAI/f,EAAO0a,EAAKg2C,GAC3C,IAAIroD,EAAU0X,EAAG1X,QAAS4oD,GAAQ,EAC9BC,EAAUrjB,GAAU9tB,GAAI,SAAU5iB,GAChCsY,IAAUpN,EAAQiwB,SAASqZ,WAAY,GAC3C5xB,EAAG4D,MAAM6gC,cAAe,EACxB7kC,GAAItX,EAAQgvB,QAAQlV,cAAe,UAAW+uC,GAC9CvxC,GAAItX,EAAQgvB,QAAQlV,cAAe,YAAagvC,GAChDxxC,GAAItX,EAAQiwB,SAAU,YAAaplB,GACnCyM,GAAItX,EAAQiwB,SAAU,OAAQ44B,GACzBD,IACHtwC,GAAiBxjB,GACZuzD,EAASG,QACVlY,GAAgB54B,EAAGtW,IAAKiR,EAAK,KAAM,KAAMg2C,EAASl8D,QAElDihB,GAAUH,GAAoB,GAAdC,EAChB1f,YAAW,WAAawS,EAAQgvB,QAAQlV,cAAcxX,KAAK8H,QAASpK,EAAQwqB,MAAMpgB,UAAW,IAE7FpK,EAAQwqB,MAAMpgB,YAGlB0+C,EAAY,SAASC,GACvBH,EAAQA,GAAShxE,KAAKoN,IAAI2S,EAAMlB,QAAUsyD,EAAGtyD,SAAW7e,KAAKoN,IAAI2S,EAAMjB,QAAUqyD,EAAGryD,UAAY,IAE9FmU,EAAY,WAAc,OAAO+9C,GAAQ,GAEzCx7C,IAAUpN,EAAQiwB,SAASqZ,WAAY,GAC3C5xB,EAAG4D,MAAM6gC,aAAe0M,EACxBA,EAAQ1wE,MAAQkwE,EAASI,WAErBzoD,EAAQiwB,SAAS04B,UAAY3oD,EAAQiwB,SAAS04B,WAClDzxC,GAAGlX,EAAQgvB,QAAQlV,cAAe,UAAW+uC,GAC7C3xC,GAAGlX,EAAQgvB,QAAQlV,cAAe,YAAagvC,GAC/C5xC,GAAGlX,EAAQiwB,SAAU,YAAaplB,GAClCqM,GAAGlX,EAAQiwB,SAAU,OAAQ44B,GAE7BzsB,GAAe1kB,GACflqB,YAAW,WAAc,OAAOwS,EAAQwqB,MAAMpgB,UAAY,IA3CtD4+C,CAAoBtxC,EAAI/f,EAAO0a,EAAKg2C,GAuD1C,SAA0B3wC,EAAI/f,EAAOgY,EAAO04C,GAC1C,IAAIroD,EAAU0X,EAAG1X,QAASoB,EAAMsW,EAAGtW,IACnCkX,GAAiB3gB,GAEjB,IAAIsxD,EAAUC,EAAUC,EAAW/nD,EAAI+3B,IAAKC,EAAS+vB,EAAS/vB,OAY9D,GAXIivB,EAASG,SAAWH,EAASl8D,QAC/B+8D,EAAW9nD,EAAI+3B,IAAIlqB,SAASU,GAExBs5C,EADAC,GAAY,EACD9vB,EAAO8vB,GAEP,IAAIhe,GAAMv7B,EAAOA,KAEhCs5C,EAAW7nD,EAAI+3B,IAAIJ,UACnBmwB,EAAW9nD,EAAI+3B,IAAIE,WAGA,aAAjBgvB,EAASE,KACNF,EAASG,SAAUS,EAAW,IAAI/d,GAAMv7B,EAAOA,IACpDA,EAAQ8nB,GAAa/f,EAAI/f,GAAO,GAAM,GACtCuxD,GAAY,MACP,CACL,IAAI36C,EAAQ66C,GAAa1xC,EAAI/H,EAAO04C,EAASE,MAEzCU,EADAZ,EAASl8D,OACEikD,GAAY6Y,EAAU16C,EAAMyoB,OAAQzoB,EAAMjN,KAAM+mD,EAASl8D,QAEzDoiB,EAGZ85C,EAASG,QAIU,GAAbU,GACTA,EAAW9vB,EAAOjyC,OAClBopD,GAAanvC,EAAKgqC,GAAmB1zB,EAAI0hB,EAAO5xB,OAAO,CAACyhD,IAAYC,GACvD,CAACn3C,QAAQ,EAAOE,OAAQ,YAC5BmnB,EAAOjyC,OAAS,GAAKiyC,EAAO8vB,GAAU5vB,SAA4B,QAAjB+uB,EAASE,OAAmBF,EAASl8D,QAC/FokD,GAAanvC,EAAKgqC,GAAmB1zB,EAAI0hB,EAAOptC,MAAM,EAAGk9D,GAAU1hD,OAAO4xB,EAAOptC,MAAMk9D,EAAW,IAAK,GAC1F,CAACn3C,QAAQ,EAAOE,OAAQ,WACrCk3C,EAAW/nD,EAAI+3B,KAEfuX,GAAoBtvC,EAAK8nD,EAAUD,EAAUj3C,IAZ7Ck3C,EAAW,EACX3Y,GAAanvC,EAAK,IAAIypC,GAAU,CAACoe,GAAW,GAAIj3C,GAChDm3C,EAAW/nD,EAAI+3B,KAajB,IAAIkwB,EAAU15C,EACd,SAAS25C,EAASj3C,GAChB,GAAyB,GAArBiL,GAAI+rC,EAASh3C,GAGjB,GAFAg3C,EAAUh3C,EAEW,aAAjBg2C,EAASE,KAAqB,CAKhC,IAJA,IAAInvB,EAAS,GAAIxoB,EAAU8G,EAAGhd,QAAQkW,QAClC24C,EAAW74C,EAAYsL,GAAQ5a,EAAKuO,EAAMqH,MAAMhZ,KAAM2R,EAAMuD,GAAItC,GAChE44C,EAAS94C,EAAYsL,GAAQ5a,EAAKiR,EAAI2E,MAAMhZ,KAAMqU,EAAIa,GAAItC,GAC1D7uB,EAAOnK,KAAK6P,IAAI8hE,EAAUC,GAASxnE,EAAQpK,KAAKoP,IAAIuiE,EAAUC,GACzDxyC,EAAOp/B,KAAK6P,IAAIkoB,EAAMqH,KAAM3E,EAAI2E,MAAOpH,EAAMh4B,KAAK6P,IAAIiwB,EAAGoP,WAAYlvC,KAAKoP,IAAI2oB,EAAMqH,KAAM3E,EAAI2E,OAClGA,GAAQpH,EAAKoH,IAAQ,CACxB,IAAIhZ,EAAOge,GAAQ5a,EAAK4V,GAAMhZ,KAAMyrD,EAAUt3C,EAAWnU,EAAMjc,EAAM6uB,GACjE7uB,GAAQC,EACRo3C,EAAO7gC,KAAK,IAAI2yC,GAAM7tB,GAAIrG,EAAMyyC,GAAUpsC,GAAIrG,EAAMyyC,KAC/CzrD,EAAK7W,OAASsiE,GACnBrwB,EAAO7gC,KAAK,IAAI2yC,GAAM7tB,GAAIrG,EAAMyyC,GAAUpsC,GAAIrG,EAAM7E,EAAWnU,EAAMhc,EAAO4uB,MAE7EwoB,EAAOjyC,QAAUiyC,EAAO7gC,KAAK,IAAI2yC,GAAMv7B,EAAOA,IACnD4gC,GAAanvC,EAAKgqC,GAAmB1zB,EAAIyxC,EAAS/vB,OAAOptC,MAAM,EAAGk9D,GAAU1hD,OAAO4xB,GAAS8vB,GAC/E,CAACj3C,OAAQ,SAAUF,QAAQ,IACxC2F,EAAGgtB,eAAeryB,OACb,CACL,IAE8B/Q,EAF1BooD,EAAWT,EACX16C,EAAQ66C,GAAa1xC,EAAIrF,EAAKg2C,EAASE,MACvCvxB,EAAS0yB,EAAS1yB,OAClB1Z,GAAI/O,EAAMyoB,OAAQA,GAAU,GAC9B11B,EAAOiN,EAAMjN,KACb01B,EAAStZ,GAAOgsC,EAASz1C,OAAQ1F,EAAMyoB,UAEvC11B,EAAOiN,EAAMyoB,OACbA,EAASvZ,GAAOisC,EAASx1C,KAAM3F,EAAMjN,OAEvC,IAAIqoD,EAAWR,EAAS/vB,OAAOptC,MAAM,GACrC29D,EAAST,GA2Df,SAAsBxxC,EAAInJ,GACxB,IAAIyoB,EAASzoB,EAAMyoB,OACf11B,EAAOiN,EAAMjN,KACbsoD,EAAa5tC,GAAQtE,EAAGtW,IAAK41B,EAAOhgB,MACxC,GAAyB,GAArBsG,GAAI0Z,EAAQ11B,IAAc01B,EAAOxiB,QAAUlT,EAAKkT,OAAU,OAAOjG,EACrE,IAAIgG,EAAQwC,GAAS6yC,GACrB,IAAKr1C,EAAS,OAAOhG,EACrB,IAAI3V,EAAQ0b,GAAcC,EAAOyiB,EAAO9jB,GAAI8jB,EAAOxiB,QAAS4V,EAAO7V,EAAM3b,GACzE,GAAIwxB,EAAKnW,MAAQ+iB,EAAO9jB,IAAMkX,EAAKlW,IAAM8iB,EAAO9jB,GAAM,OAAO3E,EAC7D,IAKIurB,EALA+vB,EAAWjxD,GAAUwxB,EAAKnW,MAAQ+iB,EAAO9jB,KAAsB,GAAdkX,EAAKlV,OAAc,EAAI,GAC5E,GAAgB,GAAZ20C,GAAiBA,GAAYt1C,EAAMptB,OAAU,OAAOonB,EAKxD,GAAIjN,EAAK0V,MAAQggB,EAAOhgB,KACtB8iB,GAAYx4B,EAAK0V,KAAOggB,EAAOhgB,OAA6B,OAApBU,EAAGtW,IAAI+T,UAAqB,GAAK,GAAK,MACzE,CACL,IAAI20C,EAAYx1C,GAAcC,EAAOjT,EAAK4R,GAAI5R,EAAKkT,QAC/CX,EAAMi2C,EAAYlxD,IAAU0I,EAAK4R,GAAK8jB,EAAO9jB,KAAqB,GAAdkX,EAAKlV,OAAc,EAAI,GAE3E4kB,EADAgwB,GAAaD,EAAW,GAAKC,GAAaD,EAC/Bh2C,EAAM,EAENA,EAAM,EAGvB,IAAIk2C,EAAUx1C,EAAMs1C,GAAY/vB,GAAY,EAAI,IAC5C7lB,EAAO6lB,IAA8B,GAAjBiwB,EAAQ70C,OAC5BhC,EAAKe,EAAO81C,EAAQ91C,KAAO81C,EAAQ71C,GAAIM,EAASP,EAAO,QAAU,SACrE,OAAO+iB,EAAO9jB,IAAMA,GAAM8jB,EAAOxiB,QAAUA,EAASjG,EAAQ,IAAI28B,GAAM,IAAI7tB,GAAI2Z,EAAOhgB,KAAM9D,EAAIsB,GAASlT,GAxF/E0oD,CAAatyC,EAAI,IAAIwzB,GAAMttB,GAAQxc,EAAK41B,GAAS11B,IACtEivC,GAAanvC,EAAKgqC,GAAmB1zB,EAAIiyC,EAAUT,GAAWl3C,IAIlE,IAAIi4C,EAAajqD,EAAQgvB,QAAQvxB,wBAK7BysD,EAAU,EAsBd,SAAStc,EAAK94C,GACZ4iB,EAAG4D,MAAM4sC,eAAgB,EACzBgC,EAAUrnE,IAINiS,IACFwjB,GAAiBxjB,GACjBkL,EAAQwqB,MAAMpgB,SAEhBkN,GAAItX,EAAQgvB,QAAQlV,cAAe,YAAaqwC,GAChD7yC,GAAItX,EAAQgvB,QAAQlV,cAAe,UAAW91B,GAC9Cod,EAAI4tC,QAAQZ,cAAgB,KAG9B,IAAI+b,EAAO3kB,GAAU9tB,GAAI,SAAU5iB,GACf,IAAdA,EAAEs1D,SAAkBvxC,GAAS/jB,GApCnC,SAAS3I,EAAO2I,GACd,IAAIu1D,IAAaH,EACbx1C,EAAM+iB,GAAa/f,EAAI5iB,GAAG,EAAuB,aAAjBuzD,EAASE,MAC7C,GAAK7zC,EACL,GAAyB,GAArB4I,GAAI5I,EAAK20C,GAAe,CAC1B3xC,EAAGO,MAAM7N,MAAQkF,IACjBg6C,EAAS50C,GACT,IAAI4xB,EAAUtJ,GAAah9B,EAASoB,IAChCsT,EAAIsC,MAAQsvB,EAAQpyB,IAAMQ,EAAIsC,KAAOsvB,EAAQryB,OAC7CzmB,WAAWg4C,GAAU9tB,GAAI,WAAiBwyC,GAAWG,GAAYl+D,EAAO2I,MAAS,SAChF,CACL,IAAI4gC,EAAU5gC,EAAE4B,QAAUuzD,EAAW/nE,KAAO,GAAK4S,EAAE4B,QAAUuzD,EAAWhoE,OAAS,GAAK,EAClFyzC,GAAWloC,WAAWg4C,GAAU9tB,GAAI,WAClCwyC,GAAWG,IACfrqD,EAAQiwB,SAASqE,WAAaoB,EAC9BvpC,EAAO2I,OACL,KAqBC3I,CAAO2I,GADyB84C,EAAK94C,MAG1C9Q,EAAKwhD,GAAU9tB,EAAIk2B,GACvBl2B,EAAG4D,MAAM4sC,cAAgBlkE,EACzBkzB,GAAGlX,EAAQgvB,QAAQlV,cAAe,YAAaqwC,GAC/CjzC,GAAGlX,EAAQgvB,QAAQlV,cAAe,UAAW91B,GAzLzCsmE,CAAiB5yC,EAAI/f,EAAO0a,EAAKg2C,GAzDxBkC,CAAe7yC,EAAIrF,EAAKy1C,EAAQhzD,GAClC6jB,GAAS7jB,IAAMkL,EAAQiwB,UAAY3X,GAAiBxjB,GAC1C,GAAV6U,GACL0I,GAAOi+B,GAAgB54B,EAAGtW,IAAKiR,GACnC7kB,YAAW,WAAc,OAAOwS,EAAQwqB,MAAMpgB,UAAY,KACvC,GAAVT,IACLyE,EAAqBsJ,EAAG1X,QAAQwqB,MAAMggC,cAAc11D,GACjDsnC,GAAe1kB,MA8F1B,SAAS0xC,GAAa1xC,EAAIrF,EAAKk2C,GAC7B,GAAY,QAARA,EAAkB,OAAO,IAAIrd,GAAM74B,EAAKA,GAC5C,GAAY,QAARk2C,EAAkB,OAAO7wC,EAAG+yC,WAAWp4C,GAC3C,GAAY,QAARk2C,EAAkB,OAAO,IAAIrd,GAAM7tB,GAAIhL,EAAI2E,KAAM,GAAI4G,GAAQlG,EAAGtW,IAAKic,GAAIhL,EAAI2E,KAAO,EAAG,KAC3F,IAAI9mB,EAASq4D,EAAK7wC,EAAIrF,GACtB,OAAO,IAAI64B,GAAMh7C,EAAO+jB,KAAM/jB,EAAOgkB,IAgLvC,SAASw2C,GAAYhzC,EAAI5iB,EAAG8E,EAAM+wD,GAChC,IAAIC,EAAIC,EACR,GAAI/1D,EAAE6I,QACJitD,EAAK91D,EAAE6I,QAAQ,GAAGlH,QAClBo0D,EAAK/1D,EAAE6I,QAAQ,GAAGjH,aAElB,IAAMk0D,EAAK91D,EAAE2B,QAASo0D,EAAK/1D,EAAE4B,QAC7B,MAAM5B,GAAK,OAAO,EAEpB,GAAI81D,GAAMhzE,KAAK4P,MAAMkwB,EAAG1X,QAAQ+uB,QAAQtxB,wBAAwBzb,OAAU,OAAO,EAC7E2oE,GAAWryC,GAAiBxjB,GAEhC,IAAIkL,EAAU0X,EAAG1X,QACb8qD,EAAU9qD,EAAQ68B,QAAQp/B,wBAE9B,GAAIotD,EAAKC,EAAQ7oE,SAAWk2B,GAAWT,EAAI9d,GAAS,OAAOie,GAAmB/iB,GAC9E+1D,GAAMC,EAAQ5oE,IAAM8d,EAAQ20B,WAE5B,IAAK,IAAI1tC,EAAI,EAAGA,EAAIywB,EAAG1X,QAAQ4tB,YAAYzmC,SAAUF,EAAG,CACtD,IAAIwE,EAAIuU,EAAQ+uB,QAAQlpB,WAAW5e,GACnC,GAAIwE,GAAKA,EAAEgS,wBAAwBzb,OAAS4oE,EAI1C,OADArzC,GAAOG,EAAI9d,EAAM8d,EAFNmF,GAAanF,EAAGtW,IAAKypD,GACnBnzC,EAAG1X,QAAQ4tB,YAAY3mC,GACFqP,UAAWxB,GACtC+iB,GAAmB/iB,IAKhC,SAAS+yD,GAAcnwC,EAAI5iB,GACzB,OAAO41D,GAAYhzC,EAAI5iB,EAAG,eAAe,GAQ3C,SAAS01D,GAAc9yC,EAAI5iB,GACrBo6B,GAAcxX,EAAG1X,QAASlL,IAKhC,SAA6B4iB,EAAI5iB,GAC/B,QAAKqjB,GAAWT,EAAI,sBACbgzC,GAAYhzC,EAAI5iB,EAAG,qBAAqB,GAPXi2D,CAAoBrzC,EAAI5iB,IACxD2iB,GAAeC,EAAI5iB,EAAG,gBACrBsZ,GAAqBsJ,EAAG1X,QAAQwqB,MAAMggC,cAAc11D,GAQ3D,SAASk2D,GAAatzC,GACpBA,EAAG1X,QAAQgvB,QAAQ14B,UAAYohB,EAAG1X,QAAQgvB,QAAQ14B,UAAUmC,QAAQ,eAAgB,IAClFif,EAAGhd,QAAQuwD,MAAMxyD,QAAQ,aAAc,UACzCm7B,GAAYlc,GAnYdgwC,GAAU57D,UAAUk8D,QAAU,SAAUz2C,EAAMc,EAAK1I,GACjD,OAAOvd,KAAKmlB,KATU,IASiBA,GACf,GAAtB+L,GAAIjL,EAAKjmB,KAAKimB,MAAa1I,GAAUvd,KAAKud,QAoY9C,IAAIuhD,GAAO,CAAC1/D,SAAU,WAAW,MAAO,oBAEpCsB,GAAW,GACXq+D,GAAiB,GA4IrB,SAASC,GAAgB1zC,EAAIxmB,EAAOizB,GAElC,IAAKjzB,KADOizB,GAAOA,GAAO+mC,IACJ,CACpB,IAAIG,EAAQ3zC,EAAG1X,QAAQsrD,cACnBC,EAASr6D,EAAQgmB,GAAKI,GAC1Bi0C,EAAO7zC,EAAG1X,QAAQiwB,SAAU,YAAao7B,EAAM17C,OAC/C47C,EAAO7zC,EAAG1X,QAAQiwB,SAAU,YAAao7B,EAAMG,OAC/CD,EAAO7zC,EAAG1X,QAAQiwB,SAAU,WAAYo7B,EAAMI,MAC9CF,EAAO7zC,EAAG1X,QAAQiwB,SAAU,YAAao7B,EAAMK,OAC/CH,EAAO7zC,EAAG1X,QAAQiwB,SAAU,OAAQo7B,EAAMM,OAI9C,SAASC,GAAgBl0C,GACnBA,EAAGhd,QAAQ42B,cACbn5B,EAASuf,EAAG1X,QAAQgvB,QAAS,mBAC7BtX,EAAG1X,QAAQovB,MAAM95B,MAAM0qC,SAAW,GAClCtoB,EAAG1X,QAAQg6B,WAAa,OAExBxrB,EAAQkJ,EAAG1X,QAAQgvB,QAAS,mBAC5B1H,GAAY5P,IAEd4f,GAAoB5f,GACpBmgB,GAAUngB,GACVkc,GAAYlc,GACZlqB,YAAW,WAAc,OAAO0zC,GAAiBxpB,KAAQ,KAM3D,SAASmjC,GAAWjpB,EAAOl3B,GACzB,IAAI66C,EAASnpD,KAEb,KAAMA,gBAAgByuD,IAAe,OAAO,IAAIA,GAAWjpB,EAAOl3B,GAElEtO,KAAKsO,QAAUA,EAAUA,EAAU4V,EAAQ5V,GAAW,GAEtD4V,EAAQxjB,GAAU4N,GAAS,GAE3B,IAAI0G,EAAM1G,EAAQxJ,MACA,iBAAPkQ,EAAmBA,EAAM,IAAI01C,GAAI11C,EAAK1G,EAAQ6f,KAAM,KAAM7f,EAAQu8C,cAAev8C,EAAQya,WAC3Fza,EAAQ6f,OAAQnZ,EAAI4qC,WAAatxC,EAAQ6f,MAClDnuB,KAAKgV,IAAMA,EAEX,IAAIopB,EAAQ,IAAIqwB,GAAWgR,YAAYnxD,EAAQoxD,YAAY1/D,MACvD4T,EAAU5T,KAAK4T,QAAU,IAAIqpC,GAAQzX,EAAOxwB,EAAKopB,EAAO9vB,GAyC5D,IAAK,IAAII,KAxCTkF,EAAQgvB,QAAQ6rB,WAAazuD,KAC7B4+D,GAAa5+D,MACTsO,EAAQ42B,eACRllC,KAAK4T,QAAQgvB,QAAQ14B,WAAa,oBACtCwrC,GAAe11C,MAEfA,KAAKkvB,MAAQ,CACXsrC,QAAS,GACTvmC,SAAU,GACVL,QAAS,EACTzP,WAAW,EACX8rB,mBAAmB,EACnBV,SAAS,EACT0W,eAAe,EACf0Z,eAAgB,EAAGC,aAAc,EACjC9D,eAAe,EACf/L,cAAc,EACdxW,UAAW,IAAIt0B,EACfq1C,OAAQ,KACR/8B,aAAc,MAGZjvB,EAAQuxD,YAAcp+C,GAAU7N,EAAQwqB,MAAMpgB,QAI9C6C,GAAMC,EAAa,IAAM1f,YAAW,WAAc,OAAO+nD,EAAOv1C,QAAQwqB,MAAMgS,OAAM,KAAU,IAiCpG,SAA+B9kB,GAC7B,IAAIpvB,EAAIovB,EAAG1X,QACXkX,GAAG5uB,EAAE2nC,SAAU,YAAauV,GAAU9tB,EAAIiwC,KAGtCzwC,GAAG5uB,EAAE2nC,SAAU,WADfhjB,GAAMC,EAAa,GACQs4B,GAAU9tB,GAAI,SAAU5iB,GACnD,IAAI2iB,GAAeC,EAAI5iB,GAAvB,CACA,IAAIud,EAAMolB,GAAa/f,EAAI5iB,GAC3B,GAAKud,IAAOw1C,GAAcnwC,EAAI5iB,KAAMo6B,GAAcxX,EAAG1X,QAASlL,GAA9D,CACAwjB,GAAiBxjB,GACjB,IAAIo3D,EAAOx0C,EAAG+yC,WAAWp4C,GACzBi+B,GAAgB54B,EAAGtW,IAAK8qD,EAAKl1B,OAAQk1B,EAAK5qD,WAGf,SAAUxM,GAAK,OAAO2iB,GAAeC,EAAI5iB,IAAMwjB,GAAiBxjB,KAI/FoiB,GAAG5uB,EAAE2nC,SAAU,eAAe,SAAUn7B,GAAK,OAAO01D,GAAc9yC,EAAI5iB,MACtEoiB,GAAG5uB,EAAEkiC,MAAM2hC,WAAY,eAAe,SAAUr3D,GACzCxM,EAAE2nC,SAAShhB,SAASna,EAAE5P,SAAWslE,GAAc9yC,EAAI5iB,MAI1D,IAAIs3D,EAAeC,EAAY,CAACz8C,IAAK,GACrC,SAAS08C,IACHhkE,EAAEmhD,cACJ2iB,EAAgB5+D,YAAW,WAAc,OAAOlF,EAAEmhD,YAAc,OAAS,MACzE4iB,EAAY/jE,EAAEmhD,aACJ75B,KAAO,IAAI+B,MAQzB,SAAS46C,EAAQC,EAAOj3B,GACtB,GAAkB,MAAdA,EAAMxzC,KAAgB,OAAO,EACjC,IAAI8nD,EAAKtU,EAAMxzC,KAAOyqE,EAAMzqE,KAAMgoD,EAAKxU,EAAMrzC,IAAMsqE,EAAMtqE,IACzD,OAAO2nD,EAAKA,EAAKE,EAAKA,EAAK,IAE7B7yB,GAAG5uB,EAAE2nC,SAAU,cAAc,SAAUn7B,GACrC,IAAK2iB,GAAeC,EAAI5iB,KAX1B,SAA+BA,GAC7B,GAAwB,GAApBA,EAAE6I,QAAQxW,OAAe,OAAO,EACpC,IAAIqlE,EAAQ13D,EAAE6I,QAAQ,GACtB,OAAO6uD,EAAMC,SAAW,GAAKD,EAAME,SAAW,EAQfC,CAAsB73D,KAAO+yD,GAAcnwC,EAAI5iB,GAAI,CAChFxM,EAAEkiC,MAAM67B,eACRr4D,aAAao+D,GACb,IAAIrE,GAAO,IAAIp2C,KACfrpB,EAAEmhD,YAAc,CAAC95B,MAAOo4C,EAAKa,OAAO,EACnBpzC,KAAMuyC,EAAMsE,EAAUz8C,KAAO,IAAMy8C,EAAY,MACxC,GAApBv3D,EAAE6I,QAAQxW,SACZmB,EAAEmhD,YAAY1nD,KAAO+S,EAAE6I,QAAQ,GAAGivD,MAClCtkE,EAAEmhD,YAAYvnD,IAAM4S,EAAE6I,QAAQ,GAAGkvD,WAIvC31C,GAAG5uB,EAAE2nC,SAAU,aAAa,WACtB3nC,EAAEmhD,cAAenhD,EAAEmhD,YAAYmf,OAAQ,MAE7C1xC,GAAG5uB,EAAE2nC,SAAU,YAAY,SAAUn7B,GACnC,IAAI03D,EAAQlkE,EAAEmhD,YACd,GAAI+iB,IAAUt9B,GAAc5mC,EAAGwM,IAAoB,MAAd03D,EAAMzqE,OACtCyqE,EAAM5D,OAAS,IAAIj3C,KAAO66C,EAAM78C,MAAQ,IAAK,CAChD,IAAgDpB,EAA5C8D,EAAMqF,EAAGke,WAAWttC,EAAEmhD,YAAa,QAEnCl7B,GADCi+C,EAAMh3C,MAAQ+2C,EAAQC,EAAOA,EAAMh3C,MAC5B,IAAI01B,GAAM74B,EAAKA,IACjBm6C,EAAMh3C,KAAKA,MAAQ+2C,EAAQC,EAAOA,EAAMh3C,KAAKA,MAC3CkC,EAAG+yC,WAAWp4C,GAEd,IAAI64B,GAAM7tB,GAAIhL,EAAI2E,KAAM,GAAI4G,GAAQlG,EAAGtW,IAAKic,GAAIhL,EAAI2E,KAAO,EAAG,KAC1EU,EAAG64B,aAAahiC,EAAMyoB,OAAQzoB,EAAMjN,MACpCoW,EAAGtN,QACHkO,GAAiBxjB,GAEnBw3D,OAEFp1C,GAAG5uB,EAAE2nC,SAAU,cAAeq8B,GAI9Bp1C,GAAG5uB,EAAE2nC,SAAU,UAAU,WACnB3nC,EAAE2nC,SAASG,eACbqO,GAAgB/mB,EAAIpvB,EAAE2nC,SAASqE,WAC/B0K,GAActnB,EAAIpvB,EAAE2nC,SAASkE,YAAY,GACzC5c,GAAOG,EAAI,SAAUA,OAKzBR,GAAG5uB,EAAE2nC,SAAU,cAAc,SAAUn7B,GAAK,OAAOw1C,GAAc5yB,EAAI5iB,MACrEoiB,GAAG5uB,EAAE2nC,SAAU,kBAAkB,SAAUn7B,GAAK,OAAOw1C,GAAc5yB,EAAI5iB,MAGzEoiB,GAAG5uB,EAAE0mC,QAAS,UAAU,WAAc,OAAO1mC,EAAE0mC,QAAQsF,UAAYhsC,EAAE0mC,QAAQmF,WAAa,KAE1F7rC,EAAEgjE,cAAgB,CAChBE,MAAO,SAAU12D,GAAS2iB,GAAeC,EAAI5iB,IAAM4jB,GAAO5jB,IAC1D22D,KAAM,SAAU32D,GAAS2iB,GAAeC,EAAI5iB,KAx4ChD,SAAoB4iB,EAAI5iB,GACtB,IAAIud,EAAMolB,GAAa/f,EAAI5iB,GAC3B,GAAKud,EAAL,CACA,IAAIy6C,EAAO54D,SAAS21B,yBACpB2P,GAAoB9hB,EAAIrF,EAAKy6C,GACxBp1C,EAAG1X,QAAQu8C,aACd7kC,EAAG1X,QAAQu8C,WAAa1tC,EAAI,MAAO,KAAM,6CACzC6I,EAAG1X,QAAQuvB,UAAU3pB,aAAa8R,EAAG1X,QAAQu8C,WAAY7kC,EAAG1X,QAAQ87B,YAEtEltB,EAAqB8I,EAAG1X,QAAQu8C,WAAYuQ,IA+3CQC,CAAWr1C,EAAI5iB,GAAI4jB,GAAO5jB,KAC5E6a,MAAO,SAAU7a,GAAK,OAh6C1B,SAAqB4iB,EAAI5iB,GACvB,GAAImY,KAAQyK,EAAG4D,MAAM6gC,eAAiB,IAAIxqC,KAAOwpC,GAAW,KAAQziC,GAAO5jB,QAC3E,IAAI2iB,GAAeC,EAAI5iB,KAAMo6B,GAAcxX,EAAG1X,QAASlL,KAEvDA,EAAEymD,aAAayR,QAAQ,OAAQt1C,EAAGkC,gBAClC9kB,EAAEymD,aAAa0R,cAAgB,WAI3Bn4D,EAAEymD,aAAa2R,eAAiB1/C,GAAQ,CAC1C,IAAI2/C,EAAMt+C,EAAI,MAAO,KAAM,KAAM,qCACjCs+C,EAAIC,IAAM,6EACN7/C,IACF4/C,EAAIj0D,MAAQi0D,EAAI/zD,OAAS,EACzBse,EAAG1X,QAAQgvB,QAAQ10B,YAAY6yD,GAE/BA,EAAIE,KAAOF,EAAI1zD,WAEjB3E,EAAEymD,aAAa2R,aAAaC,EAAK,EAAG,GAChC5/C,GAAU4/C,EAAI/9C,WAAW9D,YAAY6hD,IA64CZG,CAAY51C,EAAI5iB,IAC7C62D,KAAMnmB,GAAU9tB,EAAI0jC,IACpBsQ,MAAO,SAAU52D,GAAS2iB,GAAeC,EAAI5iB,IAAMumD,GAAgB3jC,KAGrE,IAAI61C,EAAMjlE,EAAEkiC,MAAM2hC,WAClBj1C,GAAGq2C,EAAK,SAAS,SAAUz4D,GAAK,OAAOuyD,GAAQ/6D,KAAKorB,EAAI5iB,MACxDoiB,GAAGq2C,EAAK,UAAW/nB,GAAU9tB,EAAIwvC,KACjChwC,GAAGq2C,EAAK,WAAY/nB,GAAU9tB,EAAI4vC,KAClCpwC,GAAGq2C,EAAK,SAAS,SAAUz4D,GAAK,OAAOqnC,GAAQzkB,EAAI5iB,MACnDoiB,GAAGq2C,EAAK,QAAQ,SAAUz4D,GAAK,OAAO+J,GAAO6Y,EAAI5iB,MA1IjD04D,CAAsBphE,MACtBywD,KAEA5a,GAAe71C,MACfA,KAAK6rB,MAAM6Y,aAAc,EACzB0c,GAAUphD,KAAMgV,GAEX1G,EAAQuxD,YAAcp+C,GAAWzhB,KAAKg7C,WACvC55C,WAAWX,EAAKsvC,GAAS/vC,MAAO,IAEhCyS,GAAOzS,MAEK++D,GAAsBA,GAAe16C,eAAe3V,IAChEqwD,GAAerwD,GAAK1O,KAAMsO,EAAQI,GAAMowD,IAC5CtkB,GAA2Bx6C,MACvBsO,EAAQ+yD,YAAc/yD,EAAQ+yD,WAAWrhE,MAC7C,IAAK,IAAInF,EAAI,EAAGA,EAAIymE,GAAUvmE,SAAUF,EAAKymE,GAAUzmE,GAAGmF,MAC1Du2C,GAAav2C,MAGTghB,GAAU1S,EAAQ42B,cACiC,sBAAnDr4B,iBAAiB+G,EAAQ68B,SAAS8wB,gBAClC3tD,EAAQ68B,QAAQvnC,MAAMq4D,cAAgB,QAI5C9S,GAAW/tD,SAAWA,GAEtB+tD,GAAWsQ,eAAiBA,GAiH5B,IAAIuC,GAAY,GAQhB,SAAS7H,GAAWnuC,EAAI1G,EAAG48C,EAAKC,GAC9B,IAAkBvyC,EAAdla,EAAMsW,EAAGtW,IACF,MAAPwsD,IAAeA,EAAM,OACd,SAAPA,IAGGxsD,EAAImZ,KAAKuzC,OACPxyC,EAAQuF,GAAiBnJ,EAAI1G,GAAGsK,MADfsyC,EAAM,QAIhC,IAAIh9C,EAAU8G,EAAGhd,QAAQkW,QACrBoG,EAAOgF,GAAQ5a,EAAK4P,GAAI+8C,EAAWr9C,EAAYsG,EAAKhZ,KAAM,KAAM4S,GAChEoG,EAAKgK,aAAchK,EAAKgK,WAAa,MACzC,IAAiDpC,EAA7CovC,EAAiBh3C,EAAKhZ,KAAK7O,MAAM,QAAQ,GAC7C,GAAK0+D,GAAe,KAAK3+D,KAAK8nB,EAAKhZ,OAG5B,GAAW,SAAP4vD,KACThvC,EAAcxd,EAAImZ,KAAKuzC,OAAOxyC,EAAOtE,EAAKhZ,KAAKhS,MAAMgiE,EAAe7mE,QAAS6vB,EAAKhZ,QAC/D6T,GAAQ+M,EAAc,KAAK,CAC5C,IAAKivC,EAAc,OACnBD,EAAM,aANRhvC,EAAc,EACdgvC,EAAM,MAQG,QAAPA,EACmBhvC,EAAjB5N,EAAI5P,EAAI6a,MAAuBvL,EAAYsL,GAAQ5a,EAAK4P,EAAE,GAAGhT,KAAM,KAAM4S,GACxD,EACL,OAAPg9C,EACThvC,EAAcmvC,EAAWr2C,EAAGhd,QAAQuzD,WACpB,YAAPL,EACThvC,EAAcmvC,EAAWr2C,EAAGhd,QAAQuzD,WACb,iBAAPL,IAChBhvC,EAAcmvC,EAAWH,GAE3BhvC,EAAchnC,KAAKoP,IAAI,EAAG43B,GAE1B,IAAIsvC,EAAe,GAAI77C,EAAM,EAC7B,GAAIqF,EAAGhd,QAAQyzD,eACX,IAAK,IAAIlnE,EAAIrP,KAAK4P,MAAMo3B,EAAchO,GAAU3pB,IAAKA,EAAIorB,GAAOzB,EAASs9C,GAAgB,KAG7F,GAFI77C,EAAMuM,IAAesvC,GAAgBz7C,EAASmM,EAAcvM,IAE5D67C,GAAgBF,EAGlB,OAFAla,GAAa1yC,EAAK8sD,EAAc7wC,GAAIrM,EAAG,GAAIqM,GAAIrM,EAAGg9C,EAAe7mE,QAAS,UAC1E6vB,EAAKgK,WAAa,MACX,EAIP,IAAK,IAAIzL,EAAM,EAAGA,EAAMnU,EAAI+3B,IAAIC,OAAOjyC,OAAQouB,IAAO,CACpD,IAAIhH,EAAQnN,EAAI+3B,IAAIC,OAAO7jB,GAC3B,GAAIhH,EAAMjN,KAAK0V,MAAQhG,GAAKzC,EAAMjN,KAAK4R,GAAK86C,EAAe7mE,OAAQ,CACjE,IAAIinE,EAAQ/wC,GAAIrM,EAAGg9C,EAAe7mE,QAClCupD,GAAoBtvC,EAAKmU,EAAK,IAAI21B,GAAMkjB,EAAOA,IAC/C,QA5DRvT,GAAWwT,eAAiB,SAAU1rE,GAAK,OAAO+qE,GAAUn1D,KAAK5V,IAqEjE,IAAI2rE,GAAa,KAEjB,SAASC,GAAcC,GACrBF,GAAaE,EAGf,SAASC,GAAe/2C,EAAIg3C,EAAUC,EAASx1B,EAAKlnB,GAClD,IAAI7Q,EAAMsW,EAAGtW,IACbsW,EAAG1X,QAAQ08B,OAAQ,EACdvD,IAAOA,EAAM/3B,EAAI+3B,KAEtB,IAAIy1B,GAAU,IAAIj9C,KAAO,IACrBk9C,EAAkB,SAAV58C,GAAqByF,EAAG4D,MAAMywC,cAAgB6C,EACtDE,EAAYt1C,GAAek1C,GAAWK,EAAa,KAEvD,GAAIF,GAAS11B,EAAIC,OAAOjyC,OAAS,EAC/B,GAAImnE,IAAcA,GAAWtwD,KAAKxF,KAAK,OAASk2D,GAC9C,GAAIv1B,EAAIC,OAAOjyC,OAASmnE,GAAWtwD,KAAK7W,QAAU,EAAG,CACnD4nE,EAAa,GACb,IAAK,IAAI9nE,EAAI,EAAGA,EAAIqnE,GAAWtwD,KAAK7W,OAAQF,IACxC8nE,EAAWx2D,KAAK6I,EAAI4yC,WAAWsa,GAAWtwD,KAAK/W,WAE5C6nE,EAAU3nE,QAAUgyC,EAAIC,OAAOjyC,QAAUuwB,EAAGhd,QAAQs0D,yBAC7DD,EAAan0D,EAAIk0D,GAAW,SAAU7jE,GAAK,MAAO,CAACA,OAMvD,IAFA,IAAIk3C,EAAczqB,EAAGO,MAAMkqB,YAElB5sB,EAAM4jB,EAAIC,OAAOjyC,OAAS,EAAGouB,GAAO,EAAGA,IAAO,CACrD,IAAIhH,EAAQ4qB,EAAIC,OAAO7jB,GACnBtB,EAAO1F,EAAM0F,OAAQC,EAAK3F,EAAM2F,KAChC3F,EAAM+qB,UACJq1B,GAAWA,EAAU,EACrB16C,EAAOoJ,GAAIpJ,EAAK+C,KAAM/C,EAAKf,GAAKy7C,GAC3Bj3C,EAAG4D,MAAM/K,YAAcs+C,EAC5B36C,EAAKmJ,GAAInJ,EAAG8C,KAAMp/B,KAAK6P,IAAIu0B,GAAQ5a,EAAK8S,EAAG8C,MAAMhZ,KAAK7W,OAAQ+sB,EAAGhB,GAAKR,EAAIo8C,GAAW3nE,SAChF0nE,GAASP,IAAcA,GAAWW,UAAYX,GAAWtwD,KAAKxF,KAAK,OAASk2D,IACjFz6C,EAAOC,EAAKmJ,GAAIpJ,EAAK+C,KAAM,KAEjC,IAAIk4C,EAAc,CAACj7C,KAAMA,EAAMC,GAAIA,EAAIlW,KAAM+wD,EAAaA,EAAWx5C,EAAMw5C,EAAW5nE,QAAU2nE,EAC7E78C,OAAQA,IAAW48C,EAAQ,QAAUn3C,EAAG4D,MAAM0wC,YAAc4C,EAAS,MAAQ,WAChGzc,GAAWz6B,EAAGtW,IAAK8tD,GACnBtjC,GAAYlU,EAAI,YAAaA,EAAIw3C,GAE/BR,IAAaG,GACbM,GAAgBz3C,EAAIg3C,GAExBzwB,GAAoBvmB,GAChBA,EAAGO,MAAMkqB,YAAc,IAAKzqB,EAAGO,MAAMkqB,YAAcA,GACvDzqB,EAAGO,MAAMmqB,QAAS,EAClB1qB,EAAG4D,MAAMywC,cAAgBr0C,EAAG4D,MAAM0wC,aAAe,EAGnD,SAASoD,GAAYt6D,EAAG4iB,GACtB,IAAI23C,EAASv6D,EAAEw6D,eAAiBx6D,EAAEw6D,cAAcjT,QAAQ,QACxD,GAAIgT,EAIF,OAHAv6D,EAAEwI,iBACGoa,EAAG8jC,cAAiB9jC,EAAGhd,QAAQ60D,cAChChqB,GAAQ7tB,GAAI,WAAc,OAAO+2C,GAAe/2C,EAAI23C,EAAQ,EAAG,KAAM,aAClE,EAIX,SAASF,GAAgBz3C,EAAIg3C,GAE3B,GAAKh3C,EAAGhd,QAAQ80D,eAAkB93C,EAAGhd,QAAQ+0D,YAG7C,IAFA,IAAIt2B,EAAMzhB,EAAGtW,IAAI+3B,IAERlyC,EAAIkyC,EAAIC,OAAOjyC,OAAS,EAAGF,GAAK,EAAGA,IAAK,CAC/C,IAAIsnB,EAAQ4qB,EAAIC,OAAOnyC,GACvB,KAAIsnB,EAAMjN,KAAK4R,GAAK,KAAQjsB,GAAKkyC,EAAIC,OAAOnyC,EAAI,GAAGqa,KAAK0V,MAAQzI,EAAMjN,KAAK0V,MAA3E,CACA,IAAIuD,EAAO7C,EAAGg4C,UAAUnhD,EAAMjN,MAC1BkgB,GAAW,EACf,GAAIjH,EAAKi1C,eACP,IAAK,IAAIx5C,EAAI,EAAGA,EAAIuE,EAAKi1C,cAAcroE,OAAQ6uB,IAC3C,GAAI04C,EAASp2D,QAAQiiB,EAAKi1C,cAAc17C,OAAOkC,KAAO,EAAG,CACzDwL,EAAWqkC,GAAWnuC,EAAInJ,EAAMjN,KAAK0V,KAAM,SAC3C,YAEKuD,EAAKo1C,eACVp1C,EAAKo1C,cAAczgE,KAAK8sB,GAAQtE,EAAGtW,IAAKmN,EAAMjN,KAAK0V,MAAMhZ,KAAKhS,MAAM,EAAGuiB,EAAMjN,KAAK4R,OAClFsO,EAAWqkC,GAAWnuC,EAAInJ,EAAMjN,KAAK0V,KAAM,UAE7CwK,GAAYoK,GAAYlU,EAAI,gBAAiBA,EAAInJ,EAAMjN,KAAK0V,QAIpE,SAAS44C,GAAel4C,GAEtB,IADA,IAAI1Z,EAAO,GAAIo7B,EAAS,GACfnyC,EAAI,EAAGA,EAAIywB,EAAGtW,IAAI+3B,IAAIC,OAAOjyC,OAAQF,IAAK,CACjD,IAAI+vB,EAAOU,EAAGtW,IAAI+3B,IAAIC,OAAOnyC,GAAGqa,KAAK0V,KACjC64C,EAAY,CAAC74B,OAAQ3Z,GAAIrG,EAAM,GAAI1V,KAAM+b,GAAIrG,EAAO,EAAG,IAC3DoiB,EAAO7gC,KAAKs3D,GACZ7xD,EAAKzF,KAAKmf,EAAGw/B,SAAS2Y,EAAU74B,OAAQ64B,EAAUvuD,OAEpD,MAAO,CAACtD,KAAMA,EAAMo7B,OAAQA,GAG9B,SAAS02B,GAAoBC,EAAOC,EAAYC,EAAaC,GAC3DH,EAAM31D,aAAa,cAAe61D,EAAc,GAAK,OACrDF,EAAM31D,aAAa,iBAAkB81D,EAAiB,GAAK,OAC3DH,EAAM31D,aAAa,eAAgB41D,GAGrC,SAASG,KACP,IAAIt2C,EAAKhL,EAAI,WAAY,KAAM,KAAM,wFACjCtkB,EAAMskB,EAAI,MAAO,CAACgL,GAAK,KAAM,kEAUjC,OALIzM,EAAUyM,EAAGvkB,MAAM4D,MAAQ,SACxB2gB,EAAGzf,aAAa,OAAQ,OAE3BuT,IAAOkM,EAAGvkB,MAAMqK,OAAS,mBAC7BmwD,GAAoBj2C,GACbtvB,EAmcT,SAAS6lE,GAAShvD,EAAKiR,EAAKwB,EAAK00C,EAAMrG,GACrC,IAAI3Q,EAASl/B,EACTg+C,EAAUx8C,EACVsT,EAAUnL,GAAQ5a,EAAKiR,EAAI2E,MAC3Bs5C,EAAUpO,GAA6B,OAAjB9gD,EAAI+T,WAAsBtB,EAAMA,EAO1D,SAAS08C,EAASC,GAChB,IAAIpyC,EANAnzB,EAYJ,GAAY,OAJVmzB,EADE8jC,EAlwDR,SAAsBxqC,EAAIV,EAAMrH,EAAOkE,GACrC,IAAI48C,EAAO15C,GAASC,EAAMU,EAAGtW,IAAI+T,WACjC,IAAKs7C,EAAQ,OAAOzO,GAAchrC,EAAMrH,EAAOkE,GAC3ClE,EAAMuD,IAAM8D,EAAKhZ,KAAK7W,QACxBwoB,EAAMuD,GAAK8D,EAAKhZ,KAAK7W,OACrBwoB,EAAM6E,OAAS,UACN7E,EAAMuD,IAAM,IACrBvD,EAAMuD,GAAK,EACXvD,EAAM6E,OAAS,SAEjB,IAAI8gB,EAAUhhB,GAAcm8C,EAAM9gD,EAAMuD,GAAIvD,EAAM6E,QAAS4V,EAAOqmC,EAAKn7B,GACvE,GAAwB,OAApB5d,EAAGtW,IAAI+T,WAAsBiV,EAAKlV,MAAQ,GAAK,IAAMrB,EAAM,EAAIuW,EAAKlW,GAAKvE,EAAMuD,GAAKkX,EAAKnW,KAAOtE,EAAMuD,IAGxG,OAAO8uC,GAAchrC,EAAMrH,EAAOkE,GAGpC,IACIsuC,EADAuO,EAAK,SAAUr+C,EAAKwB,GAAO,OAAOkuC,GAAkB/qC,EAAM3E,aAAegL,GAAMhL,EAAIa,GAAKb,EAAKwB,IAE7F88C,EAAuB,SAAUz9C,GACnC,OAAKwE,EAAGhd,QAAQ42B,cAChB6wB,EAAOA,GAAQzxB,GAAsBhZ,EAAIV,GAClCif,GAAsBve,EAAIV,EAAMmrC,EAAMjvC,IAFN,CAAC8iB,MAAO,EAAGpmB,IAAKoH,EAAKhZ,KAAK7W,SAI/D4uC,EAAoB46B,EAAqC,UAAhBhhD,EAAM6E,OAAqBk8C,EAAG/gD,GAAQ,GAAKA,EAAMuD,IAE9F,GAAwB,OAApBwE,EAAGtW,IAAI+T,WAAoC,GAAdiV,EAAKlV,MAAY,CAChD,IAAI07C,EAAoC,GAAdxmC,EAAKlV,OAAgBrB,EAAM,EACjDX,EAAKw9C,EAAG/gD,EAAOihD,EAAqB,GAAK,GAC7C,GAAU,MAAN19C,IAAgB09C,EAAwE19C,GAAMkX,EAAKlW,IAAMhB,GAAM6iB,EAAkBnmB,IAA5FsD,GAAMkX,EAAKnW,MAAQf,GAAM6iB,EAAkBC,OAAuD,CAEzI,IAAIxhB,EAASo8C,EAAqB,SAAW,QAC7C,OAAO,IAAIvzC,GAAI1N,EAAMqH,KAAM9D,EAAIsB,IAOnC,IAAIq8C,EAAqB,SAAUv7B,EAASzhB,EAAKkiB,GAK/C,IAJA,IAAI+6B,EAAS,SAAU59C,EAAI09C,GAAsB,OAAOA,EACpD,IAAIvzC,GAAI1N,EAAMqH,KAAM05C,EAAGx9C,EAAI,GAAI,UAC/B,IAAImK,GAAI1N,EAAMqH,KAAM9D,EAAI,UAErBoiB,GAAW,GAAKA,EAAUm7B,EAAKtpE,OAAQmuC,GAAWzhB,EAAK,CAC5D,IAAIuW,EAAOqmC,EAAKn7B,GACZs7B,EAAsB/8C,EAAM,IAAqB,GAAduW,EAAKlV,OACxChC,EAAK09C,EAAqB76B,EAAkBC,MAAQ06B,EAAG36B,EAAkBnmB,KAAM,GACnF,GAAIwa,EAAKnW,MAAQf,GAAMA,EAAKkX,EAAKlW,GAAM,OAAO48C,EAAO59C,EAAI09C,GAEzD,GADA19C,EAAK09C,EAAqBxmC,EAAKnW,KAAOy8C,EAAGtmC,EAAKlW,IAAK,GAC/C6hB,EAAkBC,OAAS9iB,GAAMA,EAAK6iB,EAAkBnmB,IAAO,OAAOkhD,EAAO59C,EAAI09C,KAKrFG,EAAMF,EAAmBv7B,EAAUzhB,EAAKA,EAAKkiB,GACjD,GAAIg7B,EAAO,OAAOA,EAGlB,IAAIC,EAASn9C,EAAM,EAAIkiB,EAAkBnmB,IAAM8gD,EAAG36B,EAAkBC,OAAQ,GAC5E,OAAc,MAAVg7B,GAAoBn9C,EAAM,GAAKm9C,GAAUh6C,EAAKhZ,KAAK7W,UACrD4pE,EAAMF,EAAmBh9C,EAAM,EAAI,EAAI48C,EAAKtpE,OAAS,EAAG0sB,EAAK88C,EAAqBK,KAK7E,KAJaD,EAqsDTE,CAAa7vD,EAAIsW,GAAIyP,EAAS9U,EAAKwB,GAEnCmuC,GAAc76B,EAAS9U,EAAKwB,IAEnB,CAChB,GAAK28C,IAbHvlE,EAAIonB,EAAI2E,KAAOs5C,GACXlvD,EAAI6a,OAAShxB,GAAKmW,EAAI6a,MAAQ7a,EAAI8a,OAC1C7J,EAAM,IAAIgL,GAAIpyB,EAAGonB,EAAIa,GAAIb,EAAImC,UACtB2S,EAAUnL,GAAQ5a,EAAKnW,KAaxB,OAAO,EAFPonB,EAAM4vC,GAAUC,EAAU9gD,EAAIsW,GAAIyP,EAAS9U,EAAI2E,KAAMs5C,QAIzDj+C,EAAM+L,EAER,OAAO,EAGT,GAAY,QAARmqC,EACFgI,SACK,GAAY,UAARhI,EACTgI,GAAS,QACJ,GAAY,QAARhI,GAA0B,SAARA,EAG3B,IAFA,IAAI2I,EAAU,KAAMruB,EAAgB,SAAR0lB,EACxBj1C,EAASlS,EAAIsW,IAAMtW,EAAIsW,GAAGy5C,UAAU9+C,EAAK,aACpC4J,GAAQ,IACXpI,EAAM,IAAM08C,GAAUt0C,GADJA,GAAQ,EAAO,CAErC,IAAIvH,EAAMyS,EAAQnpB,KAAK8V,OAAOzB,EAAIa,KAAO,KACrCtZ,EAAOyZ,GAAWqB,EAAKpB,GAAU,IACjCuvB,GAAgB,MAAPnuB,EAAc,KACtBmuB,GAAS,KAAK3zC,KAAKwlB,GAAO,KAC3B,IAEJ,IADImuB,GAAU5mB,GAAUriB,IAAQA,EAAO,KACnCs3D,GAAWA,GAAWt3D,EAAM,CAC1Bia,EAAM,IAAIA,EAAM,EAAG08C,IAAYl+C,EAAImC,OAAS,SAChD,MAIF,GADI5a,IAAQs3D,EAAUt3D,GAClBia,EAAM,IAAM08C,GAAUt0C,GAAU,MAGxC,IAAI/rB,EAASkhD,GAAWhwC,EAAKiR,EAAKk/B,EAAQ8e,GAAS,GAEnD,OADI9yC,GAAeg0B,EAAQrhD,KAAWA,EAAOkhE,SAAU,GAChDlhE,EAMT,SAASmhE,GAAS35C,EAAIrF,EAAKwB,EAAK00C,GAC9B,IAAgCtsE,EAS5BiJ,EATAkc,EAAMsW,EAAGtW,IAAKplB,EAAIq2B,EAAItwB,KAC1B,GAAY,QAARwmE,EAAgB,CAClB,IAAI+I,EAAW15E,KAAK6P,IAAIiwB,EAAG1X,QAAQgvB,QAAQoB,aAAct5B,OAAO6L,aAAezO,SAASggC,gBAAgB9D,cACpGmhC,EAAa35E,KAAKoP,IAAIsqE,EAAW,GAAKv6B,GAAWrf,EAAG1X,SAAU,GAClE/jB,GAAK43B,EAAM,EAAIxB,EAAIpwB,OAASowB,EAAInwB,KAAO2xB,EAAM09C,MAE5B,QAARhJ,IACTtsE,EAAI43B,EAAM,EAAIxB,EAAIpwB,OAAS,EAAIowB,EAAInwB,IAAM,GAG3C,MACEgD,EAAS0wC,GAAWle,EAAI17B,EAAGC,IACfy5C,SAFL,CAGP,GAAI7hB,EAAM,EAAI53B,GAAK,EAAIA,GAAKmlB,EAAIhI,OAAQ,CAAElU,EAAOksE,SAAU,EAAM,MACjEn1E,GAAW,EAAN43B,EAEP,OAAO3uB,EAKT,IAAIssE,GAAuB,SAAS95C,GAClCtrB,KAAKsrB,GAAKA,EACVtrB,KAAKqlE,eAAiBrlE,KAAKslE,iBAAmBtlE,KAAKulE,cAAgBvlE,KAAKwlE,gBAAkB,KAC1FxlE,KAAKylE,QAAU,IAAIxgD,EACnBjlB,KAAK0lE,UAAY,KACjB1lE,KAAK2lE,aAAc,EACnB3lE,KAAK4lE,eAAiB,MAuWxB,SAASC,GAASv6C,EAAIrF,GACpB,IAAIoZ,EAAOkF,GAAgBjZ,EAAIrF,EAAI2E,MACnC,IAAKyU,GAAQA,EAAKH,OAAU,OAAO,KACnC,IAAItU,EAAOgF,GAAQtE,EAAGtW,IAAKiR,EAAI2E,MAC3ByE,EAAO6U,GAAgB7E,EAAMzU,EAAM3E,EAAI2E,MAEvCzC,EAAQwC,GAASC,EAAMU,EAAGtW,IAAI+T,WAAYolB,EAAO,OACjDhmB,IAEFgmB,EADcjmB,GAAcC,EAAOlC,EAAIa,IACtB,EAAI,QAAU,QAEjC,IAAIhjB,EAAS2hC,GAAuBpW,EAAK7gB,IAAKyX,EAAIa,GAAIqnB,GAEtD,OADArqC,EAAOrF,OAA4B,SAAnBqF,EAAOggB,SAAsBhgB,EAAO0f,IAAM1f,EAAOyf,MAC1Dzf,EAST,SAASgiE,GAAO7/C,EAAK8/C,GAAoC,OAAzBA,IAAO9/C,EAAI8/C,KAAM,GAAe9/C,EAuDhE,SAAS+/C,GAAS16C,EAAIzL,EAAMphB,GAC1B,IAAIwnE,EACJ,GAAIpmD,GAAQyL,EAAG1X,QAAQ68B,QAAS,CAE9B,KADAw1B,EAAW36C,EAAG1X,QAAQ68B,QAAQh3B,WAAWhb,IACxB,OAAOqnE,GAAOx6C,EAAGkG,QAAQP,GAAI3F,EAAG1X,QAAQ8hB,OAAS,KAAK,GACvE7V,EAAO,KAAMphB,EAAS,OAEtB,IAAKwnE,EAAWpmD,GAAOomD,EAAWA,EAASjjD,WAAY,CACrD,IAAKijD,GAAYA,GAAY36C,EAAG1X,QAAQ68B,QAAW,OAAO,KAC1D,GAAIw1B,EAASjjD,YAAcijD,EAASjjD,YAAcsI,EAAG1X,QAAQ68B,QAAW,MAG5E,IAAK,IAAI51C,EAAI,EAAGA,EAAIywB,EAAG1X,QAAQyrB,KAAKtkC,OAAQF,IAAK,CAC/C,IAAIihC,EAAWxQ,EAAG1X,QAAQyrB,KAAKxkC,GAC/B,GAAIihC,EAASjc,MAAQomD,EACjB,OAAOC,GAAqBpqC,EAAUjc,EAAMphB,IAIpD,SAASynE,GAAqBpqC,EAAUjc,EAAMphB,GAC5C,IAAImkC,EAAU9G,EAASlqB,KAAKyL,WAAY0oD,GAAM,EAC9C,IAAKlmD,IAASgD,EAAS+f,EAAS/iB,GAAS,OAAOimD,GAAO70C,GAAIV,GAAOuL,EAASlR,MAAO,IAAI,GACtF,GAAI/K,GAAQ+iB,IACVmjC,GAAM,EACNlmD,EAAO+iB,EAAQnpB,WAAWhb,GAC1BA,EAAS,GACJohB,GAAM,CACT,IAAI+K,EAAOkR,EAASM,KAAO9V,EAAIwV,EAASM,MAAQN,EAASlR,KACzD,OAAOk7C,GAAO70C,GAAIV,GAAO3F,GAAOA,EAAKhZ,KAAK7W,QAASgrE,GAIvD,IAAII,EAA4B,GAAjBtmD,EAAKkD,SAAgBlD,EAAO,KAAMumD,EAAUvmD,EAK3D,IAJKsmD,GAAsC,GAA1BtmD,EAAKpG,WAAW1e,QAA2C,GAA5B8kB,EAAKxC,WAAW0F,WAC9DojD,EAAWtmD,EAAKxC,WACZ5e,IAAUA,EAAS0nE,EAASE,UAAUtrE,SAErCqrE,EAAQpjD,YAAc4f,GAAWwjC,EAAUA,EAAQpjD,WAC1D,IAAI8J,EAAUgP,EAAShP,QAAS4P,EAAO5P,EAAQ4P,KAE/C,SAASlD,EAAK2sC,EAAUC,EAAS3nE,GAC/B,IAAK,IAAI5D,GAAK,EAAGA,GAAK6hC,EAAOA,EAAK3hC,OAAS,GAAIF,IAE7C,IADA,IAAI2T,EAAM3T,EAAI,EAAIiyB,EAAQte,IAAMkuB,EAAK7hC,GAC5B+uB,EAAI,EAAGA,EAAIpb,EAAIzT,OAAQ6uB,GAAK,EAAG,CACtC,IAAI08C,EAAU93D,EAAIob,EAAI,GACtB,GAAI08C,GAAWH,GAAYG,GAAWF,EAAS,CAC7C,IAAIx7C,EAAO2F,GAAO11B,EAAI,EAAIihC,EAASlR,KAAOkR,EAASM,KAAKvhC,IACpDisB,EAAKtY,EAAIob,GAAKnrB,EAElB,OADIA,EAAS,GAAK6nE,GAAWH,KAAYr/C,EAAKtY,EAAIob,GAAKnrB,EAAS,EAAI,KAC7DwyB,GAAIrG,EAAM9D,KAKzB,IAAIuB,EAAQmR,EAAK2sC,EAAUC,EAAS3nE,GACpC,GAAI4pB,EAAS,OAAOy9C,GAAOz9C,EAAO09C,GAGlC,IAAK,IAAIzjD,EAAQ8jD,EAAQzqD,YAAavd,EAAO+nE,EAAWA,EAASE,UAAUtrE,OAAS0D,EAAS,EAAG6jB,EAAOA,EAAQA,EAAM3G,YAAa,CAEhI,GADA0M,EAAQmR,EAAKlX,EAAOA,EAAMjF,WAAY,GAElC,OAAOyoD,GAAO70C,GAAI5I,EAAMuC,KAAMvC,EAAMvB,GAAK1oB,GAAO2nE,GAEhD3nE,GAAQkkB,EAAMikD,YAAYxrE,OAEhC,IAAK,IAAIsgB,EAAS+qD,EAAQI,gBAAiBC,EAAShoE,EAAQ4c,EAAQA,EAASA,EAAOmrD,gBAAiB,CAEnG,GADAn+C,EAAQmR,EAAKne,EAAQA,EAAOgC,YAAa,GAErC,OAAOyoD,GAAO70C,GAAI5I,EAAMuC,KAAMvC,EAAMvB,GAAK2/C,GAASV,GAElDU,GAAUprD,EAAOkrD,YAAYxrE,QAvfrCqqE,GAAqB1lE,UAAUkL,KAAO,SAAUgJ,GAC5C,IAAIu1C,EAASnpD,KAEXo+B,EAAQp+B,KAAMsrB,EAAK8S,EAAM9S,GACzBntB,EAAMigC,EAAMjgC,IAAMyV,EAAQ68B,QA4B9B,SAASi2B,EAAUh+D,GACjB,IAAI2iB,GAAeC,EAAI5iB,GAAvB,CACA,GAAI4iB,EAAGyzB,oBACLojB,GAAc,CAACU,UAAU,EAAOjxD,KAAM0Z,EAAGkgC,kBAC3B,OAAV9iD,EAAE8E,MAAiB8d,EAAGmgC,iBAAiB,GAAI,KAAM,WAChD,KAAKngC,EAAGhd,QAAQq4D,gBACrB,OAEA,IAAI35B,EAASw2B,GAAel4C,GAC5B62C,GAAc,CAACU,UAAU,EAAMjxD,KAAMo7B,EAAOp7B,OAC9B,OAAVlJ,EAAE8E,MACJ8d,EAAG8tB,WAAU,WACX9tB,EAAGggC,cAActe,EAAOA,OAAQ,EAAGtnB,GACnC4F,EAAGmgC,iBAAiB,GAAI,KAAM,UAIpC,GAAI/iD,EAAEw6D,cAAe,CACnBx6D,EAAEw6D,cAAc0D,YAChB,IAAIjkD,EAAUu/C,GAAWtwD,KAAKxF,KAAK,MAGnC,GADA1D,EAAEw6D,cAActC,QAAQ,OAAQj+C,GAC5Bja,EAAEw6D,cAAcjT,QAAQ,SAAWttC,EAErC,YADAja,EAAEwI,iBAKN,IAAI21D,EAAS9C,KAAkBt2C,EAAKo5C,EAAOxpD,WAC3CiO,EAAG1X,QAAQuvB,UAAU3pB,aAAaqtD,EAAQv7C,EAAG1X,QAAQuvB,UAAU9lB,YAC/DoQ,EAAG3oB,MAAQo9D,GAAWtwD,KAAKxF,KAAK,MAChC,IAAI06D,EAAWh/D,SAASyF,cACxB0W,EAAYwJ,GACZrsB,YAAW,WACTkqB,EAAG1X,QAAQuvB,UAAUjkB,YAAY2nD,GACjCC,EAAS9oD,QACL8oD,GAAY3oE,GAAOigC,EAAM2oC,yBAC5B,KAhELrD,GAAoBvlE,EAAKmtB,EAAGhd,QAAQs1D,WAAYt4C,EAAGhd,QAAQu1D,YAAav4C,EAAGhd,QAAQw1D,gBAEnFh5C,GAAG3sB,EAAK,SAAS,SAAUuK,GACrB2iB,GAAeC,EAAI5iB,IAAMs6D,GAAYt6D,EAAG4iB,IAExCxK,GAAc,IAAM1f,WAAWg4C,GAAU9tB,GAAI,WAAc,OAAO69B,EAAO6d,mBAAqB,OAGpGl8C,GAAG3sB,EAAK,oBAAoB,SAAUuK,GACpCygD,EAAOuc,UAAY,CAACliC,KAAM96B,EAAE86B,KAAMge,MAAM,MAE1C12B,GAAG3sB,EAAK,qBAAqB,SAAUuK,GAChCygD,EAAOuc,YAAavc,EAAOuc,UAAY,CAACliC,KAAM96B,EAAE86B,KAAMge,MAAM,OAEnE12B,GAAG3sB,EAAK,kBAAkB,SAAUuK,GAC9BygD,EAAOuc,YACLh9D,EAAE86B,MAAQ2lB,EAAOuc,UAAUliC,MAAQ2lB,EAAO8d,kBAC9C9d,EAAOuc,UAAUlkB,MAAO,MAI5B12B,GAAG3sB,EAAK,cAAc,WAAc,OAAOigC,EAAM8oC,yBAEjDp8C,GAAG3sB,EAAK,SAAS,WACVgrD,EAAOuc,WAAavc,EAAO8d,qBA0ClCn8C,GAAG3sB,EAAK,OAAQuoE,GAChB57C,GAAG3sB,EAAK,MAAOuoE,IAGjBtB,GAAqB1lE,UAAUgtC,iBAAmB,WAChD,IAAI5oC,EAAS4oC,GAAiB1sC,KAAKsrB,IAAI,GAEvC,OADAxnB,EAAOka,MAAQlW,SAASyF,eAAiBvN,KAAK7B,IACvC2F,GAGTshE,GAAqB1lE,UAAU+sC,cAAgB,SAAUpd,EAAM0oB,GACxD1oB,GAASrvB,KAAKsrB,GAAG1X,QAAQyrB,KAAKtkC,UAC/Bs0B,EAAKrR,OAAS+5B,IAAa/3C,KAAK+mE,uBACpC/mE,KAAKmnE,uBAAuB93C,KAG9B+1C,GAAqB1lE,UAAU8tB,aAAe,WAC5C,OAAOxtB,KAAKsrB,GAAG1X,QAAQgvB,QAAQlV,cAAcF,gBAG/C43C,GAAqB1lE,UAAUqnE,qBAAuB,WACpD,IAAIh6B,EAAM/sC,KAAKwtB,eAAgBlC,EAAKtrB,KAAKsrB,GAAI6zB,EAAO7zB,EAAGtW,IAAI+3B,IAAIJ,UAC3D9kB,EAAOs3B,EAAKt3B,OAAQC,EAAKq3B,EAAKr3B,KAElC,GAAIwD,EAAG1X,QAAQ8hB,QAAUpK,EAAG1X,QAAQ6hB,UAAY5N,EAAK+C,MAAQU,EAAG1X,QAAQ8hB,QAAU5N,EAAG8C,KAAOU,EAAG1X,QAAQ6hB,SACrGsX,EAAI8O,sBADN,CAKA,IAAIurB,EAAYpB,GAAS16C,EAAIyhB,EAAImO,WAAYnO,EAAIoO,cAC7CksB,EAAWrB,GAAS16C,EAAIyhB,EAAIqO,UAAWrO,EAAIsO,aAC/C,IAAI+rB,GAAcA,EAAUrB,MAAOsB,GAAaA,EAAStB,KACX,GAA1C70C,GAAII,GAAO81C,EAAWC,GAAWx/C,IACO,GAAxCqJ,GAAIG,GAAO+1C,EAAWC,GAAWv/C,GAFrC,CAKA,IAAIuX,EAAO/T,EAAG1X,QAAQyrB,KAClB9b,EAASsE,EAAK+C,MAAQU,EAAG1X,QAAQ6hB,UAAYowC,GAASv6C,EAAIzD,IAC1D,CAAChI,KAAMwf,EAAK,GAAGvS,QAAQte,IAAI,GAAI/P,OAAQ,GACvC+kB,EAAMsE,EAAG8C,KAAOU,EAAG1X,QAAQ8hB,QAAUmwC,GAASv6C,EAAIxD,GACtD,IAAKtE,EAAK,CACR,IAAIsJ,EAAUuS,EAAKA,EAAKtkC,OAAS,GAAG+xB,QAChCte,EAAMse,EAAQ4P,KAAO5P,EAAQ4P,KAAK5P,EAAQ4P,KAAK3hC,OAAS,GAAK+xB,EAAQte,IACzEgV,EAAM,CAAC3D,KAAMrR,EAAIA,EAAIzT,OAAS,GAAI0D,OAAQ+P,EAAIA,EAAIzT,OAAS,GAAKyT,EAAIA,EAAIzT,OAAS,IAGnF,GAAKwoB,GAAUC,EAAf,CAKA,IAA+C8jD,EAA3CvvC,EAAMgV,EAAIw6B,YAAcx6B,EAAIy6B,WAAW,GAC3C,IAAMF,EAAMnlD,EAAMoB,EAAM1D,KAAM0D,EAAM9kB,OAAQ+kB,EAAI/kB,OAAQ+kB,EAAI3D,MAC5D,MAAMnX,IACF4+D,KACG9mD,GAAS8K,EAAG4D,MAAMqgB,SACrBxC,EAAIjpB,SAASP,EAAM1D,KAAM0D,EAAM9kB,QAC1B6oE,EAAIvtC,YACPgT,EAAI8O,kBACJ9O,EAAI+O,SAASwrB,MAGfv6B,EAAI8O,kBACJ9O,EAAI+O,SAASwrB,IAEXvvC,GAAyB,MAAlBgV,EAAImO,WAAsBnO,EAAI+O,SAAS/jB,GACzCvX,GAASxgB,KAAKynE,oBAEzBznE,KAAK0nE,yBArBH36B,EAAI8O,qBAwBRupB,GAAqB1lE,UAAU+nE,iBAAmB,WAC9C,IAAIte,EAASnpD,KAEf4B,aAAa5B,KAAK2lE,aAClB3lE,KAAK2lE,YAAcvkE,YAAW,WAC5B+nD,EAAOwc,aAAc,EACjBxc,EAAOhT,oBACPgT,EAAO79B,GAAG8tB,WAAU,WAAc,OAAO+P,EAAO79B,GAAGO,MAAMsqB,kBAAmB,OAC/E,KAGLivB,GAAqB1lE,UAAUynE,uBAAyB,SAAU93C,GAChE7M,EAAqBxiB,KAAKsrB,GAAG1X,QAAQ87B,UAAWrgB,EAAKwd,SACrDrqB,EAAqBxiB,KAAKsrB,GAAG1X,QAAQooC,aAAc3sB,EAAK1B,YAG1Dy3C,GAAqB1lE,UAAUgoE,kBAAoB,WACjD,IAAI36B,EAAM/sC,KAAKwtB,eACfxtB,KAAKqlE,eAAiBt4B,EAAImO,WAAYl7C,KAAKslE,iBAAmBv4B,EAAIoO,aAClEn7C,KAAKulE,cAAgBx4B,EAAIqO,UAAWp7C,KAAKwlE,gBAAkBz4B,EAAIsO,aAGjE+pB,GAAqB1lE,UAAUioE,kBAAoB,WACjD,IAAI56B,EAAM/sC,KAAKwtB,eACf,IAAKuf,EAAIw6B,WAAc,OAAO,EAC9B,IAAI1nD,EAAOktB,EAAIy6B,WAAW,GAAGI,wBAC7B,OAAO/kD,EAAS7iB,KAAK7B,IAAK0hB,IAG5BulD,GAAqB1lE,UAAUse,MAAQ,WACL,YAA5Bhe,KAAKsrB,GAAGhd,QAAQ4hC,WACblwC,KAAK2nE,qBAAuB7/D,SAASyF,eAAiBvN,KAAK7B,KAC5D6B,KAAKysC,cAAczsC,KAAK0sC,oBAAoB,GAChD1sC,KAAK7B,IAAI6f,UAGbonD,GAAqB1lE,UAAUuP,KAAO,WAAcjP,KAAK7B,IAAI8Q,QAC7Dm2D,GAAqB1lE,UAAUqgE,SAAW,WAAc,OAAO//D,KAAK7B,KAEpEinE,GAAqB1lE,UAAU87D,cAAgB,WAAc,OAAO,GAEpE4J,GAAqB1lE,UAAU2wC,cAAgB,WAC7C,IAAIjS,EAAQp+B,KACRA,KAAK2nE,oBACL3nE,KAAK6nE,gBAEL1uB,GAAQn5C,KAAKsrB,IAAI,WAAc,OAAO8S,EAAM9S,GAAGO,MAAMsqB,kBAAmB,KAQ5En2C,KAAKylE,QAAQx4E,IAAI+S,KAAKsrB,GAAGhd,QAAQw5D,cANjC,SAASC,IACH3pC,EAAM9S,GAAG4D,MAAMqgB,UACjBnR,EAAMypC,gBACNzpC,EAAMqnC,QAAQx4E,IAAImxC,EAAM9S,GAAGhd,QAAQw5D,aAAcC,QAMvD3C,GAAqB1lE,UAAUy2C,iBAAmB,WAChD,IAAIpJ,EAAM/sC,KAAKwtB,eACf,OAAOuf,EAAImO,YAAcl7C,KAAKqlE,gBAAkBt4B,EAAIoO,cAAgBn7C,KAAKslE,kBACvEv4B,EAAIqO,WAAap7C,KAAKulE,eAAiBx4B,EAAIsO,aAAer7C,KAAKwlE,iBAGnEJ,GAAqB1lE,UAAUmoE,cAAgB,WAC7C,GAA2B,MAAvB7nE,KAAK4lE,iBAA0B5lE,KAAK2lE,aAAgB3lE,KAAKm2C,mBAA7D,CACA,IAAIpJ,EAAM/sC,KAAKwtB,eAAgBlC,EAAKtrB,KAAKsrB,GAOzC,GAAI9J,GAAWN,GAAUlhB,KAAKsrB,GAAG1X,QAAQ4tB,YAAYzmC,QA8JvD,SAAoB8kB,GAClB,IAAK,IAAImoD,EAAOnoD,EAAMmoD,EAAMA,EAAOA,EAAKhlD,WACpC,GAAI,4BAA4BlgB,KAAKklE,EAAK99D,WAAc,OAAO,EACnE,OAAO,EAjKwD+9D,CAAWl7B,EAAImO,YAI5E,OAHAl7C,KAAKsrB,GAAG48C,iBAAiB,CAAC16D,KAAM,UAAWrC,QAAS,EAAG+F,eAAgB1lB,KAAKoN,MAC5EoH,KAAKiP,YACLjP,KAAKge,QAGP,IAAIhe,KAAK0lE,UAAT,CACA1lE,KAAK0nE,oBACL,IAAI98B,EAASo7B,GAAS16C,EAAIyhB,EAAImO,WAAYnO,EAAIoO,cAC1CjmC,EAAO8wD,GAAS16C,EAAIyhB,EAAIqO,UAAWrO,EAAIsO,aACvCzQ,GAAU11B,GAAQikC,GAAQ7tB,GAAI,WAChC64B,GAAa74B,EAAGtW,IAAKsqC,GAAgB1U,EAAQ11B,GAAOwQ,IAChDklB,EAAOm7B,KAAO7wD,EAAK6wD,OAAOz6C,EAAGO,MAAMsqB,kBAAmB,SAI9DivB,GAAqB1lE,UAAUyoE,YAAc,WAChB,MAAvBnoE,KAAK4lE,iBACPhkE,aAAa5B,KAAK4lE,gBAClB5lE,KAAK4lE,eAAiB,MAGxB,IAQIwC,EAAWn5B,EAAUo5B,EARrB/8C,EAAKtrB,KAAKsrB,GAAI1X,EAAU0X,EAAG1X,QAASm5B,EAAMzhB,EAAGtW,IAAI+3B,IAAIJ,UACrD9kB,EAAOklB,EAAIllB,OAAQC,EAAKilB,EAAIjlB,KAKhC,GAJe,GAAXD,EAAKf,IAAWe,EAAK+C,KAAOU,EAAG80B,cAC/Bv4B,EAAOoJ,GAAIpJ,EAAK+C,KAAO,EAAGgF,GAAQtE,EAAGtW,IAAK6S,EAAK+C,KAAO,GAAG7vB,SACzD+sB,EAAGhB,IAAM8I,GAAQtE,EAAGtW,IAAK8S,EAAG8C,MAAMhZ,KAAK7W,QAAU+sB,EAAG8C,KAAOU,EAAGoP,aAC9D5S,EAAKmJ,GAAInJ,EAAG8C,KAAO,EAAG,IACtB/C,EAAK+C,KAAOhX,EAAQ6hB,UAAY3N,EAAG8C,KAAOhX,EAAQ8hB,OAAS,EAAK,OAAO,EAGvE7N,EAAK+C,MAAQhX,EAAQ6hB,UAA0D,IAA7C2yC,EAAY5jC,GAAclZ,EAAIzD,EAAK+C,QACvEqkB,EAAW1e,GAAO3c,EAAQyrB,KAAK,GAAGzU,MAClCy9C,EAAWz0D,EAAQyrB,KAAK,GAAGxf,OAE3BovB,EAAW1e,GAAO3c,EAAQyrB,KAAK+oC,GAAWx9C,MAC1Cy9C,EAAWz0D,EAAQyrB,KAAK+oC,EAAY,GAAGvoD,KAAKlE,aAE9C,IACIuzB,EAAQo5B,EADRC,EAAU/jC,GAAclZ,EAAIxD,EAAG8C,MAUnC,GARI29C,GAAW30D,EAAQyrB,KAAKtkC,OAAS,GACnCm0C,EAASt7B,EAAQ8hB,OAAS,EAC1B4yC,EAAS10D,EAAQ68B,QAAQ7T,YAEzBsS,EAAS3e,GAAO3c,EAAQyrB,KAAKkpC,EAAU,GAAG39C,MAAQ,EAClD09C,EAAS10D,EAAQyrB,KAAKkpC,EAAU,GAAG1oD,KAAK2mD,kBAGrC6B,EAAY,OAAO,EAGxB,IAFA,IAAIG,EAAUl9C,EAAGtW,IAAI4yC,WAqHvB,SAAwBt8B,EAAIzD,EAAMC,EAAImnB,EAAUC,GAC9C,IAAIt9B,EAAO,GAAI62D,GAAU,EAAO9d,EAAUr/B,EAAGtW,IAAI61C,gBAAiB6d,GAAiB,EAEnF,SAAS9oD,IACH6oD,IACF72D,GAAQ+4C,EACJ+d,IAAkB92D,GAAQ+4C,GAC9B8d,EAAUC,GAAiB,GAG/B,SAASC,EAAQ5vE,GACXA,IACF6mB,IACAhO,GAAQ7Y,GAGZ,SAAS6vE,EAAK/oD,GACZ,GAAqB,GAAjBA,EAAKkD,SAAe,CACtB,IAAI8lD,EAAShpD,EAAKkjB,aAAa,WAC/B,GAAI8lC,EAEF,YADAF,EAAQE,GAGV,IAA+C1mD,EAA3C2mD,EAAWjpD,EAAKkjB,aAAa,aACjC,GAAI+lC,EAAU,CACZ,IAAIzgD,EAAQiD,EAAGg/B,UAAUr5B,GAAIge,EAAU,GAAIhe,GAAIie,EAAS,EAAG,IAvBxChqB,GAuB6D4jD,EAvBhD,SAAU7xC,GAAU,OAAOA,EAAO/R,IAAMA,KA0BxE,YAFImD,EAAMttB,SAAWonB,EAAQkG,EAAM,GAAGmR,KAAK,KACvCmvC,EAAQx4C,GAAW7E,EAAGtW,IAAKmN,EAAM0F,KAAM1F,EAAM2F,IAAI1b,KAAKu+C,KAG5D,GAA4C,SAAxC9qC,EAAKkjB,aAAa,mBAAiC,OACvD,IAAIgmC,EAAU,6BAA6BjmE,KAAK+c,EAAKmpD,UACrD,IAAK,QAAQlmE,KAAK+c,EAAKmpD,WAAwC,GAA3BnpD,EAAK0mD,YAAYxrE,OAAe,OAEhEguE,GAAWnpD,IACf,IAAK,IAAI/kB,EAAI,EAAGA,EAAIglB,EAAKpG,WAAW1e,OAAQF,IACxC+tE,EAAK/oD,EAAKpG,WAAW5e,IAErB,aAAaiI,KAAK+c,EAAKmpD,YAAaN,GAAiB,GACrDK,IAAWN,GAAU,QACC,GAAjB5oD,EAAKkD,UACd4lD,EAAQ9oD,EAAKwmD,UAAUh6D,QAAQ,UAAW,IAAIA,QAAQ,UAAW,MAvCrE,IAAyB6Y,EA0CzB,KACE0jD,EAAK/gD,GACDA,GAAQC,GACZD,EAAOA,EAAKlM,YACZ+sD,GAAiB,EAEnB,OAAO92D,EAvKyBq3D,CAAe39C,EAAI+8C,EAAUC,EAAQr5B,EAAUC,IAC3Eg6B,EAAU/4C,GAAW7E,EAAGtW,IAAKic,GAAIge,EAAU,GAAIhe,GAAIie,EAAQtf,GAAQtE,EAAGtW,IAAKk6B,GAAQt9B,KAAK7W,SACrFytE,EAAQztE,OAAS,GAAKmuE,EAAQnuE,OAAS,GAC5C,GAAIurB,EAAIkiD,IAAYliD,EAAI4iD,GAAYV,EAAQjmB,MAAO2mB,EAAQ3mB,MAAOrT,QAC7D,IAAIs5B,EAAQ,IAAMU,EAAQ,GACxB,MAD8BV,EAAQl4B,QAAS44B,EAAQ54B,QAASrB,IAMzE,IAFA,IAAIk6B,EAAW,EAAGC,EAAS,EACvB73B,EAASi3B,EAAQ,GAAIa,EAASH,EAAQ,GAAII,EAAc99E,KAAK6P,IAAIk2C,EAAOx2C,OAAQsuE,EAAOtuE,QACpFouE,EAAWG,GAAe/3B,EAAOhqB,WAAW4hD,IAAaE,EAAO9hD,WAAW4hD,MAC5EA,EAIN,IAHA,IAAII,EAASjjD,EAAIkiD,GAAUgB,EAASljD,EAAI4iD,GACpCO,EAAYj+E,KAAK6P,IAAIkuE,EAAOxuE,QAA4B,GAAlBytE,EAAQztE,OAAcouE,EAAW,GAClDK,EAAOzuE,QAA4B,GAAlBmuE,EAAQnuE,OAAcouE,EAAW,IACpEC,EAASK,GACTF,EAAOhiD,WAAWgiD,EAAOxuE,OAASquE,EAAS,IAAMI,EAAOjiD,WAAWiiD,EAAOzuE,OAASquE,EAAS,MAC7FA,EAEN,GAAsB,GAAlBZ,EAAQztE,QAAiC,GAAlBmuE,EAAQnuE,QAAek0C,GAAYpnB,EAAK+C,KACjE,KAAOu+C,GAAYA,EAAWthD,EAAKf,IAC5ByiD,EAAOhiD,WAAWgiD,EAAOxuE,OAASquE,EAAS,IAAMI,EAAOjiD,WAAWiiD,EAAOzuE,OAASquE,EAAS,IACjGD,IACAC,IAIJZ,EAAQA,EAAQztE,OAAS,GAAKwuE,EAAO3pE,MAAM,EAAG2pE,EAAOxuE,OAASquE,GAAQ/8D,QAAQ,WAAY,IAC1Fm8D,EAAQ,GAAKA,EAAQ,GAAG5oE,MAAMupE,GAAU98D,QAAQ,WAAY,IAE5D,IAAIq9D,EAASz4C,GAAIge,EAAUk6B,GACvBQ,EAAO14C,GAAIie,EAAQg6B,EAAQnuE,OAASurB,EAAI4iD,GAASnuE,OAASquE,EAAS,GACvE,OAAIZ,EAAQztE,OAAS,GAAKytE,EAAQ,IAAMt3C,GAAIw4C,EAAQC,IAClDjiB,GAAap8B,EAAGtW,IAAKwzD,EAASkB,EAAQC,EAAM,WACrC,QAFT,GAMFvE,GAAqB1lE,UAAUu6D,aAAe,WAC5Cj6D,KAAKknE,uBAEP9B,GAAqB1lE,UAAU0wC,MAAQ,WACrCpwC,KAAKknE,uBAEP9B,GAAqB1lE,UAAUwnE,oBAAsB,WAC9ClnE,KAAK0lE,YACV9jE,aAAa5B,KAAK4lE,gBAClB5lE,KAAK0lE,UAAY,KACjB1lE,KAAKgnE,gBACLhnE,KAAK7B,IAAI8Q,OACTjP,KAAK7B,IAAI6f,UAEXonD,GAAqB1lE,UAAUunE,gBAAkB,WAC7C,IAAI9d,EAASnpD,KAEY,MAAvBA,KAAK4lE,iBACT5lE,KAAK4lE,eAAiBxkE,YAAW,WAE/B,GADA+nD,EAAOyc,eAAiB,KACpBzc,EAAOuc,UAAW,CACpB,IAAIvc,EAAOuc,UAAUlkB,KACd,OADsB2H,EAAOuc,UAAY,KAGlDvc,EAAO6d,kBACN,MAGL5B,GAAqB1lE,UAAUsnE,cAAgB,WAC3C,IAAI7d,EAASnpD,MAEXA,KAAKsrB,GAAG8jC,cAAiBpvD,KAAKmoE,eAC9BhvB,GAAQn5C,KAAKsrB,IAAI,WAAc,OAAOmgB,GAAU0d,EAAO79B,QAG7D85C,GAAqB1lE,UAAU4+B,cAAgB,SAAUze,GACvDA,EAAK+pD,gBAAkB,SAGzBxE,GAAqB1lE,UAAUw7D,WAAa,SAAUxyD,GAClC,GAAdA,EAAE0C,UAAiBpL,KAAK0lE,YAC5Bh9D,EAAEwI,iBACGlR,KAAKsrB,GAAG8jC,cACThW,GAAUp5C,KAAKsrB,GAAI+2C,GAAnBjpB,CAAmCp5C,KAAKsrB,GAAIwF,OAAOsjC,aAA2B,MAAd1rD,EAAE0C,SAAmB1C,EAAEyC,QAAUzC,EAAE0C,UAAW,KAGpHg6D,GAAqB1lE,UAAUmqE,gBAAkB,SAAUhhE,GACzD7I,KAAK7B,IAAIyrE,gBAAkB94C,OAAc,YAAPjoB,IAGpCu8D,GAAqB1lE,UAAU0+D,cAAgB,aAC/CgH,GAAqB1lE,UAAUoqE,cAAgB,aAE/C1E,GAAqB1lE,UAAU2+B,uBAAwB,EA2JvD,IAAI0rC,GAAgB,SAASz+C,GAC3BtrB,KAAKsrB,GAAKA,EAEVtrB,KAAKgqE,UAAY,GAKjBhqE,KAAKiqE,aAAc,EAEnBjqE,KAAKylE,QAAU,IAAIxgD,EAEnBjlB,KAAKutB,cAAe,EACpBvtB,KAAK0lE,UAAY,MAGnBqE,GAAcrqE,UAAUkL,KAAO,SAAUgJ,GACrC,IAAIu1C,EAASnpD,KAEXo+B,EAAQp+B,KAAMsrB,EAAKtrB,KAAKsrB,GAC5BtrB,KAAKkqE,YAAYt2D,GACjB,IAAI6Z,EAAKztB,KAAKmqE,SAmBd,SAASC,EAAe1hE,GACtB,IAAI2iB,GAAeC,EAAI5iB,GAAvB,CACA,GAAI4iB,EAAGyzB,oBACLojB,GAAc,CAACU,UAAU,EAAOjxD,KAAM0Z,EAAGkgC,sBACpC,KAAKlgC,EAAGhd,QAAQq4D,gBACrB,OAEA,IAAI35B,EAASw2B,GAAel4C,GAC5B62C,GAAc,CAACU,UAAU,EAAMjxD,KAAMo7B,EAAOp7B,OAC9B,OAAVlJ,EAAE8E,KACJ8d,EAAGggC,cAActe,EAAOA,OAAQ,KAAMtnB,IAEtC0Y,EAAM4rC,UAAY,GAClBv8C,EAAG3oB,MAAQkoC,EAAOp7B,KAAKxF,KAAK,MAC5B6X,EAAYwJ,IAGF,OAAV/kB,EAAE8E,OAAiB8d,EAAG4D,MAAM0wC,aAAe,IAAIr6C,OAlCrD3R,EAAQgvB,QAAQppB,aAAaxZ,KAAK4iC,QAAShvB,EAAQgvB,QAAQvlB,YAGvDkE,IAAOkM,EAAGvkB,MAAM4D,MAAQ,OAE5Bge,GAAG2C,EAAI,SAAS,WACV5M,GAAMC,GAAc,GAAKqoC,EAAO57B,eAAgB47B,EAAO57B,aAAe,MAC1E6Q,EAAM2pC,UAGRj9C,GAAG2C,EAAI,SAAS,SAAU/kB,GACpB2iB,GAAeC,EAAI5iB,IAAMs6D,GAAYt6D,EAAG4iB,KAE5CA,EAAG4D,MAAMywC,eAAiB,IAAIp6C,KAC9B6Y,EAAMisC,eAsBRv/C,GAAG2C,EAAI,MAAO28C,GACdt/C,GAAG2C,EAAI,OAAQ28C,GAEft/C,GAAGlX,EAAQiwB,SAAU,SAAS,SAAUn7B,GACtC,IAAIo6B,GAAclvB,EAASlL,KAAM2iB,GAAeC,EAAI5iB,GAApD,CACA,IAAK+kB,EAAGniB,cAGN,OAFAggB,EAAG4D,MAAMywC,eAAiB,IAAIp6C,UAC9B6Y,EAAMpgB,QAKR,IAAIzS,EAAQ,IAAI++D,MAAM,SACtB/+D,EAAM23D,cAAgBx6D,EAAEw6D,cACxBz1C,EAAGniB,cAAcC,OAInBuf,GAAGlX,EAAQuvB,UAAW,eAAe,SAAUz6B,GACxCo6B,GAAclvB,EAASlL,IAAMwjB,GAAiBxjB,MAGrDoiB,GAAG2C,EAAI,oBAAoB,WACzB,IAAIlK,EAAQ+H,EAAGwmB,UAAU,QACrB1T,EAAMsnC,WAAatnC,EAAMsnC,UAAUvjD,MAAMyyB,QAC7CxW,EAAMsnC,UAAY,CAChBniD,MAAOA,EACPpB,MAAOmJ,EAAGi+B,SAAShmC,EAAO+H,EAAGwmB,UAAU,MAAO,CAAC5nC,UAAW,6BAG9D4gB,GAAG2C,EAAI,kBAAkB,WACnB2Q,EAAMsnC,YACRtnC,EAAM2pC,OACN3pC,EAAMsnC,UAAUvjD,MAAMyyB,QACtBxW,EAAMsnC,UAAY,UAKxBqE,GAAcrqE,UAAUwqE,YAAc,SAAUK,GAE9CvqE,KAAK4iC,QAAUmhC,KAGf/jE,KAAKmqE,SAAWnqE,KAAK4iC,QAAQvlB,YAG/B0sD,GAAcrqE,UAAUgtC,iBAAmB,WAEzC,IAAIphB,EAAKtrB,KAAKsrB,GAAI1X,EAAU0X,EAAG1X,QAASoB,EAAMsW,EAAGtW,IAC7ClR,EAAS4oC,GAAiBphB,GAG9B,GAAIA,EAAGhd,QAAQk8D,oBAAqB,CAClC,IAAIC,EAAU1hC,GAAazd,EAAItW,EAAI+3B,IAAIJ,UAAUz3B,KAAM,OACnDw1D,EAAU92D,EAAQgvB,QAAQvxB,wBAAyBs5D,EAAU/2D,EAAQ68B,QAAQp/B,wBACjFvN,EAAO8mE,MAAQp/E,KAAKoP,IAAI,EAAGpP,KAAK6P,IAAIuY,EAAQgvB,QAAQoB,aAAe,GAC/BymC,EAAQ30E,IAAM60E,EAAQ70E,IAAM40E,EAAQ50E,MACxEgO,EAAO+mE,OAASr/E,KAAKoP,IAAI,EAAGpP,KAAK6P,IAAIuY,EAAQgvB,QAAQC,YAAc,GAC9B4nC,EAAQ90E,KAAOg1E,EAAQh1E,KAAO+0E,EAAQ/0E,OAG7E,OAAOmO,GAGTimE,GAAcrqE,UAAU+sC,cAAgB,SAAUq+B,GAChD,IAAkBl3D,EAAT5T,KAAKsrB,GAAiB1X,QAC/B4O,EAAqB5O,EAAQ87B,UAAWo7B,EAAMj+B,SAC9CrqB,EAAqB5O,EAAQooC,aAAc8uB,EAAMn9C,WAC9B,MAAfm9C,EAAMF,QACR5qE,KAAK4iC,QAAQ15B,MAAMpT,IAAMg1E,EAAMF,MAAQ,KACvC5qE,KAAK4iC,QAAQ15B,MAAMvT,KAAOm1E,EAAMD,OAAS,OAM7Cd,GAAcrqE,UAAU0wC,MAAQ,SAAU4F,GACxC,IAAIh2C,KAAK+qE,qBAAsB/qE,KAAK0lE,UAApC,CACA,IAAIp6C,EAAKtrB,KAAKsrB,GACd,GAAIA,EAAGyzB,oBAAqB,CAC1B/+C,KAAKgqE,UAAY,GACjB,IAAIrnD,EAAU2I,EAAGkC,eACjBxtB,KAAKmqE,SAASrlE,MAAQ6d,EAClB2I,EAAG4D,MAAMqgB,SAAWtrB,EAAYjkB,KAAKmqE,UACrCtpD,GAAMC,GAAc,IAAK9gB,KAAKutB,aAAe5K,QACvCqzB,IACVh2C,KAAKgqE,UAAYhqE,KAAKmqE,SAASrlE,MAAQ,GACnC+b,GAAMC,GAAc,IAAK9gB,KAAKutB,aAAe,SAIrDw8C,GAAcrqE,UAAUqgE,SAAW,WAAc,OAAO//D,KAAKmqE,UAE7DJ,GAAcrqE,UAAU87D,cAAgB,WAAc,OAAO,GAE7DuO,GAAcrqE,UAAUse,MAAQ,WAC9B,GAAgC,YAA5Bhe,KAAKsrB,GAAGhd,QAAQ4hC,YAA4BzuB,GAAUyB,KAAeljB,KAAKmqE,UAC5E,IAAMnqE,KAAKmqE,SAASnsD,QACpB,MAAOtV,MAIXqhE,GAAcrqE,UAAUuP,KAAO,WAAcjP,KAAKmqE,SAASl7D,QAE3D86D,GAAcrqE,UAAUoqE,cAAgB,WACtC9pE,KAAK4iC,QAAQ15B,MAAMpT,IAAMkK,KAAK4iC,QAAQ15B,MAAMvT,KAAO,GAGrDo0E,GAAcrqE,UAAU2wC,cAAgB,WAAcrwC,KAAKgrE,YAI3DjB,GAAcrqE,UAAUsrE,SAAW,WAC/B,IAAI7hB,EAASnpD,KAEXA,KAAKiqE,aACTjqE,KAAKylE,QAAQx4E,IAAI+S,KAAKsrB,GAAGhd,QAAQw5D,cAAc,WAC7C3e,EAAO4e,OACH5e,EAAO79B,GAAG4D,MAAMqgB,SAAW4Z,EAAO6hB,eAO1CjB,GAAcrqE,UAAU2qE,SAAW,WACjC,IAAIY,GAAS,EAAO7sC,EAAQp+B,KAC5Bo+B,EAAM6rC,aAAc,EAMpB7rC,EAAMqnC,QAAQx4E,IAAI,IALlB,SAAS2Q,IACOwgC,EAAM2pC,QACHkD,GACX7sC,EAAM6rC,aAAc,EAAO7rC,EAAM4sC,aADbC,GAAS,EAAM7sC,EAAMqnC,QAAQx4E,IAAI,GAAI2Q,QAYnEmsE,GAAcrqE,UAAUqoE,KAAO,WAC3B,IAAI5e,EAASnpD,KAEXsrB,EAAKtrB,KAAKsrB,GAAI8S,EAAQp+B,KAAKmqE,SAAUH,EAAYhqE,KAAKgqE,UAK1D,GAAIhqE,KAAK+qE,qBAAuBz/C,EAAG4D,MAAMqgB,SACpChiB,GAAa6Q,KAAW4rC,IAAchqE,KAAK0lE,WAC5Cp6C,EAAG8jC,cAAgB9jC,EAAGhd,QAAQ60D,cAAgB73C,EAAG4D,MAAMorC,OACvD,OAAO,EAEX,IAAI1oD,EAAOwsB,EAAMt5B,MAEjB,GAAI8M,GAAQo4D,IAAc1+C,EAAGyzB,oBAAuB,OAAO,EAI3D,GAAIl+B,GAAMC,GAAc,GAAK9gB,KAAKutB,eAAiB3b,GAC/C8P,GAAO,kBAAkB5e,KAAK8O,GAEhC,OADA0Z,EAAG1X,QAAQwqB,MAAMgS,SACV,EAGT,GAAI9kB,EAAGtW,IAAI+3B,KAAOzhB,EAAG1X,QAAQu8B,kBAAmB,CAC9C,IAAItgB,EAAQje,EAAK2V,WAAW,GAE5B,GADa,MAATsI,GAAoBm6C,IAAaA,EAAY,KACpC,MAATn6C,EAAiC,OAAd7vB,KAAKowC,QAAgBpwC,KAAKsrB,GAAG+tC,YAAY,QAIlE,IADA,IAAI6R,EAAO,EAAGrsE,EAAIrT,KAAK6P,IAAI2uE,EAAUjvE,OAAQ6W,EAAK7W,QAC3CmwE,EAAOrsE,GAAKmrE,EAAUziD,WAAW2jD,IAASt5D,EAAK2V,WAAW2jD,MAAWA,EAgB5E,OAdA/xB,GAAQ7tB,GAAI,WACV+2C,GAAe/2C,EAAI1Z,EAAKhS,MAAMsrE,GAAOlB,EAAUjvE,OAASmwE,EACzC,KAAM/hB,EAAOuc,UAAY,WAAa,MAGjD9zD,EAAK7W,OAAS,KAAQ6W,EAAK1F,QAAQ,OAAS,EAAKkyB,EAAMt5B,MAAQqkD,EAAO6gB,UAAY,GAC/E7gB,EAAO6gB,UAAYp4D,EAEtBu3C,EAAOuc,YACTvc,EAAOuc,UAAUvjD,MAAMyyB,QACvBuU,EAAOuc,UAAUvjD,MAAQmJ,EAAGi+B,SAASJ,EAAOuc,UAAUniD,MAAO+H,EAAGwmB,UAAU,MACvC,CAAC5nC,UAAW,8BAG5C,GAGT6/D,GAAcrqE,UAAUu6D,aAAe,WACjCj6D,KAAKiqE,aAAejqE,KAAK+nE,SAAU/nE,KAAKiqE,aAAc,IAG5DF,GAAcrqE,UAAUw7D,WAAa,WAC/Br6C,GAAMC,GAAc,IAAK9gB,KAAKutB,aAAe,MACjDvtB,KAAKqqE,YAGPN,GAAcrqE,UAAU0+D,cAAgB,SAAU11D,GAChD,IAAI01B,EAAQp+B,KAAMsrB,EAAK8S,EAAM9S,GAAI1X,EAAU0X,EAAG1X,QAAS6Z,EAAK2Q,EAAM+rC,SAC9D/rC,EAAM2sC,oBAAsB3sC,EAAM2sC,qBACtC,IAAI9kD,EAAMolB,GAAa/f,EAAI5iB,GAAIiwC,EAAY/kC,EAAQiwB,SAASqE,UAC5D,GAAKjiB,IAAO9E,EAAZ,CAIYmK,EAAGhd,QAAQ68D,8BACmB,GAA7B7/C,EAAGtW,IAAI+3B,IAAIlqB,SAASoD,IAC7BmzB,GAAU9tB,EAAI64B,GAAd/K,CAA4B9tB,EAAGtW,IAAKsqC,GAAgBr5B,GAAMP,GAE9D,IAII0lD,EAJAC,EAAS59C,EAAGvkB,MAAM8K,QAASs3D,EAAgBltC,EAAMwE,QAAQ15B,MAAM8K,QAC/Du3D,EAAantC,EAAMwE,QAAQz1B,aAAakE,wBAwD5C,GAvDA+sB,EAAMwE,QAAQ15B,MAAM8K,QAAU,mBAC9ByZ,EAAGvkB,MAAM8K,QAAU,+DAAiEtL,EAAE4B,QAAUihE,EAAWz1E,IAAM,GAAK,cAAgB4S,EAAE2B,QAAUkhE,EAAW51E,KAAO,GAAK,0CAA4CkrB,EAAK,2BAA6B,eAAiB,oHAEpQG,IAAUoqD,EAAa1gE,OAAO8gE,SAClC53D,EAAQwqB,MAAMpgB,QACVgD,GAAUtW,OAAO+gE,SAAS,KAAML,GACpCx3D,EAAQwqB,MAAMgS,QAET9kB,EAAGyzB,sBAAuBtxB,EAAG3oB,MAAQs5B,EAAM4rC,UAAY,KAC5D5rC,EAAM2sC,mBAAqBW,EAC3B93D,EAAQu8B,kBAAoB7kB,EAAGtW,IAAI+3B,IACnCnrC,aAAagS,EAAQ+3D,oBA2CjB9qD,GAAMC,GAAc,GAAK8qD,IACzB5pD,EAAmB,CACrBsK,GAAO5jB,GACP,IAAImjE,EAAU,WACZ3gD,GAAIxgB,OAAQ,UAAWmhE,GACvBzqE,WAAWsqE,EAAQ,KAErB5gD,GAAGpgB,OAAQ,UAAWmhE,QAEtBzqE,WAAWsqE,EAAQ,IA/CrB,SAASE,IACP,GAAyB,MAArBn+C,EAAG3I,eAAwB,CAC7B,IAAIorC,EAAW5kC,EAAGyzB,oBACd+sB,EAAS,KAAY5b,EAAWziC,EAAG3oB,MAAQ,IAC/C2oB,EAAG3oB,MAAQ,IACX2oB,EAAG3oB,MAAQgnE,EACX1tC,EAAM4rC,UAAY9Z,EAAW,GAAK,IAClCziC,EAAG3I,eAAiB,EAAG2I,EAAG1I,aAAe+mD,EAAO/wE,OAGhD6Y,EAAQu8B,kBAAoB7kB,EAAGtW,IAAI+3B,KAGvC,SAAS2+B,IACP,GAAIttC,EAAM2sC,oBAAsBW,IAChCttC,EAAM2sC,oBAAqB,EAC3B3sC,EAAMwE,QAAQ15B,MAAM8K,QAAUs3D,EAC9B79C,EAAGvkB,MAAM8K,QAAUq3D,EACfxqD,GAAMC,EAAa,GAAKlN,EAAQ++B,WAAWJ,aAAa3+B,EAAQiwB,SAASqE,UAAYyQ,GAGhE,MAArBlrB,EAAG3I,gBAAwB,GACxBjE,GAAOA,GAAMC,EAAa,IAAM8qD,IACrC,IAAI/wE,EAAI,EAAGktE,EAAO,WACZn0D,EAAQu8B,mBAAqB7kB,EAAGtW,IAAI+3B,KAA4B,GAArBtf,EAAG3I,gBAC9C2I,EAAG1I,aAAe,GAAwB,KAAnBqZ,EAAM4rC,UAC/B5wB,GAAU9tB,EAAIq6B,GAAdvM,CAAyB9tB,GAChBzwB,IAAM,GACf+Y,EAAQ+3D,mBAAqBvqE,WAAW2mE,EAAM,MAE9Cn0D,EAAQu8B,kBAAoB,KAC5Bv8B,EAAQwqB,MAAMgS,UAGlBx8B,EAAQ+3D,mBAAqBvqE,WAAW2mE,EAAM,QAiBpDgC,GAAcrqE,UAAUmqE,gBAAkB,SAAUhhE,GAC7CA,GAAO7I,KAAKowC,QACjBpwC,KAAKmqE,SAAS4B,SAAkB,YAAPljE,GAG3BkhE,GAAcrqE,UAAU4+B,cAAgB,aAExCyrC,GAAcrqE,UAAU2+B,uBAAwB,EAv5DhD,SAAuBowB,GACrB,IAAIsQ,EAAiBtQ,EAAWsQ,eAEhC,SAAS7C,EAAOxjD,EAAMszD,EAAO9jB,EAAQ+jB,GACnCxd,EAAW/tD,SAASgY,GAAQszD,EACxB9jB,IAAU6W,EAAermD,GAC3BuzD,EAAY,SAAU3gD,EAAIziB,EAAKkvB,GAAUA,GAAO+mC,IAAQ5W,EAAO58B,EAAIziB,EAAKkvB,IAAWmwB,GAGvFuG,EAAWyd,aAAehQ,EAG1BzN,EAAWqQ,KAAOA,GAIlB5C,EAAO,QAAS,IAAI,SAAU5wC,EAAIziB,GAAO,OAAOyiB,EAAGrd,SAASpF,MAAS,GACrEqzD,EAAO,OAAQ,MAAM,SAAU5wC,EAAIziB,GACjCyiB,EAAGtW,IAAI4qC,WAAa/2C,EACpB82C,GAASr0B,MACR,GAEH4wC,EAAO,aAAc,EAAGvc,IAAU,GAClCuc,EAAO,kBAAkB,GACzBA,EAAO,eAAe,GACtBA,EAAO,UAAW,GAAG,SAAU5wC,GAC7Bu0B,GAAev0B,GACfkc,GAAYlc,GACZmgB,GAAUngB,MACT,GAEH4wC,EAAO,gBAAiB,MAAM,SAAU5wC,EAAIziB,GAE1C,GADAyiB,EAAGtW,IAAI21C,QAAU9hD,EACZA,EAAL,CACA,IAAIsjE,EAAY,GAAI57C,EAASjF,EAAGtW,IAAI6a,MACpCvE,EAAGtW,IAAIob,MAAK,SAAUxF,GACpB,IAAK,IAAI3E,EAAM,IAAK,CAClB,IAAIoC,EAAQuC,EAAKhZ,KAAK1F,QAAQrD,EAAKod,GACnC,IAAc,GAAVoC,EAAe,MACnBpC,EAAMoC,EAAQxf,EAAI9N,OAClBoxE,EAAUhgE,KAAK8kB,GAAIV,EAAQlI,IAE7BkI,OAEF,IAAK,IAAI11B,EAAIsxE,EAAUpxE,OAAS,EAAGF,GAAK,EAAGA,IACvC6sD,GAAap8B,EAAGtW,IAAKnM,EAAKsjE,EAAUtxE,GAAIo2B,GAAIk7C,EAAUtxE,GAAG+vB,KAAMuhD,EAAUtxE,GAAGisB,GAAKje,EAAI9N,aAE3FmhE,EAAO,eAAgB,yFAAyF,SAAU5wC,EAAIziB,EAAKkvB,GACjIzM,EAAG4D,MAAMqO,aAAe,IAAI5wB,OAAO9D,EAAIse,QAAUte,EAAI/F,KAAK,MAAQ,GAAK,OAAQ,KAC3Ei1B,GAAO+mC,IAAQxzC,EAAG8gD,aAExBlQ,EAAO,yBAA0Bp/B,IAA+B,SAAUxR,GAAM,OAAOA,EAAG8gD,aAAc,GACxGlQ,EAAO,iBAAiB,GACxBA,EAAO,aAAcz6C,EAAS,kBAAoB,YAAY,WAC5D,MAAM,IAAIta,MAAM,8DACf,GACH+0D,EAAO,cAAc,GAAO,SAAU5wC,EAAIziB,GAAO,OAAOyiB,EAAG+gD,gBAAgBzI,WAAa/6D,KAAQ,GAChGqzD,EAAO,eAAe,GAAO,SAAU5wC,EAAIziB,GAAO,OAAOyiB,EAAG+gD,gBAAgBxI,YAAch7D,KAAQ,GAClGqzD,EAAO,kBAAkB,GAAO,SAAU5wC,EAAIziB,GAAO,OAAOyiB,EAAG+gD,gBAAgBvI,eAAiBj7D,KAAQ,GACxGqzD,EAAO,mBAAoBt6C,GAC3Bs6C,EAAO,yBAAyB,GAEhCA,EAAO,QAAS,WAAW,SAAU5wC,GACnCszC,GAAatzC,GACb0xB,GAAc1xB,MACb,GACH4wC,EAAO,SAAU,WAAW,SAAU5wC,EAAIziB,EAAKkvB,GAC7C,IAAI/F,EAAO+iC,GAAUlsD,GACjBugB,EAAO2O,GAAO+mC,IAAQ/J,GAAUh9B,GAChC3O,GAAQA,EAAKkjD,QAAUljD,EAAKkjD,OAAOhhD,EAAI0G,GACvCA,EAAKu6C,QAAUv6C,EAAKu6C,OAAOjhD,EAAIlC,GAAQ,SAE7C8yC,EAAO,YAAa,MACpBA,EAAO,iBAAkB,MAEzBA,EAAO,gBAAgB,EAAOsD,IAAiB,GAC/CtD,EAAO,UAAW,IAAI,SAAU5wC,EAAIziB,GAClCyiB,EAAG1X,QAAQ4tB,YAAcmb,GAAW9zC,EAAKyiB,EAAGhd,QAAQ6yB,aACpD6b,GAAc1xB,MACb,GACH4wC,EAAO,eAAe,GAAM,SAAU5wC,EAAIziB,GACxCyiB,EAAG1X,QAAQ+uB,QAAQz5B,MAAMvT,KAAOkT,EAAMiiC,GAAqBxf,EAAG1X,SAAW,KAAO,IAChF0X,EAAG8gD,aACF,GACHlQ,EAAO,8BAA8B,GAAO,SAAU5wC,GAAM,OAAOwpB,GAAiBxpB,MAAQ,GAC5F4wC,EAAO,iBAAkB,UAAU,SAAU5wC,GAC3CoqB,GAAepqB,GACfwpB,GAAiBxpB,GACjBA,EAAG1X,QAAQ++B,WAAWJ,aAAajnB,EAAGtW,IAAIkzB,WAC1C5c,EAAG1X,QAAQ++B,WAAWC,cAActnB,EAAGtW,IAAI+yB,eAC1C,GACHm0B,EAAO,eAAe,GAAO,SAAU5wC,EAAIziB,GACzCyiB,EAAG1X,QAAQ4tB,YAAcmb,GAAWrxB,EAAGhd,QAAQq0B,QAAS95B,GACxDm0C,GAAc1xB,MACb,GACH4wC,EAAO,kBAAmB,EAAGlf,IAAe,GAC5Ckf,EAAO,uBAAuB,SAAUsQ,GAAW,OAAOA,IAAYxvB,IAAe,GACrFkf,EAAO,2BAA2B,EAAO1vB,IAAiB,GAE1D0vB,EAAO,+BAA+B,GACtCA,EAAO,mBAAmB,GAC1BA,EAAO,0BAA0B,GACjCA,EAAO,sBAAsB,GAE7BA,EAAO,YAAY,GAAO,SAAU5wC,EAAIziB,GAC3B,YAAPA,IACF4J,GAAO6Y,GACPA,EAAG1X,QAAQwqB,MAAMnvB,QAEnBqc,EAAG1X,QAAQwqB,MAAMyrC,gBAAgBhhE,MAEnCqzD,EAAO,gBAAgB,GAAO,SAAU5wC,EAAIziB,GAAWA,GAAOyiB,EAAG1X,QAAQwqB,MAAMgS,WAAa,GAC5F8rB,EAAO,YAAY,EAAM8C,IACzB9C,EAAO,qBAAsB,MAE7BA,EAAO,kBAAmB,KAC1BA,EAAO,qBAAsB,GAC7BA,EAAO,eAAgB,EAAG1vB,IAAiB,GAC3C0vB,EAAO,6BAA6B,EAAM1vB,IAAiB,GAC3D0vB,EAAO,WAAY,KACnBA,EAAO,YAAa,KACpBA,EAAO,gBAAgB,EAAMrc,IAAgB,GAC7Cqc,EAAO,gBAAgB,EAAOrc,IAAgB,GAC9Cqc,EAAO,eAAgB,KACvBA,EAAO,YAAa,KAAK,SAAU5wC,EAAIziB,GAAO,OAAOyiB,EAAGtW,IAAI4tC,QAAQlB,UAAY74C,KAChFqzD,EAAO,oBAAqB,MAC5BA,EAAO,iBAAkB,IAAI,SAAU5wC,GAAM,OAAOA,EAAG8gD,aAAc,GACrElQ,EAAO,qBAAsB,IAAOrc,IAAgB,GACpDqc,EAAO,uBAAuB,GAAM,SAAU5wC,EAAIziB,GAC3CA,GAAOyiB,EAAG1X,QAAQwqB,MAAM0rC,mBAG/B5N,EAAO,WAAY,MAAM,SAAU5wC,EAAIziB,GAAO,OAAOyiB,EAAG1X,QAAQwqB,MAAM2hC,WAAWtsB,SAAW5qC,GAAO,MACnGqzD,EAAO,YAAa,MACpBA,EAAO,YAAa,OAAO,SAAU5wC,EAAIziB,GAAO,OAAOyiB,EAAGtW,IAAI65C,aAAahmD,MAAS,GACpFqzD,EAAO,UAAW,MAy3DpBuQ,CAAche,IAx9Cd,SAA0BA,GACxB,IAAIsQ,EAAiBtQ,EAAWsQ,eAE5B2N,EAAUje,EAAWie,QAAU,GAEnCje,EAAW/uD,UAAY,CACrByC,YAAassD,EACbzwC,MAAO,WAAWtT,OAAOsT,QAAShe,KAAK4T,QAAQwqB,MAAMpgB,SAErD2uD,UAAW,SAASzQ,EAAQp3D,GAC1B,IAAIwJ,EAAUtO,KAAKsO,QAASypB,EAAMzpB,EAAQ4tD,GACtC5tD,EAAQ4tD,IAAWp3D,GAAmB,QAAVo3D,IAChC5tD,EAAQ4tD,GAAUp3D,EACdi6D,EAAe16C,eAAe63C,IAC9B9iB,GAAUp5C,KAAM++D,EAAe7C,GAA/B9iB,CAAwCp5C,KAAM8E,EAAOizB,GACzD5M,GAAOnrB,KAAM,eAAgBA,KAAMk8D,KAGrC//B,UAAW,SAAS+/B,GAAS,OAAOl8D,KAAKsO,QAAQ4tD,IACjD0Q,OAAQ,WAAY,OAAO5sE,KAAKgV,KAEhC63D,UAAW,SAASr+D,EAAK3Y,GACvBmK,KAAKkvB,MAAMsrC,QAAQ3kE,EAAS,OAAS,WAAWk/D,GAAUvmD,KAE5Ds+D,aAAc,SAASt+D,GAErB,IADA,IAAIkuB,EAAO18B,KAAKkvB,MAAMsrC,QACb3/D,EAAI,EAAGA,EAAI6hC,EAAK3hC,SAAUF,EAC/B,GAAI6hC,EAAK7hC,IAAM2T,GAAOkuB,EAAK7hC,GAAG6d,MAAQlK,EAEtC,OADAkuB,EAAKjwB,OAAO5R,EAAG,IACR,GAIbkyE,WAAY1zB,IAAS,SAAS/qB,EAAMhgB,GAClC,IAAI6f,EAAOG,EAAK2H,MAAQ3H,EAAOmgC,EAAWlgC,QAAQvuB,KAAKsO,QAASggB,GAChE,GAAIH,EAAKmB,WAAc,MAAM,IAAInoB,MAAM,kCAtzP7C,SAAsBme,EAAOxgB,EAAOkoE,GAElC,IADA,IAAI/mD,EAAM,EAAGgnD,EAAWD,EAAMloE,GACvBmhB,EAAMX,EAAMvqB,QAAUiyE,EAAM1nD,EAAMW,KAASgnD,GAAYhnD,IAC9DX,EAAM7Y,OAAOwZ,EAAK,EAAGnhB,GAozPjBooE,CAAaltE,KAAKkvB,MAAM+E,SACX,CAAC9F,KAAMA,EAAMg/C,SAAU7+C,EAAM6F,OAAQ7lB,GAAWA,EAAQ6lB,OACvD84C,SAAW3+D,GAAWA,EAAQ2+D,UAAa,IAC5C,SAAUj5C,GAAW,OAAOA,EAAQi5C,YACjDjtE,KAAKkvB,MAAM0E,UACX6X,GAAUzrC,SAEZotE,cAAe/zB,IAAS,SAAS/qB,GAE/B,IADA,IAAI2F,EAAWj0B,KAAKkvB,MAAM+E,SACjBp5B,EAAI,EAAGA,EAAIo5B,EAASl5B,SAAUF,EAAG,CACxC,IAAIytB,EAAM2L,EAASp5B,GAAGsyE,SACtB,GAAI7kD,GAAOgG,GAAuB,iBAARA,GAAoBhG,EAAI5P,MAAQ4V,EAIxD,OAHA2F,EAASxnB,OAAO5R,EAAG,GACnBmF,KAAKkvB,MAAM0E,eACX6X,GAAUzrC,UAMhBy5D,WAAYpgB,IAAS,SAASz0B,EAAG6C,EAAKg6C,GAClB,iBAAPh6C,GAAiC,iBAAPA,IAChBA,EAAR,MAAPA,EAAqBznB,KAAKsO,QAAQ+0D,YAAc,QAAU,OACjD57C,EAAM,MAAQ,YAEzBmJ,GAAO5wB,KAAKgV,IAAK4P,IAAM60C,GAAWz5D,KAAM4kB,EAAG6C,EAAKg6C,MAEtD3I,gBAAiBzf,IAAS,SAASmoB,GAEjC,IADA,IAAIx0B,EAAShtC,KAAKgV,IAAI+3B,IAAIC,OAAQxpB,GAAO,EAChC3oB,EAAI,EAAGA,EAAImyC,EAAOjyC,OAAQF,IAAK,CACtC,IAAIsnB,EAAQ6qB,EAAOnyC,GACnB,GAAKsnB,EAAM+qB,QASA/qB,EAAMjN,KAAK0V,KAAOpH,IAC3Bi2C,GAAWz5D,KAAMmiB,EAAMjN,KAAK0V,KAAM42C,GAAK,GACvCh+C,EAAMrB,EAAMjN,KAAK0V,KACb/vB,GAAKmF,KAAKgV,IAAI+3B,IAAIE,WAAa4E,GAAoB7xC,WAZrC,CAClB,IAAI6nB,EAAO1F,EAAM0F,OAAQC,EAAK3F,EAAM2F,KAChCvE,EAAQ/3B,KAAKoP,IAAI4oB,EAAKqE,EAAK+C,MAC/BpH,EAAMh4B,KAAK6P,IAAI2E,KAAK06B,WAAY5S,EAAG8C,MAAQ9C,EAAGhB,GAAK,EAAI,IAAM,EAC7D,IAAK,IAAI8C,EAAIrG,EAAOqG,EAAIpG,IAAOoG,EAC3B6vC,GAAWz5D,KAAM4pB,EAAG43C,GACxB,IAAI6L,EAAYrtE,KAAKgV,IAAI+3B,IAAIC,OACd,GAAXnlB,EAAKf,IAAWkmB,EAAOjyC,QAAUsyE,EAAUtyE,QAAUsyE,EAAUxyE,GAAGgtB,OAAOf,GAAK,GAC9Ew9B,GAAoBtkD,KAAKgV,IAAKna,EAAG,IAAIikD,GAAMj3B,EAAMwlD,EAAUxyE,GAAGitB,MAAOpC,QAW/E4nD,WAAY,SAASrnD,EAAK+O,GACxB,OAAOmB,GAAUn2B,KAAMimB,EAAK+O,IAG9Bu4C,cAAe,SAAS3iD,EAAMoK,GAC5B,OAAOmB,GAAUn2B,KAAMixB,GAAIrG,GAAOoK,GAAS,IAG7Cw4C,eAAgB,SAASvnD,GACvBA,EAAMuL,GAAQxxB,KAAKgV,IAAKiR,GACxB,IAEIzY,EAFA4mB,EAASG,GAAcv0B,KAAM4vB,GAAQ5vB,KAAKgV,IAAKiR,EAAI2E,OACnDvP,EAAS,EAAGiH,GAAS8R,EAAOr5B,OAAS,GAAK,EAAG+rB,EAAKb,EAAIa,GAE1D,GAAU,GAANA,EAAWtZ,EAAO4mB,EAAO,QACtB,OAAS,CACd,IAAIpM,EAAO3M,EAASiH,GAAU,EAC9B,IAAK0F,EAAMoM,EAAa,EAANpM,EAAU,GAAK,IAAMlB,EAAMxE,EAAQ0F,MAChD,MAAIoM,EAAa,EAANpM,EAAU,GAAKlB,GAC1B,CAAEtZ,EAAO4mB,EAAa,EAANpM,EAAU,GAAI,MADE3M,EAAS2M,EAAM,GAGtD,IAAI8jB,EAAMt+B,EAAOA,EAAKtB,QAAQ,aAAe,EAC7C,OAAO4/B,EAAM,EAAIt+B,EAAc,GAAPs+B,EAAW,KAAOt+B,EAAK5N,MAAM,EAAGksC,EAAM,IAGhEw3B,UAAW,SAASr9C,GAClB,IAAIkI,EAAOnuB,KAAKgV,IAAImZ,KACpB,OAAKA,EAAKiB,UACHq/B,EAAWr/B,UAAUjB,EAAMnuB,KAAKstE,WAAWrnD,GAAKiJ,OAAOf,KADhCA,GAIhC42C,UAAW,SAAS9+C,EAAKzY,GACvB,OAAOxN,KAAKytE,WAAWxnD,EAAKzY,GAAM,IAGpCigE,WAAY,SAASxnD,EAAKzY,GACxB,IAAI6a,EAAQ,GACZ,IAAKqkD,EAAQroD,eAAe7W,GAAS,OAAO6a,EAC5C,IAAIqlD,EAAOhB,EAAQl/D,GAAO2gB,EAAOnuB,KAAKsjE,UAAUr9C,GAChD,GAAyB,iBAAdkI,EAAK3gB,GACVkgE,EAAKv/C,EAAK3gB,KAAU6a,EAAMlc,KAAKuhE,EAAKv/C,EAAK3gB,UACxC,GAAI2gB,EAAK3gB,GACd,IAAK,IAAI3S,EAAI,EAAGA,EAAIszB,EAAK3gB,GAAMzS,OAAQF,IAAK,CAC1C,IAAIgO,EAAM6kE,EAAKv/C,EAAK3gB,GAAM3S,IACtBgO,GAAOwf,EAAMlc,KAAKtD,QAEfslB,EAAKS,YAAc8+C,EAAKv/C,EAAKS,YACtCvG,EAAMlc,KAAKuhE,EAAKv/C,EAAKS,aACZ8+C,EAAKv/C,EAAKzV,OACnB2P,EAAMlc,KAAKuhE,EAAKv/C,EAAKzV,OAEvB,IAAK,IAAIyQ,EAAM,EAAGA,EAAMukD,EAAKC,QAAQ5yE,OAAQouB,IAAO,CAClD,IAAIb,EAAMolD,EAAKC,QAAQxkD,GACnBb,EAAIV,KAAKuG,EAAMnuB,QAAqC,GAA5BkM,EAAQmc,EAAOC,EAAIzf,MAC3Cwf,EAAMlc,KAAKmc,EAAIzf,KAErB,OAAOwf,GAGTulD,cAAe,SAAShjD,EAAMoK,GAC5B,IAAIhgB,EAAMhV,KAAKgV,IAEf,OAAOyf,GAAiBz0B,MADxB4qB,EAAO2G,GAASvc,EAAa,MAAR4V,EAAe5V,EAAI6a,MAAQ7a,EAAI8a,KAAO,EAAGlF,IACzB,EAAGoK,GAAS9F,OAGnD6Z,aAAc,SAASxlB,EAAO4K,GAC5B,IAAShM,EAAQniB,KAAKgV,IAAI+3B,IAAIJ,UAI9B,OAAO5D,GAAa/oC,KAHP,MAATujB,EAAuBpB,EAAMjN,KACR,iBAATqO,EAA2BiO,GAAQxxB,KAAKgV,IAAKuO,GAChDA,EAAQpB,EAAM0F,OAAS1F,EAAM2F,KACXqG,GAAQ,SAGzC2a,WAAY,SAAS7iB,EAAKkI,GACxB,OAAO2a,GAAW9oC,KAAMwxB,GAAQxxB,KAAKgV,IAAKiR,GAAMkI,GAAQ,SAG1Dqb,WAAY,SAASb,EAAQxa,GAE3B,OAAOqb,GAAWxpC,MADlB2oC,EAASD,GAAgB1oC,KAAM2oC,EAAQxa,GAAQ,SAChBx4B,KAAMgzC,EAAO7yC,MAG9C26B,aAAc,SAASzjB,EAAQmhB,GAE7B,OADAnhB,EAAS07B,GAAgB1oC,KAAM,CAAClK,IAAKkX,EAAQrX,KAAM,GAAIw4B,GAAQ,QAAQr4B,IAChE26B,GAAazwB,KAAKgV,IAAKhI,EAAShN,KAAK4T,QAAQ20B,aAEtDzN,aAAc,SAASlQ,EAAMuD,EAAMka,GACjC,IAAiBtN,EAAbvX,GAAM,EACV,GAAmB,iBAARoH,EAAkB,CAC3B,IAAI6G,EAAOzxB,KAAKgV,IAAI6a,MAAQ7vB,KAAKgV,IAAI8a,KAAO,EACxClF,EAAO5qB,KAAKgV,IAAI6a,MAASjF,EAAO5qB,KAAKgV,IAAI6a,MACpCjF,EAAO6G,IAAQ7G,EAAO6G,EAAMjO,GAAM,GAC3CuX,EAAUnL,GAAQ5vB,KAAKgV,IAAK4V,QAE5BmQ,EAAUnQ,EAEZ,OAAOwd,GAAgBpoC,KAAM+6B,EAAS,CAACjlC,IAAK,EAAGH,KAAM,GAAIw4B,GAAQ,OAAQka,GAAkB7kB,GAAK1tB,KAC7F0tB,EAAMxjB,KAAKgV,IAAIhI,OAAS8tB,GAAaC,GAAW,IAGrD8yC,kBAAmB,WAAa,OAAOljC,GAAW3qC,KAAK4T,UACvDk6D,iBAAkB,WAAa,OAAOrnC,GAAUzmC,KAAK4T,UAErDm6D,YAAa,WAAa,MAAO,CAAClmD,KAAM7nB,KAAK4T,QAAQ6hB,SAAU3N,GAAI9nB,KAAK4T,QAAQ8hB,SAEhFs4C,UAAW,SAAS/nD,EAAKpG,EAAM8F,EAAQlc,EAAM+pC,GAC3C,IA10JkBloB,EAAIuZ,EACtB8T,EAy0JI/kC,EAAU5T,KAAK4T,QAEf9d,GADJmwB,EAAM8iB,GAAa/oC,KAAMwxB,GAAQxxB,KAAKgV,IAAKiR,KAC7BpwB,OAAQF,EAAOswB,EAAItwB,KAKjC,GAJAkqB,EAAK3W,MAAMU,SAAW,WACtBiW,EAAK7R,aAAa,mBAAoB,QACtChO,KAAK4T,QAAQwqB,MAAME,cAAcze,GACjCjM,EAAQovB,MAAM90B,YAAY2R,GACd,QAARpW,EACF3T,EAAMmwB,EAAInwB,SACL,GAAY,SAAR2T,GAA2B,QAARA,EAAgB,CAC5C,IAAIwkE,EAASziF,KAAKoP,IAAIgZ,EAAQgvB,QAAQoB,aAAchkC,KAAKgV,IAAIhI,QAC7DkhE,EAAS1iF,KAAKoP,IAAIgZ,EAAQovB,MAAMH,YAAajvB,EAAQuvB,UAAUN,cAElD,SAARp5B,GAAmBwc,EAAIpwB,OAASgqB,EAAKC,aAAemuD,IAAWhoD,EAAInwB,IAAM+pB,EAAKC,aAC/EhqB,EAAMmwB,EAAInwB,IAAM+pB,EAAKC,aAChBmG,EAAIpwB,OAASgqB,EAAKC,cAAgBmuD,IACvCn4E,EAAMmwB,EAAIpwB,QACVF,EAAOkqB,EAAKkN,YAAcmhD,IAC1Bv4E,EAAOu4E,EAASruD,EAAKkN,aAE3BlN,EAAK3W,MAAMpT,IAAMA,EAAM,KACvB+pB,EAAK3W,MAAMvT,KAAOkqB,EAAK3W,MAAMtT,MAAQ,GACxB,SAAT49C,GACF79C,EAAOie,EAAQovB,MAAMH,YAAchjB,EAAKkN,YACxClN,EAAK3W,MAAMtT,MAAQ,QAEN,QAAT49C,EAAmB79C,EAAO,EACZ,UAAT69C,IAAqB79C,GAAQie,EAAQovB,MAAMH,YAAchjB,EAAKkN,aAAe,GACtFlN,EAAK3W,MAAMvT,KAAOA,EAAO,MAEvBgwB,IAx2Jc2F,EAy2JCtrB,KAz2JG6kC,EAy2JG,CAAClvC,KAAMA,EAAMG,IAAKA,EAAKF,MAAOD,EAAOkqB,EAAKkN,YAAal3B,OAAQC,EAAM+pB,EAAKC,cAv2J5E,OADvB64B,EAAY1H,GAAmB3lB,EAAIuZ,IACzBqD,WAAqBmK,GAAgB/mB,EAAIqtB,EAAUzQ,WACrC,MAAxByQ,EAAU5Q,YAAsB6K,GAActnB,EAAIqtB,EAAU5Q,cAy2J9DmgC,iBAAkB7uB,GAASyhB,IAC3BqT,kBAAmB90B,GAAS6hB,IAC5BkT,eAAgBnT,GAChBoT,mBAAoBh1B,GAASkiB,IAE7BlC,YAAa,SAAS5E,GACpB,GAAI4B,GAAShyC,eAAeowC,GACxB,OAAO4B,GAAS5B,GAAKv0D,KAAK,KAAMF,OAGtC+iE,gBAAiB1pB,IAAS,SAASznC,GAAQmxD,GAAgB/iE,KAAM4R,MAEjEoyD,SAAU,SAASn8C,EAAMymD,EAAQnS,EAAMrG,GACrC,IAAIruC,EAAM,EACN6mD,EAAS,IAAK7mD,GAAO,EAAG6mD,GAAUA,GAEtC,IADA,IAAIhmD,EAAMkJ,GAAQxxB,KAAKgV,IAAK6S,GACnBhtB,EAAI,EAAGA,EAAIyzE,KAClBhmD,EAAM07C,GAAShkE,KAAKgV,IAAKsT,EAAKb,EAAK00C,EAAMrG,IACjCkP,UAFoBnqE,GAI9B,OAAOytB,GAGTwvC,MAAOze,IAAS,SAAS5xB,EAAK00C,GAC5B,IAAIhT,EAASnpD,KAEbA,KAAKqrD,oBAAmB,SAAUlpC,GAChC,OAAIgnC,EAAOv1C,QAAQ08B,OAAS6Y,EAAOn0C,IAAIjV,QAAUoiB,EAAM+qB,QAC5C82B,GAAS7a,EAAOn0C,IAAKmN,EAAMjN,KAAMuS,EAAK00C,EAAMhT,EAAO76C,QAAQigE,iBAE3D9mD,EAAM,EAAItF,EAAM0F,OAAS1F,EAAM2F,OACzChC,MAGLyyC,QAASlf,IAAS,SAAS5xB,EAAK00C,GAC9B,IAAIpvB,EAAM/sC,KAAKgV,IAAI+3B,IAAK/3B,EAAMhV,KAAKgV,IAC/B+3B,EAAIgS,oBACJ/pC,EAAIy2C,iBAAiB,GAAI,KAAM,WAE/B6J,GAAoBt1D,MAAM,SAAUmiB,GACpC,IAAIgnB,EAAQ66B,GAAShvD,EAAKmN,EAAMjN,KAAMuS,EAAK00C,GAAM,GACjD,OAAO10C,EAAM,EAAI,CAACI,KAAMshB,EAAOrhB,GAAI3F,EAAMjN,MAAQ,CAAC2S,KAAM1F,EAAMjN,KAAM4S,GAAIqhB,SAI9E87B,SAAU,SAASp9C,EAAMymD,EAAQnS,EAAMqS,GACrC,IAAI/mD,EAAM,EAAG73B,EAAI4+E,EACbF,EAAS,IAAK7mD,GAAO,EAAG6mD,GAAUA,GAEtC,IADA,IAAIhmD,EAAMkJ,GAAQxxB,KAAKgV,IAAK6S,GACnBhtB,EAAI,EAAGA,EAAIyzE,IAAUzzE,EAAG,CAC/B,IAAI8tC,EAASI,GAAa/oC,KAAMsoB,EAAK,OAIrC,GAHS,MAAL14B,EAAaA,EAAI+4C,EAAOhzC,KACrBgzC,EAAOhzC,KAAO/F,GACrB04B,EAAM28C,GAASjlE,KAAM2oC,EAAQlhB,EAAK00C,IAC1B6I,QAAW,MAErB,OAAO18C,GAGTmvC,MAAOpe,IAAS,SAAS5xB,EAAK00C,GAC5B,IAAIhT,EAASnpD,KAETgV,EAAMhV,KAAKgV,IAAKy5D,EAAQ,GACxB3qD,GAAY9jB,KAAK4T,QAAQ08B,QAAUt7B,EAAIjV,QAAUiV,EAAI+3B,IAAIgS,oBAY7D,GAXA/pC,EAAIq2C,oBAAmB,SAAUlpC,GAC/B,GAAI2B,EACA,OAAO2D,EAAM,EAAItF,EAAM0F,OAAS1F,EAAM2F,KAC1C,IAAI2iD,EAAU1hC,GAAaogB,EAAQhnC,EAAMjN,KAAM,OACvB,MAApBiN,EAAMqsD,aAAsB/D,EAAQ90E,KAAOwsB,EAAMqsD,YACrDC,EAAMtiE,KAAKs+D,EAAQ90E,MACnB,IAAIswB,EAAMg/C,GAAS9b,EAAQshB,EAAShjD,EAAK00C,GAGzC,MAFY,QAARA,GAAkBh6C,GAASnN,EAAI+3B,IAAIJ,WACnCgF,GAAewX,EAAQrgB,GAAWqgB,EAAQljC,EAAK,OAAOnwB,IAAM20E,EAAQ30E,KACjEmwB,IACNH,GACC2oD,EAAM1zE,OAAU,IAAK,IAAIF,EAAI,EAAGA,EAAIma,EAAI+3B,IAAIC,OAAOjyC,OAAQF,IAC3Dma,EAAI+3B,IAAIC,OAAOnyC,GAAG2zE,WAAaC,EAAM5zE,MAI3CwjE,WAAY,SAASp4C,GACnB,IAAoB2E,EAAOgF,GAAjB5vB,KAAKgV,IAAyBiR,EAAI2E,MAAMhZ,KAC9C2R,EAAQ0C,EAAIa,GAAItD,EAAMyC,EAAIa,GAC9B,GAAI8D,EAAM,CACR,IAAI1D,EAASlnB,KAAK+kE,UAAU9+C,EAAK,aACd,UAAdA,EAAImC,QAAsB5E,GAAOoH,EAAK7vB,SAAWwoB,IAA6BC,IAAlBD,EAMjE,IALA,IAAImrD,EAAY9jD,EAAKlD,OAAOnE,GACxBorD,EAAQ1nD,GAAWynD,EAAWxnD,GAC9B,SAAUJ,GAAM,OAAOG,GAAWH,EAAII,IACtC,KAAKpkB,KAAK4rE,GAAa,SAAU5nD,GAAM,MAAO,KAAKhkB,KAAKgkB,IACxD,SAAUA,GAAM,OAAS,KAAKhkB,KAAKgkB,KAAQG,GAAWH,IACnDvD,EAAQ,GAAKorD,EAAM/jD,EAAKlD,OAAOnE,EAAQ,OAASA,EACvD,KAAOC,EAAMoH,EAAK7vB,QAAU4zE,EAAM/jD,EAAKlD,OAAOlE,OAAWA,EAE3D,OAAO,IAAIs7B,GAAM7tB,GAAIhL,EAAI2E,KAAMrH,GAAQ0N,GAAIhL,EAAI2E,KAAMpH,KAGvDm2C,gBAAiB,SAAS70D,GACX,MAATA,GAAiBA,GAAS9E,KAAKkvB,MAAM/K,aACrCnkB,KAAKkvB,MAAM/K,WAAankB,KAAKkvB,MAAM/K,WACnCpY,EAAS/L,KAAK4T,QAAQ87B,UAAW,wBAEjCttB,EAAQpiB,KAAK4T,QAAQ87B,UAAW,wBAEpCvkB,GAAOnrB,KAAM,kBAAmBA,KAAMA,KAAKkvB,MAAM/K,aAEnD62B,SAAU,WAAa,OAAOh7C,KAAK4T,QAAQwqB,MAAM2hC,YAAc78C,KAC/DksC,WAAY,WAAa,SAAUpvD,KAAKsO,QAAQ4hC,WAAYlwC,KAAKgV,IAAI0wC,WAErE+lB,SAAUpyB,IAAS,SAAUzpD,EAAGC,GAAKqiD,GAAelyC,KAAMpQ,EAAGC,MAC7D++E,cAAe,WACb,IAAI/qC,EAAW7jC,KAAK4T,QAAQiwB,SAC5B,MAAO,CAACluC,KAAMkuC,EAASkE,WAAYjyC,IAAK+tC,EAASqE,UACzCl7B,OAAQ62B,EAAS6O,aAAehP,GAAU1jC,MAAQA,KAAK4T,QAAQqwB,UAC/Dn3B,MAAO+2B,EAASiP,YAAcpP,GAAU1jC,MAAQA,KAAK4T,QAAQkwB,SAC7DE,aAAcD,GAAc/jC,MAAO6iC,YAAae,GAAa5jC,QAGvEs4C,eAAgBe,IAAS,SAASl3B,EAAO6vB,GAC1B,MAAT7vB,GACFA,EAAQ,CAAC0F,KAAM7nB,KAAKgV,IAAI+3B,IAAIJ,UAAUz3B,KAAM4S,GAAI,MAClC,MAAVkqB,IAAkBA,EAAShyC,KAAKsO,QAAQ2jC,qBACnB,iBAAT9vB,EAChBA,EAAQ,CAAC0F,KAAMoJ,GAAI9O,EAAO,GAAI2F,GAAI,MACX,MAAd3F,EAAM0F,OACf1F,EAAQ,CAAC0F,KAAM1F,EAAO2F,GAAI,OAEvB3F,EAAM2F,KAAM3F,EAAM2F,GAAK3F,EAAM0F,MAClC1F,EAAM6vB,OAASA,GAAU,EAEF,MAAnB7vB,EAAM0F,KAAK+C,KAl7JrB,SAAuBU,EAAInJ,GACzByvB,GAAmBtmB,GACnBA,EAAGO,MAAMkmB,YAAc5vB,EAi7JjB0sD,CAAc7uE,KAAMmiB,GAEpBgwB,GAAoBnyC,KAAMmiB,EAAM0F,KAAM1F,EAAM2F,GAAI3F,EAAM6vB,WAI1D2e,QAAStX,IAAS,SAASvsC,EAAOE,GAChC,IAAIm8C,EAASnpD,KAETgE,EAAY,SAAU6E,GAAO,MAAqB,iBAAPA,GAAmB,QAAQ/F,KAAKguB,OAAOjoB,IAAQA,EAAM,KAAOA,GAC9F,MAATiE,IAAiB9M,KAAK4T,QAAQgvB,QAAQ15B,MAAM4D,MAAQ9I,EAAU8I,IACpD,MAAVE,IAAkBhN,KAAK4T,QAAQgvB,QAAQ15B,MAAM8D,OAAShJ,EAAUgJ,IAChEhN,KAAKsO,QAAQ42B,cAAgBoC,GAA0BtnC,MAC3D,IAAIuwB,EAASvwB,KAAK4T,QAAQ6hB,SAC1Bz1B,KAAKgV,IAAIob,KAAKG,EAAQvwB,KAAK4T,QAAQ8hB,QAAQ,SAAU9K,GACnD,GAAIA,EAAKoX,QAAW,IAAK,IAAInnC,EAAI,EAAGA,EAAI+vB,EAAKoX,QAAQjnC,OAAQF,IACzD,GAAI+vB,EAAKoX,QAAQnnC,GAAGwnC,UAAW,CAAE8J,GAAcgd,EAAQ54B,EAAQ,UAAW,QAC5EA,KAEJvwB,KAAK6rB,MAAM6Y,aAAc,EACzBvZ,GAAOnrB,KAAM,UAAWA,SAG1Bo5C,UAAW,SAAS7iD,GAAG,OAAO4iD,GAAQn5C,KAAMzJ,IAC5Cs/C,eAAgB,WAAW,OAAOA,GAAe71C,OACjDu2C,aAAc,WAAW,OAAOA,GAAav2C,OAE7CosE,QAAS/yB,IAAS,WAChB,IAAIoP,EAAYzoD,KAAK4T,QAAQ8zB,iBAC7B+D,GAAUzrC,MACVA,KAAK6rB,MAAM6Y,aAAc,EACzB8C,GAAYxnC,MACZkyC,GAAelyC,KAAMA,KAAKgV,IAAI+yB,WAAY/nC,KAAKgV,IAAIkzB,WACnDiU,GAAkBn8C,KAAK4T,UACN,MAAb60C,GAAqBj9D,KAAKoN,IAAI6vD,EAAY9d,GAAW3qC,KAAK4T,UAAY,KACtEs3B,GAAoBlrC,MACxBmrB,GAAOnrB,KAAM,UAAWA,SAG1B8uE,QAASz1B,IAAS,SAASrkC,GACzB,IAAI+iB,EAAM/3B,KAAKgV,IAUf,OATA+iB,EAAIzM,GAAK,KAELtrB,KAAKkvB,MAAM4sC,eAAiB97D,KAAKkvB,MAAM4sC,gBAC3C1a,GAAUphD,KAAMgV,GAChBwyB,GAAYxnC,MACZA,KAAK4T,QAAQwqB,MAAMgS,QACnB8B,GAAelyC,KAAMgV,EAAI+yB,WAAY/yB,EAAIkzB,WACzCloC,KAAK6rB,MAAM4mB,aAAc,EACzBjT,GAAYx/B,KAAM,UAAWA,KAAM+3B,GAC5BA,KAGTg3C,OAAQ,SAASC,GACf,IAAIC,EAAUjvE,KAAKsO,QAAQ2gE,QAC3B,OAAOA,GAAW5uE,OAAOX,UAAU2kB,eAAenkB,KAAK+uE,EAASD,GAAcC,EAAQD,GAAcA,GAGtG3C,cAAe,WAAW,OAAOrsE,KAAK4T,QAAQwqB,MAAM2hC,YACpDmP,kBAAmB,WAAW,OAAOlvE,KAAK4T,QAAQgvB,SAClDusC,mBAAoB,WAAW,OAAOnvE,KAAK4T,QAAQiwB,UACnDurC,iBAAkB,WAAW,OAAOpvE,KAAK4T,QAAQ+uB,UAEnD3W,GAAWyiC,GAEXA,EAAW4gB,eAAiB,SAAS7hE,EAAMkL,EAAM5T,GAC1C4nE,EAAQroD,eAAe7W,KAASk/D,EAAQl/D,GAAQihD,EAAWjhD,GAAQ,CAACmgE,QAAS,KAClFjB,EAAQl/D,GAAMkL,GAAQ5T,GAExB2pD,EAAW6gB,qBAAuB,SAAS9hE,EAAMkL,EAAM62D,EAAWzqE,GAChE2pD,EAAW4gB,eAAe7hE,EAAMkL,EAAM5T,GACtC4nE,EAAQl/D,GAAMmgE,QAAQxhE,KAAK,CAACyb,KAAM2nD,EAAW1mE,IAAK/D,KA+iCtD0qE,CAAiB/gB,IAGjB,IAAIghB,GAAe,gDAAgDxjE,MAAM,KACzE,IAAK,IAAImY,MAAQsmC,GAAIhrD,UAAiBgrD,GAAIhrD,UAAU2kB,eAAeD,KAASlY,EAAQujE,GAAcrrD,IAAQ,IACtGqqC,GAAW/uD,UAAU0kB,IAAQ,SAAUjI,GACvC,OAAO,WAAY,OAAOA,EAAOrb,MAAMd,KAAKgV,IAAKla,YADpB,CAE5B4vD,GAAIhrD,UAAU0kB,MAkCnB,OAhCA4H,GAAW0+B,IACX+D,GAAWgR,YAAc,CAAC,SAAYsK,GAAe,gBAAmB3E,IAKxE3W,GAAWvgC,WAAa,SAASxV,GAC1B+1C,GAAW/tD,SAASytB,MAAgB,QAARzV,IAAkB+1C,GAAW/tD,SAASytB,KAAOzV,GAC9EwV,GAAWptB,MAAMd,KAAMlF,YAGzB2zD,GAAWihB,WAtyRX,SAAoBC,EAAMrhD,GACxBL,GAAU0hD,GAAQrhD,GAwyRpBmgC,GAAWvgC,WAAW,QAAQ,WAAc,MAAO,CAAE+H,MAAO,SAAUJ,GAAU,OAAOA,EAAOzD,iBAC9Fq8B,GAAWihB,WAAW,aAAc,QAIpCjhB,GAAWmhB,gBAAkB,SAAUl3D,EAAMpX,GAC3CmtD,GAAW/uD,UAAUgZ,GAAQpX,GAE/BmtD,GAAWohB,mBAAqB,SAAUn3D,EAAMpX,GAC9CopD,GAAIhrD,UAAUgZ,GAAQpX,GAGxBmtD,GAAWqhB,aA5IX,SAAsB3F,EAAU77D,GAS9B,IARAA,EAAUA,EAAU4V,EAAQ5V,GAAW,IAC/BxJ,MAAQqlE,EAASrlE,OACpBwJ,EAAQyhE,UAAY5F,EAAS12B,WAC9BnlC,EAAQyhE,SAAW5F,EAAS12B,WAC3BnlC,EAAQ0hE,aAAe7F,EAAS6F,cACjC1hE,EAAQ0hE,YAAc7F,EAAS6F,aAGV,MAArB1hE,EAAQuxD,UAAmB,CAC7B,IAAI7kB,EAAW93B,IACf5U,EAAQuxD,UAAY7kB,GAAYmvB,GACQ,MAAtCA,EAASpnC,aAAa,cAAwBiY,GAAYlzC,SAASoO,KAGvE,SAAS+H,IAAQksD,EAASrlE,MAAQwmB,EAAGljB,WAErC,IAAI6nE,EACJ,GAAI9F,EAAS+F,OACXplD,GAAGq/C,EAAS+F,KAAM,SAAUjyD,IAEvB3P,EAAQ6hE,wBAAwB,CACnC,IAAID,EAAO/F,EAAS+F,KACpBD,EAAaC,EAAKE,OAClB,IACE,IAAIC,EAAgBH,EAAKE,OAAS,WAChCnyD,IACAiyD,EAAKE,OAASH,EACdC,EAAKE,SACLF,EAAKE,OAASC,GAEhB,MAAM3nE,KAIZ4F,EAAQ+yD,WAAa,SAAU/1C,GAC7BA,EAAGrN,KAAOA,EACVqN,EAAGglD,YAAc,WAAc,OAAOnG,GACtC7+C,EAAGilD,WAAa,WACdjlD,EAAGilD,WAAaxuE,MAChBkc,IACAksD,EAASnnD,WAAW9D,YAAYoM,EAAG4jD,qBACnC/E,EAASjhE,MAAM0K,QAAU,GACrBu2D,EAAS+F,OACXhlD,GAAIi/C,EAAS+F,KAAM,SAAUjyD,GACxB3P,EAAQ6hE,wBAAyD,mBAAxBhG,EAAS+F,KAAKE,SACxDjG,EAAS+F,KAAKE,OAASH,MAKjC9F,EAASjhE,MAAM0K,QAAU,OACzB,IAAI0X,EAAKmjC,IAAW,SAAU5uC,GAAQ,OAAOsqD,EAASnnD,WAAWxJ,aAAaqG,EAAMsqD,EAASxuD,eAC3FrN,GACF,OAAOgd,GAGT,SAAwBmjC,GACtBA,EAAWvjC,IAAMA,GACjBujC,EAAW3jC,GAAKA,GAChB2jC,EAAWxQ,iBAAmBA,GAC9BwQ,EAAW/D,IAAMA,GACjB+D,EAAW7G,WAAax6B,GACxBqhC,EAAWnqC,YAAcA,EACzBmqC,EAAW1oC,WAAaA,EACxB0oC,EAAWxnC,WAAaJ,EACxB4nC,EAAWhpC,KAAOA,EAClBgpC,EAAWtjC,OAASA,GACpBsjC,EAAWnzB,KAAOA,GAClBmzB,EAAWlP,UAAYA,GACvBkP,EAAWhZ,eAAiBA,GAC5BgZ,EAAWx9B,IAAMA,GACjBw9B,EAAW+hB,OAASt/C,GACpBu9B,EAAWzgC,MAAQA,GACnBygC,EAAWxgC,UAAYA,GACvBwgC,EAAWpgC,YAAcA,GACzBogC,EAAWlgC,QAAUA,GACrBkgC,EAAW//B,eAAiBA,GAC5B+/B,EAAW1/B,WAAaA,GACxB0/B,EAAWx/B,UAAYA,GACvBw/B,EAAWn/B,WAAaA,GACxBm/B,EAAWr/B,UAAYA,GACvBq/B,EAAW4H,SAAWA,GACtB5H,EAAW4F,OAASA,GACpB5F,EAAW2G,QAAUA,GACrB3G,EAAWwG,cAAgBA,GAC3BxG,EAAWqG,UAAYA,GACvBrG,EAAWkG,gBAAkBA,GAC7BlG,EAAWl/B,aAAeA,GAC1Bk/B,EAAW/E,iBAAmBA,GAC9B+E,EAAWnF,WAAaA,GACxBmF,EAAWxF,WAAaA,GACxBwF,EAAWviC,iBAAmBA,GAC9BuiC,EAAWriC,kBAAoBA,GAC/BqiC,EAAWniC,OAASA,GACpBmiC,EAAW1iD,SAAWA,EACtB0iD,EAAW5rC,SAAWA,EACtB4rC,EAAWrsC,QAAUA,EACrBqsC,EAAWmC,SAAWA,GA4CxB6f,CAAehiB,IAEfA,GAAWiiB,QAAU,SAEdjiB,GAlgTyEkiB","file":"common-fc446a.js","sourcesContent":["let glslang = undefined;\nexport default async function() {\n  if (glslang !== undefined) return glslang;\n  // @ts-ignore\n  const glslangModule = await import(/* webpackIgnore: true */ 'https://unpkg.com/@webgpu/glslang@0.0.15/dist/web-devel/glslang.js');\n  glslang = await glslangModule.default();\n  return glslang;\n}\n","export const cubeVertexSize = 4 * 10; // Byte size of one cube vertex.\nexport const cubePositionOffset = 0;\nexport const cubeColorOffset = 4 * 4; // Byte offset of cube vertex color attribute.\nexport const cubeUVOffset = 4 * 8;\nexport const cubeVertexArray = new Float32Array([\n    // float4 position, float4 color, float2 uv,\n    1, -1, 1, 1,   1, 0, 1, 1,  1, 1,\n    -1, -1, 1, 1,  0, 0, 1, 1,  0, 1,\n    -1, -1, -1, 1, 0, 0, 0, 1,  0, 0,\n    1, -1, -1, 1,  1, 0, 0, 1,  1, 0,\n    1, -1, 1, 1,   1, 0, 1, 1,  1, 1,\n    -1, -1, -1, 1, 0, 0, 0, 1,  0, 0,\n\n    1, 1, 1, 1,    1, 1, 1, 1,  1, 1,\n    1, -1, 1, 1,   1, 0, 1, 1,  0, 1,\n    1, -1, -1, 1,  1, 0, 0, 1,  0, 0,\n    1, 1, -1, 1,   1, 1, 0, 1,  1, 0,\n    1, 1, 1, 1,    1, 1, 1, 1,  1, 1,\n    1, -1, -1, 1,  1, 0, 0, 1,  0, 0,\n\n    -1, 1, 1, 1,   0, 1, 1, 1,  1, 1,\n    1, 1, 1, 1,    1, 1, 1, 1,  0, 1,\n    1, 1, -1, 1,   1, 1, 0, 1,  0, 0,\n    -1, 1, -1, 1,  0, 1, 0, 1,  1, 0,\n    -1, 1, 1, 1,   0, 1, 1, 1,  1, 1,\n    1, 1, -1, 1,   1, 1, 0, 1,  0, 0,\n\n    -1, -1, 1, 1,  0, 0, 1, 1,  1, 1,\n    -1, 1, 1, 1,   0, 1, 1, 1,  0, 1,\n    -1, 1, -1, 1,  0, 1, 0, 1,  0, 0,\n    -1, -1, -1, 1, 0, 0, 0, 1,  1, 0,\n    -1, -1, 1, 1,  0, 0, 1, 1,  1, 1,\n    -1, 1, -1, 1,  0, 1, 0, 1,  0, 0,\n\n    1, 1, 1, 1,    1, 1, 1, 1,  1, 1,\n    -1, 1, 1, 1,   0, 1, 1, 1,  0, 1,\n    -1, -1, 1, 1,  0, 0, 1, 1,  0, 0,\n    -1, -1, 1, 1,  0, 0, 1, 1,  0, 0,\n    1, -1, 1, 1,   1, 0, 1, 1,  1, 0,\n    1, 1, 1, 1,    1, 1, 1, 1,  1, 1,\n\n    1, -1, -1, 1,  1, 0, 0, 1,  1, 1,\n    -1, -1, -1, 1, 0, 0, 0, 1,  0, 1,\n    -1, 1, -1, 1,  0, 1, 0, 1,  0, 0,\n    1, 1, -1, 1,   1, 1, 0, 1,  1, 0,\n    1, -1, -1, 1,  1, 0, 0, 1,  1, 1,\n    -1, 1, -1, 1,  0, 1, 0, 1,  0, 0,\n]);\n","/**\r\n * Common utilities\r\n * @module glMatrix\r\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\r\n * Sets the type of array used when creating new vectors and matrices\r\n *\r\n * @param {Type} type Array type, such as Float32Array or Array\r\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\r\n * Convert Degree To Radian\r\n *\r\n * @param {Number} a Angle in Degrees\r\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\r\n * Tests whether or not the arguments have approximately the same value, within an absolute\r\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\r\n * than or equal to 1.0, and a relative tolerance is used for larger values)\r\n *\r\n * @param {Number} a The first number to test.\r\n * @param {Number} b The second number to test.\r\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};","import * as glMatrix from \"./common.js\";\n/**\r\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\r\n * @module mat4\r\n */\n\n/**\r\n * Creates a new identity mat4\r\n *\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 initialized with values from an existing matrix\r\n *\r\n * @param {mat4} a matrix to clone\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Copy the values from one mat4 to another\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Create a new mat4 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} A new mat4\r\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set the components of a mat4 to the given values\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} out\r\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set a mat4 to the identity matrix\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @returns {mat4} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat4\r\n *\r\n * @param {mat4} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\r\n * Multiplies two mat4s\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\r\n * Translate a mat4 by the given vector\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to translate\r\n * @param {vec3} v vector to translate by\r\n * @returns {mat4} out\r\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\r\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to scale\r\n * @param {vec3} v the vec3 to scale the matrix by\r\n * @returns {mat4} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Rotates a mat4 by the given angle around the given axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {vec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the X axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Y axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Z axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {vec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.scale(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {vec3} v Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle around a given axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotate(dest, dest, rad, axis);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {vec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the X axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateX(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Y axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateY(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Z axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateZ(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation and vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {vec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 from a dual quat.\r\n *\r\n * @param {mat4} out Matrix\r\n * @param {quat2} a Dual Quaternion\r\n * @returns {mat4} mat4 receiving operation result\r\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\r\n * Returns the translation vector component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslation,\r\n *  the returned vector will be the same as the translation vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive translation component\r\n * @param  {mat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\r\n * Returns the scaling factor component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslationScale\r\n *  with a normalized Quaternion paramter, the returned vector will be\r\n *  the same as the scaling vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive scaling factor component\r\n * @param  {mat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\r\n * Returns a quaternion representing the rotational component\r\n *  of a transformation matrix. If a matrix is built with\r\n *  fromRotationTranslation, the returned quaternion will be the\r\n *  same as the quaternion originally supplied.\r\n * @param {quat} out Quaternion to receive the rotation component\r\n * @param {mat4} mat Matrix to be decomposed (input)\r\n * @return {quat} out\r\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {vec3} v Translation vector\r\n * @param {vec3} s Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     mat4.translate(dest, origin);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *     mat4.translate(dest, negativeOrigin);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {vec3} v Translation vector\r\n * @param {vec3} s Scaling vector\r\n * @param {vec3} o The origin vector around which to scale and rotate\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Calculates a 4x4 matrix from the given quaternion\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat4} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a frustum matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Number} left Left bound of the frustum\r\n * @param {Number} right Right bound of the frustum\r\n * @param {Number} bottom Bottom bound of the frustum\r\n * @param {Number} top Top bound of the frustum\r\n * @param {Number} near Near bound of the frustum\r\n * @param {Number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given bounds.\r\n * Passing null/undefined/no value for far will generate infinite projection matrix.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} fovy Vertical field of view in radians\r\n * @param {number} aspect Aspect ratio. typically viewport width/height\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum, can be null or Infinity\r\n * @returns {mat4} out\r\n */\n\nexport function perspective(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given field of view.\r\n * This is primarily useful for generating projection matrices to be used\r\n * with the still experiemental WebVR API.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\r\n * Generates a orthogonal projection matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} left Left bound of the frustum\r\n * @param {number} right Right bound of the frustum\r\n * @param {number} bottom Bottom bound of the frustum\r\n * @param {number} top Top bound of the frustum\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function ortho(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\r\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {vec3} eye Position of the viewer\r\n * @param {vec3} center Point the viewer is looking at\r\n * @param {vec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a matrix that makes something look at something else.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {vec3} eye Position of the viewer\r\n * @param {vec3} center Point the viewer is looking at\r\n * @param {vec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat4\r\n *\r\n * @param {mat4} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat4\r\n *\r\n * @param {mat4} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\r\n * Adds two mat4's\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\r\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat4} out the receiving vector\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {mat4} a The first matrix.\r\n * @param {mat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {mat4} a The first matrix.\r\n * @param {mat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\r\n * Alias for {@link mat4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 3 Dimensional Vector\r\n * @module vec3\r\n */\n\n/**\r\n * Creates a new, empty vec3\r\n *\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec3 initialized with values from an existing vector\r\n *\r\n * @param {vec3} a vector to clone\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Calculates the length of a vec3\r\n *\r\n * @param {vec3} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Creates a new vec3 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Copy the values from one vec3 to another\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the source vector\r\n * @returns {vec3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Set the components of a vec3 to the given values\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} out\r\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Adds two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\r\n * Multiplies two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\r\n * Divides two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to ceil\r\n * @returns {vec3} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to floor\r\n * @returns {vec3} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to round\r\n * @returns {vec3} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\r\n * Scales a vec3 by a scalar number\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec3} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\r\n * Adds two vec3's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec3} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec3's\r\n *\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec3's\r\n *\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Calculates the squared length of a vec3\r\n *\r\n * @param {vec3} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Negates the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to negate\r\n * @returns {vec3} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to invert\r\n * @returns {vec3} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\r\n * Normalize a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to normalize\r\n * @returns {vec3} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec3's\r\n *\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\r\n * Computes the cross product of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\r\n * Performs a hermite interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {vec3} c the third operand\r\n * @param {vec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Performs a bezier interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {vec3} c the third operand\r\n * @param {vec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec3} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat4.\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to transform\r\n * @param {mat4} m matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat3.\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to transform\r\n * @param {mat3} m the 3x3 matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\r\n * Transforms the vec3 with a quat\r\n * Can also be used for dual quaternions. (Multiply it with the real part)\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to transform\r\n * @param {quat} q quaternion to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the x-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {vec3} a The vec3 point to rotate\r\n * @param {vec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the y-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {vec3} a The vec3 point to rotate\r\n * @param {vec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the z-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {vec3} a The vec3 point to rotate\r\n * @param {vec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Get the angle between two 3D vectors\r\n * @param {vec3} a The first operand\r\n * @param {vec3} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\r\n * Set the components of a vec3 to zero\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @returns {vec3} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {vec3} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {vec3} a The first vector.\r\n * @param {vec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {vec3} a The first vector.\r\n * @param {vec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\r\n * Alias for {@link vec3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec3.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec3.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec3.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec3.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec3.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec3s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();","/**\n * dat-gui JavaScript Controller Library\n * http://code.google.com/p/dat-gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\nfunction ___$insertStyle(css) {\n  if (!css) {\n    return;\n  }\n  if (typeof window === 'undefined') {\n    return;\n  }\n\n  var style = document.createElement('style');\n\n  style.setAttribute('type', 'text/css');\n  style.innerHTML = css;\n  document.head.appendChild(style);\n\n  return css;\n}\n\nfunction colorToString (color, forceCSSHex) {\n  var colorFormat = color.__state.conversionName.toString();\n  var r = Math.round(color.r);\n  var g = Math.round(color.g);\n  var b = Math.round(color.b);\n  var a = color.a;\n  var h = Math.round(color.h);\n  var s = color.s.toFixed(1);\n  var v = color.v.toFixed(1);\n  if (forceCSSHex || colorFormat === 'THREE_CHAR_HEX' || colorFormat === 'SIX_CHAR_HEX') {\n    var str = color.hex.toString(16);\n    while (str.length < 6) {\n      str = '0' + str;\n    }\n    return '#' + str;\n  } else if (colorFormat === 'CSS_RGB') {\n    return 'rgb(' + r + ',' + g + ',' + b + ')';\n  } else if (colorFormat === 'CSS_RGBA') {\n    return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';\n  } else if (colorFormat === 'HEX') {\n    return '0x' + color.hex.toString(16);\n  } else if (colorFormat === 'RGB_ARRAY') {\n    return '[' + r + ',' + g + ',' + b + ']';\n  } else if (colorFormat === 'RGBA_ARRAY') {\n    return '[' + r + ',' + g + ',' + b + ',' + a + ']';\n  } else if (colorFormat === 'RGB_OBJ') {\n    return '{r:' + r + ',g:' + g + ',b:' + b + '}';\n  } else if (colorFormat === 'RGBA_OBJ') {\n    return '{r:' + r + ',g:' + g + ',b:' + b + ',a:' + a + '}';\n  } else if (colorFormat === 'HSV_OBJ') {\n    return '{h:' + h + ',s:' + s + ',v:' + v + '}';\n  } else if (colorFormat === 'HSVA_OBJ') {\n    return '{h:' + h + ',s:' + s + ',v:' + v + ',a:' + a + '}';\n  }\n  return 'unknown format';\n}\n\nvar ARR_EACH = Array.prototype.forEach;\nvar ARR_SLICE = Array.prototype.slice;\nvar Common = {\n  BREAK: {},\n  extend: function extend(target) {\n    this.each(ARR_SLICE.call(arguments, 1), function (obj) {\n      var keys = this.isObject(obj) ? Object.keys(obj) : [];\n      keys.forEach(function (key) {\n        if (!this.isUndefined(obj[key])) {\n          target[key] = obj[key];\n        }\n      }.bind(this));\n    }, this);\n    return target;\n  },\n  defaults: function defaults(target) {\n    this.each(ARR_SLICE.call(arguments, 1), function (obj) {\n      var keys = this.isObject(obj) ? Object.keys(obj) : [];\n      keys.forEach(function (key) {\n        if (this.isUndefined(target[key])) {\n          target[key] = obj[key];\n        }\n      }.bind(this));\n    }, this);\n    return target;\n  },\n  compose: function compose() {\n    var toCall = ARR_SLICE.call(arguments);\n    return function () {\n      var args = ARR_SLICE.call(arguments);\n      for (var i = toCall.length - 1; i >= 0; i--) {\n        args = [toCall[i].apply(this, args)];\n      }\n      return args[0];\n    };\n  },\n  each: function each(obj, itr, scope) {\n    if (!obj) {\n      return;\n    }\n    if (ARR_EACH && obj.forEach && obj.forEach === ARR_EACH) {\n      obj.forEach(itr, scope);\n    } else if (obj.length === obj.length + 0) {\n      var key = void 0;\n      var l = void 0;\n      for (key = 0, l = obj.length; key < l; key++) {\n        if (key in obj && itr.call(scope, obj[key], key) === this.BREAK) {\n          return;\n        }\n      }\n    } else {\n      for (var _key in obj) {\n        if (itr.call(scope, obj[_key], _key) === this.BREAK) {\n          return;\n        }\n      }\n    }\n  },\n  defer: function defer(fnc) {\n    setTimeout(fnc, 0);\n  },\n  debounce: function debounce(func, threshold, callImmediately) {\n    var timeout = void 0;\n    return function () {\n      var obj = this;\n      var args = arguments;\n      function delayed() {\n        timeout = null;\n        if (!callImmediately) func.apply(obj, args);\n      }\n      var callNow = callImmediately || !timeout;\n      clearTimeout(timeout);\n      timeout = setTimeout(delayed, threshold);\n      if (callNow) {\n        func.apply(obj, args);\n      }\n    };\n  },\n  toArray: function toArray(obj) {\n    if (obj.toArray) return obj.toArray();\n    return ARR_SLICE.call(obj);\n  },\n  isUndefined: function isUndefined(obj) {\n    return obj === undefined;\n  },\n  isNull: function isNull(obj) {\n    return obj === null;\n  },\n  isNaN: function (_isNaN) {\n    function isNaN(_x) {\n      return _isNaN.apply(this, arguments);\n    }\n    isNaN.toString = function () {\n      return _isNaN.toString();\n    };\n    return isNaN;\n  }(function (obj) {\n    return isNaN(obj);\n  }),\n  isArray: Array.isArray || function (obj) {\n    return obj.constructor === Array;\n  },\n  isObject: function isObject(obj) {\n    return obj === Object(obj);\n  },\n  isNumber: function isNumber(obj) {\n    return obj === obj + 0;\n  },\n  isString: function isString(obj) {\n    return obj === obj + '';\n  },\n  isBoolean: function isBoolean(obj) {\n    return obj === false || obj === true;\n  },\n  isFunction: function isFunction(obj) {\n    return Object.prototype.toString.call(obj) === '[object Function]';\n  }\n};\n\nvar INTERPRETATIONS = [\n{\n  litmus: Common.isString,\n  conversions: {\n    THREE_CHAR_HEX: {\n      read: function read(original) {\n        var test = original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);\n        if (test === null) {\n          return false;\n        }\n        return {\n          space: 'HEX',\n          hex: parseInt('0x' + test[1].toString() + test[1].toString() + test[2].toString() + test[2].toString() + test[3].toString() + test[3].toString(), 0)\n        };\n      },\n      write: colorToString\n    },\n    SIX_CHAR_HEX: {\n      read: function read(original) {\n        var test = original.match(/^#([A-F0-9]{6})$/i);\n        if (test === null) {\n          return false;\n        }\n        return {\n          space: 'HEX',\n          hex: parseInt('0x' + test[1].toString(), 0)\n        };\n      },\n      write: colorToString\n    },\n    CSS_RGB: {\n      read: function read(original) {\n        var test = original.match(/^rgb\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\n        if (test === null) {\n          return false;\n        }\n        return {\n          space: 'RGB',\n          r: parseFloat(test[1]),\n          g: parseFloat(test[2]),\n          b: parseFloat(test[3])\n        };\n      },\n      write: colorToString\n    },\n    CSS_RGBA: {\n      read: function read(original) {\n        var test = original.match(/^rgba\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\n        if (test === null) {\n          return false;\n        }\n        return {\n          space: 'RGB',\n          r: parseFloat(test[1]),\n          g: parseFloat(test[2]),\n          b: parseFloat(test[3]),\n          a: parseFloat(test[4])\n        };\n      },\n      write: colorToString\n    }\n  }\n},\n{\n  litmus: Common.isNumber,\n  conversions: {\n    HEX: {\n      read: function read(original) {\n        return {\n          space: 'HEX',\n          hex: original,\n          conversionName: 'HEX'\n        };\n      },\n      write: function write(color) {\n        return color.hex;\n      }\n    }\n  }\n},\n{\n  litmus: Common.isArray,\n  conversions: {\n    RGB_ARRAY: {\n      read: function read(original) {\n        if (original.length !== 3) {\n          return false;\n        }\n        return {\n          space: 'RGB',\n          r: original[0],\n          g: original[1],\n          b: original[2]\n        };\n      },\n      write: function write(color) {\n        return [color.r, color.g, color.b];\n      }\n    },\n    RGBA_ARRAY: {\n      read: function read(original) {\n        if (original.length !== 4) return false;\n        return {\n          space: 'RGB',\n          r: original[0],\n          g: original[1],\n          b: original[2],\n          a: original[3]\n        };\n      },\n      write: function write(color) {\n        return [color.r, color.g, color.b, color.a];\n      }\n    }\n  }\n},\n{\n  litmus: Common.isObject,\n  conversions: {\n    RGBA_OBJ: {\n      read: function read(original) {\n        if (Common.isNumber(original.r) && Common.isNumber(original.g) && Common.isNumber(original.b) && Common.isNumber(original.a)) {\n          return {\n            space: 'RGB',\n            r: original.r,\n            g: original.g,\n            b: original.b,\n            a: original.a\n          };\n        }\n        return false;\n      },\n      write: function write(color) {\n        return {\n          r: color.r,\n          g: color.g,\n          b: color.b,\n          a: color.a\n        };\n      }\n    },\n    RGB_OBJ: {\n      read: function read(original) {\n        if (Common.isNumber(original.r) && Common.isNumber(original.g) && Common.isNumber(original.b)) {\n          return {\n            space: 'RGB',\n            r: original.r,\n            g: original.g,\n            b: original.b\n          };\n        }\n        return false;\n      },\n      write: function write(color) {\n        return {\n          r: color.r,\n          g: color.g,\n          b: color.b\n        };\n      }\n    },\n    HSVA_OBJ: {\n      read: function read(original) {\n        if (Common.isNumber(original.h) && Common.isNumber(original.s) && Common.isNumber(original.v) && Common.isNumber(original.a)) {\n          return {\n            space: 'HSV',\n            h: original.h,\n            s: original.s,\n            v: original.v,\n            a: original.a\n          };\n        }\n        return false;\n      },\n      write: function write(color) {\n        return {\n          h: color.h,\n          s: color.s,\n          v: color.v,\n          a: color.a\n        };\n      }\n    },\n    HSV_OBJ: {\n      read: function read(original) {\n        if (Common.isNumber(original.h) && Common.isNumber(original.s) && Common.isNumber(original.v)) {\n          return {\n            space: 'HSV',\n            h: original.h,\n            s: original.s,\n            v: original.v\n          };\n        }\n        return false;\n      },\n      write: function write(color) {\n        return {\n          h: color.h,\n          s: color.s,\n          v: color.v\n        };\n      }\n    }\n  }\n}];\nvar result = void 0;\nvar toReturn = void 0;\nvar interpret = function interpret() {\n  toReturn = false;\n  var original = arguments.length > 1 ? Common.toArray(arguments) : arguments[0];\n  Common.each(INTERPRETATIONS, function (family) {\n    if (family.litmus(original)) {\n      Common.each(family.conversions, function (conversion, conversionName) {\n        result = conversion.read(original);\n        if (toReturn === false && result !== false) {\n          toReturn = result;\n          result.conversionName = conversionName;\n          result.conversion = conversion;\n          return Common.BREAK;\n        }\n      });\n      return Common.BREAK;\n    }\n  });\n  return toReturn;\n};\n\nvar tmpComponent = void 0;\nvar ColorMath = {\n  hsv_to_rgb: function hsv_to_rgb(h, s, v) {\n    var hi = Math.floor(h / 60) % 6;\n    var f = h / 60 - Math.floor(h / 60);\n    var p = v * (1.0 - s);\n    var q = v * (1.0 - f * s);\n    var t = v * (1.0 - (1.0 - f) * s);\n    var c = [[v, t, p], [q, v, p], [p, v, t], [p, q, v], [t, p, v], [v, p, q]][hi];\n    return {\n      r: c[0] * 255,\n      g: c[1] * 255,\n      b: c[2] * 255\n    };\n  },\n  rgb_to_hsv: function rgb_to_hsv(r, g, b) {\n    var min = Math.min(r, g, b);\n    var max = Math.max(r, g, b);\n    var delta = max - min;\n    var h = void 0;\n    var s = void 0;\n    if (max !== 0) {\n      s = delta / max;\n    } else {\n      return {\n        h: NaN,\n        s: 0,\n        v: 0\n      };\n    }\n    if (r === max) {\n      h = (g - b) / delta;\n    } else if (g === max) {\n      h = 2 + (b - r) / delta;\n    } else {\n      h = 4 + (r - g) / delta;\n    }\n    h /= 6;\n    if (h < 0) {\n      h += 1;\n    }\n    return {\n      h: h * 360,\n      s: s,\n      v: max / 255\n    };\n  },\n  rgb_to_hex: function rgb_to_hex(r, g, b) {\n    var hex = this.hex_with_component(0, 2, r);\n    hex = this.hex_with_component(hex, 1, g);\n    hex = this.hex_with_component(hex, 0, b);\n    return hex;\n  },\n  component_from_hex: function component_from_hex(hex, componentIndex) {\n    return hex >> componentIndex * 8 & 0xFF;\n  },\n  hex_with_component: function hex_with_component(hex, componentIndex, value) {\n    return value << (tmpComponent = componentIndex * 8) | hex & ~(0xFF << tmpComponent);\n  }\n};\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\n\n\n\n\n\n\n\n\n\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nvar createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\n\n\n\n\n\n\nvar get = function get(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\nvar inherits = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\n\n\n\n\n\n\n\n\n\n\nvar possibleConstructorReturn = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n};\n\nvar Color = function () {\n  function Color() {\n    classCallCheck(this, Color);\n    this.__state = interpret.apply(this, arguments);\n    if (this.__state === false) {\n      throw new Error('Failed to interpret color arguments');\n    }\n    this.__state.a = this.__state.a || 1;\n  }\n  createClass(Color, [{\n    key: 'toString',\n    value: function toString() {\n      return colorToString(this);\n    }\n  }, {\n    key: 'toHexString',\n    value: function toHexString() {\n      return colorToString(this, true);\n    }\n  }, {\n    key: 'toOriginal',\n    value: function toOriginal() {\n      return this.__state.conversion.write(this);\n    }\n  }]);\n  return Color;\n}();\nfunction defineRGBComponent(target, component, componentHexIndex) {\n  Object.defineProperty(target, component, {\n    get: function get$$1() {\n      if (this.__state.space === 'RGB') {\n        return this.__state[component];\n      }\n      Color.recalculateRGB(this, component, componentHexIndex);\n      return this.__state[component];\n    },\n    set: function set$$1(v) {\n      if (this.__state.space !== 'RGB') {\n        Color.recalculateRGB(this, component, componentHexIndex);\n        this.__state.space = 'RGB';\n      }\n      this.__state[component] = v;\n    }\n  });\n}\nfunction defineHSVComponent(target, component) {\n  Object.defineProperty(target, component, {\n    get: function get$$1() {\n      if (this.__state.space === 'HSV') {\n        return this.__state[component];\n      }\n      Color.recalculateHSV(this);\n      return this.__state[component];\n    },\n    set: function set$$1(v) {\n      if (this.__state.space !== 'HSV') {\n        Color.recalculateHSV(this);\n        this.__state.space = 'HSV';\n      }\n      this.__state[component] = v;\n    }\n  });\n}\nColor.recalculateRGB = function (color, component, componentHexIndex) {\n  if (color.__state.space === 'HEX') {\n    color.__state[component] = ColorMath.component_from_hex(color.__state.hex, componentHexIndex);\n  } else if (color.__state.space === 'HSV') {\n    Common.extend(color.__state, ColorMath.hsv_to_rgb(color.__state.h, color.__state.s, color.__state.v));\n  } else {\n    throw new Error('Corrupted color state');\n  }\n};\nColor.recalculateHSV = function (color) {\n  var result = ColorMath.rgb_to_hsv(color.r, color.g, color.b);\n  Common.extend(color.__state, {\n    s: result.s,\n    v: result.v\n  });\n  if (!Common.isNaN(result.h)) {\n    color.__state.h = result.h;\n  } else if (Common.isUndefined(color.__state.h)) {\n    color.__state.h = 0;\n  }\n};\nColor.COMPONENTS = ['r', 'g', 'b', 'h', 's', 'v', 'hex', 'a'];\ndefineRGBComponent(Color.prototype, 'r', 2);\ndefineRGBComponent(Color.prototype, 'g', 1);\ndefineRGBComponent(Color.prototype, 'b', 0);\ndefineHSVComponent(Color.prototype, 'h');\ndefineHSVComponent(Color.prototype, 's');\ndefineHSVComponent(Color.prototype, 'v');\nObject.defineProperty(Color.prototype, 'a', {\n  get: function get$$1() {\n    return this.__state.a;\n  },\n  set: function set$$1(v) {\n    this.__state.a = v;\n  }\n});\nObject.defineProperty(Color.prototype, 'hex', {\n  get: function get$$1() {\n    if (!this.__state.space !== 'HEX') {\n      this.__state.hex = ColorMath.rgb_to_hex(this.r, this.g, this.b);\n    }\n    return this.__state.hex;\n  },\n  set: function set$$1(v) {\n    this.__state.space = 'HEX';\n    this.__state.hex = v;\n  }\n});\n\nvar Controller = function () {\n  function Controller(object, property) {\n    classCallCheck(this, Controller);\n    this.initialValue = object[property];\n    this.domElement = document.createElement('div');\n    this.object = object;\n    this.property = property;\n    this.__onChange = undefined;\n    this.__onFinishChange = undefined;\n  }\n  createClass(Controller, [{\n    key: 'onChange',\n    value: function onChange(fnc) {\n      this.__onChange = fnc;\n      return this;\n    }\n  }, {\n    key: 'onFinishChange',\n    value: function onFinishChange(fnc) {\n      this.__onFinishChange = fnc;\n      return this;\n    }\n  }, {\n    key: 'setValue',\n    value: function setValue(newValue) {\n      this.object[this.property] = newValue;\n      if (this.__onChange) {\n        this.__onChange.call(this, newValue);\n      }\n      this.updateDisplay();\n      return this;\n    }\n  }, {\n    key: 'getValue',\n    value: function getValue() {\n      return this.object[this.property];\n    }\n  }, {\n    key: 'updateDisplay',\n    value: function updateDisplay() {\n      return this;\n    }\n  }, {\n    key: 'isModified',\n    value: function isModified() {\n      return this.initialValue !== this.getValue();\n    }\n  }]);\n  return Controller;\n}();\n\nvar EVENT_MAP = {\n  HTMLEvents: ['change'],\n  MouseEvents: ['click', 'mousemove', 'mousedown', 'mouseup', 'mouseover'],\n  KeyboardEvents: ['keydown']\n};\nvar EVENT_MAP_INV = {};\nCommon.each(EVENT_MAP, function (v, k) {\n  Common.each(v, function (e) {\n    EVENT_MAP_INV[e] = k;\n  });\n});\nvar CSS_VALUE_PIXELS = /(\\d+(\\.\\d+)?)px/;\nfunction cssValueToPixels(val) {\n  if (val === '0' || Common.isUndefined(val)) {\n    return 0;\n  }\n  var match = val.match(CSS_VALUE_PIXELS);\n  if (!Common.isNull(match)) {\n    return parseFloat(match[1]);\n  }\n  return 0;\n}\nvar dom = {\n  makeSelectable: function makeSelectable(elem, selectable) {\n    if (elem === undefined || elem.style === undefined) return;\n    elem.onselectstart = selectable ? function () {\n      return false;\n    } : function () {};\n    elem.style.MozUserSelect = selectable ? 'auto' : 'none';\n    elem.style.KhtmlUserSelect = selectable ? 'auto' : 'none';\n    elem.unselectable = selectable ? 'on' : 'off';\n  },\n  makeFullscreen: function makeFullscreen(elem, hor, vert) {\n    var vertical = vert;\n    var horizontal = hor;\n    if (Common.isUndefined(horizontal)) {\n      horizontal = true;\n    }\n    if (Common.isUndefined(vertical)) {\n      vertical = true;\n    }\n    elem.style.position = 'absolute';\n    if (horizontal) {\n      elem.style.left = 0;\n      elem.style.right = 0;\n    }\n    if (vertical) {\n      elem.style.top = 0;\n      elem.style.bottom = 0;\n    }\n  },\n  fakeEvent: function fakeEvent(elem, eventType, pars, aux) {\n    var params = pars || {};\n    var className = EVENT_MAP_INV[eventType];\n    if (!className) {\n      throw new Error('Event type ' + eventType + ' not supported.');\n    }\n    var evt = document.createEvent(className);\n    switch (className) {\n      case 'MouseEvents':\n        {\n          var clientX = params.x || params.clientX || 0;\n          var clientY = params.y || params.clientY || 0;\n          evt.initMouseEvent(eventType, params.bubbles || false, params.cancelable || true, window, params.clickCount || 1, 0,\n          0,\n          clientX,\n          clientY,\n          false, false, false, false, 0, null);\n          break;\n        }\n      case 'KeyboardEvents':\n        {\n          var init = evt.initKeyboardEvent || evt.initKeyEvent;\n          Common.defaults(params, {\n            cancelable: true,\n            ctrlKey: false,\n            altKey: false,\n            shiftKey: false,\n            metaKey: false,\n            keyCode: undefined,\n            charCode: undefined\n          });\n          init(eventType, params.bubbles || false, params.cancelable, window, params.ctrlKey, params.altKey, params.shiftKey, params.metaKey, params.keyCode, params.charCode);\n          break;\n        }\n      default:\n        {\n          evt.initEvent(eventType, params.bubbles || false, params.cancelable || true);\n          break;\n        }\n    }\n    Common.defaults(evt, aux);\n    elem.dispatchEvent(evt);\n  },\n  bind: function bind(elem, event, func, newBool) {\n    var bool = newBool || false;\n    if (elem.addEventListener) {\n      elem.addEventListener(event, func, bool);\n    } else if (elem.attachEvent) {\n      elem.attachEvent('on' + event, func);\n    }\n    return dom;\n  },\n  unbind: function unbind(elem, event, func, newBool) {\n    var bool = newBool || false;\n    if (elem.removeEventListener) {\n      elem.removeEventListener(event, func, bool);\n    } else if (elem.detachEvent) {\n      elem.detachEvent('on' + event, func);\n    }\n    return dom;\n  },\n  addClass: function addClass(elem, className) {\n    if (elem.className === undefined) {\n      elem.className = className;\n    } else if (elem.className !== className) {\n      var classes = elem.className.split(/ +/);\n      if (classes.indexOf(className) === -1) {\n        classes.push(className);\n        elem.className = classes.join(' ').replace(/^\\s+/, '').replace(/\\s+$/, '');\n      }\n    }\n    return dom;\n  },\n  removeClass: function removeClass(elem, className) {\n    if (className) {\n      if (elem.className === className) {\n        elem.removeAttribute('class');\n      } else {\n        var classes = elem.className.split(/ +/);\n        var index = classes.indexOf(className);\n        if (index !== -1) {\n          classes.splice(index, 1);\n          elem.className = classes.join(' ');\n        }\n      }\n    } else {\n      elem.className = undefined;\n    }\n    return dom;\n  },\n  hasClass: function hasClass(elem, className) {\n    return new RegExp('(?:^|\\\\s+)' + className + '(?:\\\\s+|$)').test(elem.className) || false;\n  },\n  getWidth: function getWidth(elem) {\n    var style = getComputedStyle(elem);\n    return cssValueToPixels(style['border-left-width']) + cssValueToPixels(style['border-right-width']) + cssValueToPixels(style['padding-left']) + cssValueToPixels(style['padding-right']) + cssValueToPixels(style.width);\n  },\n  getHeight: function getHeight(elem) {\n    var style = getComputedStyle(elem);\n    return cssValueToPixels(style['border-top-width']) + cssValueToPixels(style['border-bottom-width']) + cssValueToPixels(style['padding-top']) + cssValueToPixels(style['padding-bottom']) + cssValueToPixels(style.height);\n  },\n  getOffset: function getOffset(el) {\n    var elem = el;\n    var offset = { left: 0, top: 0 };\n    if (elem.offsetParent) {\n      do {\n        offset.left += elem.offsetLeft;\n        offset.top += elem.offsetTop;\n        elem = elem.offsetParent;\n      } while (elem);\n    }\n    return offset;\n  },\n  isActive: function isActive(elem) {\n    return elem === document.activeElement && (elem.type || elem.href);\n  }\n};\n\nvar BooleanController = function (_Controller) {\n  inherits(BooleanController, _Controller);\n  function BooleanController(object, property) {\n    classCallCheck(this, BooleanController);\n    var _this2 = possibleConstructorReturn(this, (BooleanController.__proto__ || Object.getPrototypeOf(BooleanController)).call(this, object, property));\n    var _this = _this2;\n    _this2.__prev = _this2.getValue();\n    _this2.__checkbox = document.createElement('input');\n    _this2.__checkbox.setAttribute('type', 'checkbox');\n    function onChange() {\n      _this.setValue(!_this.__prev);\n    }\n    dom.bind(_this2.__checkbox, 'change', onChange, false);\n    _this2.domElement.appendChild(_this2.__checkbox);\n    _this2.updateDisplay();\n    return _this2;\n  }\n  createClass(BooleanController, [{\n    key: 'setValue',\n    value: function setValue(v) {\n      var toReturn = get(BooleanController.prototype.__proto__ || Object.getPrototypeOf(BooleanController.prototype), 'setValue', this).call(this, v);\n      if (this.__onFinishChange) {\n        this.__onFinishChange.call(this, this.getValue());\n      }\n      this.__prev = this.getValue();\n      return toReturn;\n    }\n  }, {\n    key: 'updateDisplay',\n    value: function updateDisplay() {\n      if (this.getValue() === true) {\n        this.__checkbox.setAttribute('checked', 'checked');\n        this.__checkbox.checked = true;\n        this.__prev = true;\n      } else {\n        this.__checkbox.checked = false;\n        this.__prev = false;\n      }\n      return get(BooleanController.prototype.__proto__ || Object.getPrototypeOf(BooleanController.prototype), 'updateDisplay', this).call(this);\n    }\n  }]);\n  return BooleanController;\n}(Controller);\n\nvar OptionController = function (_Controller) {\n  inherits(OptionController, _Controller);\n  function OptionController(object, property, opts) {\n    classCallCheck(this, OptionController);\n    var _this2 = possibleConstructorReturn(this, (OptionController.__proto__ || Object.getPrototypeOf(OptionController)).call(this, object, property));\n    var options = opts;\n    var _this = _this2;\n    _this2.__select = document.createElement('select');\n    if (Common.isArray(options)) {\n      var map = {};\n      Common.each(options, function (element) {\n        map[element] = element;\n      });\n      options = map;\n    }\n    Common.each(options, function (value, key) {\n      var opt = document.createElement('option');\n      opt.innerHTML = key;\n      opt.setAttribute('value', value);\n      _this.__select.appendChild(opt);\n    });\n    _this2.updateDisplay();\n    dom.bind(_this2.__select, 'change', function () {\n      var desiredValue = this.options[this.selectedIndex].value;\n      _this.setValue(desiredValue);\n    });\n    _this2.domElement.appendChild(_this2.__select);\n    return _this2;\n  }\n  createClass(OptionController, [{\n    key: 'setValue',\n    value: function setValue(v) {\n      var toReturn = get(OptionController.prototype.__proto__ || Object.getPrototypeOf(OptionController.prototype), 'setValue', this).call(this, v);\n      if (this.__onFinishChange) {\n        this.__onFinishChange.call(this, this.getValue());\n      }\n      return toReturn;\n    }\n  }, {\n    key: 'updateDisplay',\n    value: function updateDisplay() {\n      if (dom.isActive(this.__select)) return this;\n      this.__select.value = this.getValue();\n      return get(OptionController.prototype.__proto__ || Object.getPrototypeOf(OptionController.prototype), 'updateDisplay', this).call(this);\n    }\n  }]);\n  return OptionController;\n}(Controller);\n\nvar StringController = function (_Controller) {\n  inherits(StringController, _Controller);\n  function StringController(object, property) {\n    classCallCheck(this, StringController);\n    var _this2 = possibleConstructorReturn(this, (StringController.__proto__ || Object.getPrototypeOf(StringController)).call(this, object, property));\n    var _this = _this2;\n    function onChange() {\n      _this.setValue(_this.__input.value);\n    }\n    function onBlur() {\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n    _this2.__input = document.createElement('input');\n    _this2.__input.setAttribute('type', 'text');\n    dom.bind(_this2.__input, 'keyup', onChange);\n    dom.bind(_this2.__input, 'change', onChange);\n    dom.bind(_this2.__input, 'blur', onBlur);\n    dom.bind(_this2.__input, 'keydown', function (e) {\n      if (e.keyCode === 13) {\n        this.blur();\n      }\n    });\n    _this2.updateDisplay();\n    _this2.domElement.appendChild(_this2.__input);\n    return _this2;\n  }\n  createClass(StringController, [{\n    key: 'updateDisplay',\n    value: function updateDisplay() {\n      if (!dom.isActive(this.__input)) {\n        this.__input.value = this.getValue();\n      }\n      return get(StringController.prototype.__proto__ || Object.getPrototypeOf(StringController.prototype), 'updateDisplay', this).call(this);\n    }\n  }]);\n  return StringController;\n}(Controller);\n\nfunction numDecimals(x) {\n  var _x = x.toString();\n  if (_x.indexOf('.') > -1) {\n    return _x.length - _x.indexOf('.') - 1;\n  }\n  return 0;\n}\nvar NumberController = function (_Controller) {\n  inherits(NumberController, _Controller);\n  function NumberController(object, property, params) {\n    classCallCheck(this, NumberController);\n    var _this = possibleConstructorReturn(this, (NumberController.__proto__ || Object.getPrototypeOf(NumberController)).call(this, object, property));\n    var _params = params || {};\n    _this.__min = _params.min;\n    _this.__max = _params.max;\n    _this.__step = _params.step;\n    if (Common.isUndefined(_this.__step)) {\n      if (_this.initialValue === 0) {\n        _this.__impliedStep = 1;\n      } else {\n        _this.__impliedStep = Math.pow(10, Math.floor(Math.log(Math.abs(_this.initialValue)) / Math.LN10)) / 10;\n      }\n    } else {\n      _this.__impliedStep = _this.__step;\n    }\n    _this.__precision = numDecimals(_this.__impliedStep);\n    return _this;\n  }\n  createClass(NumberController, [{\n    key: 'setValue',\n    value: function setValue(v) {\n      var _v = v;\n      if (this.__min !== undefined && _v < this.__min) {\n        _v = this.__min;\n      } else if (this.__max !== undefined && _v > this.__max) {\n        _v = this.__max;\n      }\n      if (this.__step !== undefined && _v % this.__step !== 0) {\n        _v = Math.round(_v / this.__step) * this.__step;\n      }\n      return get(NumberController.prototype.__proto__ || Object.getPrototypeOf(NumberController.prototype), 'setValue', this).call(this, _v);\n    }\n  }, {\n    key: 'min',\n    value: function min(minValue) {\n      this.__min = minValue;\n      return this;\n    }\n  }, {\n    key: 'max',\n    value: function max(maxValue) {\n      this.__max = maxValue;\n      return this;\n    }\n  }, {\n    key: 'step',\n    value: function step(stepValue) {\n      this.__step = stepValue;\n      this.__impliedStep = stepValue;\n      this.__precision = numDecimals(stepValue);\n      return this;\n    }\n  }]);\n  return NumberController;\n}(Controller);\n\nfunction roundToDecimal(value, decimals) {\n  var tenTo = Math.pow(10, decimals);\n  return Math.round(value * tenTo) / tenTo;\n}\nvar NumberControllerBox = function (_NumberController) {\n  inherits(NumberControllerBox, _NumberController);\n  function NumberControllerBox(object, property, params) {\n    classCallCheck(this, NumberControllerBox);\n    var _this2 = possibleConstructorReturn(this, (NumberControllerBox.__proto__ || Object.getPrototypeOf(NumberControllerBox)).call(this, object, property, params));\n    _this2.__truncationSuspended = false;\n    var _this = _this2;\n    var prevY = void 0;\n    function onChange() {\n      var attempted = parseFloat(_this.__input.value);\n      if (!Common.isNaN(attempted)) {\n        _this.setValue(attempted);\n      }\n    }\n    function onFinish() {\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n    function onBlur() {\n      onFinish();\n    }\n    function onMouseDrag(e) {\n      var diff = prevY - e.clientY;\n      _this.setValue(_this.getValue() + diff * _this.__impliedStep);\n      prevY = e.clientY;\n    }\n    function onMouseUp() {\n      dom.unbind(window, 'mousemove', onMouseDrag);\n      dom.unbind(window, 'mouseup', onMouseUp);\n      onFinish();\n    }\n    function onMouseDown(e) {\n      dom.bind(window, 'mousemove', onMouseDrag);\n      dom.bind(window, 'mouseup', onMouseUp);\n      prevY = e.clientY;\n    }\n    _this2.__input = document.createElement('input');\n    _this2.__input.setAttribute('type', 'text');\n    dom.bind(_this2.__input, 'change', onChange);\n    dom.bind(_this2.__input, 'blur', onBlur);\n    dom.bind(_this2.__input, 'mousedown', onMouseDown);\n    dom.bind(_this2.__input, 'keydown', function (e) {\n      if (e.keyCode === 13) {\n        _this.__truncationSuspended = true;\n        this.blur();\n        _this.__truncationSuspended = false;\n        onFinish();\n      }\n    });\n    _this2.updateDisplay();\n    _this2.domElement.appendChild(_this2.__input);\n    return _this2;\n  }\n  createClass(NumberControllerBox, [{\n    key: 'updateDisplay',\n    value: function updateDisplay() {\n      this.__input.value = this.__truncationSuspended ? this.getValue() : roundToDecimal(this.getValue(), this.__precision);\n      return get(NumberControllerBox.prototype.__proto__ || Object.getPrototypeOf(NumberControllerBox.prototype), 'updateDisplay', this).call(this);\n    }\n  }]);\n  return NumberControllerBox;\n}(NumberController);\n\nfunction map(v, i1, i2, o1, o2) {\n  return o1 + (o2 - o1) * ((v - i1) / (i2 - i1));\n}\nvar NumberControllerSlider = function (_NumberController) {\n  inherits(NumberControllerSlider, _NumberController);\n  function NumberControllerSlider(object, property, min, max, step) {\n    classCallCheck(this, NumberControllerSlider);\n    var _this2 = possibleConstructorReturn(this, (NumberControllerSlider.__proto__ || Object.getPrototypeOf(NumberControllerSlider)).call(this, object, property, { min: min, max: max, step: step }));\n    var _this = _this2;\n    _this2.__background = document.createElement('div');\n    _this2.__foreground = document.createElement('div');\n    dom.bind(_this2.__background, 'mousedown', onMouseDown);\n    dom.bind(_this2.__background, 'touchstart', onTouchStart);\n    dom.addClass(_this2.__background, 'slider');\n    dom.addClass(_this2.__foreground, 'slider-fg');\n    function onMouseDown(e) {\n      document.activeElement.blur();\n      dom.bind(window, 'mousemove', onMouseDrag);\n      dom.bind(window, 'mouseup', onMouseUp);\n      onMouseDrag(e);\n    }\n    function onMouseDrag(e) {\n      e.preventDefault();\n      var bgRect = _this.__background.getBoundingClientRect();\n      _this.setValue(map(e.clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));\n      return false;\n    }\n    function onMouseUp() {\n      dom.unbind(window, 'mousemove', onMouseDrag);\n      dom.unbind(window, 'mouseup', onMouseUp);\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n    function onTouchStart(e) {\n      if (e.touches.length !== 1) {\n        return;\n      }\n      dom.bind(window, 'touchmove', onTouchMove);\n      dom.bind(window, 'touchend', onTouchEnd);\n      onTouchMove(e);\n    }\n    function onTouchMove(e) {\n      var clientX = e.touches[0].clientX;\n      var bgRect = _this.__background.getBoundingClientRect();\n      _this.setValue(map(clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));\n    }\n    function onTouchEnd() {\n      dom.unbind(window, 'touchmove', onTouchMove);\n      dom.unbind(window, 'touchend', onTouchEnd);\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n    _this2.updateDisplay();\n    _this2.__background.appendChild(_this2.__foreground);\n    _this2.domElement.appendChild(_this2.__background);\n    return _this2;\n  }\n  createClass(NumberControllerSlider, [{\n    key: 'updateDisplay',\n    value: function updateDisplay() {\n      var pct = (this.getValue() - this.__min) / (this.__max - this.__min);\n      this.__foreground.style.width = pct * 100 + '%';\n      return get(NumberControllerSlider.prototype.__proto__ || Object.getPrototypeOf(NumberControllerSlider.prototype), 'updateDisplay', this).call(this);\n    }\n  }]);\n  return NumberControllerSlider;\n}(NumberController);\n\nvar FunctionController = function (_Controller) {\n  inherits(FunctionController, _Controller);\n  function FunctionController(object, property, text) {\n    classCallCheck(this, FunctionController);\n    var _this2 = possibleConstructorReturn(this, (FunctionController.__proto__ || Object.getPrototypeOf(FunctionController)).call(this, object, property));\n    var _this = _this2;\n    _this2.__button = document.createElement('div');\n    _this2.__button.innerHTML = text === undefined ? 'Fire' : text;\n    dom.bind(_this2.__button, 'click', function (e) {\n      e.preventDefault();\n      _this.fire();\n      return false;\n    });\n    dom.addClass(_this2.__button, 'button');\n    _this2.domElement.appendChild(_this2.__button);\n    return _this2;\n  }\n  createClass(FunctionController, [{\n    key: 'fire',\n    value: function fire() {\n      if (this.__onChange) {\n        this.__onChange.call(this);\n      }\n      this.getValue().call(this.object);\n      if (this.__onFinishChange) {\n        this.__onFinishChange.call(this, this.getValue());\n      }\n    }\n  }]);\n  return FunctionController;\n}(Controller);\n\nvar ColorController = function (_Controller) {\n  inherits(ColorController, _Controller);\n  function ColorController(object, property) {\n    classCallCheck(this, ColorController);\n    var _this2 = possibleConstructorReturn(this, (ColorController.__proto__ || Object.getPrototypeOf(ColorController)).call(this, object, property));\n    _this2.__color = new Color(_this2.getValue());\n    _this2.__temp = new Color(0);\n    var _this = _this2;\n    _this2.domElement = document.createElement('div');\n    dom.makeSelectable(_this2.domElement, false);\n    _this2.__selector = document.createElement('div');\n    _this2.__selector.className = 'selector';\n    _this2.__saturation_field = document.createElement('div');\n    _this2.__saturation_field.className = 'saturation-field';\n    _this2.__field_knob = document.createElement('div');\n    _this2.__field_knob.className = 'field-knob';\n    _this2.__field_knob_border = '2px solid ';\n    _this2.__hue_knob = document.createElement('div');\n    _this2.__hue_knob.className = 'hue-knob';\n    _this2.__hue_field = document.createElement('div');\n    _this2.__hue_field.className = 'hue-field';\n    _this2.__input = document.createElement('input');\n    _this2.__input.type = 'text';\n    _this2.__input_textShadow = '0 1px 1px ';\n    dom.bind(_this2.__input, 'keydown', function (e) {\n      if (e.keyCode === 13) {\n        onBlur.call(this);\n      }\n    });\n    dom.bind(_this2.__input, 'blur', onBlur);\n    dom.bind(_this2.__selector, 'mousedown', function ()        {\n      dom.addClass(this, 'drag').bind(window, 'mouseup', function ()        {\n        dom.removeClass(_this.__selector, 'drag');\n      });\n    });\n    dom.bind(_this2.__selector, 'touchstart', function ()        {\n      dom.addClass(this, 'drag').bind(window, 'touchend', function ()        {\n        dom.removeClass(_this.__selector, 'drag');\n      });\n    });\n    var valueField = document.createElement('div');\n    Common.extend(_this2.__selector.style, {\n      width: '122px',\n      height: '102px',\n      padding: '3px',\n      backgroundColor: '#222',\n      boxShadow: '0px 1px 3px rgba(0,0,0,0.3)'\n    });\n    Common.extend(_this2.__field_knob.style, {\n      position: 'absolute',\n      width: '12px',\n      height: '12px',\n      border: _this2.__field_knob_border + (_this2.__color.v < 0.5 ? '#fff' : '#000'),\n      boxShadow: '0px 1px 3px rgba(0,0,0,0.5)',\n      borderRadius: '12px',\n      zIndex: 1\n    });\n    Common.extend(_this2.__hue_knob.style, {\n      position: 'absolute',\n      width: '15px',\n      height: '2px',\n      borderRight: '4px solid #fff',\n      zIndex: 1\n    });\n    Common.extend(_this2.__saturation_field.style, {\n      width: '100px',\n      height: '100px',\n      border: '1px solid #555',\n      marginRight: '3px',\n      display: 'inline-block',\n      cursor: 'pointer'\n    });\n    Common.extend(valueField.style, {\n      width: '100%',\n      height: '100%',\n      background: 'none'\n    });\n    linearGradient(valueField, 'top', 'rgba(0,0,0,0)', '#000');\n    Common.extend(_this2.__hue_field.style, {\n      width: '15px',\n      height: '100px',\n      border: '1px solid #555',\n      cursor: 'ns-resize',\n      position: 'absolute',\n      top: '3px',\n      right: '3px'\n    });\n    hueGradient(_this2.__hue_field);\n    Common.extend(_this2.__input.style, {\n      outline: 'none',\n      textAlign: 'center',\n      color: '#fff',\n      border: 0,\n      fontWeight: 'bold',\n      textShadow: _this2.__input_textShadow + 'rgba(0,0,0,0.7)'\n    });\n    dom.bind(_this2.__saturation_field, 'mousedown', fieldDown);\n    dom.bind(_this2.__saturation_field, 'touchstart', fieldDown);\n    dom.bind(_this2.__field_knob, 'mousedown', fieldDown);\n    dom.bind(_this2.__field_knob, 'touchstart', fieldDown);\n    dom.bind(_this2.__hue_field, 'mousedown', fieldDownH);\n    dom.bind(_this2.__hue_field, 'touchstart', fieldDownH);\n    function fieldDown(e) {\n      setSV(e);\n      dom.bind(window, 'mousemove', setSV);\n      dom.bind(window, 'touchmove', setSV);\n      dom.bind(window, 'mouseup', fieldUpSV);\n      dom.bind(window, 'touchend', fieldUpSV);\n    }\n    function fieldDownH(e) {\n      setH(e);\n      dom.bind(window, 'mousemove', setH);\n      dom.bind(window, 'touchmove', setH);\n      dom.bind(window, 'mouseup', fieldUpH);\n      dom.bind(window, 'touchend', fieldUpH);\n    }\n    function fieldUpSV() {\n      dom.unbind(window, 'mousemove', setSV);\n      dom.unbind(window, 'touchmove', setSV);\n      dom.unbind(window, 'mouseup', fieldUpSV);\n      dom.unbind(window, 'touchend', fieldUpSV);\n      onFinish();\n    }\n    function fieldUpH() {\n      dom.unbind(window, 'mousemove', setH);\n      dom.unbind(window, 'touchmove', setH);\n      dom.unbind(window, 'mouseup', fieldUpH);\n      dom.unbind(window, 'touchend', fieldUpH);\n      onFinish();\n    }\n    function onBlur() {\n      var i = interpret(this.value);\n      if (i !== false) {\n        _this.__color.__state = i;\n        _this.setValue(_this.__color.toOriginal());\n      } else {\n        this.value = _this.__color.toString();\n      }\n    }\n    function onFinish() {\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.__color.toOriginal());\n      }\n    }\n    _this2.__saturation_field.appendChild(valueField);\n    _this2.__selector.appendChild(_this2.__field_knob);\n    _this2.__selector.appendChild(_this2.__saturation_field);\n    _this2.__selector.appendChild(_this2.__hue_field);\n    _this2.__hue_field.appendChild(_this2.__hue_knob);\n    _this2.domElement.appendChild(_this2.__input);\n    _this2.domElement.appendChild(_this2.__selector);\n    _this2.updateDisplay();\n    function setSV(e) {\n      if (e.type.indexOf('touch') === -1) {\n        e.preventDefault();\n      }\n      var fieldRect = _this.__saturation_field.getBoundingClientRect();\n      var _ref = e.touches && e.touches[0] || e,\n          clientX = _ref.clientX,\n          clientY = _ref.clientY;\n      var s = (clientX - fieldRect.left) / (fieldRect.right - fieldRect.left);\n      var v = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\n      if (v > 1) {\n        v = 1;\n      } else if (v < 0) {\n        v = 0;\n      }\n      if (s > 1) {\n        s = 1;\n      } else if (s < 0) {\n        s = 0;\n      }\n      _this.__color.v = v;\n      _this.__color.s = s;\n      _this.setValue(_this.__color.toOriginal());\n      return false;\n    }\n    function setH(e) {\n      if (e.type.indexOf('touch') === -1) {\n        e.preventDefault();\n      }\n      var fieldRect = _this.__hue_field.getBoundingClientRect();\n      var _ref2 = e.touches && e.touches[0] || e,\n          clientY = _ref2.clientY;\n      var h = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\n      if (h > 1) {\n        h = 1;\n      } else if (h < 0) {\n        h = 0;\n      }\n      _this.__color.h = h * 360;\n      _this.setValue(_this.__color.toOriginal());\n      return false;\n    }\n    return _this2;\n  }\n  createClass(ColorController, [{\n    key: 'updateDisplay',\n    value: function updateDisplay() {\n      var i = interpret(this.getValue());\n      if (i !== false) {\n        var mismatch = false;\n        Common.each(Color.COMPONENTS, function (component) {\n          if (!Common.isUndefined(i[component]) && !Common.isUndefined(this.__color.__state[component]) && i[component] !== this.__color.__state[component]) {\n            mismatch = true;\n            return {};\n          }\n        }, this);\n        if (mismatch) {\n          Common.extend(this.__color.__state, i);\n        }\n      }\n      Common.extend(this.__temp.__state, this.__color.__state);\n      this.__temp.a = 1;\n      var flip = this.__color.v < 0.5 || this.__color.s > 0.5 ? 255 : 0;\n      var _flip = 255 - flip;\n      Common.extend(this.__field_knob.style, {\n        marginLeft: 100 * this.__color.s - 7 + 'px',\n        marginTop: 100 * (1 - this.__color.v) - 7 + 'px',\n        backgroundColor: this.__temp.toHexString(),\n        border: this.__field_knob_border + 'rgb(' + flip + ',' + flip + ',' + flip + ')'\n      });\n      this.__hue_knob.style.marginTop = (1 - this.__color.h / 360) * 100 + 'px';\n      this.__temp.s = 1;\n      this.__temp.v = 1;\n      linearGradient(this.__saturation_field, 'left', '#fff', this.__temp.toHexString());\n      this.__input.value = this.__color.toString();\n      Common.extend(this.__input.style, {\n        backgroundColor: this.__color.toHexString(),\n        color: 'rgb(' + flip + ',' + flip + ',' + flip + ')',\n        textShadow: this.__input_textShadow + 'rgba(' + _flip + ',' + _flip + ',' + _flip + ',.7)'\n      });\n    }\n  }]);\n  return ColorController;\n}(Controller);\nvar vendors = ['-moz-', '-o-', '-webkit-', '-ms-', ''];\nfunction linearGradient(elem, x, a, b) {\n  elem.style.background = '';\n  Common.each(vendors, function (vendor) {\n    elem.style.cssText += 'background: ' + vendor + 'linear-gradient(' + x + ', ' + a + ' 0%, ' + b + ' 100%); ';\n  });\n}\nfunction hueGradient(elem) {\n  elem.style.background = '';\n  elem.style.cssText += 'background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);';\n  elem.style.cssText += 'background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\n  elem.style.cssText += 'background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\n  elem.style.cssText += 'background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\n  elem.style.cssText += 'background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\n}\n\nvar css = {\n  load: function load(url, indoc) {\n    var doc = indoc || document;\n    var link = doc.createElement('link');\n    link.type = 'text/css';\n    link.rel = 'stylesheet';\n    link.href = url;\n    doc.getElementsByTagName('head')[0].appendChild(link);\n  },\n  inject: function inject(cssContent, indoc) {\n    var doc = indoc || document;\n    var injected = document.createElement('style');\n    injected.type = 'text/css';\n    injected.innerHTML = cssContent;\n    var head = doc.getElementsByTagName('head')[0];\n    try {\n      head.appendChild(injected);\n    } catch (e) {\n    }\n  }\n};\n\nvar saveDialogContents = \"<div id=\\\"dg-save\\\" class=\\\"dg dialogue\\\">\\n\\n  Here's the new load parameter for your <code>GUI</code>'s constructor:\\n\\n  <textarea id=\\\"dg-new-constructor\\\"></textarea>\\n\\n  <div id=\\\"dg-save-locally\\\">\\n\\n    <input id=\\\"dg-local-storage\\\" type=\\\"checkbox\\\"/> Automatically save\\n    values to <code>localStorage</code> on exit.\\n\\n    <div id=\\\"dg-local-explain\\\">The values saved to <code>localStorage</code> will\\n      override those passed to <code>dat.GUI</code>'s constructor. This makes it\\n      easier to work incrementally, but <code>localStorage</code> is fragile,\\n      and your friends may not see the same values you do.\\n\\n    </div>\\n\\n  </div>\\n\\n</div>\";\n\nvar ControllerFactory = function ControllerFactory(object, property) {\n  var initialValue = object[property];\n  if (Common.isArray(arguments[2]) || Common.isObject(arguments[2])) {\n    return new OptionController(object, property, arguments[2]);\n  }\n  if (Common.isNumber(initialValue)) {\n    if (Common.isNumber(arguments[2]) && Common.isNumber(arguments[3])) {\n      if (Common.isNumber(arguments[4])) {\n        return new NumberControllerSlider(object, property, arguments[2], arguments[3], arguments[4]);\n      }\n      return new NumberControllerSlider(object, property, arguments[2], arguments[3]);\n    }\n    if (Common.isNumber(arguments[4])) {\n      return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3], step: arguments[4] });\n    }\n    return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3] });\n  }\n  if (Common.isString(initialValue)) {\n    return new StringController(object, property);\n  }\n  if (Common.isFunction(initialValue)) {\n    return new FunctionController(object, property, '');\n  }\n  if (Common.isBoolean(initialValue)) {\n    return new BooleanController(object, property);\n  }\n  return null;\n};\n\nfunction requestAnimationFrame(callback) {\n  setTimeout(callback, 1000 / 60);\n}\nvar requestAnimationFrame$1 = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || requestAnimationFrame;\n\nvar CenteredDiv = function () {\n  function CenteredDiv() {\n    classCallCheck(this, CenteredDiv);\n    this.backgroundElement = document.createElement('div');\n    Common.extend(this.backgroundElement.style, {\n      backgroundColor: 'rgba(0,0,0,0.8)',\n      top: 0,\n      left: 0,\n      display: 'none',\n      zIndex: '1000',\n      opacity: 0,\n      WebkitTransition: 'opacity 0.2s linear',\n      transition: 'opacity 0.2s linear'\n    });\n    dom.makeFullscreen(this.backgroundElement);\n    this.backgroundElement.style.position = 'fixed';\n    this.domElement = document.createElement('div');\n    Common.extend(this.domElement.style, {\n      position: 'fixed',\n      display: 'none',\n      zIndex: '1001',\n      opacity: 0,\n      WebkitTransition: '-webkit-transform 0.2s ease-out, opacity 0.2s linear',\n      transition: 'transform 0.2s ease-out, opacity 0.2s linear'\n    });\n    document.body.appendChild(this.backgroundElement);\n    document.body.appendChild(this.domElement);\n    var _this = this;\n    dom.bind(this.backgroundElement, 'click', function () {\n      _this.hide();\n    });\n  }\n  createClass(CenteredDiv, [{\n    key: 'show',\n    value: function show() {\n      var _this = this;\n      this.backgroundElement.style.display = 'block';\n      this.domElement.style.display = 'block';\n      this.domElement.style.opacity = 0;\n      this.domElement.style.webkitTransform = 'scale(1.1)';\n      this.layout();\n      Common.defer(function () {\n        _this.backgroundElement.style.opacity = 1;\n        _this.domElement.style.opacity = 1;\n        _this.domElement.style.webkitTransform = 'scale(1)';\n      });\n    }\n  }, {\n    key: 'hide',\n    value: function hide() {\n      var _this = this;\n      var hide = function hide() {\n        _this.domElement.style.display = 'none';\n        _this.backgroundElement.style.display = 'none';\n        dom.unbind(_this.domElement, 'webkitTransitionEnd', hide);\n        dom.unbind(_this.domElement, 'transitionend', hide);\n        dom.unbind(_this.domElement, 'oTransitionEnd', hide);\n      };\n      dom.bind(this.domElement, 'webkitTransitionEnd', hide);\n      dom.bind(this.domElement, 'transitionend', hide);\n      dom.bind(this.domElement, 'oTransitionEnd', hide);\n      this.backgroundElement.style.opacity = 0;\n      this.domElement.style.opacity = 0;\n      this.domElement.style.webkitTransform = 'scale(1.1)';\n    }\n  }, {\n    key: 'layout',\n    value: function layout() {\n      this.domElement.style.left = window.innerWidth / 2 - dom.getWidth(this.domElement) / 2 + 'px';\n      this.domElement.style.top = window.innerHeight / 2 - dom.getHeight(this.domElement) / 2 + 'px';\n    }\n  }]);\n  return CenteredDiv;\n}();\n\nvar styleSheet = ___$insertStyle(\".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\\n\");\n\ncss.inject(styleSheet);\nvar CSS_NAMESPACE = 'dg';\nvar HIDE_KEY_CODE = 72;\nvar CLOSE_BUTTON_HEIGHT = 20;\nvar DEFAULT_DEFAULT_PRESET_NAME = 'Default';\nvar SUPPORTS_LOCAL_STORAGE = function () {\n  try {\n    return !!window.localStorage;\n  } catch (e) {\n    return false;\n  }\n}();\nvar SAVE_DIALOGUE = void 0;\nvar autoPlaceVirgin = true;\nvar autoPlaceContainer = void 0;\nvar hide = false;\nvar hideableGuis = [];\nvar GUI = function GUI(pars) {\n  var _this = this;\n  var params = pars || {};\n  this.domElement = document.createElement('div');\n  this.__ul = document.createElement('ul');\n  this.domElement.appendChild(this.__ul);\n  dom.addClass(this.domElement, CSS_NAMESPACE);\n  this.__folders = {};\n  this.__controllers = [];\n  this.__rememberedObjects = [];\n  this.__rememberedObjectIndecesToControllers = [];\n  this.__listening = [];\n  params = Common.defaults(params, {\n    closeOnTop: false,\n    autoPlace: true,\n    width: GUI.DEFAULT_WIDTH\n  });\n  params = Common.defaults(params, {\n    resizable: params.autoPlace,\n    hideable: params.autoPlace\n  });\n  if (!Common.isUndefined(params.load)) {\n    if (params.preset) {\n      params.load.preset = params.preset;\n    }\n  } else {\n    params.load = { preset: DEFAULT_DEFAULT_PRESET_NAME };\n  }\n  if (Common.isUndefined(params.parent) && params.hideable) {\n    hideableGuis.push(this);\n  }\n  params.resizable = Common.isUndefined(params.parent) && params.resizable;\n  if (params.autoPlace && Common.isUndefined(params.scrollable)) {\n    params.scrollable = true;\n  }\n  var useLocalStorage = SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(this, 'isLocal')) === 'true';\n  var saveToLocalStorage = void 0;\n  var titleRow = void 0;\n  Object.defineProperties(this,\n  {\n    parent: {\n      get: function get$$1() {\n        return params.parent;\n      }\n    },\n    scrollable: {\n      get: function get$$1() {\n        return params.scrollable;\n      }\n    },\n    autoPlace: {\n      get: function get$$1() {\n        return params.autoPlace;\n      }\n    },\n    closeOnTop: {\n      get: function get$$1() {\n        return params.closeOnTop;\n      }\n    },\n    preset: {\n      get: function get$$1() {\n        if (_this.parent) {\n          return _this.getRoot().preset;\n        }\n        return params.load.preset;\n      },\n      set: function set$$1(v) {\n        if (_this.parent) {\n          _this.getRoot().preset = v;\n        } else {\n          params.load.preset = v;\n        }\n        setPresetSelectIndex(this);\n        _this.revert();\n      }\n    },\n    width: {\n      get: function get$$1() {\n        return params.width;\n      },\n      set: function set$$1(v) {\n        params.width = v;\n        setWidth(_this, v);\n      }\n    },\n    name: {\n      get: function get$$1() {\n        return params.name;\n      },\n      set: function set$$1(v) {\n        params.name = v;\n        if (titleRow) {\n          titleRow.innerHTML = params.name;\n        }\n      }\n    },\n    closed: {\n      get: function get$$1() {\n        return params.closed;\n      },\n      set: function set$$1(v) {\n        params.closed = v;\n        if (params.closed) {\n          dom.addClass(_this.__ul, GUI.CLASS_CLOSED);\n        } else {\n          dom.removeClass(_this.__ul, GUI.CLASS_CLOSED);\n        }\n        this.onResize();\n        if (_this.__closeButton) {\n          _this.__closeButton.innerHTML = v ? GUI.TEXT_OPEN : GUI.TEXT_CLOSED;\n        }\n      }\n    },\n    load: {\n      get: function get$$1() {\n        return params.load;\n      }\n    },\n    useLocalStorage: {\n      get: function get$$1() {\n        return useLocalStorage;\n      },\n      set: function set$$1(bool) {\n        if (SUPPORTS_LOCAL_STORAGE) {\n          useLocalStorage = bool;\n          if (bool) {\n            dom.bind(window, 'unload', saveToLocalStorage);\n          } else {\n            dom.unbind(window, 'unload', saveToLocalStorage);\n          }\n          localStorage.setItem(getLocalStorageHash(_this, 'isLocal'), bool);\n        }\n      }\n    }\n  });\n  if (Common.isUndefined(params.parent)) {\n    this.closed = params.closed || false;\n    dom.addClass(this.domElement, GUI.CLASS_MAIN);\n    dom.makeSelectable(this.domElement, false);\n    if (SUPPORTS_LOCAL_STORAGE) {\n      if (useLocalStorage) {\n        _this.useLocalStorage = true;\n        var savedGui = localStorage.getItem(getLocalStorageHash(this, 'gui'));\n        if (savedGui) {\n          params.load = JSON.parse(savedGui);\n        }\n      }\n    }\n    this.__closeButton = document.createElement('div');\n    this.__closeButton.innerHTML = GUI.TEXT_CLOSED;\n    dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BUTTON);\n    if (params.closeOnTop) {\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_TOP);\n      this.domElement.insertBefore(this.__closeButton, this.domElement.childNodes[0]);\n    } else {\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BOTTOM);\n      this.domElement.appendChild(this.__closeButton);\n    }\n    dom.bind(this.__closeButton, 'click', function () {\n      _this.closed = !_this.closed;\n    });\n  } else {\n    if (params.closed === undefined) {\n      params.closed = true;\n    }\n    var titleRowName = document.createTextNode(params.name);\n    dom.addClass(titleRowName, 'controller-name');\n    titleRow = addRow(_this, titleRowName);\n    var onClickTitle = function onClickTitle(e) {\n      e.preventDefault();\n      _this.closed = !_this.closed;\n      return false;\n    };\n    dom.addClass(this.__ul, GUI.CLASS_CLOSED);\n    dom.addClass(titleRow, 'title');\n    dom.bind(titleRow, 'click', onClickTitle);\n    if (!params.closed) {\n      this.closed = false;\n    }\n  }\n  if (params.autoPlace) {\n    if (Common.isUndefined(params.parent)) {\n      if (autoPlaceVirgin) {\n        autoPlaceContainer = document.createElement('div');\n        dom.addClass(autoPlaceContainer, CSS_NAMESPACE);\n        dom.addClass(autoPlaceContainer, GUI.CLASS_AUTO_PLACE_CONTAINER);\n        document.body.appendChild(autoPlaceContainer);\n        autoPlaceVirgin = false;\n      }\n      autoPlaceContainer.appendChild(this.domElement);\n      dom.addClass(this.domElement, GUI.CLASS_AUTO_PLACE);\n    }\n    if (!this.parent) {\n      setWidth(_this, params.width);\n    }\n  }\n  this.__resizeHandler = function () {\n    _this.onResizeDebounced();\n  };\n  dom.bind(window, 'resize', this.__resizeHandler);\n  dom.bind(this.__ul, 'webkitTransitionEnd', this.__resizeHandler);\n  dom.bind(this.__ul, 'transitionend', this.__resizeHandler);\n  dom.bind(this.__ul, 'oTransitionEnd', this.__resizeHandler);\n  this.onResize();\n  if (params.resizable) {\n    addResizeHandle(this);\n  }\n  saveToLocalStorage = function saveToLocalStorage() {\n    if (SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(_this, 'isLocal')) === 'true') {\n      localStorage.setItem(getLocalStorageHash(_this, 'gui'), JSON.stringify(_this.getSaveObject()));\n    }\n  };\n  this.saveToLocalStorageIfPossible = saveToLocalStorage;\n  function resetWidth() {\n    var root = _this.getRoot();\n    root.width += 1;\n    Common.defer(function () {\n      root.width -= 1;\n    });\n  }\n  if (!params.parent) {\n    resetWidth();\n  }\n};\nGUI.toggleHide = function () {\n  hide = !hide;\n  Common.each(hideableGuis, function (gui) {\n    gui.domElement.style.display = hide ? 'none' : '';\n  });\n};\nGUI.CLASS_AUTO_PLACE = 'a';\nGUI.CLASS_AUTO_PLACE_CONTAINER = 'ac';\nGUI.CLASS_MAIN = 'main';\nGUI.CLASS_CONTROLLER_ROW = 'cr';\nGUI.CLASS_TOO_TALL = 'taller-than-window';\nGUI.CLASS_CLOSED = 'closed';\nGUI.CLASS_CLOSE_BUTTON = 'close-button';\nGUI.CLASS_CLOSE_TOP = 'close-top';\nGUI.CLASS_CLOSE_BOTTOM = 'close-bottom';\nGUI.CLASS_DRAG = 'drag';\nGUI.DEFAULT_WIDTH = 245;\nGUI.TEXT_CLOSED = 'Close Controls';\nGUI.TEXT_OPEN = 'Open Controls';\nGUI._keydownHandler = function (e) {\n  if (document.activeElement.type !== 'text' && (e.which === HIDE_KEY_CODE || e.keyCode === HIDE_KEY_CODE)) {\n    GUI.toggleHide();\n  }\n};\ndom.bind(window, 'keydown', GUI._keydownHandler, false);\nCommon.extend(GUI.prototype,\n{\n  add: function add(object, property) {\n    return _add(this, object, property, {\n      factoryArgs: Array.prototype.slice.call(arguments, 2)\n    });\n  },\n  addColor: function addColor(object, property) {\n    return _add(this, object, property, {\n      color: true\n    });\n  },\n  remove: function remove(controller) {\n    this.__ul.removeChild(controller.__li);\n    this.__controllers.splice(this.__controllers.indexOf(controller), 1);\n    var _this = this;\n    Common.defer(function () {\n      _this.onResize();\n    });\n  },\n  destroy: function destroy() {\n    if (this.parent) {\n      throw new Error('Only the root GUI should be removed with .destroy(). ' + 'For subfolders, use gui.removeFolder(folder) instead.');\n    }\n    if (this.autoPlace) {\n      autoPlaceContainer.removeChild(this.domElement);\n    }\n    var _this = this;\n    Common.each(this.__folders, function (subfolder) {\n      _this.removeFolder(subfolder);\n    });\n    dom.unbind(window, 'keydown', GUI._keydownHandler, false);\n    removeListeners(this);\n  },\n  addFolder: function addFolder(name) {\n    if (this.__folders[name] !== undefined) {\n      throw new Error('You already have a folder in this GUI by the' + ' name \"' + name + '\"');\n    }\n    var newGuiParams = { name: name, parent: this };\n    newGuiParams.autoPlace = this.autoPlace;\n    if (this.load &&\n    this.load.folders &&\n    this.load.folders[name]) {\n      newGuiParams.closed = this.load.folders[name].closed;\n      newGuiParams.load = this.load.folders[name];\n    }\n    var gui = new GUI(newGuiParams);\n    this.__folders[name] = gui;\n    var li = addRow(this, gui.domElement);\n    dom.addClass(li, 'folder');\n    return gui;\n  },\n  removeFolder: function removeFolder(folder) {\n    this.__ul.removeChild(folder.domElement.parentElement);\n    delete this.__folders[folder.name];\n    if (this.load &&\n    this.load.folders &&\n    this.load.folders[folder.name]) {\n      delete this.load.folders[folder.name];\n    }\n    removeListeners(folder);\n    var _this = this;\n    Common.each(folder.__folders, function (subfolder) {\n      folder.removeFolder(subfolder);\n    });\n    Common.defer(function () {\n      _this.onResize();\n    });\n  },\n  open: function open() {\n    this.closed = false;\n  },\n  close: function close() {\n    this.closed = true;\n  },\n  hide: function hide() {\n    this.domElement.style.display = 'none';\n  },\n  show: function show() {\n    this.domElement.style.display = '';\n  },\n  onResize: function onResize() {\n    var root = this.getRoot();\n    if (root.scrollable) {\n      var top = dom.getOffset(root.__ul).top;\n      var h = 0;\n      Common.each(root.__ul.childNodes, function (node) {\n        if (!(root.autoPlace && node === root.__save_row)) {\n          h += dom.getHeight(node);\n        }\n      });\n      if (window.innerHeight - top - CLOSE_BUTTON_HEIGHT < h) {\n        dom.addClass(root.domElement, GUI.CLASS_TOO_TALL);\n        root.__ul.style.height = window.innerHeight - top - CLOSE_BUTTON_HEIGHT + 'px';\n      } else {\n        dom.removeClass(root.domElement, GUI.CLASS_TOO_TALL);\n        root.__ul.style.height = 'auto';\n      }\n    }\n    if (root.__resize_handle) {\n      Common.defer(function () {\n        root.__resize_handle.style.height = root.__ul.offsetHeight + 'px';\n      });\n    }\n    if (root.__closeButton) {\n      root.__closeButton.style.width = root.width + 'px';\n    }\n  },\n  onResizeDebounced: Common.debounce(function () {\n    this.onResize();\n  }, 50),\n  remember: function remember() {\n    if (Common.isUndefined(SAVE_DIALOGUE)) {\n      SAVE_DIALOGUE = new CenteredDiv();\n      SAVE_DIALOGUE.domElement.innerHTML = saveDialogContents;\n    }\n    if (this.parent) {\n      throw new Error('You can only call remember on a top level GUI.');\n    }\n    var _this = this;\n    Common.each(Array.prototype.slice.call(arguments), function (object) {\n      if (_this.__rememberedObjects.length === 0) {\n        addSaveMenu(_this);\n      }\n      if (_this.__rememberedObjects.indexOf(object) === -1) {\n        _this.__rememberedObjects.push(object);\n      }\n    });\n    if (this.autoPlace) {\n      setWidth(this, this.width);\n    }\n  },\n  getRoot: function getRoot() {\n    var gui = this;\n    while (gui.parent) {\n      gui = gui.parent;\n    }\n    return gui;\n  },\n  getSaveObject: function getSaveObject() {\n    var toReturn = this.load;\n    toReturn.closed = this.closed;\n    if (this.__rememberedObjects.length > 0) {\n      toReturn.preset = this.preset;\n      if (!toReturn.remembered) {\n        toReturn.remembered = {};\n      }\n      toReturn.remembered[this.preset] = getCurrentPreset(this);\n    }\n    toReturn.folders = {};\n    Common.each(this.__folders, function (element, key) {\n      toReturn.folders[key] = element.getSaveObject();\n    });\n    return toReturn;\n  },\n  save: function save() {\n    if (!this.load.remembered) {\n      this.load.remembered = {};\n    }\n    this.load.remembered[this.preset] = getCurrentPreset(this);\n    markPresetModified(this, false);\n    this.saveToLocalStorageIfPossible();\n  },\n  saveAs: function saveAs(presetName) {\n    if (!this.load.remembered) {\n      this.load.remembered = {};\n      this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME] = getCurrentPreset(this, true);\n    }\n    this.load.remembered[presetName] = getCurrentPreset(this);\n    this.preset = presetName;\n    addPresetOption(this, presetName, true);\n    this.saveToLocalStorageIfPossible();\n  },\n  revert: function revert(gui) {\n    Common.each(this.__controllers, function (controller) {\n      if (!this.getRoot().load.remembered) {\n        controller.setValue(controller.initialValue);\n      } else {\n        recallSavedValue(gui || this.getRoot(), controller);\n      }\n      if (controller.__onFinishChange) {\n        controller.__onFinishChange.call(controller, controller.getValue());\n      }\n    }, this);\n    Common.each(this.__folders, function (folder) {\n      folder.revert(folder);\n    });\n    if (!gui) {\n      markPresetModified(this.getRoot(), false);\n    }\n  },\n  listen: function listen(controller) {\n    var init = this.__listening.length === 0;\n    this.__listening.push(controller);\n    if (init) {\n      updateDisplays(this.__listening);\n    }\n  },\n  updateDisplay: function updateDisplay() {\n    Common.each(this.__controllers, function (controller) {\n      controller.updateDisplay();\n    });\n    Common.each(this.__folders, function (folder) {\n      folder.updateDisplay();\n    });\n  }\n});\nfunction addRow(gui, newDom, liBefore) {\n  var li = document.createElement('li');\n  if (newDom) {\n    li.appendChild(newDom);\n  }\n  if (liBefore) {\n    gui.__ul.insertBefore(li, liBefore);\n  } else {\n    gui.__ul.appendChild(li);\n  }\n  gui.onResize();\n  return li;\n}\nfunction removeListeners(gui) {\n  dom.unbind(window, 'resize', gui.__resizeHandler);\n  if (gui.saveToLocalStorageIfPossible) {\n    dom.unbind(window, 'unload', gui.saveToLocalStorageIfPossible);\n  }\n}\nfunction markPresetModified(gui, modified) {\n  var opt = gui.__preset_select[gui.__preset_select.selectedIndex];\n  if (modified) {\n    opt.innerHTML = opt.value + '*';\n  } else {\n    opt.innerHTML = opt.value;\n  }\n}\nfunction augmentController(gui, li, controller) {\n  controller.__li = li;\n  controller.__gui = gui;\n  Common.extend(controller,                                   {\n    options: function options(_options) {\n      if (arguments.length > 1) {\n        var nextSibling = controller.__li.nextElementSibling;\n        controller.remove();\n        return _add(gui, controller.object, controller.property, {\n          before: nextSibling,\n          factoryArgs: [Common.toArray(arguments)]\n        });\n      }\n      if (Common.isArray(_options) || Common.isObject(_options)) {\n        var _nextSibling = controller.__li.nextElementSibling;\n        controller.remove();\n        return _add(gui, controller.object, controller.property, {\n          before: _nextSibling,\n          factoryArgs: [_options]\n        });\n      }\n    },\n    name: function name(_name) {\n      controller.__li.firstElementChild.firstElementChild.innerHTML = _name;\n      return controller;\n    },\n    listen: function listen() {\n      controller.__gui.listen(controller);\n      return controller;\n    },\n    remove: function remove() {\n      controller.__gui.remove(controller);\n      return controller;\n    }\n  });\n  if (controller instanceof NumberControllerSlider) {\n    var box = new NumberControllerBox(controller.object, controller.property, { min: controller.__min, max: controller.__max, step: controller.__step });\n    Common.each(['updateDisplay', 'onChange', 'onFinishChange', 'step', 'min', 'max'], function (method) {\n      var pc = controller[method];\n      var pb = box[method];\n      controller[method] = box[method] = function () {\n        var args = Array.prototype.slice.call(arguments);\n        pb.apply(box, args);\n        return pc.apply(controller, args);\n      };\n    });\n    dom.addClass(li, 'has-slider');\n    controller.domElement.insertBefore(box.domElement, controller.domElement.firstElementChild);\n  } else if (controller instanceof NumberControllerBox) {\n    var r = function r(returned) {\n      if (Common.isNumber(controller.__min) && Common.isNumber(controller.__max)) {\n        var oldName = controller.__li.firstElementChild.firstElementChild.innerHTML;\n        var wasListening = controller.__gui.__listening.indexOf(controller) > -1;\n        controller.remove();\n        var newController = _add(gui, controller.object, controller.property, {\n          before: controller.__li.nextElementSibling,\n          factoryArgs: [controller.__min, controller.__max, controller.__step]\n        });\n        newController.name(oldName);\n        if (wasListening) newController.listen();\n        return newController;\n      }\n      return returned;\n    };\n    controller.min = Common.compose(r, controller.min);\n    controller.max = Common.compose(r, controller.max);\n  } else if (controller instanceof BooleanController) {\n    dom.bind(li, 'click', function () {\n      dom.fakeEvent(controller.__checkbox, 'click');\n    });\n    dom.bind(controller.__checkbox, 'click', function (e) {\n      e.stopPropagation();\n    });\n  } else if (controller instanceof FunctionController) {\n    dom.bind(li, 'click', function () {\n      dom.fakeEvent(controller.__button, 'click');\n    });\n    dom.bind(li, 'mouseover', function () {\n      dom.addClass(controller.__button, 'hover');\n    });\n    dom.bind(li, 'mouseout', function () {\n      dom.removeClass(controller.__button, 'hover');\n    });\n  } else if (controller instanceof ColorController) {\n    dom.addClass(li, 'color');\n    controller.updateDisplay = Common.compose(function (val) {\n      li.style.borderLeftColor = controller.__color.toString();\n      return val;\n    }, controller.updateDisplay);\n    controller.updateDisplay();\n  }\n  controller.setValue = Common.compose(function (val) {\n    if (gui.getRoot().__preset_select && controller.isModified()) {\n      markPresetModified(gui.getRoot(), true);\n    }\n    return val;\n  }, controller.setValue);\n}\nfunction recallSavedValue(gui, controller) {\n  var root = gui.getRoot();\n  var matchedIndex = root.__rememberedObjects.indexOf(controller.object);\n  if (matchedIndex !== -1) {\n    var controllerMap = root.__rememberedObjectIndecesToControllers[matchedIndex];\n    if (controllerMap === undefined) {\n      controllerMap = {};\n      root.__rememberedObjectIndecesToControllers[matchedIndex] = controllerMap;\n    }\n    controllerMap[controller.property] = controller;\n    if (root.load && root.load.remembered) {\n      var presetMap = root.load.remembered;\n      var preset = void 0;\n      if (presetMap[gui.preset]) {\n        preset = presetMap[gui.preset];\n      } else if (presetMap[DEFAULT_DEFAULT_PRESET_NAME]) {\n        preset = presetMap[DEFAULT_DEFAULT_PRESET_NAME];\n      } else {\n        return;\n      }\n      if (preset[matchedIndex] && preset[matchedIndex][controller.property] !== undefined) {\n        var value = preset[matchedIndex][controller.property];\n        controller.initialValue = value;\n        controller.setValue(value);\n      }\n    }\n  }\n}\nfunction _add(gui, object, property, params) {\n  if (object[property] === undefined) {\n    throw new Error('Object \"' + object + '\" has no property \"' + property + '\"');\n  }\n  var controller = void 0;\n  if (params.color) {\n    controller = new ColorController(object, property);\n  } else {\n    var factoryArgs = [object, property].concat(params.factoryArgs);\n    controller = ControllerFactory.apply(gui, factoryArgs);\n  }\n  if (params.before instanceof Controller) {\n    params.before = params.before.__li;\n  }\n  recallSavedValue(gui, controller);\n  dom.addClass(controller.domElement, 'c');\n  var name = document.createElement('span');\n  dom.addClass(name, 'property-name');\n  name.innerHTML = controller.property;\n  var container = document.createElement('div');\n  container.appendChild(name);\n  container.appendChild(controller.domElement);\n  var li = addRow(gui, container, params.before);\n  dom.addClass(li, GUI.CLASS_CONTROLLER_ROW);\n  if (controller instanceof ColorController) {\n    dom.addClass(li, 'color');\n  } else {\n    dom.addClass(li, _typeof(controller.getValue()));\n  }\n  augmentController(gui, li, controller);\n  gui.__controllers.push(controller);\n  return controller;\n}\nfunction getLocalStorageHash(gui, key) {\n  return document.location.href + '.' + key;\n}\nfunction addPresetOption(gui, name, setSelected) {\n  var opt = document.createElement('option');\n  opt.innerHTML = name;\n  opt.value = name;\n  gui.__preset_select.appendChild(opt);\n  if (setSelected) {\n    gui.__preset_select.selectedIndex = gui.__preset_select.length - 1;\n  }\n}\nfunction showHideExplain(gui, explain) {\n  explain.style.display = gui.useLocalStorage ? 'block' : 'none';\n}\nfunction addSaveMenu(gui) {\n  var div = gui.__save_row = document.createElement('li');\n  dom.addClass(gui.domElement, 'has-save');\n  gui.__ul.insertBefore(div, gui.__ul.firstChild);\n  dom.addClass(div, 'save-row');\n  var gears = document.createElement('span');\n  gears.innerHTML = '&nbsp;';\n  dom.addClass(gears, 'button gears');\n  var button = document.createElement('span');\n  button.innerHTML = 'Save';\n  dom.addClass(button, 'button');\n  dom.addClass(button, 'save');\n  var button2 = document.createElement('span');\n  button2.innerHTML = 'New';\n  dom.addClass(button2, 'button');\n  dom.addClass(button2, 'save-as');\n  var button3 = document.createElement('span');\n  button3.innerHTML = 'Revert';\n  dom.addClass(button3, 'button');\n  dom.addClass(button3, 'revert');\n  var select = gui.__preset_select = document.createElement('select');\n  if (gui.load && gui.load.remembered) {\n    Common.each(gui.load.remembered, function (value, key) {\n      addPresetOption(gui, key, key === gui.preset);\n    });\n  } else {\n    addPresetOption(gui, DEFAULT_DEFAULT_PRESET_NAME, false);\n  }\n  dom.bind(select, 'change', function () {\n    for (var index = 0; index < gui.__preset_select.length; index++) {\n      gui.__preset_select[index].innerHTML = gui.__preset_select[index].value;\n    }\n    gui.preset = this.value;\n  });\n  div.appendChild(select);\n  div.appendChild(gears);\n  div.appendChild(button);\n  div.appendChild(button2);\n  div.appendChild(button3);\n  if (SUPPORTS_LOCAL_STORAGE) {\n    var explain = document.getElementById('dg-local-explain');\n    var localStorageCheckBox = document.getElementById('dg-local-storage');\n    var saveLocally = document.getElementById('dg-save-locally');\n    saveLocally.style.display = 'block';\n    if (localStorage.getItem(getLocalStorageHash(gui, 'isLocal')) === 'true') {\n      localStorageCheckBox.setAttribute('checked', 'checked');\n    }\n    showHideExplain(gui, explain);\n    dom.bind(localStorageCheckBox, 'change', function () {\n      gui.useLocalStorage = !gui.useLocalStorage;\n      showHideExplain(gui, explain);\n    });\n  }\n  var newConstructorTextArea = document.getElementById('dg-new-constructor');\n  dom.bind(newConstructorTextArea, 'keydown', function (e) {\n    if (e.metaKey && (e.which === 67 || e.keyCode === 67)) {\n      SAVE_DIALOGUE.hide();\n    }\n  });\n  dom.bind(gears, 'click', function () {\n    newConstructorTextArea.innerHTML = JSON.stringify(gui.getSaveObject(), undefined, 2);\n    SAVE_DIALOGUE.show();\n    newConstructorTextArea.focus();\n    newConstructorTextArea.select();\n  });\n  dom.bind(button, 'click', function () {\n    gui.save();\n  });\n  dom.bind(button2, 'click', function () {\n    var presetName = prompt('Enter a new preset name.');\n    if (presetName) {\n      gui.saveAs(presetName);\n    }\n  });\n  dom.bind(button3, 'click', function () {\n    gui.revert();\n  });\n}\nfunction addResizeHandle(gui) {\n  var pmouseX = void 0;\n  gui.__resize_handle = document.createElement('div');\n  Common.extend(gui.__resize_handle.style, {\n    width: '6px',\n    marginLeft: '-3px',\n    height: '200px',\n    cursor: 'ew-resize',\n    position: 'absolute'\n  });\n  function drag(e) {\n    e.preventDefault();\n    gui.width += pmouseX - e.clientX;\n    gui.onResize();\n    pmouseX = e.clientX;\n    return false;\n  }\n  function dragStop() {\n    dom.removeClass(gui.__closeButton, GUI.CLASS_DRAG);\n    dom.unbind(window, 'mousemove', drag);\n    dom.unbind(window, 'mouseup', dragStop);\n  }\n  function dragStart(e) {\n    e.preventDefault();\n    pmouseX = e.clientX;\n    dom.addClass(gui.__closeButton, GUI.CLASS_DRAG);\n    dom.bind(window, 'mousemove', drag);\n    dom.bind(window, 'mouseup', dragStop);\n    return false;\n  }\n  dom.bind(gui.__resize_handle, 'mousedown', dragStart);\n  dom.bind(gui.__closeButton, 'mousedown', dragStart);\n  gui.domElement.insertBefore(gui.__resize_handle, gui.domElement.firstElementChild);\n}\nfunction setWidth(gui, w) {\n  gui.domElement.style.width = w + 'px';\n  if (gui.__save_row && gui.autoPlace) {\n    gui.__save_row.style.width = w + 'px';\n  }\n  if (gui.__closeButton) {\n    gui.__closeButton.style.width = w + 'px';\n  }\n}\nfunction getCurrentPreset(gui, useInitialValues) {\n  var toReturn = {};\n  Common.each(gui.__rememberedObjects, function (val, index) {\n    var savedValues = {};\n    var controllerMap = gui.__rememberedObjectIndecesToControllers[index];\n    Common.each(controllerMap, function (controller, property) {\n      savedValues[property] = useInitialValues ? controller.initialValue : controller.getValue();\n    });\n    toReturn[index] = savedValues;\n  });\n  return toReturn;\n}\nfunction setPresetSelectIndex(gui) {\n  for (var index = 0; index < gui.__preset_select.length; index++) {\n    if (gui.__preset_select[index].value === gui.preset) {\n      gui.__preset_select.selectedIndex = index;\n    }\n  }\n}\nfunction updateDisplays(controllerArray) {\n  if (controllerArray.length !== 0) {\n    requestAnimationFrame$1.call(window, function () {\n      updateDisplays(controllerArray);\n    });\n  }\n  Common.each(controllerArray, function (c) {\n    c.updateDisplay();\n  });\n}\n\nvar color = {\n  Color: Color,\n  math: ColorMath,\n  interpret: interpret\n};\nvar controllers = {\n  Controller: Controller,\n  BooleanController: BooleanController,\n  OptionController: OptionController,\n  StringController: StringController,\n  NumberController: NumberController,\n  NumberControllerBox: NumberControllerBox,\n  NumberControllerSlider: NumberControllerSlider,\n  FunctionController: FunctionController,\n  ColorController: ColorController\n};\nvar dom$1 = { dom: dom };\nvar gui = { GUI: GUI };\nvar GUI$1 = GUI;\nvar index = {\n  color: color,\n  controllers: controllers,\n  dom: dom$1,\n  gui: gui,\n  GUI: GUI$1\n};\n\nexport { color, controllers, dom$1 as dom, gui, GUI$1 as GUI };\nexport default index;\n//# sourceMappingURL=dat.gui.module.js.map\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// This is CodeMirror (https://codemirror.net), a code editor\n// implemented in JavaScript on top of the browser's DOM.\n//\n// You can find some technical background for some of the code below\n// at http://marijnhaverbeke.nl/blog/#cm-internals .\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.CodeMirror = factory());\n}(this, (function () { 'use strict';\n\n  // Kludges for bugs and behavior differences that can't be feature\n  // detected are enabled based on userAgent etc sniffing.\n  var userAgent = navigator.userAgent;\n  var platform = navigator.platform;\n\n  var gecko = /gecko\\/\\d/i.test(userAgent);\n  var ie_upto10 = /MSIE \\d/.test(userAgent);\n  var ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(userAgent);\n  var edge = /Edge\\/(\\d+)/.exec(userAgent);\n  var ie = ie_upto10 || ie_11up || edge;\n  var ie_version = ie && (ie_upto10 ? document.documentMode || 6 : +(edge || ie_11up)[1]);\n  var webkit = !edge && /WebKit\\//.test(userAgent);\n  var qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(userAgent);\n  var chrome = !edge && /Chrome\\//.test(userAgent);\n  var presto = /Opera\\//.test(userAgent);\n  var safari = /Apple Computer/.test(navigator.vendor);\n  var mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(userAgent);\n  var phantom = /PhantomJS/.test(userAgent);\n\n  var ios = !edge && /AppleWebKit/.test(userAgent) && /Mobile\\/\\w+/.test(userAgent);\n  var android = /Android/.test(userAgent);\n  // This is woefully incomplete. Suggestions for alternative methods welcome.\n  var mobile = ios || android || /webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);\n  var mac = ios || /Mac/.test(platform);\n  var chromeOS = /\\bCrOS\\b/.test(userAgent);\n  var windows = /win/i.test(platform);\n\n  var presto_version = presto && userAgent.match(/Version\\/(\\d*\\.\\d*)/);\n  if (presto_version) { presto_version = Number(presto_version[1]); }\n  if (presto_version && presto_version >= 15) { presto = false; webkit = true; }\n  // Some browsers use the wrong event properties to signal cmd/ctrl on OS X\n  var flipCtrlCmd = mac && (qtwebkit || presto && (presto_version == null || presto_version < 12.11));\n  var captureRightClick = gecko || (ie && ie_version >= 9);\n\n  function classTest(cls) { return new RegExp(\"(^|\\\\s)\" + cls + \"(?:$|\\\\s)\\\\s*\") }\n\n  var rmClass = function(node, cls) {\n    var current = node.className;\n    var match = classTest(cls).exec(current);\n    if (match) {\n      var after = current.slice(match.index + match[0].length);\n      node.className = current.slice(0, match.index) + (after ? match[1] + after : \"\");\n    }\n  };\n\n  function removeChildren(e) {\n    for (var count = e.childNodes.length; count > 0; --count)\n      { e.removeChild(e.firstChild); }\n    return e\n  }\n\n  function removeChildrenAndAdd(parent, e) {\n    return removeChildren(parent).appendChild(e)\n  }\n\n  function elt(tag, content, className, style) {\n    var e = document.createElement(tag);\n    if (className) { e.className = className; }\n    if (style) { e.style.cssText = style; }\n    if (typeof content == \"string\") { e.appendChild(document.createTextNode(content)); }\n    else if (content) { for (var i = 0; i < content.length; ++i) { e.appendChild(content[i]); } }\n    return e\n  }\n  // wrapper for elt, which removes the elt from the accessibility tree\n  function eltP(tag, content, className, style) {\n    var e = elt(tag, content, className, style);\n    e.setAttribute(\"role\", \"presentation\");\n    return e\n  }\n\n  var range;\n  if (document.createRange) { range = function(node, start, end, endNode) {\n    var r = document.createRange();\n    r.setEnd(endNode || node, end);\n    r.setStart(node, start);\n    return r\n  }; }\n  else { range = function(node, start, end) {\n    var r = document.body.createTextRange();\n    try { r.moveToElementText(node.parentNode); }\n    catch(e) { return r }\n    r.collapse(true);\n    r.moveEnd(\"character\", end);\n    r.moveStart(\"character\", start);\n    return r\n  }; }\n\n  function contains(parent, child) {\n    if (child.nodeType == 3) // Android browser always returns false when child is a textnode\n      { child = child.parentNode; }\n    if (parent.contains)\n      { return parent.contains(child) }\n    do {\n      if (child.nodeType == 11) { child = child.host; }\n      if (child == parent) { return true }\n    } while (child = child.parentNode)\n  }\n\n  function activeElt() {\n    // IE and Edge may throw an \"Unspecified Error\" when accessing document.activeElement.\n    // IE < 10 will throw when accessed while the page is loading or in an iframe.\n    // IE > 9 and Edge will throw when accessed in an iframe if document.body is unavailable.\n    var activeElement;\n    try {\n      activeElement = document.activeElement;\n    } catch(e) {\n      activeElement = document.body || null;\n    }\n    while (activeElement && activeElement.shadowRoot && activeElement.shadowRoot.activeElement)\n      { activeElement = activeElement.shadowRoot.activeElement; }\n    return activeElement\n  }\n\n  function addClass(node, cls) {\n    var current = node.className;\n    if (!classTest(cls).test(current)) { node.className += (current ? \" \" : \"\") + cls; }\n  }\n  function joinClasses(a, b) {\n    var as = a.split(\" \");\n    for (var i = 0; i < as.length; i++)\n      { if (as[i] && !classTest(as[i]).test(b)) { b += \" \" + as[i]; } }\n    return b\n  }\n\n  var selectInput = function(node) { node.select(); };\n  if (ios) // Mobile Safari apparently has a bug where select() is broken.\n    { selectInput = function(node) { node.selectionStart = 0; node.selectionEnd = node.value.length; }; }\n  else if (ie) // Suppress mysterious IE10 errors\n    { selectInput = function(node) { try { node.select(); } catch(_e) {} }; }\n\n  function bind(f) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    return function(){return f.apply(null, args)}\n  }\n\n  function copyObj(obj, target, overwrite) {\n    if (!target) { target = {}; }\n    for (var prop in obj)\n      { if (obj.hasOwnProperty(prop) && (overwrite !== false || !target.hasOwnProperty(prop)))\n        { target[prop] = obj[prop]; } }\n    return target\n  }\n\n  // Counts the column offset in a string, taking tabs into account.\n  // Used mostly to find indentation.\n  function countColumn(string, end, tabSize, startIndex, startValue) {\n    if (end == null) {\n      end = string.search(/[^\\s\\u00a0]/);\n      if (end == -1) { end = string.length; }\n    }\n    for (var i = startIndex || 0, n = startValue || 0;;) {\n      var nextTab = string.indexOf(\"\\t\", i);\n      if (nextTab < 0 || nextTab >= end)\n        { return n + (end - i) }\n      n += nextTab - i;\n      n += tabSize - (n % tabSize);\n      i = nextTab + 1;\n    }\n  }\n\n  var Delayed = function() {\n    this.id = null;\n    this.f = null;\n    this.time = 0;\n    this.handler = bind(this.onTimeout, this);\n  };\n  Delayed.prototype.onTimeout = function (self) {\n    self.id = 0;\n    if (self.time <= +new Date) {\n      self.f();\n    } else {\n      setTimeout(self.handler, self.time - +new Date);\n    }\n  };\n  Delayed.prototype.set = function (ms, f) {\n    this.f = f;\n    var time = +new Date + ms;\n    if (!this.id || time < this.time) {\n      clearTimeout(this.id);\n      this.id = setTimeout(this.handler, ms);\n      this.time = time;\n    }\n  };\n\n  function indexOf(array, elt) {\n    for (var i = 0; i < array.length; ++i)\n      { if (array[i] == elt) { return i } }\n    return -1\n  }\n\n  // Number of pixels added to scroller and sizer to hide scrollbar\n  var scrollerGap = 30;\n\n  // Returned or thrown by various protocols to signal 'I'm not\n  // handling this'.\n  var Pass = {toString: function(){return \"CodeMirror.Pass\"}};\n\n  // Reused option objects for setSelection & friends\n  var sel_dontScroll = {scroll: false}, sel_mouse = {origin: \"*mouse\"}, sel_move = {origin: \"+move\"};\n\n  // The inverse of countColumn -- find the offset that corresponds to\n  // a particular column.\n  function findColumn(string, goal, tabSize) {\n    for (var pos = 0, col = 0;;) {\n      var nextTab = string.indexOf(\"\\t\", pos);\n      if (nextTab == -1) { nextTab = string.length; }\n      var skipped = nextTab - pos;\n      if (nextTab == string.length || col + skipped >= goal)\n        { return pos + Math.min(skipped, goal - col) }\n      col += nextTab - pos;\n      col += tabSize - (col % tabSize);\n      pos = nextTab + 1;\n      if (col >= goal) { return pos }\n    }\n  }\n\n  var spaceStrs = [\"\"];\n  function spaceStr(n) {\n    while (spaceStrs.length <= n)\n      { spaceStrs.push(lst(spaceStrs) + \" \"); }\n    return spaceStrs[n]\n  }\n\n  function lst(arr) { return arr[arr.length-1] }\n\n  function map(array, f) {\n    var out = [];\n    for (var i = 0; i < array.length; i++) { out[i] = f(array[i], i); }\n    return out\n  }\n\n  function insertSorted(array, value, score) {\n    var pos = 0, priority = score(value);\n    while (pos < array.length && score(array[pos]) <= priority) { pos++; }\n    array.splice(pos, 0, value);\n  }\n\n  function nothing() {}\n\n  function createObj(base, props) {\n    var inst;\n    if (Object.create) {\n      inst = Object.create(base);\n    } else {\n      nothing.prototype = base;\n      inst = new nothing();\n    }\n    if (props) { copyObj(props, inst); }\n    return inst\n  }\n\n  var nonASCIISingleCaseWordChar = /[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\n  function isWordCharBasic(ch) {\n    return /\\w/.test(ch) || ch > \"\\x80\" &&\n      (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch))\n  }\n  function isWordChar(ch, helper) {\n    if (!helper) { return isWordCharBasic(ch) }\n    if (helper.source.indexOf(\"\\\\w\") > -1 && isWordCharBasic(ch)) { return true }\n    return helper.test(ch)\n  }\n\n  function isEmpty(obj) {\n    for (var n in obj) { if (obj.hasOwnProperty(n) && obj[n]) { return false } }\n    return true\n  }\n\n  // Extending unicode characters. A series of a non-extending char +\n  // any number of extending chars is treated as a single unit as far\n  // as editing and measuring is concerned. This is not fully correct,\n  // since some scripts/fonts/browsers also treat other configurations\n  // of code points as a group.\n  var extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;\n  function isExtendingChar(ch) { return ch.charCodeAt(0) >= 768 && extendingChars.test(ch) }\n\n  // Returns a number from the range [`0`; `str.length`] unless `pos` is outside that range.\n  function skipExtendingChars(str, pos, dir) {\n    while ((dir < 0 ? pos > 0 : pos < str.length) && isExtendingChar(str.charAt(pos))) { pos += dir; }\n    return pos\n  }\n\n  // Returns the value from the range [`from`; `to`] that satisfies\n  // `pred` and is closest to `from`. Assumes that at least `to`\n  // satisfies `pred`. Supports `from` being greater than `to`.\n  function findFirst(pred, from, to) {\n    // At any point we are certain `to` satisfies `pred`, don't know\n    // whether `from` does.\n    var dir = from > to ? -1 : 1;\n    for (;;) {\n      if (from == to) { return from }\n      var midF = (from + to) / 2, mid = dir < 0 ? Math.ceil(midF) : Math.floor(midF);\n      if (mid == from) { return pred(mid) ? from : to }\n      if (pred(mid)) { to = mid; }\n      else { from = mid + dir; }\n    }\n  }\n\n  // BIDI HELPERS\n\n  function iterateBidiSections(order, from, to, f) {\n    if (!order) { return f(from, to, \"ltr\", 0) }\n    var found = false;\n    for (var i = 0; i < order.length; ++i) {\n      var part = order[i];\n      if (part.from < to && part.to > from || from == to && part.to == from) {\n        f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? \"rtl\" : \"ltr\", i);\n        found = true;\n      }\n    }\n    if (!found) { f(from, to, \"ltr\"); }\n  }\n\n  var bidiOther = null;\n  function getBidiPartAt(order, ch, sticky) {\n    var found;\n    bidiOther = null;\n    for (var i = 0; i < order.length; ++i) {\n      var cur = order[i];\n      if (cur.from < ch && cur.to > ch) { return i }\n      if (cur.to == ch) {\n        if (cur.from != cur.to && sticky == \"before\") { found = i; }\n        else { bidiOther = i; }\n      }\n      if (cur.from == ch) {\n        if (cur.from != cur.to && sticky != \"before\") { found = i; }\n        else { bidiOther = i; }\n      }\n    }\n    return found != null ? found : bidiOther\n  }\n\n  // Bidirectional ordering algorithm\n  // See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\n  // that this (partially) implements.\n\n  // One-char codes used for character types:\n  // L (L):   Left-to-Right\n  // R (R):   Right-to-Left\n  // r (AL):  Right-to-Left Arabic\n  // 1 (EN):  European Number\n  // + (ES):  European Number Separator\n  // % (ET):  European Number Terminator\n  // n (AN):  Arabic Number\n  // , (CS):  Common Number Separator\n  // m (NSM): Non-Spacing Mark\n  // b (BN):  Boundary Neutral\n  // s (B):   Paragraph Separator\n  // t (S):   Segment Separator\n  // w (WS):  Whitespace\n  // N (ON):  Other Neutrals\n\n  // Returns null if characters are ordered as they appear\n  // (left-to-right), or an array of sections ({from, to, level}\n  // objects) in the order in which they occur visually.\n  var bidiOrdering = (function() {\n    // Character types for codepoints 0 to 0xff\n    var lowTypes = \"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN\";\n    // Character types for codepoints 0x600 to 0x6f9\n    var arabicTypes = \"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111\";\n    function charType(code) {\n      if (code <= 0xf7) { return lowTypes.charAt(code) }\n      else if (0x590 <= code && code <= 0x5f4) { return \"R\" }\n      else if (0x600 <= code && code <= 0x6f9) { return arabicTypes.charAt(code - 0x600) }\n      else if (0x6ee <= code && code <= 0x8ac) { return \"r\" }\n      else if (0x2000 <= code && code <= 0x200b) { return \"w\" }\n      else if (code == 0x200c) { return \"b\" }\n      else { return \"L\" }\n    }\n\n    var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n    var isNeutral = /[stwN]/, isStrong = /[LRr]/, countsAsLeft = /[Lb1n]/, countsAsNum = /[1n]/;\n\n    function BidiSpan(level, from, to) {\n      this.level = level;\n      this.from = from; this.to = to;\n    }\n\n    return function(str, direction) {\n      var outerType = direction == \"ltr\" ? \"L\" : \"R\";\n\n      if (str.length == 0 || direction == \"ltr\" && !bidiRE.test(str)) { return false }\n      var len = str.length, types = [];\n      for (var i = 0; i < len; ++i)\n        { types.push(charType(str.charCodeAt(i))); }\n\n      // W1. Examine each non-spacing mark (NSM) in the level run, and\n      // change the type of the NSM to the type of the previous\n      // character. If the NSM is at the start of the level run, it will\n      // get the type of sor.\n      for (var i$1 = 0, prev = outerType; i$1 < len; ++i$1) {\n        var type = types[i$1];\n        if (type == \"m\") { types[i$1] = prev; }\n        else { prev = type; }\n      }\n\n      // W2. Search backwards from each instance of a European number\n      // until the first strong type (R, L, AL, or sor) is found. If an\n      // AL is found, change the type of the European number to Arabic\n      // number.\n      // W3. Change all ALs to R.\n      for (var i$2 = 0, cur = outerType; i$2 < len; ++i$2) {\n        var type$1 = types[i$2];\n        if (type$1 == \"1\" && cur == \"r\") { types[i$2] = \"n\"; }\n        else if (isStrong.test(type$1)) { cur = type$1; if (type$1 == \"r\") { types[i$2] = \"R\"; } }\n      }\n\n      // W4. A single European separator between two European numbers\n      // changes to a European number. A single common separator between\n      // two numbers of the same type changes to that type.\n      for (var i$3 = 1, prev$1 = types[0]; i$3 < len - 1; ++i$3) {\n        var type$2 = types[i$3];\n        if (type$2 == \"+\" && prev$1 == \"1\" && types[i$3+1] == \"1\") { types[i$3] = \"1\"; }\n        else if (type$2 == \",\" && prev$1 == types[i$3+1] &&\n                 (prev$1 == \"1\" || prev$1 == \"n\")) { types[i$3] = prev$1; }\n        prev$1 = type$2;\n      }\n\n      // W5. A sequence of European terminators adjacent to European\n      // numbers changes to all European numbers.\n      // W6. Otherwise, separators and terminators change to Other\n      // Neutral.\n      for (var i$4 = 0; i$4 < len; ++i$4) {\n        var type$3 = types[i$4];\n        if (type$3 == \",\") { types[i$4] = \"N\"; }\n        else if (type$3 == \"%\") {\n          var end = (void 0);\n          for (end = i$4 + 1; end < len && types[end] == \"%\"; ++end) {}\n          var replace = (i$4 && types[i$4-1] == \"!\") || (end < len && types[end] == \"1\") ? \"1\" : \"N\";\n          for (var j = i$4; j < end; ++j) { types[j] = replace; }\n          i$4 = end - 1;\n        }\n      }\n\n      // W7. Search backwards from each instance of a European number\n      // until the first strong type (R, L, or sor) is found. If an L is\n      // found, then change the type of the European number to L.\n      for (var i$5 = 0, cur$1 = outerType; i$5 < len; ++i$5) {\n        var type$4 = types[i$5];\n        if (cur$1 == \"L\" && type$4 == \"1\") { types[i$5] = \"L\"; }\n        else if (isStrong.test(type$4)) { cur$1 = type$4; }\n      }\n\n      // N1. A sequence of neutrals takes the direction of the\n      // surrounding strong text if the text on both sides has the same\n      // direction. European and Arabic numbers act as if they were R in\n      // terms of their influence on neutrals. Start-of-level-run (sor)\n      // and end-of-level-run (eor) are used at level run boundaries.\n      // N2. Any remaining neutrals take the embedding direction.\n      for (var i$6 = 0; i$6 < len; ++i$6) {\n        if (isNeutral.test(types[i$6])) {\n          var end$1 = (void 0);\n          for (end$1 = i$6 + 1; end$1 < len && isNeutral.test(types[end$1]); ++end$1) {}\n          var before = (i$6 ? types[i$6-1] : outerType) == \"L\";\n          var after = (end$1 < len ? types[end$1] : outerType) == \"L\";\n          var replace$1 = before == after ? (before ? \"L\" : \"R\") : outerType;\n          for (var j$1 = i$6; j$1 < end$1; ++j$1) { types[j$1] = replace$1; }\n          i$6 = end$1 - 1;\n        }\n      }\n\n      // Here we depart from the documented algorithm, in order to avoid\n      // building up an actual levels array. Since there are only three\n      // levels (0, 1, 2) in an implementation that doesn't take\n      // explicit embedding into account, we can build up the order on\n      // the fly, without following the level-based algorithm.\n      var order = [], m;\n      for (var i$7 = 0; i$7 < len;) {\n        if (countsAsLeft.test(types[i$7])) {\n          var start = i$7;\n          for (++i$7; i$7 < len && countsAsLeft.test(types[i$7]); ++i$7) {}\n          order.push(new BidiSpan(0, start, i$7));\n        } else {\n          var pos = i$7, at = order.length, isRTL = direction == \"rtl\" ? 1 : 0;\n          for (++i$7; i$7 < len && types[i$7] != \"L\"; ++i$7) {}\n          for (var j$2 = pos; j$2 < i$7;) {\n            if (countsAsNum.test(types[j$2])) {\n              if (pos < j$2) { order.splice(at, 0, new BidiSpan(1, pos, j$2)); at += isRTL; }\n              var nstart = j$2;\n              for (++j$2; j$2 < i$7 && countsAsNum.test(types[j$2]); ++j$2) {}\n              order.splice(at, 0, new BidiSpan(2, nstart, j$2));\n              at += isRTL;\n              pos = j$2;\n            } else { ++j$2; }\n          }\n          if (pos < i$7) { order.splice(at, 0, new BidiSpan(1, pos, i$7)); }\n        }\n      }\n      if (direction == \"ltr\") {\n        if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\n          order[0].from = m[0].length;\n          order.unshift(new BidiSpan(0, 0, m[0].length));\n        }\n        if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\n          lst(order).to -= m[0].length;\n          order.push(new BidiSpan(0, len - m[0].length, len));\n        }\n      }\n\n      return direction == \"rtl\" ? order.reverse() : order\n    }\n  })();\n\n  // Get the bidi ordering for the given line (and cache it). Returns\n  // false for lines that are fully left-to-right, and an array of\n  // BidiSpan objects otherwise.\n  function getOrder(line, direction) {\n    var order = line.order;\n    if (order == null) { order = line.order = bidiOrdering(line.text, direction); }\n    return order\n  }\n\n  // EVENT HANDLING\n\n  // Lightweight event framework. on/off also work on DOM nodes,\n  // registering native DOM handlers.\n\n  var noHandlers = [];\n\n  var on = function(emitter, type, f) {\n    if (emitter.addEventListener) {\n      emitter.addEventListener(type, f, false);\n    } else if (emitter.attachEvent) {\n      emitter.attachEvent(\"on\" + type, f);\n    } else {\n      var map = emitter._handlers || (emitter._handlers = {});\n      map[type] = (map[type] || noHandlers).concat(f);\n    }\n  };\n\n  function getHandlers(emitter, type) {\n    return emitter._handlers && emitter._handlers[type] || noHandlers\n  }\n\n  function off(emitter, type, f) {\n    if (emitter.removeEventListener) {\n      emitter.removeEventListener(type, f, false);\n    } else if (emitter.detachEvent) {\n      emitter.detachEvent(\"on\" + type, f);\n    } else {\n      var map = emitter._handlers, arr = map && map[type];\n      if (arr) {\n        var index = indexOf(arr, f);\n        if (index > -1)\n          { map[type] = arr.slice(0, index).concat(arr.slice(index + 1)); }\n      }\n    }\n  }\n\n  function signal(emitter, type /*, values...*/) {\n    var handlers = getHandlers(emitter, type);\n    if (!handlers.length) { return }\n    var args = Array.prototype.slice.call(arguments, 2);\n    for (var i = 0; i < handlers.length; ++i) { handlers[i].apply(null, args); }\n  }\n\n  // The DOM events that CodeMirror handles can be overridden by\n  // registering a (non-DOM) handler on the editor for the event name,\n  // and preventDefault-ing the event in that handler.\n  function signalDOMEvent(cm, e, override) {\n    if (typeof e == \"string\")\n      { e = {type: e, preventDefault: function() { this.defaultPrevented = true; }}; }\n    signal(cm, override || e.type, cm, e);\n    return e_defaultPrevented(e) || e.codemirrorIgnore\n  }\n\n  function signalCursorActivity(cm) {\n    var arr = cm._handlers && cm._handlers.cursorActivity;\n    if (!arr) { return }\n    var set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = []);\n    for (var i = 0; i < arr.length; ++i) { if (indexOf(set, arr[i]) == -1)\n      { set.push(arr[i]); } }\n  }\n\n  function hasHandler(emitter, type) {\n    return getHandlers(emitter, type).length > 0\n  }\n\n  // Add on and off methods to a constructor's prototype, to make\n  // registering events on such objects more convenient.\n  function eventMixin(ctor) {\n    ctor.prototype.on = function(type, f) {on(this, type, f);};\n    ctor.prototype.off = function(type, f) {off(this, type, f);};\n  }\n\n  // Due to the fact that we still support jurassic IE versions, some\n  // compatibility wrappers are needed.\n\n  function e_preventDefault(e) {\n    if (e.preventDefault) { e.preventDefault(); }\n    else { e.returnValue = false; }\n  }\n  function e_stopPropagation(e) {\n    if (e.stopPropagation) { e.stopPropagation(); }\n    else { e.cancelBubble = true; }\n  }\n  function e_defaultPrevented(e) {\n    return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false\n  }\n  function e_stop(e) {e_preventDefault(e); e_stopPropagation(e);}\n\n  function e_target(e) {return e.target || e.srcElement}\n  function e_button(e) {\n    var b = e.which;\n    if (b == null) {\n      if (e.button & 1) { b = 1; }\n      else if (e.button & 2) { b = 3; }\n      else if (e.button & 4) { b = 2; }\n    }\n    if (mac && e.ctrlKey && b == 1) { b = 3; }\n    return b\n  }\n\n  // Detect drag-and-drop\n  var dragAndDrop = function() {\n    // There is *some* kind of drag-and-drop support in IE6-8, but I\n    // couldn't get it to work yet.\n    if (ie && ie_version < 9) { return false }\n    var div = elt('div');\n    return \"draggable\" in div || \"dragDrop\" in div\n  }();\n\n  var zwspSupported;\n  function zeroWidthElement(measure) {\n    if (zwspSupported == null) {\n      var test = elt(\"span\", \"\\u200b\");\n      removeChildrenAndAdd(measure, elt(\"span\", [test, document.createTextNode(\"x\")]));\n      if (measure.firstChild.offsetHeight != 0)\n        { zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !(ie && ie_version < 8); }\n    }\n    var node = zwspSupported ? elt(\"span\", \"\\u200b\") :\n      elt(\"span\", \"\\u00a0\", null, \"display: inline-block; width: 1px; margin-right: -1px\");\n    node.setAttribute(\"cm-text\", \"\");\n    return node\n  }\n\n  // Feature-detect IE's crummy client rect reporting for bidi text\n  var badBidiRects;\n  function hasBadBidiRects(measure) {\n    if (badBidiRects != null) { return badBidiRects }\n    var txt = removeChildrenAndAdd(measure, document.createTextNode(\"A\\u062eA\"));\n    var r0 = range(txt, 0, 1).getBoundingClientRect();\n    var r1 = range(txt, 1, 2).getBoundingClientRect();\n    removeChildren(measure);\n    if (!r0 || r0.left == r0.right) { return false } // Safari returns null in some cases (#2780)\n    return badBidiRects = (r1.right - r0.right < 3)\n  }\n\n  // See if \"\".split is the broken IE version, if so, provide an\n  // alternative way to split lines.\n  var splitLinesAuto = \"\\n\\nb\".split(/\\n/).length != 3 ? function (string) {\n    var pos = 0, result = [], l = string.length;\n    while (pos <= l) {\n      var nl = string.indexOf(\"\\n\", pos);\n      if (nl == -1) { nl = string.length; }\n      var line = string.slice(pos, string.charAt(nl - 1) == \"\\r\" ? nl - 1 : nl);\n      var rt = line.indexOf(\"\\r\");\n      if (rt != -1) {\n        result.push(line.slice(0, rt));\n        pos += rt + 1;\n      } else {\n        result.push(line);\n        pos = nl + 1;\n      }\n    }\n    return result\n  } : function (string) { return string.split(/\\r\\n?|\\n/); };\n\n  var hasSelection = window.getSelection ? function (te) {\n    try { return te.selectionStart != te.selectionEnd }\n    catch(e) { return false }\n  } : function (te) {\n    var range;\n    try {range = te.ownerDocument.selection.createRange();}\n    catch(e) {}\n    if (!range || range.parentElement() != te) { return false }\n    return range.compareEndPoints(\"StartToEnd\", range) != 0\n  };\n\n  var hasCopyEvent = (function () {\n    var e = elt(\"div\");\n    if (\"oncopy\" in e) { return true }\n    e.setAttribute(\"oncopy\", \"return;\");\n    return typeof e.oncopy == \"function\"\n  })();\n\n  var badZoomedRects = null;\n  function hasBadZoomedRects(measure) {\n    if (badZoomedRects != null) { return badZoomedRects }\n    var node = removeChildrenAndAdd(measure, elt(\"span\", \"x\"));\n    var normal = node.getBoundingClientRect();\n    var fromRange = range(node, 0, 1).getBoundingClientRect();\n    return badZoomedRects = Math.abs(normal.left - fromRange.left) > 1\n  }\n\n  // Known modes, by name and by MIME\n  var modes = {}, mimeModes = {};\n\n  // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n  function defineMode(name, mode) {\n    if (arguments.length > 2)\n      { mode.dependencies = Array.prototype.slice.call(arguments, 2); }\n    modes[name] = mode;\n  }\n\n  function defineMIME(mime, spec) {\n    mimeModes[mime] = spec;\n  }\n\n  // Given a MIME type, a {name, ...options} config object, or a name\n  // string, return a mode config object.\n  function resolveMode(spec) {\n    if (typeof spec == \"string\" && mimeModes.hasOwnProperty(spec)) {\n      spec = mimeModes[spec];\n    } else if (spec && typeof spec.name == \"string\" && mimeModes.hasOwnProperty(spec.name)) {\n      var found = mimeModes[spec.name];\n      if (typeof found == \"string\") { found = {name: found}; }\n      spec = createObj(found, spec);\n      spec.name = found.name;\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\n      return resolveMode(\"application/xml\")\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+json$/.test(spec)) {\n      return resolveMode(\"application/json\")\n    }\n    if (typeof spec == \"string\") { return {name: spec} }\n    else { return spec || {name: \"null\"} }\n  }\n\n  // Given a mode spec (anything that resolveMode accepts), find and\n  // initialize an actual mode object.\n  function getMode(options, spec) {\n    spec = resolveMode(spec);\n    var mfactory = modes[spec.name];\n    if (!mfactory) { return getMode(options, \"text/plain\") }\n    var modeObj = mfactory(options, spec);\n    if (modeExtensions.hasOwnProperty(spec.name)) {\n      var exts = modeExtensions[spec.name];\n      for (var prop in exts) {\n        if (!exts.hasOwnProperty(prop)) { continue }\n        if (modeObj.hasOwnProperty(prop)) { modeObj[\"_\" + prop] = modeObj[prop]; }\n        modeObj[prop] = exts[prop];\n      }\n    }\n    modeObj.name = spec.name;\n    if (spec.helperType) { modeObj.helperType = spec.helperType; }\n    if (spec.modeProps) { for (var prop$1 in spec.modeProps)\n      { modeObj[prop$1] = spec.modeProps[prop$1]; } }\n\n    return modeObj\n  }\n\n  // This can be used to attach properties to mode objects from\n  // outside the actual mode definition.\n  var modeExtensions = {};\n  function extendMode(mode, properties) {\n    var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : (modeExtensions[mode] = {});\n    copyObj(properties, exts);\n  }\n\n  function copyState(mode, state) {\n    if (state === true) { return state }\n    if (mode.copyState) { return mode.copyState(state) }\n    var nstate = {};\n    for (var n in state) {\n      var val = state[n];\n      if (val instanceof Array) { val = val.concat([]); }\n      nstate[n] = val;\n    }\n    return nstate\n  }\n\n  // Given a mode and a state (for that mode), find the inner mode and\n  // state at the position that the state refers to.\n  function innerMode(mode, state) {\n    var info;\n    while (mode.innerMode) {\n      info = mode.innerMode(state);\n      if (!info || info.mode == mode) { break }\n      state = info.state;\n      mode = info.mode;\n    }\n    return info || {mode: mode, state: state}\n  }\n\n  function startState(mode, a1, a2) {\n    return mode.startState ? mode.startState(a1, a2) : true\n  }\n\n  // STRING STREAM\n\n  // Fed to the mode parsers, provides helper functions to make\n  // parsers more succinct.\n\n  var StringStream = function(string, tabSize, lineOracle) {\n    this.pos = this.start = 0;\n    this.string = string;\n    this.tabSize = tabSize || 8;\n    this.lastColumnPos = this.lastColumnValue = 0;\n    this.lineStart = 0;\n    this.lineOracle = lineOracle;\n  };\n\n  StringStream.prototype.eol = function () {return this.pos >= this.string.length};\n  StringStream.prototype.sol = function () {return this.pos == this.lineStart};\n  StringStream.prototype.peek = function () {return this.string.charAt(this.pos) || undefined};\n  StringStream.prototype.next = function () {\n    if (this.pos < this.string.length)\n      { return this.string.charAt(this.pos++) }\n  };\n  StringStream.prototype.eat = function (match) {\n    var ch = this.string.charAt(this.pos);\n    var ok;\n    if (typeof match == \"string\") { ok = ch == match; }\n    else { ok = ch && (match.test ? match.test(ch) : match(ch)); }\n    if (ok) {++this.pos; return ch}\n  };\n  StringStream.prototype.eatWhile = function (match) {\n    var start = this.pos;\n    while (this.eat(match)){}\n    return this.pos > start\n  };\n  StringStream.prototype.eatSpace = function () {\n    var start = this.pos;\n    while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) { ++this.pos; }\n    return this.pos > start\n  };\n  StringStream.prototype.skipToEnd = function () {this.pos = this.string.length;};\n  StringStream.prototype.skipTo = function (ch) {\n    var found = this.string.indexOf(ch, this.pos);\n    if (found > -1) {this.pos = found; return true}\n  };\n  StringStream.prototype.backUp = function (n) {this.pos -= n;};\n  StringStream.prototype.column = function () {\n    if (this.lastColumnPos < this.start) {\n      this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\n      this.lastColumnPos = this.start;\n    }\n    return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n  };\n  StringStream.prototype.indentation = function () {\n    return countColumn(this.string, null, this.tabSize) -\n      (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n  };\n  StringStream.prototype.match = function (pattern, consume, caseInsensitive) {\n    if (typeof pattern == \"string\") {\n      var cased = function (str) { return caseInsensitive ? str.toLowerCase() : str; };\n      var substr = this.string.substr(this.pos, pattern.length);\n      if (cased(substr) == cased(pattern)) {\n        if (consume !== false) { this.pos += pattern.length; }\n        return true\n      }\n    } else {\n      var match = this.string.slice(this.pos).match(pattern);\n      if (match && match.index > 0) { return null }\n      if (match && consume !== false) { this.pos += match[0].length; }\n      return match\n    }\n  };\n  StringStream.prototype.current = function (){return this.string.slice(this.start, this.pos)};\n  StringStream.prototype.hideFirstChars = function (n, inner) {\n    this.lineStart += n;\n    try { return inner() }\n    finally { this.lineStart -= n; }\n  };\n  StringStream.prototype.lookAhead = function (n) {\n    var oracle = this.lineOracle;\n    return oracle && oracle.lookAhead(n)\n  };\n  StringStream.prototype.baseToken = function () {\n    var oracle = this.lineOracle;\n    return oracle && oracle.baseToken(this.pos)\n  };\n\n  // Find the line object corresponding to the given line number.\n  function getLine(doc, n) {\n    n -= doc.first;\n    if (n < 0 || n >= doc.size) { throw new Error(\"There is no line \" + (n + doc.first) + \" in the document.\") }\n    var chunk = doc;\n    while (!chunk.lines) {\n      for (var i = 0;; ++i) {\n        var child = chunk.children[i], sz = child.chunkSize();\n        if (n < sz) { chunk = child; break }\n        n -= sz;\n      }\n    }\n    return chunk.lines[n]\n  }\n\n  // Get the part of a document between two positions, as an array of\n  // strings.\n  function getBetween(doc, start, end) {\n    var out = [], n = start.line;\n    doc.iter(start.line, end.line + 1, function (line) {\n      var text = line.text;\n      if (n == end.line) { text = text.slice(0, end.ch); }\n      if (n == start.line) { text = text.slice(start.ch); }\n      out.push(text);\n      ++n;\n    });\n    return out\n  }\n  // Get the lines between from and to, as array of strings.\n  function getLines(doc, from, to) {\n    var out = [];\n    doc.iter(from, to, function (line) { out.push(line.text); }); // iter aborts when callback returns truthy value\n    return out\n  }\n\n  // Update the height of a line, propagating the height change\n  // upwards to parent nodes.\n  function updateLineHeight(line, height) {\n    var diff = height - line.height;\n    if (diff) { for (var n = line; n; n = n.parent) { n.height += diff; } }\n  }\n\n  // Given a line object, find its line number by walking up through\n  // its parent links.\n  function lineNo(line) {\n    if (line.parent == null) { return null }\n    var cur = line.parent, no = indexOf(cur.lines, line);\n    for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\n      for (var i = 0;; ++i) {\n        if (chunk.children[i] == cur) { break }\n        no += chunk.children[i].chunkSize();\n      }\n    }\n    return no + cur.first\n  }\n\n  // Find the line at the given vertical position, using the height\n  // information in the document tree.\n  function lineAtHeight(chunk, h) {\n    var n = chunk.first;\n    outer: do {\n      for (var i$1 = 0; i$1 < chunk.children.length; ++i$1) {\n        var child = chunk.children[i$1], ch = child.height;\n        if (h < ch) { chunk = child; continue outer }\n        h -= ch;\n        n += child.chunkSize();\n      }\n      return n\n    } while (!chunk.lines)\n    var i = 0;\n    for (; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i], lh = line.height;\n      if (h < lh) { break }\n      h -= lh;\n    }\n    return n + i\n  }\n\n  function isLine(doc, l) {return l >= doc.first && l < doc.first + doc.size}\n\n  function lineNumberFor(options, i) {\n    return String(options.lineNumberFormatter(i + options.firstLineNumber))\n  }\n\n  // A Pos instance represents a position within the text.\n  function Pos(line, ch, sticky) {\n    if ( sticky === void 0 ) sticky = null;\n\n    if (!(this instanceof Pos)) { return new Pos(line, ch, sticky) }\n    this.line = line;\n    this.ch = ch;\n    this.sticky = sticky;\n  }\n\n  // Compare two positions, return 0 if they are the same, a negative\n  // number when a is less, and a positive number otherwise.\n  function cmp(a, b) { return a.line - b.line || a.ch - b.ch }\n\n  function equalCursorPos(a, b) { return a.sticky == b.sticky && cmp(a, b) == 0 }\n\n  function copyPos(x) {return Pos(x.line, x.ch)}\n  function maxPos(a, b) { return cmp(a, b) < 0 ? b : a }\n  function minPos(a, b) { return cmp(a, b) < 0 ? a : b }\n\n  // Most of the external API clips given positions to make sure they\n  // actually exist within the document.\n  function clipLine(doc, n) {return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1))}\n  function clipPos(doc, pos) {\n    if (pos.line < doc.first) { return Pos(doc.first, 0) }\n    var last = doc.first + doc.size - 1;\n    if (pos.line > last) { return Pos(last, getLine(doc, last).text.length) }\n    return clipToLen(pos, getLine(doc, pos.line).text.length)\n  }\n  function clipToLen(pos, linelen) {\n    var ch = pos.ch;\n    if (ch == null || ch > linelen) { return Pos(pos.line, linelen) }\n    else if (ch < 0) { return Pos(pos.line, 0) }\n    else { return pos }\n  }\n  function clipPosArray(doc, array) {\n    var out = [];\n    for (var i = 0; i < array.length; i++) { out[i] = clipPos(doc, array[i]); }\n    return out\n  }\n\n  var SavedContext = function(state, lookAhead) {\n    this.state = state;\n    this.lookAhead = lookAhead;\n  };\n\n  var Context = function(doc, state, line, lookAhead) {\n    this.state = state;\n    this.doc = doc;\n    this.line = line;\n    this.maxLookAhead = lookAhead || 0;\n    this.baseTokens = null;\n    this.baseTokenPos = 1;\n  };\n\n  Context.prototype.lookAhead = function (n) {\n    var line = this.doc.getLine(this.line + n);\n    if (line != null && n > this.maxLookAhead) { this.maxLookAhead = n; }\n    return line\n  };\n\n  Context.prototype.baseToken = function (n) {\n    if (!this.baseTokens) { return null }\n    while (this.baseTokens[this.baseTokenPos] <= n)\n      { this.baseTokenPos += 2; }\n    var type = this.baseTokens[this.baseTokenPos + 1];\n    return {type: type && type.replace(/( |^)overlay .*/, \"\"),\n            size: this.baseTokens[this.baseTokenPos] - n}\n  };\n\n  Context.prototype.nextLine = function () {\n    this.line++;\n    if (this.maxLookAhead > 0) { this.maxLookAhead--; }\n  };\n\n  Context.fromSaved = function (doc, saved, line) {\n    if (saved instanceof SavedContext)\n      { return new Context(doc, copyState(doc.mode, saved.state), line, saved.lookAhead) }\n    else\n      { return new Context(doc, copyState(doc.mode, saved), line) }\n  };\n\n  Context.prototype.save = function (copy) {\n    var state = copy !== false ? copyState(this.doc.mode, this.state) : this.state;\n    return this.maxLookAhead > 0 ? new SavedContext(state, this.maxLookAhead) : state\n  };\n\n\n  // Compute a style array (an array starting with a mode generation\n  // -- for invalidation -- followed by pairs of end positions and\n  // style strings), which is used to highlight the tokens on the\n  // line.\n  function highlightLine(cm, line, context, forceToEnd) {\n    // A styles array always starts with a number identifying the\n    // mode/overlays that it is based on (for easy invalidation).\n    var st = [cm.state.modeGen], lineClasses = {};\n    // Compute the base array of styles\n    runMode(cm, line.text, cm.doc.mode, context, function (end, style) { return st.push(end, style); },\n            lineClasses, forceToEnd);\n    var state = context.state;\n\n    // Run overlays, adjust style array.\n    var loop = function ( o ) {\n      context.baseTokens = st;\n      var overlay = cm.state.overlays[o], i = 1, at = 0;\n      context.state = true;\n      runMode(cm, line.text, overlay.mode, context, function (end, style) {\n        var start = i;\n        // Ensure there's a token end at the current position, and that i points at it\n        while (at < end) {\n          var i_end = st[i];\n          if (i_end > end)\n            { st.splice(i, 1, end, st[i+1], i_end); }\n          i += 2;\n          at = Math.min(end, i_end);\n        }\n        if (!style) { return }\n        if (overlay.opaque) {\n          st.splice(start, i - start, end, \"overlay \" + style);\n          i = start + 2;\n        } else {\n          for (; start < i; start += 2) {\n            var cur = st[start+1];\n            st[start+1] = (cur ? cur + \" \" : \"\") + \"overlay \" + style;\n          }\n        }\n      }, lineClasses);\n      context.state = state;\n      context.baseTokens = null;\n      context.baseTokenPos = 1;\n    };\n\n    for (var o = 0; o < cm.state.overlays.length; ++o) loop( o );\n\n    return {styles: st, classes: lineClasses.bgClass || lineClasses.textClass ? lineClasses : null}\n  }\n\n  function getLineStyles(cm, line, updateFrontier) {\n    if (!line.styles || line.styles[0] != cm.state.modeGen) {\n      var context = getContextBefore(cm, lineNo(line));\n      var resetState = line.text.length > cm.options.maxHighlightLength && copyState(cm.doc.mode, context.state);\n      var result = highlightLine(cm, line, context);\n      if (resetState) { context.state = resetState; }\n      line.stateAfter = context.save(!resetState);\n      line.styles = result.styles;\n      if (result.classes) { line.styleClasses = result.classes; }\n      else if (line.styleClasses) { line.styleClasses = null; }\n      if (updateFrontier === cm.doc.highlightFrontier)\n        { cm.doc.modeFrontier = Math.max(cm.doc.modeFrontier, ++cm.doc.highlightFrontier); }\n    }\n    return line.styles\n  }\n\n  function getContextBefore(cm, n, precise) {\n    var doc = cm.doc, display = cm.display;\n    if (!doc.mode.startState) { return new Context(doc, true, n) }\n    var start = findStartLine(cm, n, precise);\n    var saved = start > doc.first && getLine(doc, start - 1).stateAfter;\n    var context = saved ? Context.fromSaved(doc, saved, start) : new Context(doc, startState(doc.mode), start);\n\n    doc.iter(start, n, function (line) {\n      processLine(cm, line.text, context);\n      var pos = context.line;\n      line.stateAfter = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo ? context.save() : null;\n      context.nextLine();\n    });\n    if (precise) { doc.modeFrontier = context.line; }\n    return context\n  }\n\n  // Lightweight form of highlight -- proceed over this line and\n  // update state, but don't save a style array. Used for lines that\n  // aren't currently visible.\n  function processLine(cm, text, context, startAt) {\n    var mode = cm.doc.mode;\n    var stream = new StringStream(text, cm.options.tabSize, context);\n    stream.start = stream.pos = startAt || 0;\n    if (text == \"\") { callBlankLine(mode, context.state); }\n    while (!stream.eol()) {\n      readToken(mode, stream, context.state);\n      stream.start = stream.pos;\n    }\n  }\n\n  function callBlankLine(mode, state) {\n    if (mode.blankLine) { return mode.blankLine(state) }\n    if (!mode.innerMode) { return }\n    var inner = innerMode(mode, state);\n    if (inner.mode.blankLine) { return inner.mode.blankLine(inner.state) }\n  }\n\n  function readToken(mode, stream, state, inner) {\n    for (var i = 0; i < 10; i++) {\n      if (inner) { inner[0] = innerMode(mode, state).mode; }\n      var style = mode.token(stream, state);\n      if (stream.pos > stream.start) { return style }\n    }\n    throw new Error(\"Mode \" + mode.name + \" failed to advance stream.\")\n  }\n\n  var Token = function(stream, type, state) {\n    this.start = stream.start; this.end = stream.pos;\n    this.string = stream.current();\n    this.type = type || null;\n    this.state = state;\n  };\n\n  // Utility for getTokenAt and getLineTokens\n  function takeToken(cm, pos, precise, asArray) {\n    var doc = cm.doc, mode = doc.mode, style;\n    pos = clipPos(doc, pos);\n    var line = getLine(doc, pos.line), context = getContextBefore(cm, pos.line, precise);\n    var stream = new StringStream(line.text, cm.options.tabSize, context), tokens;\n    if (asArray) { tokens = []; }\n    while ((asArray || stream.pos < pos.ch) && !stream.eol()) {\n      stream.start = stream.pos;\n      style = readToken(mode, stream, context.state);\n      if (asArray) { tokens.push(new Token(stream, style, copyState(doc.mode, context.state))); }\n    }\n    return asArray ? tokens : new Token(stream, style, context.state)\n  }\n\n  function extractLineClasses(type, output) {\n    if (type) { for (;;) {\n      var lineClass = type.match(/(?:^|\\s+)line-(background-)?(\\S+)/);\n      if (!lineClass) { break }\n      type = type.slice(0, lineClass.index) + type.slice(lineClass.index + lineClass[0].length);\n      var prop = lineClass[1] ? \"bgClass\" : \"textClass\";\n      if (output[prop] == null)\n        { output[prop] = lineClass[2]; }\n      else if (!(new RegExp(\"(?:^|\\s)\" + lineClass[2] + \"(?:$|\\s)\")).test(output[prop]))\n        { output[prop] += \" \" + lineClass[2]; }\n    } }\n    return type\n  }\n\n  // Run the given mode's parser over a line, calling f for each token.\n  function runMode(cm, text, mode, context, f, lineClasses, forceToEnd) {\n    var flattenSpans = mode.flattenSpans;\n    if (flattenSpans == null) { flattenSpans = cm.options.flattenSpans; }\n    var curStart = 0, curStyle = null;\n    var stream = new StringStream(text, cm.options.tabSize, context), style;\n    var inner = cm.options.addModeClass && [null];\n    if (text == \"\") { extractLineClasses(callBlankLine(mode, context.state), lineClasses); }\n    while (!stream.eol()) {\n      if (stream.pos > cm.options.maxHighlightLength) {\n        flattenSpans = false;\n        if (forceToEnd) { processLine(cm, text, context, stream.pos); }\n        stream.pos = text.length;\n        style = null;\n      } else {\n        style = extractLineClasses(readToken(mode, stream, context.state, inner), lineClasses);\n      }\n      if (inner) {\n        var mName = inner[0].name;\n        if (mName) { style = \"m-\" + (style ? mName + \" \" + style : mName); }\n      }\n      if (!flattenSpans || curStyle != style) {\n        while (curStart < stream.start) {\n          curStart = Math.min(stream.start, curStart + 5000);\n          f(curStart, curStyle);\n        }\n        curStyle = style;\n      }\n      stream.start = stream.pos;\n    }\n    while (curStart < stream.pos) {\n      // Webkit seems to refuse to render text nodes longer than 57444\n      // characters, and returns inaccurate measurements in nodes\n      // starting around 5000 chars.\n      var pos = Math.min(stream.pos, curStart + 5000);\n      f(pos, curStyle);\n      curStart = pos;\n    }\n  }\n\n  // Finds the line to start with when starting a parse. Tries to\n  // find a line with a stateAfter, so that it can start with a\n  // valid state. If that fails, it returns the line with the\n  // smallest indentation, which tends to need the least context to\n  // parse correctly.\n  function findStartLine(cm, n, precise) {\n    var minindent, minline, doc = cm.doc;\n    var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100);\n    for (var search = n; search > lim; --search) {\n      if (search <= doc.first) { return doc.first }\n      var line = getLine(doc, search - 1), after = line.stateAfter;\n      if (after && (!precise || search + (after instanceof SavedContext ? after.lookAhead : 0) <= doc.modeFrontier))\n        { return search }\n      var indented = countColumn(line.text, null, cm.options.tabSize);\n      if (minline == null || minindent > indented) {\n        minline = search - 1;\n        minindent = indented;\n      }\n    }\n    return minline\n  }\n\n  function retreatFrontier(doc, n) {\n    doc.modeFrontier = Math.min(doc.modeFrontier, n);\n    if (doc.highlightFrontier < n - 10) { return }\n    var start = doc.first;\n    for (var line = n - 1; line > start; line--) {\n      var saved = getLine(doc, line).stateAfter;\n      // change is on 3\n      // state on line 1 looked ahead 2 -- so saw 3\n      // test 1 + 2 < 3 should cover this\n      if (saved && (!(saved instanceof SavedContext) || line + saved.lookAhead < n)) {\n        start = line + 1;\n        break\n      }\n    }\n    doc.highlightFrontier = Math.min(doc.highlightFrontier, start);\n  }\n\n  // Optimize some code when these features are not used.\n  var sawReadOnlySpans = false, sawCollapsedSpans = false;\n\n  function seeReadOnlySpans() {\n    sawReadOnlySpans = true;\n  }\n\n  function seeCollapsedSpans() {\n    sawCollapsedSpans = true;\n  }\n\n  // TEXTMARKER SPANS\n\n  function MarkedSpan(marker, from, to) {\n    this.marker = marker;\n    this.from = from; this.to = to;\n  }\n\n  // Search an array of spans for a span matching the given marker.\n  function getMarkedSpanFor(spans, marker) {\n    if (spans) { for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.marker == marker) { return span }\n    } }\n  }\n  // Remove a span from an array, returning undefined if no spans are\n  // left (we don't store arrays for lines without spans).\n  function removeMarkedSpan(spans, span) {\n    var r;\n    for (var i = 0; i < spans.length; ++i)\n      { if (spans[i] != span) { (r || (r = [])).push(spans[i]); } }\n    return r\n  }\n  // Add a span to a line.\n  function addMarkedSpan(line, span) {\n    line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span];\n    span.marker.attachLine(line);\n  }\n\n  // Used for the algorithm that adjusts markers for a change in the\n  // document. These functions cut an array of spans at a given\n  // character position, returning an array of remaining chunks (or\n  // undefined if nothing remains).\n  function markedSpansBefore(old, startCh, isInsert) {\n    var nw;\n    if (old) { for (var i = 0; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh);\n      if (startsBefore || span.from == startCh && marker.type == \"bookmark\" && (!isInsert || !span.marker.insertLeft)) {\n        var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh)\n        ;(nw || (nw = [])).push(new MarkedSpan(marker, span.from, endsAfter ? null : span.to));\n      }\n    } }\n    return nw\n  }\n  function markedSpansAfter(old, endCh, isInsert) {\n    var nw;\n    if (old) { for (var i = 0; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh);\n      if (endsAfter || span.from == endCh && marker.type == \"bookmark\" && (!isInsert || span.marker.insertLeft)) {\n        var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh)\n        ;(nw || (nw = [])).push(new MarkedSpan(marker, startsBefore ? null : span.from - endCh,\n                                              span.to == null ? null : span.to - endCh));\n      }\n    } }\n    return nw\n  }\n\n  // Given a change object, compute the new set of marker spans that\n  // cover the line in which the change took place. Removes spans\n  // entirely within the change, reconnects spans belonging to the\n  // same marker that appear on both sides of the change, and cuts off\n  // spans partially within the change. Returns an array of span\n  // arrays with one element for each line in (after) the change.\n  function stretchSpansOverChange(doc, change) {\n    if (change.full) { return null }\n    var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans;\n    var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans;\n    if (!oldFirst && !oldLast) { return null }\n\n    var startCh = change.from.ch, endCh = change.to.ch, isInsert = cmp(change.from, change.to) == 0;\n    // Get the spans that 'stick out' on both sides\n    var first = markedSpansBefore(oldFirst, startCh, isInsert);\n    var last = markedSpansAfter(oldLast, endCh, isInsert);\n\n    // Next, merge those two ends\n    var sameLine = change.text.length == 1, offset = lst(change.text).length + (sameLine ? startCh : 0);\n    if (first) {\n      // Fix up .to properties of first\n      for (var i = 0; i < first.length; ++i) {\n        var span = first[i];\n        if (span.to == null) {\n          var found = getMarkedSpanFor(last, span.marker);\n          if (!found) { span.to = startCh; }\n          else if (sameLine) { span.to = found.to == null ? null : found.to + offset; }\n        }\n      }\n    }\n    if (last) {\n      // Fix up .from in last (or move them into first in case of sameLine)\n      for (var i$1 = 0; i$1 < last.length; ++i$1) {\n        var span$1 = last[i$1];\n        if (span$1.to != null) { span$1.to += offset; }\n        if (span$1.from == null) {\n          var found$1 = getMarkedSpanFor(first, span$1.marker);\n          if (!found$1) {\n            span$1.from = offset;\n            if (sameLine) { (first || (first = [])).push(span$1); }\n          }\n        } else {\n          span$1.from += offset;\n          if (sameLine) { (first || (first = [])).push(span$1); }\n        }\n      }\n    }\n    // Make sure we didn't create any zero-length spans\n    if (first) { first = clearEmptySpans(first); }\n    if (last && last != first) { last = clearEmptySpans(last); }\n\n    var newMarkers = [first];\n    if (!sameLine) {\n      // Fill gap with whole-line-spans\n      var gap = change.text.length - 2, gapMarkers;\n      if (gap > 0 && first)\n        { for (var i$2 = 0; i$2 < first.length; ++i$2)\n          { if (first[i$2].to == null)\n            { (gapMarkers || (gapMarkers = [])).push(new MarkedSpan(first[i$2].marker, null, null)); } } }\n      for (var i$3 = 0; i$3 < gap; ++i$3)\n        { newMarkers.push(gapMarkers); }\n      newMarkers.push(last);\n    }\n    return newMarkers\n  }\n\n  // Remove spans that are empty and don't have a clearWhenEmpty\n  // option of false.\n  function clearEmptySpans(spans) {\n    for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false)\n        { spans.splice(i--, 1); }\n    }\n    if (!spans.length) { return null }\n    return spans\n  }\n\n  // Used to 'clip' out readOnly ranges when making a change.\n  function removeReadOnlyRanges(doc, from, to) {\n    var markers = null;\n    doc.iter(from.line, to.line + 1, function (line) {\n      if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n        var mark = line.markedSpans[i].marker;\n        if (mark.readOnly && (!markers || indexOf(markers, mark) == -1))\n          { (markers || (markers = [])).push(mark); }\n      } }\n    });\n    if (!markers) { return null }\n    var parts = [{from: from, to: to}];\n    for (var i = 0; i < markers.length; ++i) {\n      var mk = markers[i], m = mk.find(0);\n      for (var j = 0; j < parts.length; ++j) {\n        var p = parts[j];\n        if (cmp(p.to, m.from) < 0 || cmp(p.from, m.to) > 0) { continue }\n        var newParts = [j, 1], dfrom = cmp(p.from, m.from), dto = cmp(p.to, m.to);\n        if (dfrom < 0 || !mk.inclusiveLeft && !dfrom)\n          { newParts.push({from: p.from, to: m.from}); }\n        if (dto > 0 || !mk.inclusiveRight && !dto)\n          { newParts.push({from: m.to, to: p.to}); }\n        parts.splice.apply(parts, newParts);\n        j += newParts.length - 3;\n      }\n    }\n    return parts\n  }\n\n  // Connect or disconnect spans from a line.\n  function detachMarkedSpans(line) {\n    var spans = line.markedSpans;\n    if (!spans) { return }\n    for (var i = 0; i < spans.length; ++i)\n      { spans[i].marker.detachLine(line); }\n    line.markedSpans = null;\n  }\n  function attachMarkedSpans(line, spans) {\n    if (!spans) { return }\n    for (var i = 0; i < spans.length; ++i)\n      { spans[i].marker.attachLine(line); }\n    line.markedSpans = spans;\n  }\n\n  // Helpers used when computing which overlapping collapsed span\n  // counts as the larger one.\n  function extraLeft(marker) { return marker.inclusiveLeft ? -1 : 0 }\n  function extraRight(marker) { return marker.inclusiveRight ? 1 : 0 }\n\n  // Returns a number indicating which of two overlapping collapsed\n  // spans is larger (and thus includes the other). Falls back to\n  // comparing ids when the spans cover exactly the same range.\n  function compareCollapsedMarkers(a, b) {\n    var lenDiff = a.lines.length - b.lines.length;\n    if (lenDiff != 0) { return lenDiff }\n    var aPos = a.find(), bPos = b.find();\n    var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b);\n    if (fromCmp) { return -fromCmp }\n    var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b);\n    if (toCmp) { return toCmp }\n    return b.id - a.id\n  }\n\n  // Find out whether a line ends or starts in a collapsed span. If\n  // so, return the marker for that span.\n  function collapsedSpanAtSide(line, start) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (sp.marker.collapsed && (start ? sp.from : sp.to) == null &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0))\n        { found = sp.marker; }\n    } }\n    return found\n  }\n  function collapsedSpanAtStart(line) { return collapsedSpanAtSide(line, true) }\n  function collapsedSpanAtEnd(line) { return collapsedSpanAtSide(line, false) }\n\n  function collapsedSpanAround(line, ch) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) { for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (sp.marker.collapsed && (sp.from == null || sp.from < ch) && (sp.to == null || sp.to > ch) &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0)) { found = sp.marker; }\n    } }\n    return found\n  }\n\n  // Test whether there exists a collapsed span that partially\n  // overlaps (covers the start or end, but not both) of a new span.\n  // Such overlap is not allowed.\n  function conflictingCollapsedRange(doc, lineNo, from, to, marker) {\n    var line = getLine(doc, lineNo);\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) { for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (!sp.marker.collapsed) { continue }\n      var found = sp.marker.find(0);\n      var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker);\n      var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker);\n      if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) { continue }\n      if (fromCmp <= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.to, from) >= 0 : cmp(found.to, from) > 0) ||\n          fromCmp >= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.from, to) <= 0 : cmp(found.from, to) < 0))\n        { return true }\n    } }\n  }\n\n  // A visual line is a line as drawn on the screen. Folding, for\n  // example, can cause multiple logical lines to appear on the same\n  // visual line. This finds the start of the visual line that the\n  // given line is part of (usually that is the line itself).\n  function visualLine(line) {\n    var merged;\n    while (merged = collapsedSpanAtStart(line))\n      { line = merged.find(-1, true).line; }\n    return line\n  }\n\n  function visualLineEnd(line) {\n    var merged;\n    while (merged = collapsedSpanAtEnd(line))\n      { line = merged.find(1, true).line; }\n    return line\n  }\n\n  // Returns an array of logical lines that continue the visual line\n  // started by the argument, or undefined if there are no such lines.\n  function visualLineContinued(line) {\n    var merged, lines;\n    while (merged = collapsedSpanAtEnd(line)) {\n      line = merged.find(1, true).line\n      ;(lines || (lines = [])).push(line);\n    }\n    return lines\n  }\n\n  // Get the line number of the start of the visual line that the\n  // given line number is part of.\n  function visualLineNo(doc, lineN) {\n    var line = getLine(doc, lineN), vis = visualLine(line);\n    if (line == vis) { return lineN }\n    return lineNo(vis)\n  }\n\n  // Get the line number of the start of the next visual line after\n  // the given line.\n  function visualLineEndNo(doc, lineN) {\n    if (lineN > doc.lastLine()) { return lineN }\n    var line = getLine(doc, lineN), merged;\n    if (!lineIsHidden(doc, line)) { return lineN }\n    while (merged = collapsedSpanAtEnd(line))\n      { line = merged.find(1, true).line; }\n    return lineNo(line) + 1\n  }\n\n  // Compute whether a line is hidden. Lines count as hidden when they\n  // are part of a visual line that starts with another line, or when\n  // they are entirely covered by collapsed, non-widget span.\n  function lineIsHidden(doc, line) {\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (!sp.marker.collapsed) { continue }\n      if (sp.from == null) { return true }\n      if (sp.marker.widgetNode) { continue }\n      if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp))\n        { return true }\n    } }\n  }\n  function lineIsHiddenInner(doc, line, span) {\n    if (span.to == null) {\n      var end = span.marker.find(1, true);\n      return lineIsHiddenInner(doc, end.line, getMarkedSpanFor(end.line.markedSpans, span.marker))\n    }\n    if (span.marker.inclusiveRight && span.to == line.text.length)\n      { return true }\n    for (var sp = (void 0), i = 0; i < line.markedSpans.length; ++i) {\n      sp = line.markedSpans[i];\n      if (sp.marker.collapsed && !sp.marker.widgetNode && sp.from == span.to &&\n          (sp.to == null || sp.to != span.from) &&\n          (sp.marker.inclusiveLeft || span.marker.inclusiveRight) &&\n          lineIsHiddenInner(doc, line, sp)) { return true }\n    }\n  }\n\n  // Find the height above the given line.\n  function heightAtLine(lineObj) {\n    lineObj = visualLine(lineObj);\n\n    var h = 0, chunk = lineObj.parent;\n    for (var i = 0; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i];\n      if (line == lineObj) { break }\n      else { h += line.height; }\n    }\n    for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\n      for (var i$1 = 0; i$1 < p.children.length; ++i$1) {\n        var cur = p.children[i$1];\n        if (cur == chunk) { break }\n        else { h += cur.height; }\n      }\n    }\n    return h\n  }\n\n  // Compute the character length of a line, taking into account\n  // collapsed ranges (see markText) that might hide parts, and join\n  // other lines onto it.\n  function lineLength(line) {\n    if (line.height == 0) { return 0 }\n    var len = line.text.length, merged, cur = line;\n    while (merged = collapsedSpanAtStart(cur)) {\n      var found = merged.find(0, true);\n      cur = found.from.line;\n      len += found.from.ch - found.to.ch;\n    }\n    cur = line;\n    while (merged = collapsedSpanAtEnd(cur)) {\n      var found$1 = merged.find(0, true);\n      len -= cur.text.length - found$1.from.ch;\n      cur = found$1.to.line;\n      len += cur.text.length - found$1.to.ch;\n    }\n    return len\n  }\n\n  // Find the longest line in the document.\n  function findMaxLine(cm) {\n    var d = cm.display, doc = cm.doc;\n    d.maxLine = getLine(doc, doc.first);\n    d.maxLineLength = lineLength(d.maxLine);\n    d.maxLineChanged = true;\n    doc.iter(function (line) {\n      var len = lineLength(line);\n      if (len > d.maxLineLength) {\n        d.maxLineLength = len;\n        d.maxLine = line;\n      }\n    });\n  }\n\n  // LINE DATA STRUCTURE\n\n  // Line objects. These hold state related to a line, including\n  // highlighting info (the styles array).\n  var Line = function(text, markedSpans, estimateHeight) {\n    this.text = text;\n    attachMarkedSpans(this, markedSpans);\n    this.height = estimateHeight ? estimateHeight(this) : 1;\n  };\n\n  Line.prototype.lineNo = function () { return lineNo(this) };\n  eventMixin(Line);\n\n  // Change the content (text, markers) of a line. Automatically\n  // invalidates cached information and tries to re-estimate the\n  // line's height.\n  function updateLine(line, text, markedSpans, estimateHeight) {\n    line.text = text;\n    if (line.stateAfter) { line.stateAfter = null; }\n    if (line.styles) { line.styles = null; }\n    if (line.order != null) { line.order = null; }\n    detachMarkedSpans(line);\n    attachMarkedSpans(line, markedSpans);\n    var estHeight = estimateHeight ? estimateHeight(line) : 1;\n    if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n  }\n\n  // Detach a line from the document tree and its markers.\n  function cleanUpLine(line) {\n    line.parent = null;\n    detachMarkedSpans(line);\n  }\n\n  // Convert a style as returned by a mode (either null, or a string\n  // containing one or more styles) to a CSS style. This is cached,\n  // and also looks for line-wide styles.\n  var styleToClassCache = {}, styleToClassCacheWithMode = {};\n  function interpretTokenStyle(style, options) {\n    if (!style || /^\\s*$/.test(style)) { return null }\n    var cache = options.addModeClass ? styleToClassCacheWithMode : styleToClassCache;\n    return cache[style] ||\n      (cache[style] = style.replace(/\\S+/g, \"cm-$&\"))\n  }\n\n  // Render the DOM representation of the text of a line. Also builds\n  // up a 'line map', which points at the DOM nodes that represent\n  // specific stretches of text, and is used by the measuring code.\n  // The returned object contains the DOM node, this map, and\n  // information about line-wide styles that were set by the mode.\n  function buildLineContent(cm, lineView) {\n    // The padding-right forces the element to have a 'border', which\n    // is needed on Webkit to be able to get line-level bounding\n    // rectangles for it (in measureChar).\n    var content = eltP(\"span\", null, null, webkit ? \"padding-right: .1px\" : null);\n    var builder = {pre: eltP(\"pre\", [content], \"CodeMirror-line\"), content: content,\n                   col: 0, pos: 0, cm: cm,\n                   trailingSpace: false,\n                   splitSpaces: cm.getOption(\"lineWrapping\")};\n    lineView.measure = {};\n\n    // Iterate over the logical lines that make up this visual line.\n    for (var i = 0; i <= (lineView.rest ? lineView.rest.length : 0); i++) {\n      var line = i ? lineView.rest[i - 1] : lineView.line, order = (void 0);\n      builder.pos = 0;\n      builder.addToken = buildToken;\n      // Optionally wire in some hacks into the token-rendering\n      // algorithm, to deal with browser quirks.\n      if (hasBadBidiRects(cm.display.measure) && (order = getOrder(line, cm.doc.direction)))\n        { builder.addToken = buildTokenBadBidi(builder.addToken, order); }\n      builder.map = [];\n      var allowFrontierUpdate = lineView != cm.display.externalMeasured && lineNo(line);\n      insertLineContent(line, builder, getLineStyles(cm, line, allowFrontierUpdate));\n      if (line.styleClasses) {\n        if (line.styleClasses.bgClass)\n          { builder.bgClass = joinClasses(line.styleClasses.bgClass, builder.bgClass || \"\"); }\n        if (line.styleClasses.textClass)\n          { builder.textClass = joinClasses(line.styleClasses.textClass, builder.textClass || \"\"); }\n      }\n\n      // Ensure at least a single node is present, for measuring.\n      if (builder.map.length == 0)\n        { builder.map.push(0, 0, builder.content.appendChild(zeroWidthElement(cm.display.measure))); }\n\n      // Store the map and a cache object for the current logical line\n      if (i == 0) {\n        lineView.measure.map = builder.map;\n        lineView.measure.cache = {};\n      } else {\n  (lineView.measure.maps || (lineView.measure.maps = [])).push(builder.map)\n        ;(lineView.measure.caches || (lineView.measure.caches = [])).push({});\n      }\n    }\n\n    // See issue #2901\n    if (webkit) {\n      var last = builder.content.lastChild;\n      if (/\\bcm-tab\\b/.test(last.className) || (last.querySelector && last.querySelector(\".cm-tab\")))\n        { builder.content.className = \"cm-tab-wrap-hack\"; }\n    }\n\n    signal(cm, \"renderLine\", cm, lineView.line, builder.pre);\n    if (builder.pre.className)\n      { builder.textClass = joinClasses(builder.pre.className, builder.textClass || \"\"); }\n\n    return builder\n  }\n\n  function defaultSpecialCharPlaceholder(ch) {\n    var token = elt(\"span\", \"\\u2022\", \"cm-invalidchar\");\n    token.title = \"\\\\u\" + ch.charCodeAt(0).toString(16);\n    token.setAttribute(\"aria-label\", token.title);\n    return token\n  }\n\n  // Build up the DOM representation for a single token, and add it to\n  // the line map. Takes care to render special characters separately.\n  function buildToken(builder, text, style, startStyle, endStyle, css, attributes) {\n    if (!text) { return }\n    var displayText = builder.splitSpaces ? splitSpaces(text, builder.trailingSpace) : text;\n    var special = builder.cm.state.specialChars, mustWrap = false;\n    var content;\n    if (!special.test(text)) {\n      builder.col += text.length;\n      content = document.createTextNode(displayText);\n      builder.map.push(builder.pos, builder.pos + text.length, content);\n      if (ie && ie_version < 9) { mustWrap = true; }\n      builder.pos += text.length;\n    } else {\n      content = document.createDocumentFragment();\n      var pos = 0;\n      while (true) {\n        special.lastIndex = pos;\n        var m = special.exec(text);\n        var skipped = m ? m.index - pos : text.length - pos;\n        if (skipped) {\n          var txt = document.createTextNode(displayText.slice(pos, pos + skipped));\n          if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt])); }\n          else { content.appendChild(txt); }\n          builder.map.push(builder.pos, builder.pos + skipped, txt);\n          builder.col += skipped;\n          builder.pos += skipped;\n        }\n        if (!m) { break }\n        pos += skipped + 1;\n        var txt$1 = (void 0);\n        if (m[0] == \"\\t\") {\n          var tabSize = builder.cm.options.tabSize, tabWidth = tabSize - builder.col % tabSize;\n          txt$1 = content.appendChild(elt(\"span\", spaceStr(tabWidth), \"cm-tab\"));\n          txt$1.setAttribute(\"role\", \"presentation\");\n          txt$1.setAttribute(\"cm-text\", \"\\t\");\n          builder.col += tabWidth;\n        } else if (m[0] == \"\\r\" || m[0] == \"\\n\") {\n          txt$1 = content.appendChild(elt(\"span\", m[0] == \"\\r\" ? \"\\u240d\" : \"\\u2424\", \"cm-invalidchar\"));\n          txt$1.setAttribute(\"cm-text\", m[0]);\n          builder.col += 1;\n        } else {\n          txt$1 = builder.cm.options.specialCharPlaceholder(m[0]);\n          txt$1.setAttribute(\"cm-text\", m[0]);\n          if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt$1])); }\n          else { content.appendChild(txt$1); }\n          builder.col += 1;\n        }\n        builder.map.push(builder.pos, builder.pos + 1, txt$1);\n        builder.pos++;\n      }\n    }\n    builder.trailingSpace = displayText.charCodeAt(text.length - 1) == 32;\n    if (style || startStyle || endStyle || mustWrap || css) {\n      var fullStyle = style || \"\";\n      if (startStyle) { fullStyle += startStyle; }\n      if (endStyle) { fullStyle += endStyle; }\n      var token = elt(\"span\", [content], fullStyle, css);\n      if (attributes) {\n        for (var attr in attributes) { if (attributes.hasOwnProperty(attr) && attr != \"style\" && attr != \"class\")\n          { token.setAttribute(attr, attributes[attr]); } }\n      }\n      return builder.content.appendChild(token)\n    }\n    builder.content.appendChild(content);\n  }\n\n  // Change some spaces to NBSP to prevent the browser from collapsing\n  // trailing spaces at the end of a line when rendering text (issue #1362).\n  function splitSpaces(text, trailingBefore) {\n    if (text.length > 1 && !/  /.test(text)) { return text }\n    var spaceBefore = trailingBefore, result = \"\";\n    for (var i = 0; i < text.length; i++) {\n      var ch = text.charAt(i);\n      if (ch == \" \" && spaceBefore && (i == text.length - 1 || text.charCodeAt(i + 1) == 32))\n        { ch = \"\\u00a0\"; }\n      result += ch;\n      spaceBefore = ch == \" \";\n    }\n    return result\n  }\n\n  // Work around nonsense dimensions being reported for stretches of\n  // right-to-left text.\n  function buildTokenBadBidi(inner, order) {\n    return function (builder, text, style, startStyle, endStyle, css, attributes) {\n      style = style ? style + \" cm-force-border\" : \"cm-force-border\";\n      var start = builder.pos, end = start + text.length;\n      for (;;) {\n        // Find the part that overlaps with the start of this text\n        var part = (void 0);\n        for (var i = 0; i < order.length; i++) {\n          part = order[i];\n          if (part.to > start && part.from <= start) { break }\n        }\n        if (part.to >= end) { return inner(builder, text, style, startStyle, endStyle, css, attributes) }\n        inner(builder, text.slice(0, part.to - start), style, startStyle, null, css, attributes);\n        startStyle = null;\n        text = text.slice(part.to - start);\n        start = part.to;\n      }\n    }\n  }\n\n  function buildCollapsedSpan(builder, size, marker, ignoreWidget) {\n    var widget = !ignoreWidget && marker.widgetNode;\n    if (widget) { builder.map.push(builder.pos, builder.pos + size, widget); }\n    if (!ignoreWidget && builder.cm.display.input.needsContentAttribute) {\n      if (!widget)\n        { widget = builder.content.appendChild(document.createElement(\"span\")); }\n      widget.setAttribute(\"cm-marker\", marker.id);\n    }\n    if (widget) {\n      builder.cm.display.input.setUneditable(widget);\n      builder.content.appendChild(widget);\n    }\n    builder.pos += size;\n    builder.trailingSpace = false;\n  }\n\n  // Outputs a number of spans to make up a line, taking highlighting\n  // and marked text into account.\n  function insertLineContent(line, builder, styles) {\n    var spans = line.markedSpans, allText = line.text, at = 0;\n    if (!spans) {\n      for (var i$1 = 1; i$1 < styles.length; i$1+=2)\n        { builder.addToken(builder, allText.slice(at, at = styles[i$1]), interpretTokenStyle(styles[i$1+1], builder.cm.options)); }\n      return\n    }\n\n    var len = allText.length, pos = 0, i = 1, text = \"\", style, css;\n    var nextChange = 0, spanStyle, spanEndStyle, spanStartStyle, collapsed, attributes;\n    for (;;) {\n      if (nextChange == pos) { // Update current marker set\n        spanStyle = spanEndStyle = spanStartStyle = css = \"\";\n        attributes = null;\n        collapsed = null; nextChange = Infinity;\n        var foundBookmarks = [], endStyles = (void 0);\n        for (var j = 0; j < spans.length; ++j) {\n          var sp = spans[j], m = sp.marker;\n          if (m.type == \"bookmark\" && sp.from == pos && m.widgetNode) {\n            foundBookmarks.push(m);\n          } else if (sp.from <= pos && (sp.to == null || sp.to > pos || m.collapsed && sp.to == pos && sp.from == pos)) {\n            if (sp.to != null && sp.to != pos && nextChange > sp.to) {\n              nextChange = sp.to;\n              spanEndStyle = \"\";\n            }\n            if (m.className) { spanStyle += \" \" + m.className; }\n            if (m.css) { css = (css ? css + \";\" : \"\") + m.css; }\n            if (m.startStyle && sp.from == pos) { spanStartStyle += \" \" + m.startStyle; }\n            if (m.endStyle && sp.to == nextChange) { (endStyles || (endStyles = [])).push(m.endStyle, sp.to); }\n            // support for the old title property\n            // https://github.com/codemirror/CodeMirror/pull/5673\n            if (m.title) { (attributes || (attributes = {})).title = m.title; }\n            if (m.attributes) {\n              for (var attr in m.attributes)\n                { (attributes || (attributes = {}))[attr] = m.attributes[attr]; }\n            }\n            if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0))\n              { collapsed = sp; }\n          } else if (sp.from > pos && nextChange > sp.from) {\n            nextChange = sp.from;\n          }\n        }\n        if (endStyles) { for (var j$1 = 0; j$1 < endStyles.length; j$1 += 2)\n          { if (endStyles[j$1 + 1] == nextChange) { spanEndStyle += \" \" + endStyles[j$1]; } } }\n\n        if (!collapsed || collapsed.from == pos) { for (var j$2 = 0; j$2 < foundBookmarks.length; ++j$2)\n          { buildCollapsedSpan(builder, 0, foundBookmarks[j$2]); } }\n        if (collapsed && (collapsed.from || 0) == pos) {\n          buildCollapsedSpan(builder, (collapsed.to == null ? len + 1 : collapsed.to) - pos,\n                             collapsed.marker, collapsed.from == null);\n          if (collapsed.to == null) { return }\n          if (collapsed.to == pos) { collapsed = false; }\n        }\n      }\n      if (pos >= len) { break }\n\n      var upto = Math.min(len, nextChange);\n      while (true) {\n        if (text) {\n          var end = pos + text.length;\n          if (!collapsed) {\n            var tokenText = end > upto ? text.slice(0, upto - pos) : text;\n            builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle,\n                             spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : \"\", css, attributes);\n          }\n          if (end >= upto) {text = text.slice(upto - pos); pos = upto; break}\n          pos = end;\n          spanStartStyle = \"\";\n        }\n        text = allText.slice(at, at = styles[i++]);\n        style = interpretTokenStyle(styles[i++], builder.cm.options);\n      }\n    }\n  }\n\n\n  // These objects are used to represent the visible (currently drawn)\n  // part of the document. A LineView may correspond to multiple\n  // logical lines, if those are connected by collapsed ranges.\n  function LineView(doc, line, lineN) {\n    // The starting line\n    this.line = line;\n    // Continuing lines, if any\n    this.rest = visualLineContinued(line);\n    // Number of logical lines in this visual line\n    this.size = this.rest ? lineNo(lst(this.rest)) - lineN + 1 : 1;\n    this.node = this.text = null;\n    this.hidden = lineIsHidden(doc, line);\n  }\n\n  // Create a range of LineView objects for the given lines.\n  function buildViewArray(cm, from, to) {\n    var array = [], nextPos;\n    for (var pos = from; pos < to; pos = nextPos) {\n      var view = new LineView(cm.doc, getLine(cm.doc, pos), pos);\n      nextPos = pos + view.size;\n      array.push(view);\n    }\n    return array\n  }\n\n  var operationGroup = null;\n\n  function pushOperation(op) {\n    if (operationGroup) {\n      operationGroup.ops.push(op);\n    } else {\n      op.ownsGroup = operationGroup = {\n        ops: [op],\n        delayedCallbacks: []\n      };\n    }\n  }\n\n  function fireCallbacksForOps(group) {\n    // Calls delayed callbacks and cursorActivity handlers until no\n    // new ones appear\n    var callbacks = group.delayedCallbacks, i = 0;\n    do {\n      for (; i < callbacks.length; i++)\n        { callbacks[i].call(null); }\n      for (var j = 0; j < group.ops.length; j++) {\n        var op = group.ops[j];\n        if (op.cursorActivityHandlers)\n          { while (op.cursorActivityCalled < op.cursorActivityHandlers.length)\n            { op.cursorActivityHandlers[op.cursorActivityCalled++].call(null, op.cm); } }\n      }\n    } while (i < callbacks.length)\n  }\n\n  function finishOperation(op, endCb) {\n    var group = op.ownsGroup;\n    if (!group) { return }\n\n    try { fireCallbacksForOps(group); }\n    finally {\n      operationGroup = null;\n      endCb(group);\n    }\n  }\n\n  var orphanDelayedCallbacks = null;\n\n  // Often, we want to signal events at a point where we are in the\n  // middle of some work, but don't want the handler to start calling\n  // other methods on the editor, which might be in an inconsistent\n  // state or simply not expect any other events to happen.\n  // signalLater looks whether there are any handlers, and schedules\n  // them to be executed when the last operation ends, or, if no\n  // operation is active, when a timeout fires.\n  function signalLater(emitter, type /*, values...*/) {\n    var arr = getHandlers(emitter, type);\n    if (!arr.length) { return }\n    var args = Array.prototype.slice.call(arguments, 2), list;\n    if (operationGroup) {\n      list = operationGroup.delayedCallbacks;\n    } else if (orphanDelayedCallbacks) {\n      list = orphanDelayedCallbacks;\n    } else {\n      list = orphanDelayedCallbacks = [];\n      setTimeout(fireOrphanDelayed, 0);\n    }\n    var loop = function ( i ) {\n      list.push(function () { return arr[i].apply(null, args); });\n    };\n\n    for (var i = 0; i < arr.length; ++i)\n      loop( i );\n  }\n\n  function fireOrphanDelayed() {\n    var delayed = orphanDelayedCallbacks;\n    orphanDelayedCallbacks = null;\n    for (var i = 0; i < delayed.length; ++i) { delayed[i](); }\n  }\n\n  // When an aspect of a line changes, a string is added to\n  // lineView.changes. This updates the relevant part of the line's\n  // DOM structure.\n  function updateLineForChanges(cm, lineView, lineN, dims) {\n    for (var j = 0; j < lineView.changes.length; j++) {\n      var type = lineView.changes[j];\n      if (type == \"text\") { updateLineText(cm, lineView); }\n      else if (type == \"gutter\") { updateLineGutter(cm, lineView, lineN, dims); }\n      else if (type == \"class\") { updateLineClasses(cm, lineView); }\n      else if (type == \"widget\") { updateLineWidgets(cm, lineView, dims); }\n    }\n    lineView.changes = null;\n  }\n\n  // Lines with gutter elements, widgets or a background class need to\n  // be wrapped, and have the extra elements added to the wrapper div\n  function ensureLineWrapped(lineView) {\n    if (lineView.node == lineView.text) {\n      lineView.node = elt(\"div\", null, null, \"position: relative\");\n      if (lineView.text.parentNode)\n        { lineView.text.parentNode.replaceChild(lineView.node, lineView.text); }\n      lineView.node.appendChild(lineView.text);\n      if (ie && ie_version < 8) { lineView.node.style.zIndex = 2; }\n    }\n    return lineView.node\n  }\n\n  function updateLineBackground(cm, lineView) {\n    var cls = lineView.bgClass ? lineView.bgClass + \" \" + (lineView.line.bgClass || \"\") : lineView.line.bgClass;\n    if (cls) { cls += \" CodeMirror-linebackground\"; }\n    if (lineView.background) {\n      if (cls) { lineView.background.className = cls; }\n      else { lineView.background.parentNode.removeChild(lineView.background); lineView.background = null; }\n    } else if (cls) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.background = wrap.insertBefore(elt(\"div\", null, cls), wrap.firstChild);\n      cm.display.input.setUneditable(lineView.background);\n    }\n  }\n\n  // Wrapper around buildLineContent which will reuse the structure\n  // in display.externalMeasured when possible.\n  function getLineContent(cm, lineView) {\n    var ext = cm.display.externalMeasured;\n    if (ext && ext.line == lineView.line) {\n      cm.display.externalMeasured = null;\n      lineView.measure = ext.measure;\n      return ext.built\n    }\n    return buildLineContent(cm, lineView)\n  }\n\n  // Redraw the line's text. Interacts with the background and text\n  // classes because the mode may output tokens that influence these\n  // classes.\n  function updateLineText(cm, lineView) {\n    var cls = lineView.text.className;\n    var built = getLineContent(cm, lineView);\n    if (lineView.text == lineView.node) { lineView.node = built.pre; }\n    lineView.text.parentNode.replaceChild(built.pre, lineView.text);\n    lineView.text = built.pre;\n    if (built.bgClass != lineView.bgClass || built.textClass != lineView.textClass) {\n      lineView.bgClass = built.bgClass;\n      lineView.textClass = built.textClass;\n      updateLineClasses(cm, lineView);\n    } else if (cls) {\n      lineView.text.className = cls;\n    }\n  }\n\n  function updateLineClasses(cm, lineView) {\n    updateLineBackground(cm, lineView);\n    if (lineView.line.wrapClass)\n      { ensureLineWrapped(lineView).className = lineView.line.wrapClass; }\n    else if (lineView.node != lineView.text)\n      { lineView.node.className = \"\"; }\n    var textClass = lineView.textClass ? lineView.textClass + \" \" + (lineView.line.textClass || \"\") : lineView.line.textClass;\n    lineView.text.className = textClass || \"\";\n  }\n\n  function updateLineGutter(cm, lineView, lineN, dims) {\n    if (lineView.gutter) {\n      lineView.node.removeChild(lineView.gutter);\n      lineView.gutter = null;\n    }\n    if (lineView.gutterBackground) {\n      lineView.node.removeChild(lineView.gutterBackground);\n      lineView.gutterBackground = null;\n    }\n    if (lineView.line.gutterClass) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.gutterBackground = elt(\"div\", null, \"CodeMirror-gutter-background \" + lineView.line.gutterClass,\n                                      (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px; width: \" + (dims.gutterTotalWidth) + \"px\"));\n      cm.display.input.setUneditable(lineView.gutterBackground);\n      wrap.insertBefore(lineView.gutterBackground, lineView.text);\n    }\n    var markers = lineView.line.gutterMarkers;\n    if (cm.options.lineNumbers || markers) {\n      var wrap$1 = ensureLineWrapped(lineView);\n      var gutterWrap = lineView.gutter = elt(\"div\", null, \"CodeMirror-gutter-wrapper\", (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px\"));\n      cm.display.input.setUneditable(gutterWrap);\n      wrap$1.insertBefore(gutterWrap, lineView.text);\n      if (lineView.line.gutterClass)\n        { gutterWrap.className += \" \" + lineView.line.gutterClass; }\n      if (cm.options.lineNumbers && (!markers || !markers[\"CodeMirror-linenumbers\"]))\n        { lineView.lineNumber = gutterWrap.appendChild(\n          elt(\"div\", lineNumberFor(cm.options, lineN),\n              \"CodeMirror-linenumber CodeMirror-gutter-elt\",\n              (\"left: \" + (dims.gutterLeft[\"CodeMirror-linenumbers\"]) + \"px; width: \" + (cm.display.lineNumInnerWidth) + \"px\"))); }\n      if (markers) { for (var k = 0; k < cm.display.gutterSpecs.length; ++k) {\n        var id = cm.display.gutterSpecs[k].className, found = markers.hasOwnProperty(id) && markers[id];\n        if (found)\n          { gutterWrap.appendChild(elt(\"div\", [found], \"CodeMirror-gutter-elt\",\n                                     (\"left: \" + (dims.gutterLeft[id]) + \"px; width: \" + (dims.gutterWidth[id]) + \"px\"))); }\n      } }\n    }\n  }\n\n  function updateLineWidgets(cm, lineView, dims) {\n    if (lineView.alignable) { lineView.alignable = null; }\n    var isWidget = classTest(\"CodeMirror-linewidget\");\n    for (var node = lineView.node.firstChild, next = (void 0); node; node = next) {\n      next = node.nextSibling;\n      if (isWidget.test(node.className)) { lineView.node.removeChild(node); }\n    }\n    insertLineWidgets(cm, lineView, dims);\n  }\n\n  // Build a line's DOM representation from scratch\n  function buildLineElement(cm, lineView, lineN, dims) {\n    var built = getLineContent(cm, lineView);\n    lineView.text = lineView.node = built.pre;\n    if (built.bgClass) { lineView.bgClass = built.bgClass; }\n    if (built.textClass) { lineView.textClass = built.textClass; }\n\n    updateLineClasses(cm, lineView);\n    updateLineGutter(cm, lineView, lineN, dims);\n    insertLineWidgets(cm, lineView, dims);\n    return lineView.node\n  }\n\n  // A lineView may contain multiple logical lines (when merged by\n  // collapsed spans). The widgets for all of them need to be drawn.\n  function insertLineWidgets(cm, lineView, dims) {\n    insertLineWidgetsFor(cm, lineView.line, lineView, dims, true);\n    if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n      { insertLineWidgetsFor(cm, lineView.rest[i], lineView, dims, false); } }\n  }\n\n  function insertLineWidgetsFor(cm, line, lineView, dims, allowAbove) {\n    if (!line.widgets) { return }\n    var wrap = ensureLineWrapped(lineView);\n    for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\n      var widget = ws[i], node = elt(\"div\", [widget.node], \"CodeMirror-linewidget\" + (widget.className ? \" \" + widget.className : \"\"));\n      if (!widget.handleMouseEvents) { node.setAttribute(\"cm-ignore-events\", \"true\"); }\n      positionLineWidget(widget, node, lineView, dims);\n      cm.display.input.setUneditable(node);\n      if (allowAbove && widget.above)\n        { wrap.insertBefore(node, lineView.gutter || lineView.text); }\n      else\n        { wrap.appendChild(node); }\n      signalLater(widget, \"redraw\");\n    }\n  }\n\n  function positionLineWidget(widget, node, lineView, dims) {\n    if (widget.noHScroll) {\n  (lineView.alignable || (lineView.alignable = [])).push(node);\n      var width = dims.wrapperWidth;\n      node.style.left = dims.fixedPos + \"px\";\n      if (!widget.coverGutter) {\n        width -= dims.gutterTotalWidth;\n        node.style.paddingLeft = dims.gutterTotalWidth + \"px\";\n      }\n      node.style.width = width + \"px\";\n    }\n    if (widget.coverGutter) {\n      node.style.zIndex = 5;\n      node.style.position = \"relative\";\n      if (!widget.noHScroll) { node.style.marginLeft = -dims.gutterTotalWidth + \"px\"; }\n    }\n  }\n\n  function widgetHeight(widget) {\n    if (widget.height != null) { return widget.height }\n    var cm = widget.doc.cm;\n    if (!cm) { return 0 }\n    if (!contains(document.body, widget.node)) {\n      var parentStyle = \"position: relative;\";\n      if (widget.coverGutter)\n        { parentStyle += \"margin-left: -\" + cm.display.gutters.offsetWidth + \"px;\"; }\n      if (widget.noHScroll)\n        { parentStyle += \"width: \" + cm.display.wrapper.clientWidth + \"px;\"; }\n      removeChildrenAndAdd(cm.display.measure, elt(\"div\", [widget.node], null, parentStyle));\n    }\n    return widget.height = widget.node.parentNode.offsetHeight\n  }\n\n  // Return true when the given mouse event happened in a widget\n  function eventInWidget(display, e) {\n    for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\n      if (!n || (n.nodeType == 1 && n.getAttribute(\"cm-ignore-events\") == \"true\") ||\n          (n.parentNode == display.sizer && n != display.mover))\n        { return true }\n    }\n  }\n\n  // POSITION MEASUREMENT\n\n  function paddingTop(display) {return display.lineSpace.offsetTop}\n  function paddingVert(display) {return display.mover.offsetHeight - display.lineSpace.offsetHeight}\n  function paddingH(display) {\n    if (display.cachedPaddingH) { return display.cachedPaddingH }\n    var e = removeChildrenAndAdd(display.measure, elt(\"pre\", \"x\", \"CodeMirror-line-like\"));\n    var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle;\n    var data = {left: parseInt(style.paddingLeft), right: parseInt(style.paddingRight)};\n    if (!isNaN(data.left) && !isNaN(data.right)) { display.cachedPaddingH = data; }\n    return data\n  }\n\n  function scrollGap(cm) { return scrollerGap - cm.display.nativeBarWidth }\n  function displayWidth(cm) {\n    return cm.display.scroller.clientWidth - scrollGap(cm) - cm.display.barWidth\n  }\n  function displayHeight(cm) {\n    return cm.display.scroller.clientHeight - scrollGap(cm) - cm.display.barHeight\n  }\n\n  // Ensure the lineView.wrapping.heights array is populated. This is\n  // an array of bottom offsets for the lines that make up a drawn\n  // line. When lineWrapping is on, there might be more than one\n  // height.\n  function ensureLineHeights(cm, lineView, rect) {\n    var wrapping = cm.options.lineWrapping;\n    var curWidth = wrapping && displayWidth(cm);\n    if (!lineView.measure.heights || wrapping && lineView.measure.width != curWidth) {\n      var heights = lineView.measure.heights = [];\n      if (wrapping) {\n        lineView.measure.width = curWidth;\n        var rects = lineView.text.firstChild.getClientRects();\n        for (var i = 0; i < rects.length - 1; i++) {\n          var cur = rects[i], next = rects[i + 1];\n          if (Math.abs(cur.bottom - next.bottom) > 2)\n            { heights.push((cur.bottom + next.top) / 2 - rect.top); }\n        }\n      }\n      heights.push(rect.bottom - rect.top);\n    }\n  }\n\n  // Find a line map (mapping character offsets to text nodes) and a\n  // measurement cache for the given line number. (A line view might\n  // contain multiple lines when collapsed ranges are present.)\n  function mapFromLineView(lineView, line, lineN) {\n    if (lineView.line == line)\n      { return {map: lineView.measure.map, cache: lineView.measure.cache} }\n    for (var i = 0; i < lineView.rest.length; i++)\n      { if (lineView.rest[i] == line)\n        { return {map: lineView.measure.maps[i], cache: lineView.measure.caches[i]} } }\n    for (var i$1 = 0; i$1 < lineView.rest.length; i$1++)\n      { if (lineNo(lineView.rest[i$1]) > lineN)\n        { return {map: lineView.measure.maps[i$1], cache: lineView.measure.caches[i$1], before: true} } }\n  }\n\n  // Render a line into the hidden node display.externalMeasured. Used\n  // when measurement is needed for a line that's not in the viewport.\n  function updateExternalMeasurement(cm, line) {\n    line = visualLine(line);\n    var lineN = lineNo(line);\n    var view = cm.display.externalMeasured = new LineView(cm.doc, line, lineN);\n    view.lineN = lineN;\n    var built = view.built = buildLineContent(cm, view);\n    view.text = built.pre;\n    removeChildrenAndAdd(cm.display.lineMeasure, built.pre);\n    return view\n  }\n\n  // Get a {top, bottom, left, right} box (in line-local coordinates)\n  // for a given character.\n  function measureChar(cm, line, ch, bias) {\n    return measureCharPrepared(cm, prepareMeasureForLine(cm, line), ch, bias)\n  }\n\n  // Find a line view that corresponds to the given line number.\n  function findViewForLine(cm, lineN) {\n    if (lineN >= cm.display.viewFrom && lineN < cm.display.viewTo)\n      { return cm.display.view[findViewIndex(cm, lineN)] }\n    var ext = cm.display.externalMeasured;\n    if (ext && lineN >= ext.lineN && lineN < ext.lineN + ext.size)\n      { return ext }\n  }\n\n  // Measurement can be split in two steps, the set-up work that\n  // applies to the whole line, and the measurement of the actual\n  // character. Functions like coordsChar, that need to do a lot of\n  // measurements in a row, can thus ensure that the set-up work is\n  // only done once.\n  function prepareMeasureForLine(cm, line) {\n    var lineN = lineNo(line);\n    var view = findViewForLine(cm, lineN);\n    if (view && !view.text) {\n      view = null;\n    } else if (view && view.changes) {\n      updateLineForChanges(cm, view, lineN, getDimensions(cm));\n      cm.curOp.forceUpdate = true;\n    }\n    if (!view)\n      { view = updateExternalMeasurement(cm, line); }\n\n    var info = mapFromLineView(view, line, lineN);\n    return {\n      line: line, view: view, rect: null,\n      map: info.map, cache: info.cache, before: info.before,\n      hasHeights: false\n    }\n  }\n\n  // Given a prepared measurement object, measures the position of an\n  // actual character (or fetches it from the cache).\n  function measureCharPrepared(cm, prepared, ch, bias, varHeight) {\n    if (prepared.before) { ch = -1; }\n    var key = ch + (bias || \"\"), found;\n    if (prepared.cache.hasOwnProperty(key)) {\n      found = prepared.cache[key];\n    } else {\n      if (!prepared.rect)\n        { prepared.rect = prepared.view.text.getBoundingClientRect(); }\n      if (!prepared.hasHeights) {\n        ensureLineHeights(cm, prepared.view, prepared.rect);\n        prepared.hasHeights = true;\n      }\n      found = measureCharInner(cm, prepared, ch, bias);\n      if (!found.bogus) { prepared.cache[key] = found; }\n    }\n    return {left: found.left, right: found.right,\n            top: varHeight ? found.rtop : found.top,\n            bottom: varHeight ? found.rbottom : found.bottom}\n  }\n\n  var nullRect = {left: 0, right: 0, top: 0, bottom: 0};\n\n  function nodeAndOffsetInLineMap(map, ch, bias) {\n    var node, start, end, collapse, mStart, mEnd;\n    // First, search the line map for the text node corresponding to,\n    // or closest to, the target character.\n    for (var i = 0; i < map.length; i += 3) {\n      mStart = map[i];\n      mEnd = map[i + 1];\n      if (ch < mStart) {\n        start = 0; end = 1;\n        collapse = \"left\";\n      } else if (ch < mEnd) {\n        start = ch - mStart;\n        end = start + 1;\n      } else if (i == map.length - 3 || ch == mEnd && map[i + 3] > ch) {\n        end = mEnd - mStart;\n        start = end - 1;\n        if (ch >= mEnd) { collapse = \"right\"; }\n      }\n      if (start != null) {\n        node = map[i + 2];\n        if (mStart == mEnd && bias == (node.insertLeft ? \"left\" : \"right\"))\n          { collapse = bias; }\n        if (bias == \"left\" && start == 0)\n          { while (i && map[i - 2] == map[i - 3] && map[i - 1].insertLeft) {\n            node = map[(i -= 3) + 2];\n            collapse = \"left\";\n          } }\n        if (bias == \"right\" && start == mEnd - mStart)\n          { while (i < map.length - 3 && map[i + 3] == map[i + 4] && !map[i + 5].insertLeft) {\n            node = map[(i += 3) + 2];\n            collapse = \"right\";\n          } }\n        break\n      }\n    }\n    return {node: node, start: start, end: end, collapse: collapse, coverStart: mStart, coverEnd: mEnd}\n  }\n\n  function getUsefulRect(rects, bias) {\n    var rect = nullRect;\n    if (bias == \"left\") { for (var i = 0; i < rects.length; i++) {\n      if ((rect = rects[i]).left != rect.right) { break }\n    } } else { for (var i$1 = rects.length - 1; i$1 >= 0; i$1--) {\n      if ((rect = rects[i$1]).left != rect.right) { break }\n    } }\n    return rect\n  }\n\n  function measureCharInner(cm, prepared, ch, bias) {\n    var place = nodeAndOffsetInLineMap(prepared.map, ch, bias);\n    var node = place.node, start = place.start, end = place.end, collapse = place.collapse;\n\n    var rect;\n    if (node.nodeType == 3) { // If it is a text node, use a range to retrieve the coordinates.\n      for (var i$1 = 0; i$1 < 4; i$1++) { // Retry a maximum of 4 times when nonsense rectangles are returned\n        while (start && isExtendingChar(prepared.line.text.charAt(place.coverStart + start))) { --start; }\n        while (place.coverStart + end < place.coverEnd && isExtendingChar(prepared.line.text.charAt(place.coverStart + end))) { ++end; }\n        if (ie && ie_version < 9 && start == 0 && end == place.coverEnd - place.coverStart)\n          { rect = node.parentNode.getBoundingClientRect(); }\n        else\n          { rect = getUsefulRect(range(node, start, end).getClientRects(), bias); }\n        if (rect.left || rect.right || start == 0) { break }\n        end = start;\n        start = start - 1;\n        collapse = \"right\";\n      }\n      if (ie && ie_version < 11) { rect = maybeUpdateRectForZooming(cm.display.measure, rect); }\n    } else { // If it is a widget, simply get the box for the whole widget.\n      if (start > 0) { collapse = bias = \"right\"; }\n      var rects;\n      if (cm.options.lineWrapping && (rects = node.getClientRects()).length > 1)\n        { rect = rects[bias == \"right\" ? rects.length - 1 : 0]; }\n      else\n        { rect = node.getBoundingClientRect(); }\n    }\n    if (ie && ie_version < 9 && !start && (!rect || !rect.left && !rect.right)) {\n      var rSpan = node.parentNode.getClientRects()[0];\n      if (rSpan)\n        { rect = {left: rSpan.left, right: rSpan.left + charWidth(cm.display), top: rSpan.top, bottom: rSpan.bottom}; }\n      else\n        { rect = nullRect; }\n    }\n\n    var rtop = rect.top - prepared.rect.top, rbot = rect.bottom - prepared.rect.top;\n    var mid = (rtop + rbot) / 2;\n    var heights = prepared.view.measure.heights;\n    var i = 0;\n    for (; i < heights.length - 1; i++)\n      { if (mid < heights[i]) { break } }\n    var top = i ? heights[i - 1] : 0, bot = heights[i];\n    var result = {left: (collapse == \"right\" ? rect.right : rect.left) - prepared.rect.left,\n                  right: (collapse == \"left\" ? rect.left : rect.right) - prepared.rect.left,\n                  top: top, bottom: bot};\n    if (!rect.left && !rect.right) { result.bogus = true; }\n    if (!cm.options.singleCursorHeightPerLine) { result.rtop = rtop; result.rbottom = rbot; }\n\n    return result\n  }\n\n  // Work around problem with bounding client rects on ranges being\n  // returned incorrectly when zoomed on IE10 and below.\n  function maybeUpdateRectForZooming(measure, rect) {\n    if (!window.screen || screen.logicalXDPI == null ||\n        screen.logicalXDPI == screen.deviceXDPI || !hasBadZoomedRects(measure))\n      { return rect }\n    var scaleX = screen.logicalXDPI / screen.deviceXDPI;\n    var scaleY = screen.logicalYDPI / screen.deviceYDPI;\n    return {left: rect.left * scaleX, right: rect.right * scaleX,\n            top: rect.top * scaleY, bottom: rect.bottom * scaleY}\n  }\n\n  function clearLineMeasurementCacheFor(lineView) {\n    if (lineView.measure) {\n      lineView.measure.cache = {};\n      lineView.measure.heights = null;\n      if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n        { lineView.measure.caches[i] = {}; } }\n    }\n  }\n\n  function clearLineMeasurementCache(cm) {\n    cm.display.externalMeasure = null;\n    removeChildren(cm.display.lineMeasure);\n    for (var i = 0; i < cm.display.view.length; i++)\n      { clearLineMeasurementCacheFor(cm.display.view[i]); }\n  }\n\n  function clearCaches(cm) {\n    clearLineMeasurementCache(cm);\n    cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null;\n    if (!cm.options.lineWrapping) { cm.display.maxLineChanged = true; }\n    cm.display.lineNumChars = null;\n  }\n\n  function pageScrollX() {\n    // Work around https://bugs.chromium.org/p/chromium/issues/detail?id=489206\n    // which causes page_Offset and bounding client rects to use\n    // different reference viewports and invalidate our calculations.\n    if (chrome && android) { return -(document.body.getBoundingClientRect().left - parseInt(getComputedStyle(document.body).marginLeft)) }\n    return window.pageXOffset || (document.documentElement || document.body).scrollLeft\n  }\n  function pageScrollY() {\n    if (chrome && android) { return -(document.body.getBoundingClientRect().top - parseInt(getComputedStyle(document.body).marginTop)) }\n    return window.pageYOffset || (document.documentElement || document.body).scrollTop\n  }\n\n  function widgetTopHeight(lineObj) {\n    var height = 0;\n    if (lineObj.widgets) { for (var i = 0; i < lineObj.widgets.length; ++i) { if (lineObj.widgets[i].above)\n      { height += widgetHeight(lineObj.widgets[i]); } } }\n    return height\n  }\n\n  // Converts a {top, bottom, left, right} box from line-local\n  // coordinates into another coordinate system. Context may be one of\n  // \"line\", \"div\" (display.lineDiv), \"local\"./null (editor), \"window\",\n  // or \"page\".\n  function intoCoordSystem(cm, lineObj, rect, context, includeWidgets) {\n    if (!includeWidgets) {\n      var height = widgetTopHeight(lineObj);\n      rect.top += height; rect.bottom += height;\n    }\n    if (context == \"line\") { return rect }\n    if (!context) { context = \"local\"; }\n    var yOff = heightAtLine(lineObj);\n    if (context == \"local\") { yOff += paddingTop(cm.display); }\n    else { yOff -= cm.display.viewOffset; }\n    if (context == \"page\" || context == \"window\") {\n      var lOff = cm.display.lineSpace.getBoundingClientRect();\n      yOff += lOff.top + (context == \"window\" ? 0 : pageScrollY());\n      var xOff = lOff.left + (context == \"window\" ? 0 : pageScrollX());\n      rect.left += xOff; rect.right += xOff;\n    }\n    rect.top += yOff; rect.bottom += yOff;\n    return rect\n  }\n\n  // Coverts a box from \"div\" coords to another coordinate system.\n  // Context may be \"window\", \"page\", \"div\", or \"local\"./null.\n  function fromCoordSystem(cm, coords, context) {\n    if (context == \"div\") { return coords }\n    var left = coords.left, top = coords.top;\n    // First move into \"page\" coordinate system\n    if (context == \"page\") {\n      left -= pageScrollX();\n      top -= pageScrollY();\n    } else if (context == \"local\" || !context) {\n      var localBox = cm.display.sizer.getBoundingClientRect();\n      left += localBox.left;\n      top += localBox.top;\n    }\n\n    var lineSpaceBox = cm.display.lineSpace.getBoundingClientRect();\n    return {left: left - lineSpaceBox.left, top: top - lineSpaceBox.top}\n  }\n\n  function charCoords(cm, pos, context, lineObj, bias) {\n    if (!lineObj) { lineObj = getLine(cm.doc, pos.line); }\n    return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, bias), context)\n  }\n\n  // Returns a box for a given cursor position, which may have an\n  // 'other' property containing the position of the secondary cursor\n  // on a bidi boundary.\n  // A cursor Pos(line, char, \"before\") is on the same visual line as `char - 1`\n  // and after `char - 1` in writing order of `char - 1`\n  // A cursor Pos(line, char, \"after\") is on the same visual line as `char`\n  // and before `char` in writing order of `char`\n  // Examples (upper-case letters are RTL, lower-case are LTR):\n  //     Pos(0, 1, ...)\n  //     before   after\n  // ab     a|b     a|b\n  // aB     a|B     aB|\n  // Ab     |Ab     A|b\n  // AB     B|A     B|A\n  // Every position after the last character on a line is considered to stick\n  // to the last character on the line.\n  function cursorCoords(cm, pos, context, lineObj, preparedMeasure, varHeight) {\n    lineObj = lineObj || getLine(cm.doc, pos.line);\n    if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n    function get(ch, right) {\n      var m = measureCharPrepared(cm, preparedMeasure, ch, right ? \"right\" : \"left\", varHeight);\n      if (right) { m.left = m.right; } else { m.right = m.left; }\n      return intoCoordSystem(cm, lineObj, m, context)\n    }\n    var order = getOrder(lineObj, cm.doc.direction), ch = pos.ch, sticky = pos.sticky;\n    if (ch >= lineObj.text.length) {\n      ch = lineObj.text.length;\n      sticky = \"before\";\n    } else if (ch <= 0) {\n      ch = 0;\n      sticky = \"after\";\n    }\n    if (!order) { return get(sticky == \"before\" ? ch - 1 : ch, sticky == \"before\") }\n\n    function getBidi(ch, partPos, invert) {\n      var part = order[partPos], right = part.level == 1;\n      return get(invert ? ch - 1 : ch, right != invert)\n    }\n    var partPos = getBidiPartAt(order, ch, sticky);\n    var other = bidiOther;\n    var val = getBidi(ch, partPos, sticky == \"before\");\n    if (other != null) { val.other = getBidi(ch, other, sticky != \"before\"); }\n    return val\n  }\n\n  // Used to cheaply estimate the coordinates for a position. Used for\n  // intermediate scroll updates.\n  function estimateCoords(cm, pos) {\n    var left = 0;\n    pos = clipPos(cm.doc, pos);\n    if (!cm.options.lineWrapping) { left = charWidth(cm.display) * pos.ch; }\n    var lineObj = getLine(cm.doc, pos.line);\n    var top = heightAtLine(lineObj) + paddingTop(cm.display);\n    return {left: left, right: left, top: top, bottom: top + lineObj.height}\n  }\n\n  // Positions returned by coordsChar contain some extra information.\n  // xRel is the relative x position of the input coordinates compared\n  // to the found position (so xRel > 0 means the coordinates are to\n  // the right of the character position, for example). When outside\n  // is true, that means the coordinates lie outside the line's\n  // vertical range.\n  function PosWithInfo(line, ch, sticky, outside, xRel) {\n    var pos = Pos(line, ch, sticky);\n    pos.xRel = xRel;\n    if (outside) { pos.outside = outside; }\n    return pos\n  }\n\n  // Compute the character position closest to the given coordinates.\n  // Input must be lineSpace-local (\"div\" coordinate system).\n  function coordsChar(cm, x, y) {\n    var doc = cm.doc;\n    y += cm.display.viewOffset;\n    if (y < 0) { return PosWithInfo(doc.first, 0, null, -1, -1) }\n    var lineN = lineAtHeight(doc, y), last = doc.first + doc.size - 1;\n    if (lineN > last)\n      { return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, null, 1, 1) }\n    if (x < 0) { x = 0; }\n\n    var lineObj = getLine(doc, lineN);\n    for (;;) {\n      var found = coordsCharInner(cm, lineObj, lineN, x, y);\n      var collapsed = collapsedSpanAround(lineObj, found.ch + (found.xRel > 0 || found.outside > 0 ? 1 : 0));\n      if (!collapsed) { return found }\n      var rangeEnd = collapsed.find(1);\n      if (rangeEnd.line == lineN) { return rangeEnd }\n      lineObj = getLine(doc, lineN = rangeEnd.line);\n    }\n  }\n\n  function wrappedLineExtent(cm, lineObj, preparedMeasure, y) {\n    y -= widgetTopHeight(lineObj);\n    var end = lineObj.text.length;\n    var begin = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch - 1).bottom <= y; }, end, 0);\n    end = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch).top > y; }, begin, end);\n    return {begin: begin, end: end}\n  }\n\n  function wrappedLineExtentChar(cm, lineObj, preparedMeasure, target) {\n    if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n    var targetTop = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, target), \"line\").top;\n    return wrappedLineExtent(cm, lineObj, preparedMeasure, targetTop)\n  }\n\n  // Returns true if the given side of a box is after the given\n  // coordinates, in top-to-bottom, left-to-right order.\n  function boxIsAfter(box, x, y, left) {\n    return box.bottom <= y ? false : box.top > y ? true : (left ? box.left : box.right) > x\n  }\n\n  function coordsCharInner(cm, lineObj, lineNo, x, y) {\n    // Move y into line-local coordinate space\n    y -= heightAtLine(lineObj);\n    var preparedMeasure = prepareMeasureForLine(cm, lineObj);\n    // When directly calling `measureCharPrepared`, we have to adjust\n    // for the widgets at this line.\n    var widgetHeight = widgetTopHeight(lineObj);\n    var begin = 0, end = lineObj.text.length, ltr = true;\n\n    var order = getOrder(lineObj, cm.doc.direction);\n    // If the line isn't plain left-to-right text, first figure out\n    // which bidi section the coordinates fall into.\n    if (order) {\n      var part = (cm.options.lineWrapping ? coordsBidiPartWrapped : coordsBidiPart)\n                   (cm, lineObj, lineNo, preparedMeasure, order, x, y);\n      ltr = part.level != 1;\n      // The awkward -1 offsets are needed because findFirst (called\n      // on these below) will treat its first bound as inclusive,\n      // second as exclusive, but we want to actually address the\n      // characters in the part's range\n      begin = ltr ? part.from : part.to - 1;\n      end = ltr ? part.to : part.from - 1;\n    }\n\n    // A binary search to find the first character whose bounding box\n    // starts after the coordinates. If we run across any whose box wrap\n    // the coordinates, store that.\n    var chAround = null, boxAround = null;\n    var ch = findFirst(function (ch) {\n      var box = measureCharPrepared(cm, preparedMeasure, ch);\n      box.top += widgetHeight; box.bottom += widgetHeight;\n      if (!boxIsAfter(box, x, y, false)) { return false }\n      if (box.top <= y && box.left <= x) {\n        chAround = ch;\n        boxAround = box;\n      }\n      return true\n    }, begin, end);\n\n    var baseX, sticky, outside = false;\n    // If a box around the coordinates was found, use that\n    if (boxAround) {\n      // Distinguish coordinates nearer to the left or right side of the box\n      var atLeft = x - boxAround.left < boxAround.right - x, atStart = atLeft == ltr;\n      ch = chAround + (atStart ? 0 : 1);\n      sticky = atStart ? \"after\" : \"before\";\n      baseX = atLeft ? boxAround.left : boxAround.right;\n    } else {\n      // (Adjust for extended bound, if necessary.)\n      if (!ltr && (ch == end || ch == begin)) { ch++; }\n      // To determine which side to associate with, get the box to the\n      // left of the character and compare it's vertical position to the\n      // coordinates\n      sticky = ch == 0 ? \"after\" : ch == lineObj.text.length ? \"before\" :\n        (measureCharPrepared(cm, preparedMeasure, ch - (ltr ? 1 : 0)).bottom + widgetHeight <= y) == ltr ?\n        \"after\" : \"before\";\n      // Now get accurate coordinates for this place, in order to get a\n      // base X position\n      var coords = cursorCoords(cm, Pos(lineNo, ch, sticky), \"line\", lineObj, preparedMeasure);\n      baseX = coords.left;\n      outside = y < coords.top ? -1 : y >= coords.bottom ? 1 : 0;\n    }\n\n    ch = skipExtendingChars(lineObj.text, ch, 1);\n    return PosWithInfo(lineNo, ch, sticky, outside, x - baseX)\n  }\n\n  function coordsBidiPart(cm, lineObj, lineNo, preparedMeasure, order, x, y) {\n    // Bidi parts are sorted left-to-right, and in a non-line-wrapping\n    // situation, we can take this ordering to correspond to the visual\n    // ordering. This finds the first part whose end is after the given\n    // coordinates.\n    var index = findFirst(function (i) {\n      var part = order[i], ltr = part.level != 1;\n      return boxIsAfter(cursorCoords(cm, Pos(lineNo, ltr ? part.to : part.from, ltr ? \"before\" : \"after\"),\n                                     \"line\", lineObj, preparedMeasure), x, y, true)\n    }, 0, order.length - 1);\n    var part = order[index];\n    // If this isn't the first part, the part's start is also after\n    // the coordinates, and the coordinates aren't on the same line as\n    // that start, move one part back.\n    if (index > 0) {\n      var ltr = part.level != 1;\n      var start = cursorCoords(cm, Pos(lineNo, ltr ? part.from : part.to, ltr ? \"after\" : \"before\"),\n                               \"line\", lineObj, preparedMeasure);\n      if (boxIsAfter(start, x, y, true) && start.top > y)\n        { part = order[index - 1]; }\n    }\n    return part\n  }\n\n  function coordsBidiPartWrapped(cm, lineObj, _lineNo, preparedMeasure, order, x, y) {\n    // In a wrapped line, rtl text on wrapping boundaries can do things\n    // that don't correspond to the ordering in our `order` array at\n    // all, so a binary search doesn't work, and we want to return a\n    // part that only spans one line so that the binary search in\n    // coordsCharInner is safe. As such, we first find the extent of the\n    // wrapped line, and then do a flat search in which we discard any\n    // spans that aren't on the line.\n    var ref = wrappedLineExtent(cm, lineObj, preparedMeasure, y);\n    var begin = ref.begin;\n    var end = ref.end;\n    if (/\\s/.test(lineObj.text.charAt(end - 1))) { end--; }\n    var part = null, closestDist = null;\n    for (var i = 0; i < order.length; i++) {\n      var p = order[i];\n      if (p.from >= end || p.to <= begin) { continue }\n      var ltr = p.level != 1;\n      var endX = measureCharPrepared(cm, preparedMeasure, ltr ? Math.min(end, p.to) - 1 : Math.max(begin, p.from)).right;\n      // Weigh against spans ending before this, so that they are only\n      // picked if nothing ends after\n      var dist = endX < x ? x - endX + 1e9 : endX - x;\n      if (!part || closestDist > dist) {\n        part = p;\n        closestDist = dist;\n      }\n    }\n    if (!part) { part = order[order.length - 1]; }\n    // Clip the part to the wrapped line.\n    if (part.from < begin) { part = {from: begin, to: part.to, level: part.level}; }\n    if (part.to > end) { part = {from: part.from, to: end, level: part.level}; }\n    return part\n  }\n\n  var measureText;\n  // Compute the default text height.\n  function textHeight(display) {\n    if (display.cachedTextHeight != null) { return display.cachedTextHeight }\n    if (measureText == null) {\n      measureText = elt(\"pre\", null, \"CodeMirror-line-like\");\n      // Measure a bunch of lines, for browsers that compute\n      // fractional heights.\n      for (var i = 0; i < 49; ++i) {\n        measureText.appendChild(document.createTextNode(\"x\"));\n        measureText.appendChild(elt(\"br\"));\n      }\n      measureText.appendChild(document.createTextNode(\"x\"));\n    }\n    removeChildrenAndAdd(display.measure, measureText);\n    var height = measureText.offsetHeight / 50;\n    if (height > 3) { display.cachedTextHeight = height; }\n    removeChildren(display.measure);\n    return height || 1\n  }\n\n  // Compute the default character width.\n  function charWidth(display) {\n    if (display.cachedCharWidth != null) { return display.cachedCharWidth }\n    var anchor = elt(\"span\", \"xxxxxxxxxx\");\n    var pre = elt(\"pre\", [anchor], \"CodeMirror-line-like\");\n    removeChildrenAndAdd(display.measure, pre);\n    var rect = anchor.getBoundingClientRect(), width = (rect.right - rect.left) / 10;\n    if (width > 2) { display.cachedCharWidth = width; }\n    return width || 10\n  }\n\n  // Do a bulk-read of the DOM positions and sizes needed to draw the\n  // view, so that we don't interleave reading and writing to the DOM.\n  function getDimensions(cm) {\n    var d = cm.display, left = {}, width = {};\n    var gutterLeft = d.gutters.clientLeft;\n    for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\n      var id = cm.display.gutterSpecs[i].className;\n      left[id] = n.offsetLeft + n.clientLeft + gutterLeft;\n      width[id] = n.clientWidth;\n    }\n    return {fixedPos: compensateForHScroll(d),\n            gutterTotalWidth: d.gutters.offsetWidth,\n            gutterLeft: left,\n            gutterWidth: width,\n            wrapperWidth: d.wrapper.clientWidth}\n  }\n\n  // Computes display.scroller.scrollLeft + display.gutters.offsetWidth,\n  // but using getBoundingClientRect to get a sub-pixel-accurate\n  // result.\n  function compensateForHScroll(display) {\n    return display.scroller.getBoundingClientRect().left - display.sizer.getBoundingClientRect().left\n  }\n\n  // Returns a function that estimates the height of a line, to use as\n  // first approximation until the line becomes visible (and is thus\n  // properly measurable).\n  function estimateHeight(cm) {\n    var th = textHeight(cm.display), wrapping = cm.options.lineWrapping;\n    var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3);\n    return function (line) {\n      if (lineIsHidden(cm.doc, line)) { return 0 }\n\n      var widgetsHeight = 0;\n      if (line.widgets) { for (var i = 0; i < line.widgets.length; i++) {\n        if (line.widgets[i].height) { widgetsHeight += line.widgets[i].height; }\n      } }\n\n      if (wrapping)\n        { return widgetsHeight + (Math.ceil(line.text.length / perLine) || 1) * th }\n      else\n        { return widgetsHeight + th }\n    }\n  }\n\n  function estimateLineHeights(cm) {\n    var doc = cm.doc, est = estimateHeight(cm);\n    doc.iter(function (line) {\n      var estHeight = est(line);\n      if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n    });\n  }\n\n  // Given a mouse event, find the corresponding position. If liberal\n  // is false, it checks whether a gutter or scrollbar was clicked,\n  // and returns null if it was. forRect is used by rectangular\n  // selections, and tries to estimate a character position even for\n  // coordinates beyond the right of the text.\n  function posFromMouse(cm, e, liberal, forRect) {\n    var display = cm.display;\n    if (!liberal && e_target(e).getAttribute(\"cm-not-content\") == \"true\") { return null }\n\n    var x, y, space = display.lineSpace.getBoundingClientRect();\n    // Fails unpredictably on IE[67] when mouse is dragged around quickly.\n    try { x = e.clientX - space.left; y = e.clientY - space.top; }\n    catch (e) { return null }\n    var coords = coordsChar(cm, x, y), line;\n    if (forRect && coords.xRel > 0 && (line = getLine(cm.doc, coords.line).text).length == coords.ch) {\n      var colDiff = countColumn(line, line.length, cm.options.tabSize) - line.length;\n      coords = Pos(coords.line, Math.max(0, Math.round((x - paddingH(cm.display).left) / charWidth(cm.display)) - colDiff));\n    }\n    return coords\n  }\n\n  // Find the view element corresponding to a given line. Return null\n  // when the line isn't visible.\n  function findViewIndex(cm, n) {\n    if (n >= cm.display.viewTo) { return null }\n    n -= cm.display.viewFrom;\n    if (n < 0) { return null }\n    var view = cm.display.view;\n    for (var i = 0; i < view.length; i++) {\n      n -= view[i].size;\n      if (n < 0) { return i }\n    }\n  }\n\n  // Updates the display.view data structure for a given change to the\n  // document. From and to are in pre-change coordinates. Lendiff is\n  // the amount of lines added or subtracted by the change. This is\n  // used for changes that span multiple lines, or change the way\n  // lines are divided into visual lines. regLineChange (below)\n  // registers single-line changes.\n  function regChange(cm, from, to, lendiff) {\n    if (from == null) { from = cm.doc.first; }\n    if (to == null) { to = cm.doc.first + cm.doc.size; }\n    if (!lendiff) { lendiff = 0; }\n\n    var display = cm.display;\n    if (lendiff && to < display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers > from))\n      { display.updateLineNumbers = from; }\n\n    cm.curOp.viewChanged = true;\n\n    if (from >= display.viewTo) { // Change after\n      if (sawCollapsedSpans && visualLineNo(cm.doc, from) < display.viewTo)\n        { resetView(cm); }\n    } else if (to <= display.viewFrom) { // Change before\n      if (sawCollapsedSpans && visualLineEndNo(cm.doc, to + lendiff) > display.viewFrom) {\n        resetView(cm);\n      } else {\n        display.viewFrom += lendiff;\n        display.viewTo += lendiff;\n      }\n    } else if (from <= display.viewFrom && to >= display.viewTo) { // Full overlap\n      resetView(cm);\n    } else if (from <= display.viewFrom) { // Top overlap\n      var cut = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cut) {\n        display.view = display.view.slice(cut.index);\n        display.viewFrom = cut.lineN;\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    } else if (to >= display.viewTo) { // Bottom overlap\n      var cut$1 = viewCuttingPoint(cm, from, from, -1);\n      if (cut$1) {\n        display.view = display.view.slice(0, cut$1.index);\n        display.viewTo = cut$1.lineN;\n      } else {\n        resetView(cm);\n      }\n    } else { // Gap in the middle\n      var cutTop = viewCuttingPoint(cm, from, from, -1);\n      var cutBot = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cutTop && cutBot) {\n        display.view = display.view.slice(0, cutTop.index)\n          .concat(buildViewArray(cm, cutTop.lineN, cutBot.lineN))\n          .concat(display.view.slice(cutBot.index));\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    }\n\n    var ext = display.externalMeasured;\n    if (ext) {\n      if (to < ext.lineN)\n        { ext.lineN += lendiff; }\n      else if (from < ext.lineN + ext.size)\n        { display.externalMeasured = null; }\n    }\n  }\n\n  // Register a change to a single line. Type must be one of \"text\",\n  // \"gutter\", \"class\", \"widget\"\n  function regLineChange(cm, line, type) {\n    cm.curOp.viewChanged = true;\n    var display = cm.display, ext = cm.display.externalMeasured;\n    if (ext && line >= ext.lineN && line < ext.lineN + ext.size)\n      { display.externalMeasured = null; }\n\n    if (line < display.viewFrom || line >= display.viewTo) { return }\n    var lineView = display.view[findViewIndex(cm, line)];\n    if (lineView.node == null) { return }\n    var arr = lineView.changes || (lineView.changes = []);\n    if (indexOf(arr, type) == -1) { arr.push(type); }\n  }\n\n  // Clear the view.\n  function resetView(cm) {\n    cm.display.viewFrom = cm.display.viewTo = cm.doc.first;\n    cm.display.view = [];\n    cm.display.viewOffset = 0;\n  }\n\n  function viewCuttingPoint(cm, oldN, newN, dir) {\n    var index = findViewIndex(cm, oldN), diff, view = cm.display.view;\n    if (!sawCollapsedSpans || newN == cm.doc.first + cm.doc.size)\n      { return {index: index, lineN: newN} }\n    var n = cm.display.viewFrom;\n    for (var i = 0; i < index; i++)\n      { n += view[i].size; }\n    if (n != oldN) {\n      if (dir > 0) {\n        if (index == view.length - 1) { return null }\n        diff = (n + view[index].size) - oldN;\n        index++;\n      } else {\n        diff = n - oldN;\n      }\n      oldN += diff; newN += diff;\n    }\n    while (visualLineNo(cm.doc, newN) != newN) {\n      if (index == (dir < 0 ? 0 : view.length - 1)) { return null }\n      newN += dir * view[index - (dir < 0 ? 1 : 0)].size;\n      index += dir;\n    }\n    return {index: index, lineN: newN}\n  }\n\n  // Force the view to cover a given range, adding empty view element\n  // or clipping off existing ones as needed.\n  function adjustView(cm, from, to) {\n    var display = cm.display, view = display.view;\n    if (view.length == 0 || from >= display.viewTo || to <= display.viewFrom) {\n      display.view = buildViewArray(cm, from, to);\n      display.viewFrom = from;\n    } else {\n      if (display.viewFrom > from)\n        { display.view = buildViewArray(cm, from, display.viewFrom).concat(display.view); }\n      else if (display.viewFrom < from)\n        { display.view = display.view.slice(findViewIndex(cm, from)); }\n      display.viewFrom = from;\n      if (display.viewTo < to)\n        { display.view = display.view.concat(buildViewArray(cm, display.viewTo, to)); }\n      else if (display.viewTo > to)\n        { display.view = display.view.slice(0, findViewIndex(cm, to)); }\n    }\n    display.viewTo = to;\n  }\n\n  // Count the number of lines in the view whose DOM representation is\n  // out of date (or nonexistent).\n  function countDirtyView(cm) {\n    var view = cm.display.view, dirty = 0;\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (!lineView.hidden && (!lineView.node || lineView.changes)) { ++dirty; }\n    }\n    return dirty\n  }\n\n  function updateSelection(cm) {\n    cm.display.input.showSelection(cm.display.input.prepareSelection());\n  }\n\n  function prepareSelection(cm, primary) {\n    if ( primary === void 0 ) primary = true;\n\n    var doc = cm.doc, result = {};\n    var curFragment = result.cursors = document.createDocumentFragment();\n    var selFragment = result.selection = document.createDocumentFragment();\n\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      if (!primary && i == doc.sel.primIndex) { continue }\n      var range = doc.sel.ranges[i];\n      if (range.from().line >= cm.display.viewTo || range.to().line < cm.display.viewFrom) { continue }\n      var collapsed = range.empty();\n      if (collapsed || cm.options.showCursorWhenSelecting)\n        { drawSelectionCursor(cm, range.head, curFragment); }\n      if (!collapsed)\n        { drawSelectionRange(cm, range, selFragment); }\n    }\n    return result\n  }\n\n  // Draws a cursor for the given range\n  function drawSelectionCursor(cm, head, output) {\n    var pos = cursorCoords(cm, head, \"div\", null, null, !cm.options.singleCursorHeightPerLine);\n\n    var cursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor\"));\n    cursor.style.left = pos.left + \"px\";\n    cursor.style.top = pos.top + \"px\";\n    cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + \"px\";\n\n    if (pos.other) {\n      // Secondary cursor, shown when on a 'jump' in bi-directional text\n      var otherCursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor CodeMirror-secondarycursor\"));\n      otherCursor.style.display = \"\";\n      otherCursor.style.left = pos.other.left + \"px\";\n      otherCursor.style.top = pos.other.top + \"px\";\n      otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + \"px\";\n    }\n  }\n\n  function cmpCoords(a, b) { return a.top - b.top || a.left - b.left }\n\n  // Draws the given range as a highlighted selection\n  function drawSelectionRange(cm, range, output) {\n    var display = cm.display, doc = cm.doc;\n    var fragment = document.createDocumentFragment();\n    var padding = paddingH(cm.display), leftSide = padding.left;\n    var rightSide = Math.max(display.sizerWidth, displayWidth(cm) - display.sizer.offsetLeft) - padding.right;\n    var docLTR = doc.direction == \"ltr\";\n\n    function add(left, top, width, bottom) {\n      if (top < 0) { top = 0; }\n      top = Math.round(top);\n      bottom = Math.round(bottom);\n      fragment.appendChild(elt(\"div\", null, \"CodeMirror-selected\", (\"position: absolute; left: \" + left + \"px;\\n                             top: \" + top + \"px; width: \" + (width == null ? rightSide - left : width) + \"px;\\n                             height: \" + (bottom - top) + \"px\")));\n    }\n\n    function drawForLine(line, fromArg, toArg) {\n      var lineObj = getLine(doc, line);\n      var lineLen = lineObj.text.length;\n      var start, end;\n      function coords(ch, bias) {\n        return charCoords(cm, Pos(line, ch), \"div\", lineObj, bias)\n      }\n\n      function wrapX(pos, dir, side) {\n        var extent = wrappedLineExtentChar(cm, lineObj, null, pos);\n        var prop = (dir == \"ltr\") == (side == \"after\") ? \"left\" : \"right\";\n        var ch = side == \"after\" ? extent.begin : extent.end - (/\\s/.test(lineObj.text.charAt(extent.end - 1)) ? 2 : 1);\n        return coords(ch, prop)[prop]\n      }\n\n      var order = getOrder(lineObj, doc.direction);\n      iterateBidiSections(order, fromArg || 0, toArg == null ? lineLen : toArg, function (from, to, dir, i) {\n        var ltr = dir == \"ltr\";\n        var fromPos = coords(from, ltr ? \"left\" : \"right\");\n        var toPos = coords(to - 1, ltr ? \"right\" : \"left\");\n\n        var openStart = fromArg == null && from == 0, openEnd = toArg == null && to == lineLen;\n        var first = i == 0, last = !order || i == order.length - 1;\n        if (toPos.top - fromPos.top <= 3) { // Single line\n          var openLeft = (docLTR ? openStart : openEnd) && first;\n          var openRight = (docLTR ? openEnd : openStart) && last;\n          var left = openLeft ? leftSide : (ltr ? fromPos : toPos).left;\n          var right = openRight ? rightSide : (ltr ? toPos : fromPos).right;\n          add(left, fromPos.top, right - left, fromPos.bottom);\n        } else { // Multiple lines\n          var topLeft, topRight, botLeft, botRight;\n          if (ltr) {\n            topLeft = docLTR && openStart && first ? leftSide : fromPos.left;\n            topRight = docLTR ? rightSide : wrapX(from, dir, \"before\");\n            botLeft = docLTR ? leftSide : wrapX(to, dir, \"after\");\n            botRight = docLTR && openEnd && last ? rightSide : toPos.right;\n          } else {\n            topLeft = !docLTR ? leftSide : wrapX(from, dir, \"before\");\n            topRight = !docLTR && openStart && first ? rightSide : fromPos.right;\n            botLeft = !docLTR && openEnd && last ? leftSide : toPos.left;\n            botRight = !docLTR ? rightSide : wrapX(to, dir, \"after\");\n          }\n          add(topLeft, fromPos.top, topRight - topLeft, fromPos.bottom);\n          if (fromPos.bottom < toPos.top) { add(leftSide, fromPos.bottom, null, toPos.top); }\n          add(botLeft, toPos.top, botRight - botLeft, toPos.bottom);\n        }\n\n        if (!start || cmpCoords(fromPos, start) < 0) { start = fromPos; }\n        if (cmpCoords(toPos, start) < 0) { start = toPos; }\n        if (!end || cmpCoords(fromPos, end) < 0) { end = fromPos; }\n        if (cmpCoords(toPos, end) < 0) { end = toPos; }\n      });\n      return {start: start, end: end}\n    }\n\n    var sFrom = range.from(), sTo = range.to();\n    if (sFrom.line == sTo.line) {\n      drawForLine(sFrom.line, sFrom.ch, sTo.ch);\n    } else {\n      var fromLine = getLine(doc, sFrom.line), toLine = getLine(doc, sTo.line);\n      var singleVLine = visualLine(fromLine) == visualLine(toLine);\n      var leftEnd = drawForLine(sFrom.line, sFrom.ch, singleVLine ? fromLine.text.length + 1 : null).end;\n      var rightStart = drawForLine(sTo.line, singleVLine ? 0 : null, sTo.ch).start;\n      if (singleVLine) {\n        if (leftEnd.top < rightStart.top - 2) {\n          add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);\n          add(leftSide, rightStart.top, rightStart.left, rightStart.bottom);\n        } else {\n          add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);\n        }\n      }\n      if (leftEnd.bottom < rightStart.top)\n        { add(leftSide, leftEnd.bottom, null, rightStart.top); }\n    }\n\n    output.appendChild(fragment);\n  }\n\n  // Cursor-blinking\n  function restartBlink(cm) {\n    if (!cm.state.focused) { return }\n    var display = cm.display;\n    clearInterval(display.blinker);\n    var on = true;\n    display.cursorDiv.style.visibility = \"\";\n    if (cm.options.cursorBlinkRate > 0)\n      { display.blinker = setInterval(function () { return display.cursorDiv.style.visibility = (on = !on) ? \"\" : \"hidden\"; },\n        cm.options.cursorBlinkRate); }\n    else if (cm.options.cursorBlinkRate < 0)\n      { display.cursorDiv.style.visibility = \"hidden\"; }\n  }\n\n  function ensureFocus(cm) {\n    if (!cm.state.focused) { cm.display.input.focus(); onFocus(cm); }\n  }\n\n  function delayBlurEvent(cm) {\n    cm.state.delayingBlurEvent = true;\n    setTimeout(function () { if (cm.state.delayingBlurEvent) {\n      cm.state.delayingBlurEvent = false;\n      onBlur(cm);\n    } }, 100);\n  }\n\n  function onFocus(cm, e) {\n    if (cm.state.delayingBlurEvent) { cm.state.delayingBlurEvent = false; }\n\n    if (cm.options.readOnly == \"nocursor\") { return }\n    if (!cm.state.focused) {\n      signal(cm, \"focus\", cm, e);\n      cm.state.focused = true;\n      addClass(cm.display.wrapper, \"CodeMirror-focused\");\n      // This test prevents this from firing when a context\n      // menu is closed (since the input reset would kill the\n      // select-all detection hack)\n      if (!cm.curOp && cm.display.selForContextMenu != cm.doc.sel) {\n        cm.display.input.reset();\n        if (webkit) { setTimeout(function () { return cm.display.input.reset(true); }, 20); } // Issue #1730\n      }\n      cm.display.input.receivedFocus();\n    }\n    restartBlink(cm);\n  }\n  function onBlur(cm, e) {\n    if (cm.state.delayingBlurEvent) { return }\n\n    if (cm.state.focused) {\n      signal(cm, \"blur\", cm, e);\n      cm.state.focused = false;\n      rmClass(cm.display.wrapper, \"CodeMirror-focused\");\n    }\n    clearInterval(cm.display.blinker);\n    setTimeout(function () { if (!cm.state.focused) { cm.display.shift = false; } }, 150);\n  }\n\n  // Read the actual heights of the rendered lines, and update their\n  // stored heights to match.\n  function updateHeightsInViewport(cm) {\n    var display = cm.display;\n    var prevBottom = display.lineDiv.offsetTop;\n    for (var i = 0; i < display.view.length; i++) {\n      var cur = display.view[i], wrapping = cm.options.lineWrapping;\n      var height = (void 0), width = 0;\n      if (cur.hidden) { continue }\n      if (ie && ie_version < 8) {\n        var bot = cur.node.offsetTop + cur.node.offsetHeight;\n        height = bot - prevBottom;\n        prevBottom = bot;\n      } else {\n        var box = cur.node.getBoundingClientRect();\n        height = box.bottom - box.top;\n        // Check that lines don't extend past the right of the current\n        // editor width\n        if (!wrapping && cur.text.firstChild)\n          { width = cur.text.firstChild.getBoundingClientRect().right - box.left - 1; }\n      }\n      var diff = cur.line.height - height;\n      if (diff > .005 || diff < -.005) {\n        updateLineHeight(cur.line, height);\n        updateWidgetHeight(cur.line);\n        if (cur.rest) { for (var j = 0; j < cur.rest.length; j++)\n          { updateWidgetHeight(cur.rest[j]); } }\n      }\n      if (width > cm.display.sizerWidth) {\n        var chWidth = Math.ceil(width / charWidth(cm.display));\n        if (chWidth > cm.display.maxLineLength) {\n          cm.display.maxLineLength = chWidth;\n          cm.display.maxLine = cur.line;\n          cm.display.maxLineChanged = true;\n        }\n      }\n    }\n  }\n\n  // Read and store the height of line widgets associated with the\n  // given line.\n  function updateWidgetHeight(line) {\n    if (line.widgets) { for (var i = 0; i < line.widgets.length; ++i) {\n      var w = line.widgets[i], parent = w.node.parentNode;\n      if (parent) { w.height = parent.offsetHeight; }\n    } }\n  }\n\n  // Compute the lines that are visible in a given viewport (defaults\n  // the the current scroll position). viewport may contain top,\n  // height, and ensure (see op.scrollToPos) properties.\n  function visibleLines(display, doc, viewport) {\n    var top = viewport && viewport.top != null ? Math.max(0, viewport.top) : display.scroller.scrollTop;\n    top = Math.floor(top - paddingTop(display));\n    var bottom = viewport && viewport.bottom != null ? viewport.bottom : top + display.wrapper.clientHeight;\n\n    var from = lineAtHeight(doc, top), to = lineAtHeight(doc, bottom);\n    // Ensure is a {from: {line, ch}, to: {line, ch}} object, and\n    // forces those lines into the viewport (if possible).\n    if (viewport && viewport.ensure) {\n      var ensureFrom = viewport.ensure.from.line, ensureTo = viewport.ensure.to.line;\n      if (ensureFrom < from) {\n        from = ensureFrom;\n        to = lineAtHeight(doc, heightAtLine(getLine(doc, ensureFrom)) + display.wrapper.clientHeight);\n      } else if (Math.min(ensureTo, doc.lastLine()) >= to) {\n        from = lineAtHeight(doc, heightAtLine(getLine(doc, ensureTo)) - display.wrapper.clientHeight);\n        to = ensureTo;\n      }\n    }\n    return {from: from, to: Math.max(to, from + 1)}\n  }\n\n  // SCROLLING THINGS INTO VIEW\n\n  // If an editor sits on the top or bottom of the window, partially\n  // scrolled out of view, this ensures that the cursor is visible.\n  function maybeScrollWindow(cm, rect) {\n    if (signalDOMEvent(cm, \"scrollCursorIntoView\")) { return }\n\n    var display = cm.display, box = display.sizer.getBoundingClientRect(), doScroll = null;\n    if (rect.top + box.top < 0) { doScroll = true; }\n    else if (rect.bottom + box.top > (window.innerHeight || document.documentElement.clientHeight)) { doScroll = false; }\n    if (doScroll != null && !phantom) {\n      var scrollNode = elt(\"div\", \"\\u200b\", null, (\"position: absolute;\\n                         top: \" + (rect.top - display.viewOffset - paddingTop(cm.display)) + \"px;\\n                         height: \" + (rect.bottom - rect.top + scrollGap(cm) + display.barHeight) + \"px;\\n                         left: \" + (rect.left) + \"px; width: \" + (Math.max(2, rect.right - rect.left)) + \"px;\"));\n      cm.display.lineSpace.appendChild(scrollNode);\n      scrollNode.scrollIntoView(doScroll);\n      cm.display.lineSpace.removeChild(scrollNode);\n    }\n  }\n\n  // Scroll a given position into view (immediately), verifying that\n  // it actually became visible (as line heights are accurately\n  // measured, the position of something may 'drift' during drawing).\n  function scrollPosIntoView(cm, pos, end, margin) {\n    if (margin == null) { margin = 0; }\n    var rect;\n    if (!cm.options.lineWrapping && pos == end) {\n      // Set pos and end to the cursor positions around the character pos sticks to\n      // If pos.sticky == \"before\", that is around pos.ch - 1, otherwise around pos.ch\n      // If pos == Pos(_, 0, \"before\"), pos and end are unchanged\n      pos = pos.ch ? Pos(pos.line, pos.sticky == \"before\" ? pos.ch - 1 : pos.ch, \"after\") : pos;\n      end = pos.sticky == \"before\" ? Pos(pos.line, pos.ch + 1, \"before\") : pos;\n    }\n    for (var limit = 0; limit < 5; limit++) {\n      var changed = false;\n      var coords = cursorCoords(cm, pos);\n      var endCoords = !end || end == pos ? coords : cursorCoords(cm, end);\n      rect = {left: Math.min(coords.left, endCoords.left),\n              top: Math.min(coords.top, endCoords.top) - margin,\n              right: Math.max(coords.left, endCoords.left),\n              bottom: Math.max(coords.bottom, endCoords.bottom) + margin};\n      var scrollPos = calculateScrollPos(cm, rect);\n      var startTop = cm.doc.scrollTop, startLeft = cm.doc.scrollLeft;\n      if (scrollPos.scrollTop != null) {\n        updateScrollTop(cm, scrollPos.scrollTop);\n        if (Math.abs(cm.doc.scrollTop - startTop) > 1) { changed = true; }\n      }\n      if (scrollPos.scrollLeft != null) {\n        setScrollLeft(cm, scrollPos.scrollLeft);\n        if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) { changed = true; }\n      }\n      if (!changed) { break }\n    }\n    return rect\n  }\n\n  // Scroll a given set of coordinates into view (immediately).\n  function scrollIntoView(cm, rect) {\n    var scrollPos = calculateScrollPos(cm, rect);\n    if (scrollPos.scrollTop != null) { updateScrollTop(cm, scrollPos.scrollTop); }\n    if (scrollPos.scrollLeft != null) { setScrollLeft(cm, scrollPos.scrollLeft); }\n  }\n\n  // Calculate a new scroll position needed to scroll the given\n  // rectangle into view. Returns an object with scrollTop and\n  // scrollLeft properties. When these are undefined, the\n  // vertical/horizontal position does not need to be adjusted.\n  function calculateScrollPos(cm, rect) {\n    var display = cm.display, snapMargin = textHeight(cm.display);\n    if (rect.top < 0) { rect.top = 0; }\n    var screentop = cm.curOp && cm.curOp.scrollTop != null ? cm.curOp.scrollTop : display.scroller.scrollTop;\n    var screen = displayHeight(cm), result = {};\n    if (rect.bottom - rect.top > screen) { rect.bottom = rect.top + screen; }\n    var docBottom = cm.doc.height + paddingVert(display);\n    var atTop = rect.top < snapMargin, atBottom = rect.bottom > docBottom - snapMargin;\n    if (rect.top < screentop) {\n      result.scrollTop = atTop ? 0 : rect.top;\n    } else if (rect.bottom > screentop + screen) {\n      var newTop = Math.min(rect.top, (atBottom ? docBottom : rect.bottom) - screen);\n      if (newTop != screentop) { result.scrollTop = newTop; }\n    }\n\n    var screenleft = cm.curOp && cm.curOp.scrollLeft != null ? cm.curOp.scrollLeft : display.scroller.scrollLeft;\n    var screenw = displayWidth(cm) - (cm.options.fixedGutter ? display.gutters.offsetWidth : 0);\n    var tooWide = rect.right - rect.left > screenw;\n    if (tooWide) { rect.right = rect.left + screenw; }\n    if (rect.left < 10)\n      { result.scrollLeft = 0; }\n    else if (rect.left < screenleft)\n      { result.scrollLeft = Math.max(0, rect.left - (tooWide ? 0 : 10)); }\n    else if (rect.right > screenw + screenleft - 3)\n      { result.scrollLeft = rect.right + (tooWide ? 0 : 10) - screenw; }\n    return result\n  }\n\n  // Store a relative adjustment to the scroll position in the current\n  // operation (to be applied when the operation finishes).\n  function addToScrollTop(cm, top) {\n    if (top == null) { return }\n    resolveScrollToPos(cm);\n    cm.curOp.scrollTop = (cm.curOp.scrollTop == null ? cm.doc.scrollTop : cm.curOp.scrollTop) + top;\n  }\n\n  // Make sure that at the end of the operation the current cursor is\n  // shown.\n  function ensureCursorVisible(cm) {\n    resolveScrollToPos(cm);\n    var cur = cm.getCursor();\n    cm.curOp.scrollToPos = {from: cur, to: cur, margin: cm.options.cursorScrollMargin};\n  }\n\n  function scrollToCoords(cm, x, y) {\n    if (x != null || y != null) { resolveScrollToPos(cm); }\n    if (x != null) { cm.curOp.scrollLeft = x; }\n    if (y != null) { cm.curOp.scrollTop = y; }\n  }\n\n  function scrollToRange(cm, range) {\n    resolveScrollToPos(cm);\n    cm.curOp.scrollToPos = range;\n  }\n\n  // When an operation has its scrollToPos property set, and another\n  // scroll action is applied before the end of the operation, this\n  // 'simulates' scrolling that position into view in a cheap way, so\n  // that the effect of intermediate scroll commands is not ignored.\n  function resolveScrollToPos(cm) {\n    var range = cm.curOp.scrollToPos;\n    if (range) {\n      cm.curOp.scrollToPos = null;\n      var from = estimateCoords(cm, range.from), to = estimateCoords(cm, range.to);\n      scrollToCoordsRange(cm, from, to, range.margin);\n    }\n  }\n\n  function scrollToCoordsRange(cm, from, to, margin) {\n    var sPos = calculateScrollPos(cm, {\n      left: Math.min(from.left, to.left),\n      top: Math.min(from.top, to.top) - margin,\n      right: Math.max(from.right, to.right),\n      bottom: Math.max(from.bottom, to.bottom) + margin\n    });\n    scrollToCoords(cm, sPos.scrollLeft, sPos.scrollTop);\n  }\n\n  // Sync the scrollable area and scrollbars, ensure the viewport\n  // covers the visible area.\n  function updateScrollTop(cm, val) {\n    if (Math.abs(cm.doc.scrollTop - val) < 2) { return }\n    if (!gecko) { updateDisplaySimple(cm, {top: val}); }\n    setScrollTop(cm, val, true);\n    if (gecko) { updateDisplaySimple(cm); }\n    startWorker(cm, 100);\n  }\n\n  function setScrollTop(cm, val, forceScroll) {\n    val = Math.max(0, Math.min(cm.display.scroller.scrollHeight - cm.display.scroller.clientHeight, val));\n    if (cm.display.scroller.scrollTop == val && !forceScroll) { return }\n    cm.doc.scrollTop = val;\n    cm.display.scrollbars.setScrollTop(val);\n    if (cm.display.scroller.scrollTop != val) { cm.display.scroller.scrollTop = val; }\n  }\n\n  // Sync scroller and scrollbar, ensure the gutter elements are\n  // aligned.\n  function setScrollLeft(cm, val, isScroller, forceScroll) {\n    val = Math.max(0, Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth));\n    if ((isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) && !forceScroll) { return }\n    cm.doc.scrollLeft = val;\n    alignHorizontally(cm);\n    if (cm.display.scroller.scrollLeft != val) { cm.display.scroller.scrollLeft = val; }\n    cm.display.scrollbars.setScrollLeft(val);\n  }\n\n  // SCROLLBARS\n\n  // Prepare DOM reads needed to update the scrollbars. Done in one\n  // shot to minimize update/measure roundtrips.\n  function measureForScrollbars(cm) {\n    var d = cm.display, gutterW = d.gutters.offsetWidth;\n    var docH = Math.round(cm.doc.height + paddingVert(cm.display));\n    return {\n      clientHeight: d.scroller.clientHeight,\n      viewHeight: d.wrapper.clientHeight,\n      scrollWidth: d.scroller.scrollWidth, clientWidth: d.scroller.clientWidth,\n      viewWidth: d.wrapper.clientWidth,\n      barLeft: cm.options.fixedGutter ? gutterW : 0,\n      docHeight: docH,\n      scrollHeight: docH + scrollGap(cm) + d.barHeight,\n      nativeBarWidth: d.nativeBarWidth,\n      gutterWidth: gutterW\n    }\n  }\n\n  var NativeScrollbars = function(place, scroll, cm) {\n    this.cm = cm;\n    var vert = this.vert = elt(\"div\", [elt(\"div\", null, null, \"min-width: 1px\")], \"CodeMirror-vscrollbar\");\n    var horiz = this.horiz = elt(\"div\", [elt(\"div\", null, null, \"height: 100%; min-height: 1px\")], \"CodeMirror-hscrollbar\");\n    vert.tabIndex = horiz.tabIndex = -1;\n    place(vert); place(horiz);\n\n    on(vert, \"scroll\", function () {\n      if (vert.clientHeight) { scroll(vert.scrollTop, \"vertical\"); }\n    });\n    on(horiz, \"scroll\", function () {\n      if (horiz.clientWidth) { scroll(horiz.scrollLeft, \"horizontal\"); }\n    });\n\n    this.checkedZeroWidth = false;\n    // Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\n    if (ie && ie_version < 8) { this.horiz.style.minHeight = this.vert.style.minWidth = \"18px\"; }\n  };\n\n  NativeScrollbars.prototype.update = function (measure) {\n    var needsH = measure.scrollWidth > measure.clientWidth + 1;\n    var needsV = measure.scrollHeight > measure.clientHeight + 1;\n    var sWidth = measure.nativeBarWidth;\n\n    if (needsV) {\n      this.vert.style.display = \"block\";\n      this.vert.style.bottom = needsH ? sWidth + \"px\" : \"0\";\n      var totalHeight = measure.viewHeight - (needsH ? sWidth : 0);\n      // A bug in IE8 can cause this value to be negative, so guard it.\n      this.vert.firstChild.style.height =\n        Math.max(0, measure.scrollHeight - measure.clientHeight + totalHeight) + \"px\";\n    } else {\n      this.vert.style.display = \"\";\n      this.vert.firstChild.style.height = \"0\";\n    }\n\n    if (needsH) {\n      this.horiz.style.display = \"block\";\n      this.horiz.style.right = needsV ? sWidth + \"px\" : \"0\";\n      this.horiz.style.left = measure.barLeft + \"px\";\n      var totalWidth = measure.viewWidth - measure.barLeft - (needsV ? sWidth : 0);\n      this.horiz.firstChild.style.width =\n        Math.max(0, measure.scrollWidth - measure.clientWidth + totalWidth) + \"px\";\n    } else {\n      this.horiz.style.display = \"\";\n      this.horiz.firstChild.style.width = \"0\";\n    }\n\n    if (!this.checkedZeroWidth && measure.clientHeight > 0) {\n      if (sWidth == 0) { this.zeroWidthHack(); }\n      this.checkedZeroWidth = true;\n    }\n\n    return {right: needsV ? sWidth : 0, bottom: needsH ? sWidth : 0}\n  };\n\n  NativeScrollbars.prototype.setScrollLeft = function (pos) {\n    if (this.horiz.scrollLeft != pos) { this.horiz.scrollLeft = pos; }\n    if (this.disableHoriz) { this.enableZeroWidthBar(this.horiz, this.disableHoriz, \"horiz\"); }\n  };\n\n  NativeScrollbars.prototype.setScrollTop = function (pos) {\n    if (this.vert.scrollTop != pos) { this.vert.scrollTop = pos; }\n    if (this.disableVert) { this.enableZeroWidthBar(this.vert, this.disableVert, \"vert\"); }\n  };\n\n  NativeScrollbars.prototype.zeroWidthHack = function () {\n    var w = mac && !mac_geMountainLion ? \"12px\" : \"18px\";\n    this.horiz.style.height = this.vert.style.width = w;\n    this.horiz.style.pointerEvents = this.vert.style.pointerEvents = \"none\";\n    this.disableHoriz = new Delayed;\n    this.disableVert = new Delayed;\n  };\n\n  NativeScrollbars.prototype.enableZeroWidthBar = function (bar, delay, type) {\n    bar.style.pointerEvents = \"auto\";\n    function maybeDisable() {\n      // To find out whether the scrollbar is still visible, we\n      // check whether the element under the pixel in the bottom\n      // right corner of the scrollbar box is the scrollbar box\n      // itself (when the bar is still visible) or its filler child\n      // (when the bar is hidden). If it is still visible, we keep\n      // it enabled, if it's hidden, we disable pointer events.\n      var box = bar.getBoundingClientRect();\n      var elt = type == \"vert\" ? document.elementFromPoint(box.right - 1, (box.top + box.bottom) / 2)\n          : document.elementFromPoint((box.right + box.left) / 2, box.bottom - 1);\n      if (elt != bar) { bar.style.pointerEvents = \"none\"; }\n      else { delay.set(1000, maybeDisable); }\n    }\n    delay.set(1000, maybeDisable);\n  };\n\n  NativeScrollbars.prototype.clear = function () {\n    var parent = this.horiz.parentNode;\n    parent.removeChild(this.horiz);\n    parent.removeChild(this.vert);\n  };\n\n  var NullScrollbars = function () {};\n\n  NullScrollbars.prototype.update = function () { return {bottom: 0, right: 0} };\n  NullScrollbars.prototype.setScrollLeft = function () {};\n  NullScrollbars.prototype.setScrollTop = function () {};\n  NullScrollbars.prototype.clear = function () {};\n\n  function updateScrollbars(cm, measure) {\n    if (!measure) { measure = measureForScrollbars(cm); }\n    var startWidth = cm.display.barWidth, startHeight = cm.display.barHeight;\n    updateScrollbarsInner(cm, measure);\n    for (var i = 0; i < 4 && startWidth != cm.display.barWidth || startHeight != cm.display.barHeight; i++) {\n      if (startWidth != cm.display.barWidth && cm.options.lineWrapping)\n        { updateHeightsInViewport(cm); }\n      updateScrollbarsInner(cm, measureForScrollbars(cm));\n      startWidth = cm.display.barWidth; startHeight = cm.display.barHeight;\n    }\n  }\n\n  // Re-synchronize the fake scrollbars with the actual size of the\n  // content.\n  function updateScrollbarsInner(cm, measure) {\n    var d = cm.display;\n    var sizes = d.scrollbars.update(measure);\n\n    d.sizer.style.paddingRight = (d.barWidth = sizes.right) + \"px\";\n    d.sizer.style.paddingBottom = (d.barHeight = sizes.bottom) + \"px\";\n    d.heightForcer.style.borderBottom = sizes.bottom + \"px solid transparent\";\n\n    if (sizes.right && sizes.bottom) {\n      d.scrollbarFiller.style.display = \"block\";\n      d.scrollbarFiller.style.height = sizes.bottom + \"px\";\n      d.scrollbarFiller.style.width = sizes.right + \"px\";\n    } else { d.scrollbarFiller.style.display = \"\"; }\n    if (sizes.bottom && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\n      d.gutterFiller.style.display = \"block\";\n      d.gutterFiller.style.height = sizes.bottom + \"px\";\n      d.gutterFiller.style.width = measure.gutterWidth + \"px\";\n    } else { d.gutterFiller.style.display = \"\"; }\n  }\n\n  var scrollbarModel = {\"native\": NativeScrollbars, \"null\": NullScrollbars};\n\n  function initScrollbars(cm) {\n    if (cm.display.scrollbars) {\n      cm.display.scrollbars.clear();\n      if (cm.display.scrollbars.addClass)\n        { rmClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n    }\n\n    cm.display.scrollbars = new scrollbarModel[cm.options.scrollbarStyle](function (node) {\n      cm.display.wrapper.insertBefore(node, cm.display.scrollbarFiller);\n      // Prevent clicks in the scrollbars from killing focus\n      on(node, \"mousedown\", function () {\n        if (cm.state.focused) { setTimeout(function () { return cm.display.input.focus(); }, 0); }\n      });\n      node.setAttribute(\"cm-not-content\", \"true\");\n    }, function (pos, axis) {\n      if (axis == \"horizontal\") { setScrollLeft(cm, pos); }\n      else { updateScrollTop(cm, pos); }\n    }, cm);\n    if (cm.display.scrollbars.addClass)\n      { addClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n  }\n\n  // Operations are used to wrap a series of changes to the editor\n  // state in such a way that each change won't have to update the\n  // cursor and display (which would be awkward, slow, and\n  // error-prone). Instead, display updates are batched and then all\n  // combined and executed at once.\n\n  var nextOpId = 0;\n  // Start a new operation.\n  function startOperation(cm) {\n    cm.curOp = {\n      cm: cm,\n      viewChanged: false,      // Flag that indicates that lines might need to be redrawn\n      startHeight: cm.doc.height, // Used to detect need to update scrollbar\n      forceUpdate: false,      // Used to force a redraw\n      updateInput: 0,       // Whether to reset the input textarea\n      typing: false,           // Whether this reset should be careful to leave existing text (for compositing)\n      changeObjs: null,        // Accumulated changes, for firing change events\n      cursorActivityHandlers: null, // Set of handlers to fire cursorActivity on\n      cursorActivityCalled: 0, // Tracks which cursorActivity handlers have been called already\n      selectionChanged: false, // Whether the selection needs to be redrawn\n      updateMaxLine: false,    // Set when the widest line needs to be determined anew\n      scrollLeft: null, scrollTop: null, // Intermediate scroll position, not pushed to DOM yet\n      scrollToPos: null,       // Used to scroll to a specific position\n      focus: false,\n      id: ++nextOpId           // Unique ID\n    };\n    pushOperation(cm.curOp);\n  }\n\n  // Finish an operation, updating the display and signalling delayed events\n  function endOperation(cm) {\n    var op = cm.curOp;\n    if (op) { finishOperation(op, function (group) {\n      for (var i = 0; i < group.ops.length; i++)\n        { group.ops[i].cm.curOp = null; }\n      endOperations(group);\n    }); }\n  }\n\n  // The DOM updates done when an operation finishes are batched so\n  // that the minimum number of relayouts are required.\n  function endOperations(group) {\n    var ops = group.ops;\n    for (var i = 0; i < ops.length; i++) // Read DOM\n      { endOperation_R1(ops[i]); }\n    for (var i$1 = 0; i$1 < ops.length; i$1++) // Write DOM (maybe)\n      { endOperation_W1(ops[i$1]); }\n    for (var i$2 = 0; i$2 < ops.length; i$2++) // Read DOM\n      { endOperation_R2(ops[i$2]); }\n    for (var i$3 = 0; i$3 < ops.length; i$3++) // Write DOM (maybe)\n      { endOperation_W2(ops[i$3]); }\n    for (var i$4 = 0; i$4 < ops.length; i$4++) // Read DOM\n      { endOperation_finish(ops[i$4]); }\n  }\n\n  function endOperation_R1(op) {\n    var cm = op.cm, display = cm.display;\n    maybeClipScrollbars(cm);\n    if (op.updateMaxLine) { findMaxLine(cm); }\n\n    op.mustUpdate = op.viewChanged || op.forceUpdate || op.scrollTop != null ||\n      op.scrollToPos && (op.scrollToPos.from.line < display.viewFrom ||\n                         op.scrollToPos.to.line >= display.viewTo) ||\n      display.maxLineChanged && cm.options.lineWrapping;\n    op.update = op.mustUpdate &&\n      new DisplayUpdate(cm, op.mustUpdate && {top: op.scrollTop, ensure: op.scrollToPos}, op.forceUpdate);\n  }\n\n  function endOperation_W1(op) {\n    op.updatedDisplay = op.mustUpdate && updateDisplayIfNeeded(op.cm, op.update);\n  }\n\n  function endOperation_R2(op) {\n    var cm = op.cm, display = cm.display;\n    if (op.updatedDisplay) { updateHeightsInViewport(cm); }\n\n    op.barMeasure = measureForScrollbars(cm);\n\n    // If the max line changed since it was last measured, measure it,\n    // and ensure the document's width matches it.\n    // updateDisplay_W2 will use these properties to do the actual resizing\n    if (display.maxLineChanged && !cm.options.lineWrapping) {\n      op.adjustWidthTo = measureChar(cm, display.maxLine, display.maxLine.text.length).left + 3;\n      cm.display.sizerWidth = op.adjustWidthTo;\n      op.barMeasure.scrollWidth =\n        Math.max(display.scroller.clientWidth, display.sizer.offsetLeft + op.adjustWidthTo + scrollGap(cm) + cm.display.barWidth);\n      op.maxScrollLeft = Math.max(0, display.sizer.offsetLeft + op.adjustWidthTo - displayWidth(cm));\n    }\n\n    if (op.updatedDisplay || op.selectionChanged)\n      { op.preparedSelection = display.input.prepareSelection(); }\n  }\n\n  function endOperation_W2(op) {\n    var cm = op.cm;\n\n    if (op.adjustWidthTo != null) {\n      cm.display.sizer.style.minWidth = op.adjustWidthTo + \"px\";\n      if (op.maxScrollLeft < cm.doc.scrollLeft)\n        { setScrollLeft(cm, Math.min(cm.display.scroller.scrollLeft, op.maxScrollLeft), true); }\n      cm.display.maxLineChanged = false;\n    }\n\n    var takeFocus = op.focus && op.focus == activeElt();\n    if (op.preparedSelection)\n      { cm.display.input.showSelection(op.preparedSelection, takeFocus); }\n    if (op.updatedDisplay || op.startHeight != cm.doc.height)\n      { updateScrollbars(cm, op.barMeasure); }\n    if (op.updatedDisplay)\n      { setDocumentHeight(cm, op.barMeasure); }\n\n    if (op.selectionChanged) { restartBlink(cm); }\n\n    if (cm.state.focused && op.updateInput)\n      { cm.display.input.reset(op.typing); }\n    if (takeFocus) { ensureFocus(op.cm); }\n  }\n\n  function endOperation_finish(op) {\n    var cm = op.cm, display = cm.display, doc = cm.doc;\n\n    if (op.updatedDisplay) { postUpdateDisplay(cm, op.update); }\n\n    // Abort mouse wheel delta measurement, when scrolling explicitly\n    if (display.wheelStartX != null && (op.scrollTop != null || op.scrollLeft != null || op.scrollToPos))\n      { display.wheelStartX = display.wheelStartY = null; }\n\n    // Propagate the scroll position to the actual DOM scroller\n    if (op.scrollTop != null) { setScrollTop(cm, op.scrollTop, op.forceScroll); }\n\n    if (op.scrollLeft != null) { setScrollLeft(cm, op.scrollLeft, true, true); }\n    // If we need to scroll a specific position into view, do so.\n    if (op.scrollToPos) {\n      var rect = scrollPosIntoView(cm, clipPos(doc, op.scrollToPos.from),\n                                   clipPos(doc, op.scrollToPos.to), op.scrollToPos.margin);\n      maybeScrollWindow(cm, rect);\n    }\n\n    // Fire events for markers that are hidden/unidden by editing or\n    // undoing\n    var hidden = op.maybeHiddenMarkers, unhidden = op.maybeUnhiddenMarkers;\n    if (hidden) { for (var i = 0; i < hidden.length; ++i)\n      { if (!hidden[i].lines.length) { signal(hidden[i], \"hide\"); } } }\n    if (unhidden) { for (var i$1 = 0; i$1 < unhidden.length; ++i$1)\n      { if (unhidden[i$1].lines.length) { signal(unhidden[i$1], \"unhide\"); } } }\n\n    if (display.wrapper.offsetHeight)\n      { doc.scrollTop = cm.display.scroller.scrollTop; }\n\n    // Fire change events, and delayed event handlers\n    if (op.changeObjs)\n      { signal(cm, \"changes\", cm, op.changeObjs); }\n    if (op.update)\n      { op.update.finish(); }\n  }\n\n  // Run the given function in an operation\n  function runInOp(cm, f) {\n    if (cm.curOp) { return f() }\n    startOperation(cm);\n    try { return f() }\n    finally { endOperation(cm); }\n  }\n  // Wraps a function in an operation. Returns the wrapped function.\n  function operation(cm, f) {\n    return function() {\n      if (cm.curOp) { return f.apply(cm, arguments) }\n      startOperation(cm);\n      try { return f.apply(cm, arguments) }\n      finally { endOperation(cm); }\n    }\n  }\n  // Used to add methods to editor and doc instances, wrapping them in\n  // operations.\n  function methodOp(f) {\n    return function() {\n      if (this.curOp) { return f.apply(this, arguments) }\n      startOperation(this);\n      try { return f.apply(this, arguments) }\n      finally { endOperation(this); }\n    }\n  }\n  function docMethodOp(f) {\n    return function() {\n      var cm = this.cm;\n      if (!cm || cm.curOp) { return f.apply(this, arguments) }\n      startOperation(cm);\n      try { return f.apply(this, arguments) }\n      finally { endOperation(cm); }\n    }\n  }\n\n  // HIGHLIGHT WORKER\n\n  function startWorker(cm, time) {\n    if (cm.doc.highlightFrontier < cm.display.viewTo)\n      { cm.state.highlight.set(time, bind(highlightWorker, cm)); }\n  }\n\n  function highlightWorker(cm) {\n    var doc = cm.doc;\n    if (doc.highlightFrontier >= cm.display.viewTo) { return }\n    var end = +new Date + cm.options.workTime;\n    var context = getContextBefore(cm, doc.highlightFrontier);\n    var changedLines = [];\n\n    doc.iter(context.line, Math.min(doc.first + doc.size, cm.display.viewTo + 500), function (line) {\n      if (context.line >= cm.display.viewFrom) { // Visible\n        var oldStyles = line.styles;\n        var resetState = line.text.length > cm.options.maxHighlightLength ? copyState(doc.mode, context.state) : null;\n        var highlighted = highlightLine(cm, line, context, true);\n        if (resetState) { context.state = resetState; }\n        line.styles = highlighted.styles;\n        var oldCls = line.styleClasses, newCls = highlighted.classes;\n        if (newCls) { line.styleClasses = newCls; }\n        else if (oldCls) { line.styleClasses = null; }\n        var ischange = !oldStyles || oldStyles.length != line.styles.length ||\n          oldCls != newCls && (!oldCls || !newCls || oldCls.bgClass != newCls.bgClass || oldCls.textClass != newCls.textClass);\n        for (var i = 0; !ischange && i < oldStyles.length; ++i) { ischange = oldStyles[i] != line.styles[i]; }\n        if (ischange) { changedLines.push(context.line); }\n        line.stateAfter = context.save();\n        context.nextLine();\n      } else {\n        if (line.text.length <= cm.options.maxHighlightLength)\n          { processLine(cm, line.text, context); }\n        line.stateAfter = context.line % 5 == 0 ? context.save() : null;\n        context.nextLine();\n      }\n      if (+new Date > end) {\n        startWorker(cm, cm.options.workDelay);\n        return true\n      }\n    });\n    doc.highlightFrontier = context.line;\n    doc.modeFrontier = Math.max(doc.modeFrontier, context.line);\n    if (changedLines.length) { runInOp(cm, function () {\n      for (var i = 0; i < changedLines.length; i++)\n        { regLineChange(cm, changedLines[i], \"text\"); }\n    }); }\n  }\n\n  // DISPLAY DRAWING\n\n  var DisplayUpdate = function(cm, viewport, force) {\n    var display = cm.display;\n\n    this.viewport = viewport;\n    // Store some values that we'll need later (but don't want to force a relayout for)\n    this.visible = visibleLines(display, cm.doc, viewport);\n    this.editorIsHidden = !display.wrapper.offsetWidth;\n    this.wrapperHeight = display.wrapper.clientHeight;\n    this.wrapperWidth = display.wrapper.clientWidth;\n    this.oldDisplayWidth = displayWidth(cm);\n    this.force = force;\n    this.dims = getDimensions(cm);\n    this.events = [];\n  };\n\n  DisplayUpdate.prototype.signal = function (emitter, type) {\n    if (hasHandler(emitter, type))\n      { this.events.push(arguments); }\n  };\n  DisplayUpdate.prototype.finish = function () {\n    for (var i = 0; i < this.events.length; i++)\n      { signal.apply(null, this.events[i]); }\n  };\n\n  function maybeClipScrollbars(cm) {\n    var display = cm.display;\n    if (!display.scrollbarsClipped && display.scroller.offsetWidth) {\n      display.nativeBarWidth = display.scroller.offsetWidth - display.scroller.clientWidth;\n      display.heightForcer.style.height = scrollGap(cm) + \"px\";\n      display.sizer.style.marginBottom = -display.nativeBarWidth + \"px\";\n      display.sizer.style.borderRightWidth = scrollGap(cm) + \"px\";\n      display.scrollbarsClipped = true;\n    }\n  }\n\n  function selectionSnapshot(cm) {\n    if (cm.hasFocus()) { return null }\n    var active = activeElt();\n    if (!active || !contains(cm.display.lineDiv, active)) { return null }\n    var result = {activeElt: active};\n    if (window.getSelection) {\n      var sel = window.getSelection();\n      if (sel.anchorNode && sel.extend && contains(cm.display.lineDiv, sel.anchorNode)) {\n        result.anchorNode = sel.anchorNode;\n        result.anchorOffset = sel.anchorOffset;\n        result.focusNode = sel.focusNode;\n        result.focusOffset = sel.focusOffset;\n      }\n    }\n    return result\n  }\n\n  function restoreSelection(snapshot) {\n    if (!snapshot || !snapshot.activeElt || snapshot.activeElt == activeElt()) { return }\n    snapshot.activeElt.focus();\n    if (snapshot.anchorNode && contains(document.body, snapshot.anchorNode) && contains(document.body, snapshot.focusNode)) {\n      var sel = window.getSelection(), range = document.createRange();\n      range.setEnd(snapshot.anchorNode, snapshot.anchorOffset);\n      range.collapse(false);\n      sel.removeAllRanges();\n      sel.addRange(range);\n      sel.extend(snapshot.focusNode, snapshot.focusOffset);\n    }\n  }\n\n  // Does the actual updating of the line display. Bails out\n  // (returning false) when there is nothing to be done and forced is\n  // false.\n  function updateDisplayIfNeeded(cm, update) {\n    var display = cm.display, doc = cm.doc;\n\n    if (update.editorIsHidden) {\n      resetView(cm);\n      return false\n    }\n\n    // Bail out if the visible area is already rendered and nothing changed.\n    if (!update.force &&\n        update.visible.from >= display.viewFrom && update.visible.to <= display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo) &&\n        display.renderedView == display.view && countDirtyView(cm) == 0)\n      { return false }\n\n    if (maybeUpdateLineNumberWidth(cm)) {\n      resetView(cm);\n      update.dims = getDimensions(cm);\n    }\n\n    // Compute a suitable new viewport (from & to)\n    var end = doc.first + doc.size;\n    var from = Math.max(update.visible.from - cm.options.viewportMargin, doc.first);\n    var to = Math.min(end, update.visible.to + cm.options.viewportMargin);\n    if (display.viewFrom < from && from - display.viewFrom < 20) { from = Math.max(doc.first, display.viewFrom); }\n    if (display.viewTo > to && display.viewTo - to < 20) { to = Math.min(end, display.viewTo); }\n    if (sawCollapsedSpans) {\n      from = visualLineNo(cm.doc, from);\n      to = visualLineEndNo(cm.doc, to);\n    }\n\n    var different = from != display.viewFrom || to != display.viewTo ||\n      display.lastWrapHeight != update.wrapperHeight || display.lastWrapWidth != update.wrapperWidth;\n    adjustView(cm, from, to);\n\n    display.viewOffset = heightAtLine(getLine(cm.doc, display.viewFrom));\n    // Position the mover div to align with the current scroll position\n    cm.display.mover.style.top = display.viewOffset + \"px\";\n\n    var toUpdate = countDirtyView(cm);\n    if (!different && toUpdate == 0 && !update.force && display.renderedView == display.view &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo))\n      { return false }\n\n    // For big changes, we hide the enclosing element during the\n    // update, since that speeds up the operations on most browsers.\n    var selSnapshot = selectionSnapshot(cm);\n    if (toUpdate > 4) { display.lineDiv.style.display = \"none\"; }\n    patchDisplay(cm, display.updateLineNumbers, update.dims);\n    if (toUpdate > 4) { display.lineDiv.style.display = \"\"; }\n    display.renderedView = display.view;\n    // There might have been a widget with a focused element that got\n    // hidden or updated, if so re-focus it.\n    restoreSelection(selSnapshot);\n\n    // Prevent selection and cursors from interfering with the scroll\n    // width and height.\n    removeChildren(display.cursorDiv);\n    removeChildren(display.selectionDiv);\n    display.gutters.style.height = display.sizer.style.minHeight = 0;\n\n    if (different) {\n      display.lastWrapHeight = update.wrapperHeight;\n      display.lastWrapWidth = update.wrapperWidth;\n      startWorker(cm, 400);\n    }\n\n    display.updateLineNumbers = null;\n\n    return true\n  }\n\n  function postUpdateDisplay(cm, update) {\n    var viewport = update.viewport;\n\n    for (var first = true;; first = false) {\n      if (!first || !cm.options.lineWrapping || update.oldDisplayWidth == displayWidth(cm)) {\n        // Clip forced viewport to actual scrollable area.\n        if (viewport && viewport.top != null)\n          { viewport = {top: Math.min(cm.doc.height + paddingVert(cm.display) - displayHeight(cm), viewport.top)}; }\n        // Updated line heights might result in the drawn area not\n        // actually covering the viewport. Keep looping until it does.\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\n        if (update.visible.from >= cm.display.viewFrom && update.visible.to <= cm.display.viewTo)\n          { break }\n      } else if (first) {\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\n      }\n      if (!updateDisplayIfNeeded(cm, update)) { break }\n      updateHeightsInViewport(cm);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      updateScrollbars(cm, barMeasure);\n      setDocumentHeight(cm, barMeasure);\n      update.force = false;\n    }\n\n    update.signal(cm, \"update\", cm);\n    if (cm.display.viewFrom != cm.display.reportedViewFrom || cm.display.viewTo != cm.display.reportedViewTo) {\n      update.signal(cm, \"viewportChange\", cm, cm.display.viewFrom, cm.display.viewTo);\n      cm.display.reportedViewFrom = cm.display.viewFrom; cm.display.reportedViewTo = cm.display.viewTo;\n    }\n  }\n\n  function updateDisplaySimple(cm, viewport) {\n    var update = new DisplayUpdate(cm, viewport);\n    if (updateDisplayIfNeeded(cm, update)) {\n      updateHeightsInViewport(cm);\n      postUpdateDisplay(cm, update);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      updateScrollbars(cm, barMeasure);\n      setDocumentHeight(cm, barMeasure);\n      update.finish();\n    }\n  }\n\n  // Sync the actual display DOM structure with display.view, removing\n  // nodes for lines that are no longer in view, and creating the ones\n  // that are not there yet, and updating the ones that are out of\n  // date.\n  function patchDisplay(cm, updateNumbersFrom, dims) {\n    var display = cm.display, lineNumbers = cm.options.lineNumbers;\n    var container = display.lineDiv, cur = container.firstChild;\n\n    function rm(node) {\n      var next = node.nextSibling;\n      // Works around a throw-scroll bug in OS X Webkit\n      if (webkit && mac && cm.display.currentWheelTarget == node)\n        { node.style.display = \"none\"; }\n      else\n        { node.parentNode.removeChild(node); }\n      return next\n    }\n\n    var view = display.view, lineN = display.viewFrom;\n    // Loop over the elements in the view, syncing cur (the DOM nodes\n    // in display.lineDiv) with the view as we go.\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (lineView.hidden) ; else if (!lineView.node || lineView.node.parentNode != container) { // Not drawn yet\n        var node = buildLineElement(cm, lineView, lineN, dims);\n        container.insertBefore(node, cur);\n      } else { // Already drawn\n        while (cur != lineView.node) { cur = rm(cur); }\n        var updateNumber = lineNumbers && updateNumbersFrom != null &&\n          updateNumbersFrom <= lineN && lineView.lineNumber;\n        if (lineView.changes) {\n          if (indexOf(lineView.changes, \"gutter\") > -1) { updateNumber = false; }\n          updateLineForChanges(cm, lineView, lineN, dims);\n        }\n        if (updateNumber) {\n          removeChildren(lineView.lineNumber);\n          lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options, lineN)));\n        }\n        cur = lineView.node.nextSibling;\n      }\n      lineN += lineView.size;\n    }\n    while (cur) { cur = rm(cur); }\n  }\n\n  function updateGutterSpace(display) {\n    var width = display.gutters.offsetWidth;\n    display.sizer.style.marginLeft = width + \"px\";\n  }\n\n  function setDocumentHeight(cm, measure) {\n    cm.display.sizer.style.minHeight = measure.docHeight + \"px\";\n    cm.display.heightForcer.style.top = measure.docHeight + \"px\";\n    cm.display.gutters.style.height = (measure.docHeight + cm.display.barHeight + scrollGap(cm)) + \"px\";\n  }\n\n  // Re-align line numbers and gutter marks to compensate for\n  // horizontal scrolling.\n  function alignHorizontally(cm) {\n    var display = cm.display, view = display.view;\n    if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) { return }\n    var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft;\n    var gutterW = display.gutters.offsetWidth, left = comp + \"px\";\n    for (var i = 0; i < view.length; i++) { if (!view[i].hidden) {\n      if (cm.options.fixedGutter) {\n        if (view[i].gutter)\n          { view[i].gutter.style.left = left; }\n        if (view[i].gutterBackground)\n          { view[i].gutterBackground.style.left = left; }\n      }\n      var align = view[i].alignable;\n      if (align) { for (var j = 0; j < align.length; j++)\n        { align[j].style.left = left; } }\n    } }\n    if (cm.options.fixedGutter)\n      { display.gutters.style.left = (comp + gutterW) + \"px\"; }\n  }\n\n  // Used to ensure that the line number gutter is still the right\n  // size for the current document size. Returns true when an update\n  // is needed.\n  function maybeUpdateLineNumberWidth(cm) {\n    if (!cm.options.lineNumbers) { return false }\n    var doc = cm.doc, last = lineNumberFor(cm.options, doc.first + doc.size - 1), display = cm.display;\n    if (last.length != display.lineNumChars) {\n      var test = display.measure.appendChild(elt(\"div\", [elt(\"div\", last)],\n                                                 \"CodeMirror-linenumber CodeMirror-gutter-elt\"));\n      var innerW = test.firstChild.offsetWidth, padding = test.offsetWidth - innerW;\n      display.lineGutter.style.width = \"\";\n      display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding) + 1;\n      display.lineNumWidth = display.lineNumInnerWidth + padding;\n      display.lineNumChars = display.lineNumInnerWidth ? last.length : -1;\n      display.lineGutter.style.width = display.lineNumWidth + \"px\";\n      updateGutterSpace(cm.display);\n      return true\n    }\n    return false\n  }\n\n  function getGutters(gutters, lineNumbers) {\n    var result = [], sawLineNumbers = false;\n    for (var i = 0; i < gutters.length; i++) {\n      var name = gutters[i], style = null;\n      if (typeof name != \"string\") { style = name.style; name = name.className; }\n      if (name == \"CodeMirror-linenumbers\") {\n        if (!lineNumbers) { continue }\n        else { sawLineNumbers = true; }\n      }\n      result.push({className: name, style: style});\n    }\n    if (lineNumbers && !sawLineNumbers) { result.push({className: \"CodeMirror-linenumbers\", style: null}); }\n    return result\n  }\n\n  // Rebuild the gutter elements, ensure the margin to the left of the\n  // code matches their width.\n  function renderGutters(display) {\n    var gutters = display.gutters, specs = display.gutterSpecs;\n    removeChildren(gutters);\n    display.lineGutter = null;\n    for (var i = 0; i < specs.length; ++i) {\n      var ref = specs[i];\n      var className = ref.className;\n      var style = ref.style;\n      var gElt = gutters.appendChild(elt(\"div\", null, \"CodeMirror-gutter \" + className));\n      if (style) { gElt.style.cssText = style; }\n      if (className == \"CodeMirror-linenumbers\") {\n        display.lineGutter = gElt;\n        gElt.style.width = (display.lineNumWidth || 1) + \"px\";\n      }\n    }\n    gutters.style.display = specs.length ? \"\" : \"none\";\n    updateGutterSpace(display);\n  }\n\n  function updateGutters(cm) {\n    renderGutters(cm.display);\n    regChange(cm);\n    alignHorizontally(cm);\n  }\n\n  // The display handles the DOM integration, both for input reading\n  // and content drawing. It holds references to DOM nodes and\n  // display-related state.\n\n  function Display(place, doc, input, options) {\n    var d = this;\n    this.input = input;\n\n    // Covers bottom-right square when both scrollbars are present.\n    d.scrollbarFiller = elt(\"div\", null, \"CodeMirror-scrollbar-filler\");\n    d.scrollbarFiller.setAttribute(\"cm-not-content\", \"true\");\n    // Covers bottom of gutter when coverGutterNextToScrollbar is on\n    // and h scrollbar is present.\n    d.gutterFiller = elt(\"div\", null, \"CodeMirror-gutter-filler\");\n    d.gutterFiller.setAttribute(\"cm-not-content\", \"true\");\n    // Will contain the actual code, positioned to cover the viewport.\n    d.lineDiv = eltP(\"div\", null, \"CodeMirror-code\");\n    // Elements are added to these to represent selection and cursors.\n    d.selectionDiv = elt(\"div\", null, null, \"position: relative; z-index: 1\");\n    d.cursorDiv = elt(\"div\", null, \"CodeMirror-cursors\");\n    // A visibility: hidden element used to find the size of things.\n    d.measure = elt(\"div\", null, \"CodeMirror-measure\");\n    // When lines outside of the viewport are measured, they are drawn in this.\n    d.lineMeasure = elt(\"div\", null, \"CodeMirror-measure\");\n    // Wraps everything that needs to exist inside the vertically-padded coordinate system\n    d.lineSpace = eltP(\"div\", [d.measure, d.lineMeasure, d.selectionDiv, d.cursorDiv, d.lineDiv],\n                      null, \"position: relative; outline: none\");\n    var lines = eltP(\"div\", [d.lineSpace], \"CodeMirror-lines\");\n    // Moved around its parent to cover visible view.\n    d.mover = elt(\"div\", [lines], null, \"position: relative\");\n    // Set to the height of the document, allowing scrolling.\n    d.sizer = elt(\"div\", [d.mover], \"CodeMirror-sizer\");\n    d.sizerWidth = null;\n    // Behavior of elts with overflow: auto and padding is\n    // inconsistent across browsers. This is used to ensure the\n    // scrollable area is big enough.\n    d.heightForcer = elt(\"div\", null, null, \"position: absolute; height: \" + scrollerGap + \"px; width: 1px;\");\n    // Will contain the gutters, if any.\n    d.gutters = elt(\"div\", null, \"CodeMirror-gutters\");\n    d.lineGutter = null;\n    // Actual scrollable element.\n    d.scroller = elt(\"div\", [d.sizer, d.heightForcer, d.gutters], \"CodeMirror-scroll\");\n    d.scroller.setAttribute(\"tabIndex\", \"-1\");\n    // The element in which the editor lives.\n    d.wrapper = elt(\"div\", [d.scrollbarFiller, d.gutterFiller, d.scroller], \"CodeMirror\");\n\n    // Work around IE7 z-index bug (not perfect, hence IE7 not really being supported)\n    if (ie && ie_version < 8) { d.gutters.style.zIndex = -1; d.scroller.style.paddingRight = 0; }\n    if (!webkit && !(gecko && mobile)) { d.scroller.draggable = true; }\n\n    if (place) {\n      if (place.appendChild) { place.appendChild(d.wrapper); }\n      else { place(d.wrapper); }\n    }\n\n    // Current rendered range (may be bigger than the view window).\n    d.viewFrom = d.viewTo = doc.first;\n    d.reportedViewFrom = d.reportedViewTo = doc.first;\n    // Information about the rendered lines.\n    d.view = [];\n    d.renderedView = null;\n    // Holds info about a single rendered line when it was rendered\n    // for measurement, while not in view.\n    d.externalMeasured = null;\n    // Empty space (in pixels) above the view\n    d.viewOffset = 0;\n    d.lastWrapHeight = d.lastWrapWidth = 0;\n    d.updateLineNumbers = null;\n\n    d.nativeBarWidth = d.barHeight = d.barWidth = 0;\n    d.scrollbarsClipped = false;\n\n    // Used to only resize the line number gutter when necessary (when\n    // the amount of lines crosses a boundary that makes its width change)\n    d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null;\n    // Set to true when a non-horizontal-scrolling line widget is\n    // added. As an optimization, line widget aligning is skipped when\n    // this is false.\n    d.alignWidgets = false;\n\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n\n    // Tracks the maximum line length so that the horizontal scrollbar\n    // can be kept static when scrolling.\n    d.maxLine = null;\n    d.maxLineLength = 0;\n    d.maxLineChanged = false;\n\n    // Used for measuring wheel scrolling granularity\n    d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null;\n\n    // True when shift is held down.\n    d.shift = false;\n\n    // Used to track whether anything happened since the context menu\n    // was opened.\n    d.selForContextMenu = null;\n\n    d.activeTouch = null;\n\n    d.gutterSpecs = getGutters(options.gutters, options.lineNumbers);\n    renderGutters(d);\n\n    input.init(d);\n  }\n\n  // Since the delta values reported on mouse wheel events are\n  // unstandardized between browsers and even browser versions, and\n  // generally horribly unpredictable, this code starts by measuring\n  // the scroll effect that the first few mouse wheel events have,\n  // and, from that, detects the way it can convert deltas to pixel\n  // offsets afterwards.\n  //\n  // The reason we want to know the amount a wheel event will scroll\n  // is that it gives us a chance to update the display before the\n  // actual scrolling happens, reducing flickering.\n\n  var wheelSamples = 0, wheelPixelsPerUnit = null;\n  // Fill in a browser-detected starting value on browsers where we\n  // know one. These don't have to be accurate -- the result of them\n  // being wrong would just be a slight flicker on the first wheel\n  // scroll (if it is large enough).\n  if (ie) { wheelPixelsPerUnit = -.53; }\n  else if (gecko) { wheelPixelsPerUnit = 15; }\n  else if (chrome) { wheelPixelsPerUnit = -.7; }\n  else if (safari) { wheelPixelsPerUnit = -1/3; }\n\n  function wheelEventDelta(e) {\n    var dx = e.wheelDeltaX, dy = e.wheelDeltaY;\n    if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) { dx = e.detail; }\n    if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) { dy = e.detail; }\n    else if (dy == null) { dy = e.wheelDelta; }\n    return {x: dx, y: dy}\n  }\n  function wheelEventPixels(e) {\n    var delta = wheelEventDelta(e);\n    delta.x *= wheelPixelsPerUnit;\n    delta.y *= wheelPixelsPerUnit;\n    return delta\n  }\n\n  function onScrollWheel(cm, e) {\n    var delta = wheelEventDelta(e), dx = delta.x, dy = delta.y;\n\n    var display = cm.display, scroll = display.scroller;\n    // Quit if there's nothing to scroll here\n    var canScrollX = scroll.scrollWidth > scroll.clientWidth;\n    var canScrollY = scroll.scrollHeight > scroll.clientHeight;\n    if (!(dx && canScrollX || dy && canScrollY)) { return }\n\n    // Webkit browsers on OS X abort momentum scrolls when the target\n    // of the scroll event is removed from the scrollable element.\n    // This hack (see related code in patchDisplay) makes sure the\n    // element is kept around.\n    if (dy && mac && webkit) {\n      outer: for (var cur = e.target, view = display.view; cur != scroll; cur = cur.parentNode) {\n        for (var i = 0; i < view.length; i++) {\n          if (view[i].node == cur) {\n            cm.display.currentWheelTarget = cur;\n            break outer\n          }\n        }\n      }\n    }\n\n    // On some browsers, horizontal scrolling will cause redraws to\n    // happen before the gutter has been realigned, causing it to\n    // wriggle around in a most unseemly way. When we have an\n    // estimated pixels/delta value, we just handle horizontal\n    // scrolling entirely here. It'll be slightly off from native, but\n    // better than glitching out.\n    if (dx && !gecko && !presto && wheelPixelsPerUnit != null) {\n      if (dy && canScrollY)\n        { updateScrollTop(cm, Math.max(0, scroll.scrollTop + dy * wheelPixelsPerUnit)); }\n      setScrollLeft(cm, Math.max(0, scroll.scrollLeft + dx * wheelPixelsPerUnit));\n      // Only prevent default scrolling if vertical scrolling is\n      // actually possible. Otherwise, it causes vertical scroll\n      // jitter on OSX trackpads when deltaX is small and deltaY\n      // is large (issue #3579)\n      if (!dy || (dy && canScrollY))\n        { e_preventDefault(e); }\n      display.wheelStartX = null; // Abort measurement, if in progress\n      return\n    }\n\n    // 'Project' the visible viewport to cover the area that is being\n    // scrolled into view (if we know enough to estimate it).\n    if (dy && wheelPixelsPerUnit != null) {\n      var pixels = dy * wheelPixelsPerUnit;\n      var top = cm.doc.scrollTop, bot = top + display.wrapper.clientHeight;\n      if (pixels < 0) { top = Math.max(0, top + pixels - 50); }\n      else { bot = Math.min(cm.doc.height, bot + pixels + 50); }\n      updateDisplaySimple(cm, {top: top, bottom: bot});\n    }\n\n    if (wheelSamples < 20) {\n      if (display.wheelStartX == null) {\n        display.wheelStartX = scroll.scrollLeft; display.wheelStartY = scroll.scrollTop;\n        display.wheelDX = dx; display.wheelDY = dy;\n        setTimeout(function () {\n          if (display.wheelStartX == null) { return }\n          var movedX = scroll.scrollLeft - display.wheelStartX;\n          var movedY = scroll.scrollTop - display.wheelStartY;\n          var sample = (movedY && display.wheelDY && movedY / display.wheelDY) ||\n            (movedX && display.wheelDX && movedX / display.wheelDX);\n          display.wheelStartX = display.wheelStartY = null;\n          if (!sample) { return }\n          wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);\n          ++wheelSamples;\n        }, 200);\n      } else {\n        display.wheelDX += dx; display.wheelDY += dy;\n      }\n    }\n  }\n\n  // Selection objects are immutable. A new one is created every time\n  // the selection changes. A selection is one or more non-overlapping\n  // (and non-touching) ranges, sorted, and an integer that indicates\n  // which one is the primary selection (the one that's scrolled into\n  // view, that getCursor returns, etc).\n  var Selection = function(ranges, primIndex) {\n    this.ranges = ranges;\n    this.primIndex = primIndex;\n  };\n\n  Selection.prototype.primary = function () { return this.ranges[this.primIndex] };\n\n  Selection.prototype.equals = function (other) {\n    if (other == this) { return true }\n    if (other.primIndex != this.primIndex || other.ranges.length != this.ranges.length) { return false }\n    for (var i = 0; i < this.ranges.length; i++) {\n      var here = this.ranges[i], there = other.ranges[i];\n      if (!equalCursorPos(here.anchor, there.anchor) || !equalCursorPos(here.head, there.head)) { return false }\n    }\n    return true\n  };\n\n  Selection.prototype.deepCopy = function () {\n    var out = [];\n    for (var i = 0; i < this.ranges.length; i++)\n      { out[i] = new Range(copyPos(this.ranges[i].anchor), copyPos(this.ranges[i].head)); }\n    return new Selection(out, this.primIndex)\n  };\n\n  Selection.prototype.somethingSelected = function () {\n    for (var i = 0; i < this.ranges.length; i++)\n      { if (!this.ranges[i].empty()) { return true } }\n    return false\n  };\n\n  Selection.prototype.contains = function (pos, end) {\n    if (!end) { end = pos; }\n    for (var i = 0; i < this.ranges.length; i++) {\n      var range = this.ranges[i];\n      if (cmp(end, range.from()) >= 0 && cmp(pos, range.to()) <= 0)\n        { return i }\n    }\n    return -1\n  };\n\n  var Range = function(anchor, head) {\n    this.anchor = anchor; this.head = head;\n  };\n\n  Range.prototype.from = function () { return minPos(this.anchor, this.head) };\n  Range.prototype.to = function () { return maxPos(this.anchor, this.head) };\n  Range.prototype.empty = function () { return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch };\n\n  // Take an unsorted, potentially overlapping set of ranges, and\n  // build a selection out of it. 'Consumes' ranges array (modifying\n  // it).\n  function normalizeSelection(cm, ranges, primIndex) {\n    var mayTouch = cm && cm.options.selectionsMayTouch;\n    var prim = ranges[primIndex];\n    ranges.sort(function (a, b) { return cmp(a.from(), b.from()); });\n    primIndex = indexOf(ranges, prim);\n    for (var i = 1; i < ranges.length; i++) {\n      var cur = ranges[i], prev = ranges[i - 1];\n      var diff = cmp(prev.to(), cur.from());\n      if (mayTouch && !cur.empty() ? diff > 0 : diff >= 0) {\n        var from = minPos(prev.from(), cur.from()), to = maxPos(prev.to(), cur.to());\n        var inv = prev.empty() ? cur.from() == cur.head : prev.from() == prev.head;\n        if (i <= primIndex) { --primIndex; }\n        ranges.splice(--i, 2, new Range(inv ? to : from, inv ? from : to));\n      }\n    }\n    return new Selection(ranges, primIndex)\n  }\n\n  function simpleSelection(anchor, head) {\n    return new Selection([new Range(anchor, head || anchor)], 0)\n  }\n\n  // Compute the position of the end of a change (its 'to' property\n  // refers to the pre-change end).\n  function changeEnd(change) {\n    if (!change.text) { return change.to }\n    return Pos(change.from.line + change.text.length - 1,\n               lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0))\n  }\n\n  // Adjust a position to refer to the post-change position of the\n  // same text, or the end of the change if the change covers it.\n  function adjustForChange(pos, change) {\n    if (cmp(pos, change.from) < 0) { return pos }\n    if (cmp(pos, change.to) <= 0) { return changeEnd(change) }\n\n    var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1, ch = pos.ch;\n    if (pos.line == change.to.line) { ch += changeEnd(change).ch - change.to.ch; }\n    return Pos(line, ch)\n  }\n\n  function computeSelAfterChange(doc, change) {\n    var out = [];\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      var range = doc.sel.ranges[i];\n      out.push(new Range(adjustForChange(range.anchor, change),\n                         adjustForChange(range.head, change)));\n    }\n    return normalizeSelection(doc.cm, out, doc.sel.primIndex)\n  }\n\n  function offsetPos(pos, old, nw) {\n    if (pos.line == old.line)\n      { return Pos(nw.line, pos.ch - old.ch + nw.ch) }\n    else\n      { return Pos(nw.line + (pos.line - old.line), pos.ch) }\n  }\n\n  // Used by replaceSelections to allow moving the selection to the\n  // start or around the replaced test. Hint may be \"start\" or \"around\".\n  function computeReplacedSel(doc, changes, hint) {\n    var out = [];\n    var oldPrev = Pos(doc.first, 0), newPrev = oldPrev;\n    for (var i = 0; i < changes.length; i++) {\n      var change = changes[i];\n      var from = offsetPos(change.from, oldPrev, newPrev);\n      var to = offsetPos(changeEnd(change), oldPrev, newPrev);\n      oldPrev = change.to;\n      newPrev = to;\n      if (hint == \"around\") {\n        var range = doc.sel.ranges[i], inv = cmp(range.head, range.anchor) < 0;\n        out[i] = new Range(inv ? to : from, inv ? from : to);\n      } else {\n        out[i] = new Range(from, from);\n      }\n    }\n    return new Selection(out, doc.sel.primIndex)\n  }\n\n  // Used to get the editor into a consistent state again when options change.\n\n  function loadMode(cm) {\n    cm.doc.mode = getMode(cm.options, cm.doc.modeOption);\n    resetModeState(cm);\n  }\n\n  function resetModeState(cm) {\n    cm.doc.iter(function (line) {\n      if (line.stateAfter) { line.stateAfter = null; }\n      if (line.styles) { line.styles = null; }\n    });\n    cm.doc.modeFrontier = cm.doc.highlightFrontier = cm.doc.first;\n    startWorker(cm, 100);\n    cm.state.modeGen++;\n    if (cm.curOp) { regChange(cm); }\n  }\n\n  // DOCUMENT DATA STRUCTURE\n\n  // By default, updates that start and end at the beginning of a line\n  // are treated specially, in order to make the association of line\n  // widgets and marker elements with the text behave more intuitive.\n  function isWholeLineUpdate(doc, change) {\n    return change.from.ch == 0 && change.to.ch == 0 && lst(change.text) == \"\" &&\n      (!doc.cm || doc.cm.options.wholeLineUpdateBefore)\n  }\n\n  // Perform a change on the document data structure.\n  function updateDoc(doc, change, markedSpans, estimateHeight) {\n    function spansFor(n) {return markedSpans ? markedSpans[n] : null}\n    function update(line, text, spans) {\n      updateLine(line, text, spans, estimateHeight);\n      signalLater(line, \"change\", line, change);\n    }\n    function linesFor(start, end) {\n      var result = [];\n      for (var i = start; i < end; ++i)\n        { result.push(new Line(text[i], spansFor(i), estimateHeight)); }\n      return result\n    }\n\n    var from = change.from, to = change.to, text = change.text;\n    var firstLine = getLine(doc, from.line), lastLine = getLine(doc, to.line);\n    var lastText = lst(text), lastSpans = spansFor(text.length - 1), nlines = to.line - from.line;\n\n    // Adjust the line structure\n    if (change.full) {\n      doc.insert(0, linesFor(0, text.length));\n      doc.remove(text.length, doc.size - text.length);\n    } else if (isWholeLineUpdate(doc, change)) {\n      // This is a whole-line replace. Treated specially to make\n      // sure line objects move the way they are supposed to.\n      var added = linesFor(0, text.length - 1);\n      update(lastLine, lastLine.text, lastSpans);\n      if (nlines) { doc.remove(from.line, nlines); }\n      if (added.length) { doc.insert(from.line, added); }\n    } else if (firstLine == lastLine) {\n      if (text.length == 1) {\n        update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans);\n      } else {\n        var added$1 = linesFor(1, text.length - 1);\n        added$1.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight));\n        update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n        doc.insert(from.line + 1, added$1);\n      }\n    } else if (text.length == 1) {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0));\n      doc.remove(from.line + 1, nlines);\n    } else {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n      update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans);\n      var added$2 = linesFor(1, text.length - 1);\n      if (nlines > 1) { doc.remove(from.line + 1, nlines - 1); }\n      doc.insert(from.line + 1, added$2);\n    }\n\n    signalLater(doc, \"change\", doc, change);\n  }\n\n  // Call f for all linked documents.\n  function linkedDocs(doc, f, sharedHistOnly) {\n    function propagate(doc, skip, sharedHist) {\n      if (doc.linked) { for (var i = 0; i < doc.linked.length; ++i) {\n        var rel = doc.linked[i];\n        if (rel.doc == skip) { continue }\n        var shared = sharedHist && rel.sharedHist;\n        if (sharedHistOnly && !shared) { continue }\n        f(rel.doc, shared);\n        propagate(rel.doc, doc, shared);\n      } }\n    }\n    propagate(doc, null, true);\n  }\n\n  // Attach a document to an editor.\n  function attachDoc(cm, doc) {\n    if (doc.cm) { throw new Error(\"This document is already in use.\") }\n    cm.doc = doc;\n    doc.cm = cm;\n    estimateLineHeights(cm);\n    loadMode(cm);\n    setDirectionClass(cm);\n    if (!cm.options.lineWrapping) { findMaxLine(cm); }\n    cm.options.mode = doc.modeOption;\n    regChange(cm);\n  }\n\n  function setDirectionClass(cm) {\n  (cm.doc.direction == \"rtl\" ? addClass : rmClass)(cm.display.lineDiv, \"CodeMirror-rtl\");\n  }\n\n  function directionChanged(cm) {\n    runInOp(cm, function () {\n      setDirectionClass(cm);\n      regChange(cm);\n    });\n  }\n\n  function History(startGen) {\n    // Arrays of change events and selections. Doing something adds an\n    // event to done and clears undo. Undoing moves events from done\n    // to undone, redoing moves them in the other direction.\n    this.done = []; this.undone = [];\n    this.undoDepth = Infinity;\n    // Used to track when changes can be merged into a single undo\n    // event\n    this.lastModTime = this.lastSelTime = 0;\n    this.lastOp = this.lastSelOp = null;\n    this.lastOrigin = this.lastSelOrigin = null;\n    // Used by the isClean() method\n    this.generation = this.maxGeneration = startGen || 1;\n  }\n\n  // Create a history change event from an updateDoc-style change\n  // object.\n  function historyChangeFromChange(doc, change) {\n    var histChange = {from: copyPos(change.from), to: changeEnd(change), text: getBetween(doc, change.from, change.to)};\n    attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n    linkedDocs(doc, function (doc) { return attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1); }, true);\n    return histChange\n  }\n\n  // Pop all selection events off the end of a history array. Stop at\n  // a change event.\n  function clearSelectionEvents(array) {\n    while (array.length) {\n      var last = lst(array);\n      if (last.ranges) { array.pop(); }\n      else { break }\n    }\n  }\n\n  // Find the top change event in the history. Pop off selection\n  // events that are in the way.\n  function lastChangeEvent(hist, force) {\n    if (force) {\n      clearSelectionEvents(hist.done);\n      return lst(hist.done)\n    } else if (hist.done.length && !lst(hist.done).ranges) {\n      return lst(hist.done)\n    } else if (hist.done.length > 1 && !hist.done[hist.done.length - 2].ranges) {\n      hist.done.pop();\n      return lst(hist.done)\n    }\n  }\n\n  // Register a change in the history. Merges changes that are within\n  // a single operation, or are close together with an origin that\n  // allows merging (starting with \"+\") into a single event.\n  function addChangeToHistory(doc, change, selAfter, opId) {\n    var hist = doc.history;\n    hist.undone.length = 0;\n    var time = +new Date, cur;\n    var last;\n\n    if ((hist.lastOp == opId ||\n         hist.lastOrigin == change.origin && change.origin &&\n         ((change.origin.charAt(0) == \"+\" && hist.lastModTime > time - (doc.cm ? doc.cm.options.historyEventDelay : 500)) ||\n          change.origin.charAt(0) == \"*\")) &&\n        (cur = lastChangeEvent(hist, hist.lastOp == opId))) {\n      // Merge this change into the last event\n      last = lst(cur.changes);\n      if (cmp(change.from, change.to) == 0 && cmp(change.from, last.to) == 0) {\n        // Optimized case for simple insertion -- don't want to add\n        // new changesets for every character typed\n        last.to = changeEnd(change);\n      } else {\n        // Add new sub-event\n        cur.changes.push(historyChangeFromChange(doc, change));\n      }\n    } else {\n      // Can not be merged, start a new event.\n      var before = lst(hist.done);\n      if (!before || !before.ranges)\n        { pushSelectionToHistory(doc.sel, hist.done); }\n      cur = {changes: [historyChangeFromChange(doc, change)],\n             generation: hist.generation};\n      hist.done.push(cur);\n      while (hist.done.length > hist.undoDepth) {\n        hist.done.shift();\n        if (!hist.done[0].ranges) { hist.done.shift(); }\n      }\n    }\n    hist.done.push(selAfter);\n    hist.generation = ++hist.maxGeneration;\n    hist.lastModTime = hist.lastSelTime = time;\n    hist.lastOp = hist.lastSelOp = opId;\n    hist.lastOrigin = hist.lastSelOrigin = change.origin;\n\n    if (!last) { signal(doc, \"historyAdded\"); }\n  }\n\n  function selectionEventCanBeMerged(doc, origin, prev, sel) {\n    var ch = origin.charAt(0);\n    return ch == \"*\" ||\n      ch == \"+\" &&\n      prev.ranges.length == sel.ranges.length &&\n      prev.somethingSelected() == sel.somethingSelected() &&\n      new Date - doc.history.lastSelTime <= (doc.cm ? doc.cm.options.historyEventDelay : 500)\n  }\n\n  // Called whenever the selection changes, sets the new selection as\n  // the pending selection in the history, and pushes the old pending\n  // selection into the 'done' array when it was significantly\n  // different (in number of selected ranges, emptiness, or time).\n  function addSelectionToHistory(doc, sel, opId, options) {\n    var hist = doc.history, origin = options && options.origin;\n\n    // A new event is started when the previous origin does not match\n    // the current, or the origins don't allow matching. Origins\n    // starting with * are always merged, those starting with + are\n    // merged when similar and close together in time.\n    if (opId == hist.lastSelOp ||\n        (origin && hist.lastSelOrigin == origin &&\n         (hist.lastModTime == hist.lastSelTime && hist.lastOrigin == origin ||\n          selectionEventCanBeMerged(doc, origin, lst(hist.done), sel))))\n      { hist.done[hist.done.length - 1] = sel; }\n    else\n      { pushSelectionToHistory(sel, hist.done); }\n\n    hist.lastSelTime = +new Date;\n    hist.lastSelOrigin = origin;\n    hist.lastSelOp = opId;\n    if (options && options.clearRedo !== false)\n      { clearSelectionEvents(hist.undone); }\n  }\n\n  function pushSelectionToHistory(sel, dest) {\n    var top = lst(dest);\n    if (!(top && top.ranges && top.equals(sel)))\n      { dest.push(sel); }\n  }\n\n  // Used to store marked span information in the history.\n  function attachLocalSpans(doc, change, from, to) {\n    var existing = change[\"spans_\" + doc.id], n = 0;\n    doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function (line) {\n      if (line.markedSpans)\n        { (existing || (existing = change[\"spans_\" + doc.id] = {}))[n] = line.markedSpans; }\n      ++n;\n    });\n  }\n\n  // When un/re-doing restores text containing marked spans, those\n  // that have been explicitly cleared should not be restored.\n  function removeClearedSpans(spans) {\n    if (!spans) { return null }\n    var out;\n    for (var i = 0; i < spans.length; ++i) {\n      if (spans[i].marker.explicitlyCleared) { if (!out) { out = spans.slice(0, i); } }\n      else if (out) { out.push(spans[i]); }\n    }\n    return !out ? spans : out.length ? out : null\n  }\n\n  // Retrieve and filter the old marked spans stored in a change event.\n  function getOldSpans(doc, change) {\n    var found = change[\"spans_\" + doc.id];\n    if (!found) { return null }\n    var nw = [];\n    for (var i = 0; i < change.text.length; ++i)\n      { nw.push(removeClearedSpans(found[i])); }\n    return nw\n  }\n\n  // Used for un/re-doing changes from the history. Combines the\n  // result of computing the existing spans with the set of spans that\n  // existed in the history (so that deleting around a span and then\n  // undoing brings back the span).\n  function mergeOldSpans(doc, change) {\n    var old = getOldSpans(doc, change);\n    var stretched = stretchSpansOverChange(doc, change);\n    if (!old) { return stretched }\n    if (!stretched) { return old }\n\n    for (var i = 0; i < old.length; ++i) {\n      var oldCur = old[i], stretchCur = stretched[i];\n      if (oldCur && stretchCur) {\n        spans: for (var j = 0; j < stretchCur.length; ++j) {\n          var span = stretchCur[j];\n          for (var k = 0; k < oldCur.length; ++k)\n            { if (oldCur[k].marker == span.marker) { continue spans } }\n          oldCur.push(span);\n        }\n      } else if (stretchCur) {\n        old[i] = stretchCur;\n      }\n    }\n    return old\n  }\n\n  // Used both to provide a JSON-safe object in .getHistory, and, when\n  // detaching a document, to split the history in two\n  function copyHistoryArray(events, newGroup, instantiateSel) {\n    var copy = [];\n    for (var i = 0; i < events.length; ++i) {\n      var event = events[i];\n      if (event.ranges) {\n        copy.push(instantiateSel ? Selection.prototype.deepCopy.call(event) : event);\n        continue\n      }\n      var changes = event.changes, newChanges = [];\n      copy.push({changes: newChanges});\n      for (var j = 0; j < changes.length; ++j) {\n        var change = changes[j], m = (void 0);\n        newChanges.push({from: change.from, to: change.to, text: change.text});\n        if (newGroup) { for (var prop in change) { if (m = prop.match(/^spans_(\\d+)$/)) {\n          if (indexOf(newGroup, Number(m[1])) > -1) {\n            lst(newChanges)[prop] = change[prop];\n            delete change[prop];\n          }\n        } } }\n      }\n    }\n    return copy\n  }\n\n  // The 'scroll' parameter given to many of these indicated whether\n  // the new cursor position should be scrolled into view after\n  // modifying the selection.\n\n  // If shift is held or the extend flag is set, extends a range to\n  // include a given position (and optionally a second position).\n  // Otherwise, simply returns the range between the given positions.\n  // Used for cursor motion and such.\n  function extendRange(range, head, other, extend) {\n    if (extend) {\n      var anchor = range.anchor;\n      if (other) {\n        var posBefore = cmp(head, anchor) < 0;\n        if (posBefore != (cmp(other, anchor) < 0)) {\n          anchor = head;\n          head = other;\n        } else if (posBefore != (cmp(head, other) < 0)) {\n          head = other;\n        }\n      }\n      return new Range(anchor, head)\n    } else {\n      return new Range(other || head, head)\n    }\n  }\n\n  // Extend the primary selection range, discard the rest.\n  function extendSelection(doc, head, other, options, extend) {\n    if (extend == null) { extend = doc.cm && (doc.cm.display.shift || doc.extend); }\n    setSelection(doc, new Selection([extendRange(doc.sel.primary(), head, other, extend)], 0), options);\n  }\n\n  // Extend all selections (pos is an array of selections with length\n  // equal the number of selections)\n  function extendSelections(doc, heads, options) {\n    var out = [];\n    var extend = doc.cm && (doc.cm.display.shift || doc.extend);\n    for (var i = 0; i < doc.sel.ranges.length; i++)\n      { out[i] = extendRange(doc.sel.ranges[i], heads[i], null, extend); }\n    var newSel = normalizeSelection(doc.cm, out, doc.sel.primIndex);\n    setSelection(doc, newSel, options);\n  }\n\n  // Updates a single range in the selection.\n  function replaceOneSelection(doc, i, range, options) {\n    var ranges = doc.sel.ranges.slice(0);\n    ranges[i] = range;\n    setSelection(doc, normalizeSelection(doc.cm, ranges, doc.sel.primIndex), options);\n  }\n\n  // Reset the selection to a single range.\n  function setSimpleSelection(doc, anchor, head, options) {\n    setSelection(doc, simpleSelection(anchor, head), options);\n  }\n\n  // Give beforeSelectionChange handlers a change to influence a\n  // selection update.\n  function filterSelectionChange(doc, sel, options) {\n    var obj = {\n      ranges: sel.ranges,\n      update: function(ranges) {\n        this.ranges = [];\n        for (var i = 0; i < ranges.length; i++)\n          { this.ranges[i] = new Range(clipPos(doc, ranges[i].anchor),\n                                     clipPos(doc, ranges[i].head)); }\n      },\n      origin: options && options.origin\n    };\n    signal(doc, \"beforeSelectionChange\", doc, obj);\n    if (doc.cm) { signal(doc.cm, \"beforeSelectionChange\", doc.cm, obj); }\n    if (obj.ranges != sel.ranges) { return normalizeSelection(doc.cm, obj.ranges, obj.ranges.length - 1) }\n    else { return sel }\n  }\n\n  function setSelectionReplaceHistory(doc, sel, options) {\n    var done = doc.history.done, last = lst(done);\n    if (last && last.ranges) {\n      done[done.length - 1] = sel;\n      setSelectionNoUndo(doc, sel, options);\n    } else {\n      setSelection(doc, sel, options);\n    }\n  }\n\n  // Set a new selection.\n  function setSelection(doc, sel, options) {\n    setSelectionNoUndo(doc, sel, options);\n    addSelectionToHistory(doc, doc.sel, doc.cm ? doc.cm.curOp.id : NaN, options);\n  }\n\n  function setSelectionNoUndo(doc, sel, options) {\n    if (hasHandler(doc, \"beforeSelectionChange\") || doc.cm && hasHandler(doc.cm, \"beforeSelectionChange\"))\n      { sel = filterSelectionChange(doc, sel, options); }\n\n    var bias = options && options.bias ||\n      (cmp(sel.primary().head, doc.sel.primary().head) < 0 ? -1 : 1);\n    setSelectionInner(doc, skipAtomicInSelection(doc, sel, bias, true));\n\n    if (!(options && options.scroll === false) && doc.cm)\n      { ensureCursorVisible(doc.cm); }\n  }\n\n  function setSelectionInner(doc, sel) {\n    if (sel.equals(doc.sel)) { return }\n\n    doc.sel = sel;\n\n    if (doc.cm) {\n      doc.cm.curOp.updateInput = 1;\n      doc.cm.curOp.selectionChanged = true;\n      signalCursorActivity(doc.cm);\n    }\n    signalLater(doc, \"cursorActivity\", doc);\n  }\n\n  // Verify that the selection does not partially select any atomic\n  // marked ranges.\n  function reCheckSelection(doc) {\n    setSelectionInner(doc, skipAtomicInSelection(doc, doc.sel, null, false));\n  }\n\n  // Return a selection that does not partially select any atomic\n  // ranges.\n  function skipAtomicInSelection(doc, sel, bias, mayClear) {\n    var out;\n    for (var i = 0; i < sel.ranges.length; i++) {\n      var range = sel.ranges[i];\n      var old = sel.ranges.length == doc.sel.ranges.length && doc.sel.ranges[i];\n      var newAnchor = skipAtomic(doc, range.anchor, old && old.anchor, bias, mayClear);\n      var newHead = skipAtomic(doc, range.head, old && old.head, bias, mayClear);\n      if (out || newAnchor != range.anchor || newHead != range.head) {\n        if (!out) { out = sel.ranges.slice(0, i); }\n        out[i] = new Range(newAnchor, newHead);\n      }\n    }\n    return out ? normalizeSelection(doc.cm, out, sel.primIndex) : sel\n  }\n\n  function skipAtomicInner(doc, pos, oldPos, dir, mayClear) {\n    var line = getLine(doc, pos.line);\n    if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n      var sp = line.markedSpans[i], m = sp.marker;\n\n      // Determine if we should prevent the cursor being placed to the left/right of an atomic marker\n      // Historically this was determined using the inclusiveLeft/Right option, but the new way to control it\n      // is with selectLeft/Right\n      var preventCursorLeft = (\"selectLeft\" in m) ? !m.selectLeft : m.inclusiveLeft;\n      var preventCursorRight = (\"selectRight\" in m) ? !m.selectRight : m.inclusiveRight;\n\n      if ((sp.from == null || (preventCursorLeft ? sp.from <= pos.ch : sp.from < pos.ch)) &&\n          (sp.to == null || (preventCursorRight ? sp.to >= pos.ch : sp.to > pos.ch))) {\n        if (mayClear) {\n          signal(m, \"beforeCursorEnter\");\n          if (m.explicitlyCleared) {\n            if (!line.markedSpans) { break }\n            else {--i; continue}\n          }\n        }\n        if (!m.atomic) { continue }\n\n        if (oldPos) {\n          var near = m.find(dir < 0 ? 1 : -1), diff = (void 0);\n          if (dir < 0 ? preventCursorRight : preventCursorLeft)\n            { near = movePos(doc, near, -dir, near && near.line == pos.line ? line : null); }\n          if (near && near.line == pos.line && (diff = cmp(near, oldPos)) && (dir < 0 ? diff < 0 : diff > 0))\n            { return skipAtomicInner(doc, near, pos, dir, mayClear) }\n        }\n\n        var far = m.find(dir < 0 ? -1 : 1);\n        if (dir < 0 ? preventCursorLeft : preventCursorRight)\n          { far = movePos(doc, far, dir, far.line == pos.line ? line : null); }\n        return far ? skipAtomicInner(doc, far, pos, dir, mayClear) : null\n      }\n    } }\n    return pos\n  }\n\n  // Ensure a given position is not inside an atomic range.\n  function skipAtomic(doc, pos, oldPos, bias, mayClear) {\n    var dir = bias || 1;\n    var found = skipAtomicInner(doc, pos, oldPos, dir, mayClear) ||\n        (!mayClear && skipAtomicInner(doc, pos, oldPos, dir, true)) ||\n        skipAtomicInner(doc, pos, oldPos, -dir, mayClear) ||\n        (!mayClear && skipAtomicInner(doc, pos, oldPos, -dir, true));\n    if (!found) {\n      doc.cantEdit = true;\n      return Pos(doc.first, 0)\n    }\n    return found\n  }\n\n  function movePos(doc, pos, dir, line) {\n    if (dir < 0 && pos.ch == 0) {\n      if (pos.line > doc.first) { return clipPos(doc, Pos(pos.line - 1)) }\n      else { return null }\n    } else if (dir > 0 && pos.ch == (line || getLine(doc, pos.line)).text.length) {\n      if (pos.line < doc.first + doc.size - 1) { return Pos(pos.line + 1, 0) }\n      else { return null }\n    } else {\n      return new Pos(pos.line, pos.ch + dir)\n    }\n  }\n\n  function selectAll(cm) {\n    cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()), sel_dontScroll);\n  }\n\n  // UPDATING\n\n  // Allow \"beforeChange\" event handlers to influence a change\n  function filterChange(doc, change, update) {\n    var obj = {\n      canceled: false,\n      from: change.from,\n      to: change.to,\n      text: change.text,\n      origin: change.origin,\n      cancel: function () { return obj.canceled = true; }\n    };\n    if (update) { obj.update = function (from, to, text, origin) {\n      if (from) { obj.from = clipPos(doc, from); }\n      if (to) { obj.to = clipPos(doc, to); }\n      if (text) { obj.text = text; }\n      if (origin !== undefined) { obj.origin = origin; }\n    }; }\n    signal(doc, \"beforeChange\", doc, obj);\n    if (doc.cm) { signal(doc.cm, \"beforeChange\", doc.cm, obj); }\n\n    if (obj.canceled) {\n      if (doc.cm) { doc.cm.curOp.updateInput = 2; }\n      return null\n    }\n    return {from: obj.from, to: obj.to, text: obj.text, origin: obj.origin}\n  }\n\n  // Apply a change to a document, and add it to the document's\n  // history, and propagating it to all linked documents.\n  function makeChange(doc, change, ignoreReadOnly) {\n    if (doc.cm) {\n      if (!doc.cm.curOp) { return operation(doc.cm, makeChange)(doc, change, ignoreReadOnly) }\n      if (doc.cm.state.suppressEdits) { return }\n    }\n\n    if (hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")) {\n      change = filterChange(doc, change, true);\n      if (!change) { return }\n    }\n\n    // Possibly split or suppress the update based on the presence\n    // of read-only spans in its range.\n    var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);\n    if (split) {\n      for (var i = split.length - 1; i >= 0; --i)\n        { makeChangeInner(doc, {from: split[i].from, to: split[i].to, text: i ? [\"\"] : change.text, origin: change.origin}); }\n    } else {\n      makeChangeInner(doc, change);\n    }\n  }\n\n  function makeChangeInner(doc, change) {\n    if (change.text.length == 1 && change.text[0] == \"\" && cmp(change.from, change.to) == 0) { return }\n    var selAfter = computeSelAfterChange(doc, change);\n    addChangeToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);\n\n    makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));\n    var rebased = [];\n\n    linkedDocs(doc, function (doc, sharedHist) {\n      if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n        rebaseHist(doc.history, change);\n        rebased.push(doc.history);\n      }\n      makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));\n    });\n  }\n\n  // Revert a change stored in a document's history.\n  function makeChangeFromHistory(doc, type, allowSelectionOnly) {\n    var suppress = doc.cm && doc.cm.state.suppressEdits;\n    if (suppress && !allowSelectionOnly) { return }\n\n    var hist = doc.history, event, selAfter = doc.sel;\n    var source = type == \"undo\" ? hist.done : hist.undone, dest = type == \"undo\" ? hist.undone : hist.done;\n\n    // Verify that there is a useable event (so that ctrl-z won't\n    // needlessly clear selection events)\n    var i = 0;\n    for (; i < source.length; i++) {\n      event = source[i];\n      if (allowSelectionOnly ? event.ranges && !event.equals(doc.sel) : !event.ranges)\n        { break }\n    }\n    if (i == source.length) { return }\n    hist.lastOrigin = hist.lastSelOrigin = null;\n\n    for (;;) {\n      event = source.pop();\n      if (event.ranges) {\n        pushSelectionToHistory(event, dest);\n        if (allowSelectionOnly && !event.equals(doc.sel)) {\n          setSelection(doc, event, {clearRedo: false});\n          return\n        }\n        selAfter = event;\n      } else if (suppress) {\n        source.push(event);\n        return\n      } else { break }\n    }\n\n    // Build up a reverse change object to add to the opposite history\n    // stack (redo when undoing, and vice versa).\n    var antiChanges = [];\n    pushSelectionToHistory(selAfter, dest);\n    dest.push({changes: antiChanges, generation: hist.generation});\n    hist.generation = event.generation || ++hist.maxGeneration;\n\n    var filter = hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\");\n\n    var loop = function ( i ) {\n      var change = event.changes[i];\n      change.origin = type;\n      if (filter && !filterChange(doc, change, false)) {\n        source.length = 0;\n        return {}\n      }\n\n      antiChanges.push(historyChangeFromChange(doc, change));\n\n      var after = i ? computeSelAfterChange(doc, change) : lst(source);\n      makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));\n      if (!i && doc.cm) { doc.cm.scrollIntoView({from: change.from, to: changeEnd(change)}); }\n      var rebased = [];\n\n      // Propagate to the linked documents\n      linkedDocs(doc, function (doc, sharedHist) {\n        if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n          rebaseHist(doc.history, change);\n          rebased.push(doc.history);\n        }\n        makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));\n      });\n    };\n\n    for (var i$1 = event.changes.length - 1; i$1 >= 0; --i$1) {\n      var returned = loop( i$1 );\n\n      if ( returned ) return returned.v;\n    }\n  }\n\n  // Sub-views need their line numbers shifted when text is added\n  // above or below them in the parent document.\n  function shiftDoc(doc, distance) {\n    if (distance == 0) { return }\n    doc.first += distance;\n    doc.sel = new Selection(map(doc.sel.ranges, function (range) { return new Range(\n      Pos(range.anchor.line + distance, range.anchor.ch),\n      Pos(range.head.line + distance, range.head.ch)\n    ); }), doc.sel.primIndex);\n    if (doc.cm) {\n      regChange(doc.cm, doc.first, doc.first - distance, distance);\n      for (var d = doc.cm.display, l = d.viewFrom; l < d.viewTo; l++)\n        { regLineChange(doc.cm, l, \"gutter\"); }\n    }\n  }\n\n  // More lower-level change function, handling only a single document\n  // (not linked ones).\n  function makeChangeSingleDoc(doc, change, selAfter, spans) {\n    if (doc.cm && !doc.cm.curOp)\n      { return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans) }\n\n    if (change.to.line < doc.first) {\n      shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));\n      return\n    }\n    if (change.from.line > doc.lastLine()) { return }\n\n    // Clip the change to the size of this doc\n    if (change.from.line < doc.first) {\n      var shift = change.text.length - 1 - (doc.first - change.from.line);\n      shiftDoc(doc, shift);\n      change = {from: Pos(doc.first, 0), to: Pos(change.to.line + shift, change.to.ch),\n                text: [lst(change.text)], origin: change.origin};\n    }\n    var last = doc.lastLine();\n    if (change.to.line > last) {\n      change = {from: change.from, to: Pos(last, getLine(doc, last).text.length),\n                text: [change.text[0]], origin: change.origin};\n    }\n\n    change.removed = getBetween(doc, change.from, change.to);\n\n    if (!selAfter) { selAfter = computeSelAfterChange(doc, change); }\n    if (doc.cm) { makeChangeSingleDocInEditor(doc.cm, change, spans); }\n    else { updateDoc(doc, change, spans); }\n    setSelectionNoUndo(doc, selAfter, sel_dontScroll);\n\n    if (doc.cantEdit && skipAtomic(doc, Pos(doc.firstLine(), 0)))\n      { doc.cantEdit = false; }\n  }\n\n  // Handle the interaction of a change to a document with the editor\n  // that this document is part of.\n  function makeChangeSingleDocInEditor(cm, change, spans) {\n    var doc = cm.doc, display = cm.display, from = change.from, to = change.to;\n\n    var recomputeMaxLength = false, checkWidthStart = from.line;\n    if (!cm.options.lineWrapping) {\n      checkWidthStart = lineNo(visualLine(getLine(doc, from.line)));\n      doc.iter(checkWidthStart, to.line + 1, function (line) {\n        if (line == display.maxLine) {\n          recomputeMaxLength = true;\n          return true\n        }\n      });\n    }\n\n    if (doc.sel.contains(change.from, change.to) > -1)\n      { signalCursorActivity(cm); }\n\n    updateDoc(doc, change, spans, estimateHeight(cm));\n\n    if (!cm.options.lineWrapping) {\n      doc.iter(checkWidthStart, from.line + change.text.length, function (line) {\n        var len = lineLength(line);\n        if (len > display.maxLineLength) {\n          display.maxLine = line;\n          display.maxLineLength = len;\n          display.maxLineChanged = true;\n          recomputeMaxLength = false;\n        }\n      });\n      if (recomputeMaxLength) { cm.curOp.updateMaxLine = true; }\n    }\n\n    retreatFrontier(doc, from.line);\n    startWorker(cm, 400);\n\n    var lendiff = change.text.length - (to.line - from.line) - 1;\n    // Remember that these lines changed, for updating the display\n    if (change.full)\n      { regChange(cm); }\n    else if (from.line == to.line && change.text.length == 1 && !isWholeLineUpdate(cm.doc, change))\n      { regLineChange(cm, from.line, \"text\"); }\n    else\n      { regChange(cm, from.line, to.line + 1, lendiff); }\n\n    var changesHandler = hasHandler(cm, \"changes\"), changeHandler = hasHandler(cm, \"change\");\n    if (changeHandler || changesHandler) {\n      var obj = {\n        from: from, to: to,\n        text: change.text,\n        removed: change.removed,\n        origin: change.origin\n      };\n      if (changeHandler) { signalLater(cm, \"change\", cm, obj); }\n      if (changesHandler) { (cm.curOp.changeObjs || (cm.curOp.changeObjs = [])).push(obj); }\n    }\n    cm.display.selForContextMenu = null;\n  }\n\n  function replaceRange(doc, code, from, to, origin) {\n    var assign;\n\n    if (!to) { to = from; }\n    if (cmp(to, from) < 0) { (assign = [to, from], from = assign[0], to = assign[1]); }\n    if (typeof code == \"string\") { code = doc.splitLines(code); }\n    makeChange(doc, {from: from, to: to, text: code, origin: origin});\n  }\n\n  // Rebasing/resetting history to deal with externally-sourced changes\n\n  function rebaseHistSelSingle(pos, from, to, diff) {\n    if (to < pos.line) {\n      pos.line += diff;\n    } else if (from < pos.line) {\n      pos.line = from;\n      pos.ch = 0;\n    }\n  }\n\n  // Tries to rebase an array of history events given a change in the\n  // document. If the change touches the same lines as the event, the\n  // event, and everything 'behind' it, is discarded. If the change is\n  // before the event, the event's positions are updated. Uses a\n  // copy-on-write scheme for the positions, to avoid having to\n  // reallocate them all on every rebase, but also avoid problems with\n  // shared position objects being unsafely updated.\n  function rebaseHistArray(array, from, to, diff) {\n    for (var i = 0; i < array.length; ++i) {\n      var sub = array[i], ok = true;\n      if (sub.ranges) {\n        if (!sub.copied) { sub = array[i] = sub.deepCopy(); sub.copied = true; }\n        for (var j = 0; j < sub.ranges.length; j++) {\n          rebaseHistSelSingle(sub.ranges[j].anchor, from, to, diff);\n          rebaseHistSelSingle(sub.ranges[j].head, from, to, diff);\n        }\n        continue\n      }\n      for (var j$1 = 0; j$1 < sub.changes.length; ++j$1) {\n        var cur = sub.changes[j$1];\n        if (to < cur.from.line) {\n          cur.from = Pos(cur.from.line + diff, cur.from.ch);\n          cur.to = Pos(cur.to.line + diff, cur.to.ch);\n        } else if (from <= cur.to.line) {\n          ok = false;\n          break\n        }\n      }\n      if (!ok) {\n        array.splice(0, i + 1);\n        i = 0;\n      }\n    }\n  }\n\n  function rebaseHist(hist, change) {\n    var from = change.from.line, to = change.to.line, diff = change.text.length - (to - from) - 1;\n    rebaseHistArray(hist.done, from, to, diff);\n    rebaseHistArray(hist.undone, from, to, diff);\n  }\n\n  // Utility for applying a change to a line by handle or number,\n  // returning the number and optionally registering the line as\n  // changed.\n  function changeLine(doc, handle, changeType, op) {\n    var no = handle, line = handle;\n    if (typeof handle == \"number\") { line = getLine(doc, clipLine(doc, handle)); }\n    else { no = lineNo(handle); }\n    if (no == null) { return null }\n    if (op(line, no) && doc.cm) { regLineChange(doc.cm, no, changeType); }\n    return line\n  }\n\n  // The document is represented as a BTree consisting of leaves, with\n  // chunk of lines in them, and branches, with up to ten leaves or\n  // other branch nodes below them. The top node is always a branch\n  // node, and is the document object itself (meaning it has\n  // additional methods and properties).\n  //\n  // All nodes have parent links. The tree is used both to go from\n  // line numbers to line objects, and to go from objects to numbers.\n  // It also indexes by height, and is used to convert between height\n  // and line object, and to find the total height of the document.\n  //\n  // See also http://marijnhaverbeke.nl/blog/codemirror-line-tree.html\n\n  function LeafChunk(lines) {\n    this.lines = lines;\n    this.parent = null;\n    var height = 0;\n    for (var i = 0; i < lines.length; ++i) {\n      lines[i].parent = this;\n      height += lines[i].height;\n    }\n    this.height = height;\n  }\n\n  LeafChunk.prototype = {\n    chunkSize: function() { return this.lines.length },\n\n    // Remove the n lines at offset 'at'.\n    removeInner: function(at, n) {\n      for (var i = at, e = at + n; i < e; ++i) {\n        var line = this.lines[i];\n        this.height -= line.height;\n        cleanUpLine(line);\n        signalLater(line, \"delete\");\n      }\n      this.lines.splice(at, n);\n    },\n\n    // Helper used to collapse a small branch into a single leaf.\n    collapse: function(lines) {\n      lines.push.apply(lines, this.lines);\n    },\n\n    // Insert the given array of lines at offset 'at', count them as\n    // having the given height.\n    insertInner: function(at, lines, height) {\n      this.height += height;\n      this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at));\n      for (var i = 0; i < lines.length; ++i) { lines[i].parent = this; }\n    },\n\n    // Used to iterate over a part of the tree.\n    iterN: function(at, n, op) {\n      for (var e = at + n; at < e; ++at)\n        { if (op(this.lines[at])) { return true } }\n    }\n  };\n\n  function BranchChunk(children) {\n    this.children = children;\n    var size = 0, height = 0;\n    for (var i = 0; i < children.length; ++i) {\n      var ch = children[i];\n      size += ch.chunkSize(); height += ch.height;\n      ch.parent = this;\n    }\n    this.size = size;\n    this.height = height;\n    this.parent = null;\n  }\n\n  BranchChunk.prototype = {\n    chunkSize: function() { return this.size },\n\n    removeInner: function(at, n) {\n      this.size -= n;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var rm = Math.min(n, sz - at), oldHeight = child.height;\n          child.removeInner(at, rm);\n          this.height -= oldHeight - child.height;\n          if (sz == rm) { this.children.splice(i--, 1); child.parent = null; }\n          if ((n -= rm) == 0) { break }\n          at = 0;\n        } else { at -= sz; }\n      }\n      // If the result is smaller than 25 lines, ensure that it is a\n      // single leaf node.\n      if (this.size - n < 25 &&\n          (this.children.length > 1 || !(this.children[0] instanceof LeafChunk))) {\n        var lines = [];\n        this.collapse(lines);\n        this.children = [new LeafChunk(lines)];\n        this.children[0].parent = this;\n      }\n    },\n\n    collapse: function(lines) {\n      for (var i = 0; i < this.children.length; ++i) { this.children[i].collapse(lines); }\n    },\n\n    insertInner: function(at, lines, height) {\n      this.size += lines.length;\n      this.height += height;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at <= sz) {\n          child.insertInner(at, lines, height);\n          if (child.lines && child.lines.length > 50) {\n            // To avoid memory thrashing when child.lines is huge (e.g. first view of a large file), it's never spliced.\n            // Instead, small slices are taken. They're taken in order because sequential memory accesses are fastest.\n            var remaining = child.lines.length % 25 + 25;\n            for (var pos = remaining; pos < child.lines.length;) {\n              var leaf = new LeafChunk(child.lines.slice(pos, pos += 25));\n              child.height -= leaf.height;\n              this.children.splice(++i, 0, leaf);\n              leaf.parent = this;\n            }\n            child.lines = child.lines.slice(0, remaining);\n            this.maybeSpill();\n          }\n          break\n        }\n        at -= sz;\n      }\n    },\n\n    // When a node has grown, check whether it should be split.\n    maybeSpill: function() {\n      if (this.children.length <= 10) { return }\n      var me = this;\n      do {\n        var spilled = me.children.splice(me.children.length - 5, 5);\n        var sibling = new BranchChunk(spilled);\n        if (!me.parent) { // Become the parent node\n          var copy = new BranchChunk(me.children);\n          copy.parent = me;\n          me.children = [copy, sibling];\n          me = copy;\n       } else {\n          me.size -= sibling.size;\n          me.height -= sibling.height;\n          var myIndex = indexOf(me.parent.children, me);\n          me.parent.children.splice(myIndex + 1, 0, sibling);\n        }\n        sibling.parent = me.parent;\n      } while (me.children.length > 10)\n      me.parent.maybeSpill();\n    },\n\n    iterN: function(at, n, op) {\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var used = Math.min(n, sz - at);\n          if (child.iterN(at, used, op)) { return true }\n          if ((n -= used) == 0) { break }\n          at = 0;\n        } else { at -= sz; }\n      }\n    }\n  };\n\n  // Line widgets are block elements displayed above or below a line.\n\n  var LineWidget = function(doc, node, options) {\n    if (options) { for (var opt in options) { if (options.hasOwnProperty(opt))\n      { this[opt] = options[opt]; } } }\n    this.doc = doc;\n    this.node = node;\n  };\n\n  LineWidget.prototype.clear = function () {\n    var cm = this.doc.cm, ws = this.line.widgets, line = this.line, no = lineNo(line);\n    if (no == null || !ws) { return }\n    for (var i = 0; i < ws.length; ++i) { if (ws[i] == this) { ws.splice(i--, 1); } }\n    if (!ws.length) { line.widgets = null; }\n    var height = widgetHeight(this);\n    updateLineHeight(line, Math.max(0, line.height - height));\n    if (cm) {\n      runInOp(cm, function () {\n        adjustScrollWhenAboveVisible(cm, line, -height);\n        regLineChange(cm, no, \"widget\");\n      });\n      signalLater(cm, \"lineWidgetCleared\", cm, this, no);\n    }\n  };\n\n  LineWidget.prototype.changed = function () {\n      var this$1 = this;\n\n    var oldH = this.height, cm = this.doc.cm, line = this.line;\n    this.height = null;\n    var diff = widgetHeight(this) - oldH;\n    if (!diff) { return }\n    if (!lineIsHidden(this.doc, line)) { updateLineHeight(line, line.height + diff); }\n    if (cm) {\n      runInOp(cm, function () {\n        cm.curOp.forceUpdate = true;\n        adjustScrollWhenAboveVisible(cm, line, diff);\n        signalLater(cm, \"lineWidgetChanged\", cm, this$1, lineNo(line));\n      });\n    }\n  };\n  eventMixin(LineWidget);\n\n  function adjustScrollWhenAboveVisible(cm, line, diff) {\n    if (heightAtLine(line) < ((cm.curOp && cm.curOp.scrollTop) || cm.doc.scrollTop))\n      { addToScrollTop(cm, diff); }\n  }\n\n  function addLineWidget(doc, handle, node, options) {\n    var widget = new LineWidget(doc, node, options);\n    var cm = doc.cm;\n    if (cm && widget.noHScroll) { cm.display.alignWidgets = true; }\n    changeLine(doc, handle, \"widget\", function (line) {\n      var widgets = line.widgets || (line.widgets = []);\n      if (widget.insertAt == null) { widgets.push(widget); }\n      else { widgets.splice(Math.min(widgets.length - 1, Math.max(0, widget.insertAt)), 0, widget); }\n      widget.line = line;\n      if (cm && !lineIsHidden(doc, line)) {\n        var aboveVisible = heightAtLine(line) < doc.scrollTop;\n        updateLineHeight(line, line.height + widgetHeight(widget));\n        if (aboveVisible) { addToScrollTop(cm, widget.height); }\n        cm.curOp.forceUpdate = true;\n      }\n      return true\n    });\n    if (cm) { signalLater(cm, \"lineWidgetAdded\", cm, widget, typeof handle == \"number\" ? handle : lineNo(handle)); }\n    return widget\n  }\n\n  // TEXTMARKERS\n\n  // Created with markText and setBookmark methods. A TextMarker is a\n  // handle that can be used to clear or find a marked position in the\n  // document. Line objects hold arrays (markedSpans) containing\n  // {from, to, marker} object pointing to such marker objects, and\n  // indicating that such a marker is present on that line. Multiple\n  // lines may point to the same marker when it spans across lines.\n  // The spans will have null for their from/to properties when the\n  // marker continues beyond the start/end of the line. Markers have\n  // links back to the lines they currently touch.\n\n  // Collapsed markers have unique ids, in order to be able to order\n  // them, which is needed for uniquely determining an outer marker\n  // when they overlap (they may nest, but not partially overlap).\n  var nextMarkerId = 0;\n\n  var TextMarker = function(doc, type) {\n    this.lines = [];\n    this.type = type;\n    this.doc = doc;\n    this.id = ++nextMarkerId;\n  };\n\n  // Clear the marker.\n  TextMarker.prototype.clear = function () {\n    if (this.explicitlyCleared) { return }\n    var cm = this.doc.cm, withOp = cm && !cm.curOp;\n    if (withOp) { startOperation(cm); }\n    if (hasHandler(this, \"clear\")) {\n      var found = this.find();\n      if (found) { signalLater(this, \"clear\", found.from, found.to); }\n    }\n    var min = null, max = null;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this);\n      if (cm && !this.collapsed) { regLineChange(cm, lineNo(line), \"text\"); }\n      else if (cm) {\n        if (span.to != null) { max = lineNo(line); }\n        if (span.from != null) { min = lineNo(line); }\n      }\n      line.markedSpans = removeMarkedSpan(line.markedSpans, span);\n      if (span.from == null && this.collapsed && !lineIsHidden(this.doc, line) && cm)\n        { updateLineHeight(line, textHeight(cm.display)); }\n    }\n    if (cm && this.collapsed && !cm.options.lineWrapping) { for (var i$1 = 0; i$1 < this.lines.length; ++i$1) {\n      var visual = visualLine(this.lines[i$1]), len = lineLength(visual);\n      if (len > cm.display.maxLineLength) {\n        cm.display.maxLine = visual;\n        cm.display.maxLineLength = len;\n        cm.display.maxLineChanged = true;\n      }\n    } }\n\n    if (min != null && cm && this.collapsed) { regChange(cm, min, max + 1); }\n    this.lines.length = 0;\n    this.explicitlyCleared = true;\n    if (this.atomic && this.doc.cantEdit) {\n      this.doc.cantEdit = false;\n      if (cm) { reCheckSelection(cm.doc); }\n    }\n    if (cm) { signalLater(cm, \"markerCleared\", cm, this, min, max); }\n    if (withOp) { endOperation(cm); }\n    if (this.parent) { this.parent.clear(); }\n  };\n\n  // Find the position of the marker in the document. Returns a {from,\n  // to} object by default. Side can be passed to get a specific side\n  // -- 0 (both), -1 (left), or 1 (right). When lineObj is true, the\n  // Pos objects returned contain a line object, rather than a line\n  // number (used to prevent looking up the same line twice).\n  TextMarker.prototype.find = function (side, lineObj) {\n    if (side == null && this.type == \"bookmark\") { side = 1; }\n    var from, to;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this);\n      if (span.from != null) {\n        from = Pos(lineObj ? line : lineNo(line), span.from);\n        if (side == -1) { return from }\n      }\n      if (span.to != null) {\n        to = Pos(lineObj ? line : lineNo(line), span.to);\n        if (side == 1) { return to }\n      }\n    }\n    return from && {from: from, to: to}\n  };\n\n  // Signals that the marker's widget changed, and surrounding layout\n  // should be recomputed.\n  TextMarker.prototype.changed = function () {\n      var this$1 = this;\n\n    var pos = this.find(-1, true), widget = this, cm = this.doc.cm;\n    if (!pos || !cm) { return }\n    runInOp(cm, function () {\n      var line = pos.line, lineN = lineNo(pos.line);\n      var view = findViewForLine(cm, lineN);\n      if (view) {\n        clearLineMeasurementCacheFor(view);\n        cm.curOp.selectionChanged = cm.curOp.forceUpdate = true;\n      }\n      cm.curOp.updateMaxLine = true;\n      if (!lineIsHidden(widget.doc, line) && widget.height != null) {\n        var oldHeight = widget.height;\n        widget.height = null;\n        var dHeight = widgetHeight(widget) - oldHeight;\n        if (dHeight)\n          { updateLineHeight(line, line.height + dHeight); }\n      }\n      signalLater(cm, \"markerChanged\", cm, this$1);\n    });\n  };\n\n  TextMarker.prototype.attachLine = function (line) {\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp;\n      if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1)\n        { (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this); }\n    }\n    this.lines.push(line);\n  };\n\n  TextMarker.prototype.detachLine = function (line) {\n    this.lines.splice(indexOf(this.lines, line), 1);\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp\n      ;(op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this);\n    }\n  };\n  eventMixin(TextMarker);\n\n  // Create a marker, wire it up to the right lines, and\n  function markText(doc, from, to, options, type) {\n    // Shared markers (across linked documents) are handled separately\n    // (markTextShared will call out to this again, once per\n    // document).\n    if (options && options.shared) { return markTextShared(doc, from, to, options, type) }\n    // Ensure we are in an operation.\n    if (doc.cm && !doc.cm.curOp) { return operation(doc.cm, markText)(doc, from, to, options, type) }\n\n    var marker = new TextMarker(doc, type), diff = cmp(from, to);\n    if (options) { copyObj(options, marker, false); }\n    // Don't connect empty markers unless clearWhenEmpty is false\n    if (diff > 0 || diff == 0 && marker.clearWhenEmpty !== false)\n      { return marker }\n    if (marker.replacedWith) {\n      // Showing up as a widget implies collapsed (widget replaces text)\n      marker.collapsed = true;\n      marker.widgetNode = eltP(\"span\", [marker.replacedWith], \"CodeMirror-widget\");\n      if (!options.handleMouseEvents) { marker.widgetNode.setAttribute(\"cm-ignore-events\", \"true\"); }\n      if (options.insertLeft) { marker.widgetNode.insertLeft = true; }\n    }\n    if (marker.collapsed) {\n      if (conflictingCollapsedRange(doc, from.line, from, to, marker) ||\n          from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker))\n        { throw new Error(\"Inserting collapsed marker partially overlapping an existing one\") }\n      seeCollapsedSpans();\n    }\n\n    if (marker.addToHistory)\n      { addChangeToHistory(doc, {from: from, to: to, origin: \"markText\"}, doc.sel, NaN); }\n\n    var curLine = from.line, cm = doc.cm, updateMaxLine;\n    doc.iter(curLine, to.line + 1, function (line) {\n      if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(line) == cm.display.maxLine)\n        { updateMaxLine = true; }\n      if (marker.collapsed && curLine != from.line) { updateLineHeight(line, 0); }\n      addMarkedSpan(line, new MarkedSpan(marker,\n                                         curLine == from.line ? from.ch : null,\n                                         curLine == to.line ? to.ch : null));\n      ++curLine;\n    });\n    // lineIsHidden depends on the presence of the spans, so needs a second pass\n    if (marker.collapsed) { doc.iter(from.line, to.line + 1, function (line) {\n      if (lineIsHidden(doc, line)) { updateLineHeight(line, 0); }\n    }); }\n\n    if (marker.clearOnEnter) { on(marker, \"beforeCursorEnter\", function () { return marker.clear(); }); }\n\n    if (marker.readOnly) {\n      seeReadOnlySpans();\n      if (doc.history.done.length || doc.history.undone.length)\n        { doc.clearHistory(); }\n    }\n    if (marker.collapsed) {\n      marker.id = ++nextMarkerId;\n      marker.atomic = true;\n    }\n    if (cm) {\n      // Sync editor state\n      if (updateMaxLine) { cm.curOp.updateMaxLine = true; }\n      if (marker.collapsed)\n        { regChange(cm, from.line, to.line + 1); }\n      else if (marker.className || marker.startStyle || marker.endStyle || marker.css ||\n               marker.attributes || marker.title)\n        { for (var i = from.line; i <= to.line; i++) { regLineChange(cm, i, \"text\"); } }\n      if (marker.atomic) { reCheckSelection(cm.doc); }\n      signalLater(cm, \"markerAdded\", cm, marker);\n    }\n    return marker\n  }\n\n  // SHARED TEXTMARKERS\n\n  // A shared marker spans multiple linked documents. It is\n  // implemented as a meta-marker-object controlling multiple normal\n  // markers.\n  var SharedTextMarker = function(markers, primary) {\n    this.markers = markers;\n    this.primary = primary;\n    for (var i = 0; i < markers.length; ++i)\n      { markers[i].parent = this; }\n  };\n\n  SharedTextMarker.prototype.clear = function () {\n    if (this.explicitlyCleared) { return }\n    this.explicitlyCleared = true;\n    for (var i = 0; i < this.markers.length; ++i)\n      { this.markers[i].clear(); }\n    signalLater(this, \"clear\");\n  };\n\n  SharedTextMarker.prototype.find = function (side, lineObj) {\n    return this.primary.find(side, lineObj)\n  };\n  eventMixin(SharedTextMarker);\n\n  function markTextShared(doc, from, to, options, type) {\n    options = copyObj(options);\n    options.shared = false;\n    var markers = [markText(doc, from, to, options, type)], primary = markers[0];\n    var widget = options.widgetNode;\n    linkedDocs(doc, function (doc) {\n      if (widget) { options.widgetNode = widget.cloneNode(true); }\n      markers.push(markText(doc, clipPos(doc, from), clipPos(doc, to), options, type));\n      for (var i = 0; i < doc.linked.length; ++i)\n        { if (doc.linked[i].isParent) { return } }\n      primary = lst(markers);\n    });\n    return new SharedTextMarker(markers, primary)\n  }\n\n  function findSharedMarkers(doc) {\n    return doc.findMarks(Pos(doc.first, 0), doc.clipPos(Pos(doc.lastLine())), function (m) { return m.parent; })\n  }\n\n  function copySharedMarkers(doc, markers) {\n    for (var i = 0; i < markers.length; i++) {\n      var marker = markers[i], pos = marker.find();\n      var mFrom = doc.clipPos(pos.from), mTo = doc.clipPos(pos.to);\n      if (cmp(mFrom, mTo)) {\n        var subMark = markText(doc, mFrom, mTo, marker.primary, marker.primary.type);\n        marker.markers.push(subMark);\n        subMark.parent = marker;\n      }\n    }\n  }\n\n  function detachSharedMarkers(markers) {\n    var loop = function ( i ) {\n      var marker = markers[i], linked = [marker.primary.doc];\n      linkedDocs(marker.primary.doc, function (d) { return linked.push(d); });\n      for (var j = 0; j < marker.markers.length; j++) {\n        var subMarker = marker.markers[j];\n        if (indexOf(linked, subMarker.doc) == -1) {\n          subMarker.parent = null;\n          marker.markers.splice(j--, 1);\n        }\n      }\n    };\n\n    for (var i = 0; i < markers.length; i++) loop( i );\n  }\n\n  var nextDocId = 0;\n  var Doc = function(text, mode, firstLine, lineSep, direction) {\n    if (!(this instanceof Doc)) { return new Doc(text, mode, firstLine, lineSep, direction) }\n    if (firstLine == null) { firstLine = 0; }\n\n    BranchChunk.call(this, [new LeafChunk([new Line(\"\", null)])]);\n    this.first = firstLine;\n    this.scrollTop = this.scrollLeft = 0;\n    this.cantEdit = false;\n    this.cleanGeneration = 1;\n    this.modeFrontier = this.highlightFrontier = firstLine;\n    var start = Pos(firstLine, 0);\n    this.sel = simpleSelection(start);\n    this.history = new History(null);\n    this.id = ++nextDocId;\n    this.modeOption = mode;\n    this.lineSep = lineSep;\n    this.direction = (direction == \"rtl\") ? \"rtl\" : \"ltr\";\n    this.extend = false;\n\n    if (typeof text == \"string\") { text = this.splitLines(text); }\n    updateDoc(this, {from: start, to: start, text: text});\n    setSelection(this, simpleSelection(start), sel_dontScroll);\n  };\n\n  Doc.prototype = createObj(BranchChunk.prototype, {\n    constructor: Doc,\n    // Iterate over the document. Supports two forms -- with only one\n    // argument, it calls that for each line in the document. With\n    // three, it iterates over the range given by the first two (with\n    // the second being non-inclusive).\n    iter: function(from, to, op) {\n      if (op) { this.iterN(from - this.first, to - from, op); }\n      else { this.iterN(this.first, this.first + this.size, from); }\n    },\n\n    // Non-public interface for adding and removing lines.\n    insert: function(at, lines) {\n      var height = 0;\n      for (var i = 0; i < lines.length; ++i) { height += lines[i].height; }\n      this.insertInner(at - this.first, lines, height);\n    },\n    remove: function(at, n) { this.removeInner(at - this.first, n); },\n\n    // From here, the methods are part of the public interface. Most\n    // are also available from CodeMirror (editor) instances.\n\n    getValue: function(lineSep) {\n      var lines = getLines(this, this.first, this.first + this.size);\n      if (lineSep === false) { return lines }\n      return lines.join(lineSep || this.lineSeparator())\n    },\n    setValue: docMethodOp(function(code) {\n      var top = Pos(this.first, 0), last = this.first + this.size - 1;\n      makeChange(this, {from: top, to: Pos(last, getLine(this, last).text.length),\n                        text: this.splitLines(code), origin: \"setValue\", full: true}, true);\n      if (this.cm) { scrollToCoords(this.cm, 0, 0); }\n      setSelection(this, simpleSelection(top), sel_dontScroll);\n    }),\n    replaceRange: function(code, from, to, origin) {\n      from = clipPos(this, from);\n      to = to ? clipPos(this, to) : from;\n      replaceRange(this, code, from, to, origin);\n    },\n    getRange: function(from, to, lineSep) {\n      var lines = getBetween(this, clipPos(this, from), clipPos(this, to));\n      if (lineSep === false) { return lines }\n      return lines.join(lineSep || this.lineSeparator())\n    },\n\n    getLine: function(line) {var l = this.getLineHandle(line); return l && l.text},\n\n    getLineHandle: function(line) {if (isLine(this, line)) { return getLine(this, line) }},\n    getLineNumber: function(line) {return lineNo(line)},\n\n    getLineHandleVisualStart: function(line) {\n      if (typeof line == \"number\") { line = getLine(this, line); }\n      return visualLine(line)\n    },\n\n    lineCount: function() {return this.size},\n    firstLine: function() {return this.first},\n    lastLine: function() {return this.first + this.size - 1},\n\n    clipPos: function(pos) {return clipPos(this, pos)},\n\n    getCursor: function(start) {\n      var range = this.sel.primary(), pos;\n      if (start == null || start == \"head\") { pos = range.head; }\n      else if (start == \"anchor\") { pos = range.anchor; }\n      else if (start == \"end\" || start == \"to\" || start === false) { pos = range.to(); }\n      else { pos = range.from(); }\n      return pos\n    },\n    listSelections: function() { return this.sel.ranges },\n    somethingSelected: function() {return this.sel.somethingSelected()},\n\n    setCursor: docMethodOp(function(line, ch, options) {\n      setSimpleSelection(this, clipPos(this, typeof line == \"number\" ? Pos(line, ch || 0) : line), null, options);\n    }),\n    setSelection: docMethodOp(function(anchor, head, options) {\n      setSimpleSelection(this, clipPos(this, anchor), clipPos(this, head || anchor), options);\n    }),\n    extendSelection: docMethodOp(function(head, other, options) {\n      extendSelection(this, clipPos(this, head), other && clipPos(this, other), options);\n    }),\n    extendSelections: docMethodOp(function(heads, options) {\n      extendSelections(this, clipPosArray(this, heads), options);\n    }),\n    extendSelectionsBy: docMethodOp(function(f, options) {\n      var heads = map(this.sel.ranges, f);\n      extendSelections(this, clipPosArray(this, heads), options);\n    }),\n    setSelections: docMethodOp(function(ranges, primary, options) {\n      if (!ranges.length) { return }\n      var out = [];\n      for (var i = 0; i < ranges.length; i++)\n        { out[i] = new Range(clipPos(this, ranges[i].anchor),\n                           clipPos(this, ranges[i].head)); }\n      if (primary == null) { primary = Math.min(ranges.length - 1, this.sel.primIndex); }\n      setSelection(this, normalizeSelection(this.cm, out, primary), options);\n    }),\n    addSelection: docMethodOp(function(anchor, head, options) {\n      var ranges = this.sel.ranges.slice(0);\n      ranges.push(new Range(clipPos(this, anchor), clipPos(this, head || anchor)));\n      setSelection(this, normalizeSelection(this.cm, ranges, ranges.length - 1), options);\n    }),\n\n    getSelection: function(lineSep) {\n      var ranges = this.sel.ranges, lines;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this, ranges[i].from(), ranges[i].to());\n        lines = lines ? lines.concat(sel) : sel;\n      }\n      if (lineSep === false) { return lines }\n      else { return lines.join(lineSep || this.lineSeparator()) }\n    },\n    getSelections: function(lineSep) {\n      var parts = [], ranges = this.sel.ranges;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this, ranges[i].from(), ranges[i].to());\n        if (lineSep !== false) { sel = sel.join(lineSep || this.lineSeparator()); }\n        parts[i] = sel;\n      }\n      return parts\n    },\n    replaceSelection: function(code, collapse, origin) {\n      var dup = [];\n      for (var i = 0; i < this.sel.ranges.length; i++)\n        { dup[i] = code; }\n      this.replaceSelections(dup, collapse, origin || \"+input\");\n    },\n    replaceSelections: docMethodOp(function(code, collapse, origin) {\n      var changes = [], sel = this.sel;\n      for (var i = 0; i < sel.ranges.length; i++) {\n        var range = sel.ranges[i];\n        changes[i] = {from: range.from(), to: range.to(), text: this.splitLines(code[i]), origin: origin};\n      }\n      var newSel = collapse && collapse != \"end\" && computeReplacedSel(this, changes, collapse);\n      for (var i$1 = changes.length - 1; i$1 >= 0; i$1--)\n        { makeChange(this, changes[i$1]); }\n      if (newSel) { setSelectionReplaceHistory(this, newSel); }\n      else if (this.cm) { ensureCursorVisible(this.cm); }\n    }),\n    undo: docMethodOp(function() {makeChangeFromHistory(this, \"undo\");}),\n    redo: docMethodOp(function() {makeChangeFromHistory(this, \"redo\");}),\n    undoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"undo\", true);}),\n    redoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"redo\", true);}),\n\n    setExtending: function(val) {this.extend = val;},\n    getExtending: function() {return this.extend},\n\n    historySize: function() {\n      var hist = this.history, done = 0, undone = 0;\n      for (var i = 0; i < hist.done.length; i++) { if (!hist.done[i].ranges) { ++done; } }\n      for (var i$1 = 0; i$1 < hist.undone.length; i$1++) { if (!hist.undone[i$1].ranges) { ++undone; } }\n      return {undo: done, redo: undone}\n    },\n    clearHistory: function() {\n      var this$1 = this;\n\n      this.history = new History(this.history.maxGeneration);\n      linkedDocs(this, function (doc) { return doc.history = this$1.history; }, true);\n    },\n\n    markClean: function() {\n      this.cleanGeneration = this.changeGeneration(true);\n    },\n    changeGeneration: function(forceSplit) {\n      if (forceSplit)\n        { this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null; }\n      return this.history.generation\n    },\n    isClean: function (gen) {\n      return this.history.generation == (gen || this.cleanGeneration)\n    },\n\n    getHistory: function() {\n      return {done: copyHistoryArray(this.history.done),\n              undone: copyHistoryArray(this.history.undone)}\n    },\n    setHistory: function(histData) {\n      var hist = this.history = new History(this.history.maxGeneration);\n      hist.done = copyHistoryArray(histData.done.slice(0), null, true);\n      hist.undone = copyHistoryArray(histData.undone.slice(0), null, true);\n    },\n\n    setGutterMarker: docMethodOp(function(line, gutterID, value) {\n      return changeLine(this, line, \"gutter\", function (line) {\n        var markers = line.gutterMarkers || (line.gutterMarkers = {});\n        markers[gutterID] = value;\n        if (!value && isEmpty(markers)) { line.gutterMarkers = null; }\n        return true\n      })\n    }),\n\n    clearGutter: docMethodOp(function(gutterID) {\n      var this$1 = this;\n\n      this.iter(function (line) {\n        if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\n          changeLine(this$1, line, \"gutter\", function () {\n            line.gutterMarkers[gutterID] = null;\n            if (isEmpty(line.gutterMarkers)) { line.gutterMarkers = null; }\n            return true\n          });\n        }\n      });\n    }),\n\n    lineInfo: function(line) {\n      var n;\n      if (typeof line == \"number\") {\n        if (!isLine(this, line)) { return null }\n        n = line;\n        line = getLine(this, line);\n        if (!line) { return null }\n      } else {\n        n = lineNo(line);\n        if (n == null) { return null }\n      }\n      return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,\n              textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,\n              widgets: line.widgets}\n    },\n\n    addLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n        var prop = where == \"text\" ? \"textClass\"\n                 : where == \"background\" ? \"bgClass\"\n                 : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        if (!line[prop]) { line[prop] = cls; }\n        else if (classTest(cls).test(line[prop])) { return false }\n        else { line[prop] += \" \" + cls; }\n        return true\n      })\n    }),\n    removeLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n        var prop = where == \"text\" ? \"textClass\"\n                 : where == \"background\" ? \"bgClass\"\n                 : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        var cur = line[prop];\n        if (!cur) { return false }\n        else if (cls == null) { line[prop] = null; }\n        else {\n          var found = cur.match(classTest(cls));\n          if (!found) { return false }\n          var end = found.index + found[0].length;\n          line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? \"\" : \" \") + cur.slice(end) || null;\n        }\n        return true\n      })\n    }),\n\n    addLineWidget: docMethodOp(function(handle, node, options) {\n      return addLineWidget(this, handle, node, options)\n    }),\n    removeLineWidget: function(widget) { widget.clear(); },\n\n    markText: function(from, to, options) {\n      return markText(this, clipPos(this, from), clipPos(this, to), options, options && options.type || \"range\")\n    },\n    setBookmark: function(pos, options) {\n      var realOpts = {replacedWith: options && (options.nodeType == null ? options.widget : options),\n                      insertLeft: options && options.insertLeft,\n                      clearWhenEmpty: false, shared: options && options.shared,\n                      handleMouseEvents: options && options.handleMouseEvents};\n      pos = clipPos(this, pos);\n      return markText(this, pos, pos, realOpts, \"bookmark\")\n    },\n    findMarksAt: function(pos) {\n      pos = clipPos(this, pos);\n      var markers = [], spans = getLine(this, pos.line).markedSpans;\n      if (spans) { for (var i = 0; i < spans.length; ++i) {\n        var span = spans[i];\n        if ((span.from == null || span.from <= pos.ch) &&\n            (span.to == null || span.to >= pos.ch))\n          { markers.push(span.marker.parent || span.marker); }\n      } }\n      return markers\n    },\n    findMarks: function(from, to, filter) {\n      from = clipPos(this, from); to = clipPos(this, to);\n      var found = [], lineNo = from.line;\n      this.iter(from.line, to.line + 1, function (line) {\n        var spans = line.markedSpans;\n        if (spans) { for (var i = 0; i < spans.length; i++) {\n          var span = spans[i];\n          if (!(span.to != null && lineNo == from.line && from.ch >= span.to ||\n                span.from == null && lineNo != from.line ||\n                span.from != null && lineNo == to.line && span.from >= to.ch) &&\n              (!filter || filter(span.marker)))\n            { found.push(span.marker.parent || span.marker); }\n        } }\n        ++lineNo;\n      });\n      return found\n    },\n    getAllMarks: function() {\n      var markers = [];\n      this.iter(function (line) {\n        var sps = line.markedSpans;\n        if (sps) { for (var i = 0; i < sps.length; ++i)\n          { if (sps[i].from != null) { markers.push(sps[i].marker); } } }\n      });\n      return markers\n    },\n\n    posFromIndex: function(off) {\n      var ch, lineNo = this.first, sepSize = this.lineSeparator().length;\n      this.iter(function (line) {\n        var sz = line.text.length + sepSize;\n        if (sz > off) { ch = off; return true }\n        off -= sz;\n        ++lineNo;\n      });\n      return clipPos(this, Pos(lineNo, ch))\n    },\n    indexFromPos: function (coords) {\n      coords = clipPos(this, coords);\n      var index = coords.ch;\n      if (coords.line < this.first || coords.ch < 0) { return 0 }\n      var sepSize = this.lineSeparator().length;\n      this.iter(this.first, coords.line, function (line) { // iter aborts when callback returns a truthy value\n        index += line.text.length + sepSize;\n      });\n      return index\n    },\n\n    copy: function(copyHistory) {\n      var doc = new Doc(getLines(this, this.first, this.first + this.size),\n                        this.modeOption, this.first, this.lineSep, this.direction);\n      doc.scrollTop = this.scrollTop; doc.scrollLeft = this.scrollLeft;\n      doc.sel = this.sel;\n      doc.extend = false;\n      if (copyHistory) {\n        doc.history.undoDepth = this.history.undoDepth;\n        doc.setHistory(this.getHistory());\n      }\n      return doc\n    },\n\n    linkedDoc: function(options) {\n      if (!options) { options = {}; }\n      var from = this.first, to = this.first + this.size;\n      if (options.from != null && options.from > from) { from = options.from; }\n      if (options.to != null && options.to < to) { to = options.to; }\n      var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from, this.lineSep, this.direction);\n      if (options.sharedHist) { copy.history = this.history\n      ; }(this.linked || (this.linked = [])).push({doc: copy, sharedHist: options.sharedHist});\n      copy.linked = [{doc: this, isParent: true, sharedHist: options.sharedHist}];\n      copySharedMarkers(copy, findSharedMarkers(this));\n      return copy\n    },\n    unlinkDoc: function(other) {\n      if (other instanceof CodeMirror) { other = other.doc; }\n      if (this.linked) { for (var i = 0; i < this.linked.length; ++i) {\n        var link = this.linked[i];\n        if (link.doc != other) { continue }\n        this.linked.splice(i, 1);\n        other.unlinkDoc(this);\n        detachSharedMarkers(findSharedMarkers(this));\n        break\n      } }\n      // If the histories were shared, split them again\n      if (other.history == this.history) {\n        var splitIds = [other.id];\n        linkedDocs(other, function (doc) { return splitIds.push(doc.id); }, true);\n        other.history = new History(null);\n        other.history.done = copyHistoryArray(this.history.done, splitIds);\n        other.history.undone = copyHistoryArray(this.history.undone, splitIds);\n      }\n    },\n    iterLinkedDocs: function(f) {linkedDocs(this, f);},\n\n    getMode: function() {return this.mode},\n    getEditor: function() {return this.cm},\n\n    splitLines: function(str) {\n      if (this.lineSep) { return str.split(this.lineSep) }\n      return splitLinesAuto(str)\n    },\n    lineSeparator: function() { return this.lineSep || \"\\n\" },\n\n    setDirection: docMethodOp(function (dir) {\n      if (dir != \"rtl\") { dir = \"ltr\"; }\n      if (dir == this.direction) { return }\n      this.direction = dir;\n      this.iter(function (line) { return line.order = null; });\n      if (this.cm) { directionChanged(this.cm); }\n    })\n  });\n\n  // Public alias.\n  Doc.prototype.eachLine = Doc.prototype.iter;\n\n  // Kludge to work around strange IE behavior where it'll sometimes\n  // re-fire a series of drag-related events right after the drop (#1551)\n  var lastDrop = 0;\n\n  function onDrop(e) {\n    var cm = this;\n    clearDragCursor(cm);\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e))\n      { return }\n    e_preventDefault(e);\n    if (ie) { lastDrop = +new Date; }\n    var pos = posFromMouse(cm, e, true), files = e.dataTransfer.files;\n    if (!pos || cm.isReadOnly()) { return }\n    // Might be a file drop, in which case we simply extract the text\n    // and insert it.\n    if (files && files.length && window.FileReader && window.File) {\n      var n = files.length, text = Array(n), read = 0;\n      var markAsReadAndPasteIfAllFilesAreRead = function () {\n        if (++read == n) {\n          operation(cm, function () {\n            pos = clipPos(cm.doc, pos);\n            var change = {from: pos, to: pos,\n                          text: cm.doc.splitLines(\n                              text.filter(function (t) { return t != null; }).join(cm.doc.lineSeparator())),\n                          origin: \"paste\"};\n            makeChange(cm.doc, change);\n            setSelectionReplaceHistory(cm.doc, simpleSelection(clipPos(cm.doc, pos), clipPos(cm.doc, changeEnd(change))));\n          })();\n        }\n      };\n      var readTextFromFile = function (file, i) {\n        if (cm.options.allowDropFileTypes &&\n            indexOf(cm.options.allowDropFileTypes, file.type) == -1) {\n          markAsReadAndPasteIfAllFilesAreRead();\n          return\n        }\n        var reader = new FileReader;\n        reader.onerror = function () { return markAsReadAndPasteIfAllFilesAreRead(); };\n        reader.onload = function () {\n          var content = reader.result;\n          if (/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(content)) {\n            markAsReadAndPasteIfAllFilesAreRead();\n            return\n          }\n          text[i] = content;\n          markAsReadAndPasteIfAllFilesAreRead();\n        };\n        reader.readAsText(file);\n      };\n      for (var i = 0; i < files.length; i++) { readTextFromFile(files[i], i); }\n    } else { // Normal drop\n      // Don't do a replace if the drop happened inside of the selected text.\n      if (cm.state.draggingText && cm.doc.sel.contains(pos) > -1) {\n        cm.state.draggingText(e);\n        // Ensure the editor is re-focused\n        setTimeout(function () { return cm.display.input.focus(); }, 20);\n        return\n      }\n      try {\n        var text$1 = e.dataTransfer.getData(\"Text\");\n        if (text$1) {\n          var selected;\n          if (cm.state.draggingText && !cm.state.draggingText.copy)\n            { selected = cm.listSelections(); }\n          setSelectionNoUndo(cm.doc, simpleSelection(pos, pos));\n          if (selected) { for (var i$1 = 0; i$1 < selected.length; ++i$1)\n            { replaceRange(cm.doc, \"\", selected[i$1].anchor, selected[i$1].head, \"drag\"); } }\n          cm.replaceSelection(text$1, \"around\", \"paste\");\n          cm.display.input.focus();\n        }\n      }\n      catch(e){}\n    }\n  }\n\n  function onDragStart(cm, e) {\n    if (ie && (!cm.state.draggingText || +new Date - lastDrop < 100)) { e_stop(e); return }\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) { return }\n\n    e.dataTransfer.setData(\"Text\", cm.getSelection());\n    e.dataTransfer.effectAllowed = \"copyMove\";\n\n    // Use dummy image instead of default browsers image.\n    // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don't do it there.\n    if (e.dataTransfer.setDragImage && !safari) {\n      var img = elt(\"img\", null, null, \"position: fixed; left: 0; top: 0;\");\n      img.src = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n      if (presto) {\n        img.width = img.height = 1;\n        cm.display.wrapper.appendChild(img);\n        // Force a relayout, or Opera won't use our image for some obscure reason\n        img._top = img.offsetTop;\n      }\n      e.dataTransfer.setDragImage(img, 0, 0);\n      if (presto) { img.parentNode.removeChild(img); }\n    }\n  }\n\n  function onDragOver(cm, e) {\n    var pos = posFromMouse(cm, e);\n    if (!pos) { return }\n    var frag = document.createDocumentFragment();\n    drawSelectionCursor(cm, pos, frag);\n    if (!cm.display.dragCursor) {\n      cm.display.dragCursor = elt(\"div\", null, \"CodeMirror-cursors CodeMirror-dragcursors\");\n      cm.display.lineSpace.insertBefore(cm.display.dragCursor, cm.display.cursorDiv);\n    }\n    removeChildrenAndAdd(cm.display.dragCursor, frag);\n  }\n\n  function clearDragCursor(cm) {\n    if (cm.display.dragCursor) {\n      cm.display.lineSpace.removeChild(cm.display.dragCursor);\n      cm.display.dragCursor = null;\n    }\n  }\n\n  // These must be handled carefully, because naively registering a\n  // handler for each editor will cause the editors to never be\n  // garbage collected.\n\n  function forEachCodeMirror(f) {\n    if (!document.getElementsByClassName) { return }\n    var byClass = document.getElementsByClassName(\"CodeMirror\"), editors = [];\n    for (var i = 0; i < byClass.length; i++) {\n      var cm = byClass[i].CodeMirror;\n      if (cm) { editors.push(cm); }\n    }\n    if (editors.length) { editors[0].operation(function () {\n      for (var i = 0; i < editors.length; i++) { f(editors[i]); }\n    }); }\n  }\n\n  var globalsRegistered = false;\n  function ensureGlobalHandlers() {\n    if (globalsRegistered) { return }\n    registerGlobalHandlers();\n    globalsRegistered = true;\n  }\n  function registerGlobalHandlers() {\n    // When the window resizes, we need to refresh active editors.\n    var resizeTimer;\n    on(window, \"resize\", function () {\n      if (resizeTimer == null) { resizeTimer = setTimeout(function () {\n        resizeTimer = null;\n        forEachCodeMirror(onResize);\n      }, 100); }\n    });\n    // When the window loses focus, we want to show the editor as blurred\n    on(window, \"blur\", function () { return forEachCodeMirror(onBlur); });\n  }\n  // Called when the window resizes\n  function onResize(cm) {\n    var d = cm.display;\n    // Might be a text scaling operation, clear size caches.\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n    d.scrollbarsClipped = false;\n    cm.setSize();\n  }\n\n  var keyNames = {\n    3: \"Pause\", 8: \"Backspace\", 9: \"Tab\", 13: \"Enter\", 16: \"Shift\", 17: \"Ctrl\", 18: \"Alt\",\n    19: \"Pause\", 20: \"CapsLock\", 27: \"Esc\", 32: \"Space\", 33: \"PageUp\", 34: \"PageDown\", 35: \"End\",\n    36: \"Home\", 37: \"Left\", 38: \"Up\", 39: \"Right\", 40: \"Down\", 44: \"PrintScrn\", 45: \"Insert\",\n    46: \"Delete\", 59: \";\", 61: \"=\", 91: \"Mod\", 92: \"Mod\", 93: \"Mod\",\n    106: \"*\", 107: \"=\", 109: \"-\", 110: \".\", 111: \"/\", 145: \"ScrollLock\",\n    173: \"-\", 186: \";\", 187: \"=\", 188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\",\n    221: \"]\", 222: \"'\", 63232: \"Up\", 63233: \"Down\", 63234: \"Left\", 63235: \"Right\", 63272: \"Delete\",\n    63273: \"Home\", 63275: \"End\", 63276: \"PageUp\", 63277: \"PageDown\", 63302: \"Insert\"\n  };\n\n  // Number keys\n  for (var i = 0; i < 10; i++) { keyNames[i + 48] = keyNames[i + 96] = String(i); }\n  // Alphabetic keys\n  for (var i$1 = 65; i$1 <= 90; i$1++) { keyNames[i$1] = String.fromCharCode(i$1); }\n  // Function keys\n  for (var i$2 = 1; i$2 <= 12; i$2++) { keyNames[i$2 + 111] = keyNames[i$2 + 63235] = \"F\" + i$2; }\n\n  var keyMap = {};\n\n  keyMap.basic = {\n    \"Left\": \"goCharLeft\", \"Right\": \"goCharRight\", \"Up\": \"goLineUp\", \"Down\": \"goLineDown\",\n    \"End\": \"goLineEnd\", \"Home\": \"goLineStartSmart\", \"PageUp\": \"goPageUp\", \"PageDown\": \"goPageDown\",\n    \"Delete\": \"delCharAfter\", \"Backspace\": \"delCharBefore\", \"Shift-Backspace\": \"delCharBefore\",\n    \"Tab\": \"defaultTab\", \"Shift-Tab\": \"indentAuto\",\n    \"Enter\": \"newlineAndIndent\", \"Insert\": \"toggleOverwrite\",\n    \"Esc\": \"singleSelection\"\n  };\n  // Note that the save and find-related commands aren't defined by\n  // default. User code or addons can define them. Unknown commands\n  // are simply ignored.\n  keyMap.pcDefault = {\n    \"Ctrl-A\": \"selectAll\", \"Ctrl-D\": \"deleteLine\", \"Ctrl-Z\": \"undo\", \"Shift-Ctrl-Z\": \"redo\", \"Ctrl-Y\": \"redo\",\n    \"Ctrl-Home\": \"goDocStart\", \"Ctrl-End\": \"goDocEnd\", \"Ctrl-Up\": \"goLineUp\", \"Ctrl-Down\": \"goLineDown\",\n    \"Ctrl-Left\": \"goGroupLeft\", \"Ctrl-Right\": \"goGroupRight\", \"Alt-Left\": \"goLineStart\", \"Alt-Right\": \"goLineEnd\",\n    \"Ctrl-Backspace\": \"delGroupBefore\", \"Ctrl-Delete\": \"delGroupAfter\", \"Ctrl-S\": \"save\", \"Ctrl-F\": \"find\",\n    \"Ctrl-G\": \"findNext\", \"Shift-Ctrl-G\": \"findPrev\", \"Shift-Ctrl-F\": \"replace\", \"Shift-Ctrl-R\": \"replaceAll\",\n    \"Ctrl-[\": \"indentLess\", \"Ctrl-]\": \"indentMore\",\n    \"Ctrl-U\": \"undoSelection\", \"Shift-Ctrl-U\": \"redoSelection\", \"Alt-U\": \"redoSelection\",\n    \"fallthrough\": \"basic\"\n  };\n  // Very basic readline/emacs-style bindings, which are standard on Mac.\n  keyMap.emacsy = {\n    \"Ctrl-F\": \"goCharRight\", \"Ctrl-B\": \"goCharLeft\", \"Ctrl-P\": \"goLineUp\", \"Ctrl-N\": \"goLineDown\",\n    \"Alt-F\": \"goWordRight\", \"Alt-B\": \"goWordLeft\", \"Ctrl-A\": \"goLineStart\", \"Ctrl-E\": \"goLineEnd\",\n    \"Ctrl-V\": \"goPageDown\", \"Shift-Ctrl-V\": \"goPageUp\", \"Ctrl-D\": \"delCharAfter\", \"Ctrl-H\": \"delCharBefore\",\n    \"Alt-D\": \"delWordAfter\", \"Alt-Backspace\": \"delWordBefore\", \"Ctrl-K\": \"killLine\", \"Ctrl-T\": \"transposeChars\",\n    \"Ctrl-O\": \"openLine\"\n  };\n  keyMap.macDefault = {\n    \"Cmd-A\": \"selectAll\", \"Cmd-D\": \"deleteLine\", \"Cmd-Z\": \"undo\", \"Shift-Cmd-Z\": \"redo\", \"Cmd-Y\": \"redo\",\n    \"Cmd-Home\": \"goDocStart\", \"Cmd-Up\": \"goDocStart\", \"Cmd-End\": \"goDocEnd\", \"Cmd-Down\": \"goDocEnd\", \"Alt-Left\": \"goGroupLeft\",\n    \"Alt-Right\": \"goGroupRight\", \"Cmd-Left\": \"goLineLeft\", \"Cmd-Right\": \"goLineRight\", \"Alt-Backspace\": \"delGroupBefore\",\n    \"Ctrl-Alt-Backspace\": \"delGroupAfter\", \"Alt-Delete\": \"delGroupAfter\", \"Cmd-S\": \"save\", \"Cmd-F\": \"find\",\n    \"Cmd-G\": \"findNext\", \"Shift-Cmd-G\": \"findPrev\", \"Cmd-Alt-F\": \"replace\", \"Shift-Cmd-Alt-F\": \"replaceAll\",\n    \"Cmd-[\": \"indentLess\", \"Cmd-]\": \"indentMore\", \"Cmd-Backspace\": \"delWrappedLineLeft\", \"Cmd-Delete\": \"delWrappedLineRight\",\n    \"Cmd-U\": \"undoSelection\", \"Shift-Cmd-U\": \"redoSelection\", \"Ctrl-Up\": \"goDocStart\", \"Ctrl-Down\": \"goDocEnd\",\n    \"fallthrough\": [\"basic\", \"emacsy\"]\n  };\n  keyMap[\"default\"] = mac ? keyMap.macDefault : keyMap.pcDefault;\n\n  // KEYMAP DISPATCH\n\n  function normalizeKeyName(name) {\n    var parts = name.split(/-(?!$)/);\n    name = parts[parts.length - 1];\n    var alt, ctrl, shift, cmd;\n    for (var i = 0; i < parts.length - 1; i++) {\n      var mod = parts[i];\n      if (/^(cmd|meta|m)$/i.test(mod)) { cmd = true; }\n      else if (/^a(lt)?$/i.test(mod)) { alt = true; }\n      else if (/^(c|ctrl|control)$/i.test(mod)) { ctrl = true; }\n      else if (/^s(hift)?$/i.test(mod)) { shift = true; }\n      else { throw new Error(\"Unrecognized modifier name: \" + mod) }\n    }\n    if (alt) { name = \"Alt-\" + name; }\n    if (ctrl) { name = \"Ctrl-\" + name; }\n    if (cmd) { name = \"Cmd-\" + name; }\n    if (shift) { name = \"Shift-\" + name; }\n    return name\n  }\n\n  // This is a kludge to keep keymaps mostly working as raw objects\n  // (backwards compatibility) while at the same time support features\n  // like normalization and multi-stroke key bindings. It compiles a\n  // new normalized keymap, and then updates the old object to reflect\n  // this.\n  function normalizeKeyMap(keymap) {\n    var copy = {};\n    for (var keyname in keymap) { if (keymap.hasOwnProperty(keyname)) {\n      var value = keymap[keyname];\n      if (/^(name|fallthrough|(de|at)tach)$/.test(keyname)) { continue }\n      if (value == \"...\") { delete keymap[keyname]; continue }\n\n      var keys = map(keyname.split(\" \"), normalizeKeyName);\n      for (var i = 0; i < keys.length; i++) {\n        var val = (void 0), name = (void 0);\n        if (i == keys.length - 1) {\n          name = keys.join(\" \");\n          val = value;\n        } else {\n          name = keys.slice(0, i + 1).join(\" \");\n          val = \"...\";\n        }\n        var prev = copy[name];\n        if (!prev) { copy[name] = val; }\n        else if (prev != val) { throw new Error(\"Inconsistent bindings for \" + name) }\n      }\n      delete keymap[keyname];\n    } }\n    for (var prop in copy) { keymap[prop] = copy[prop]; }\n    return keymap\n  }\n\n  function lookupKey(key, map, handle, context) {\n    map = getKeyMap(map);\n    var found = map.call ? map.call(key, context) : map[key];\n    if (found === false) { return \"nothing\" }\n    if (found === \"...\") { return \"multi\" }\n    if (found != null && handle(found)) { return \"handled\" }\n\n    if (map.fallthrough) {\n      if (Object.prototype.toString.call(map.fallthrough) != \"[object Array]\")\n        { return lookupKey(key, map.fallthrough, handle, context) }\n      for (var i = 0; i < map.fallthrough.length; i++) {\n        var result = lookupKey(key, map.fallthrough[i], handle, context);\n        if (result) { return result }\n      }\n    }\n  }\n\n  // Modifier key presses don't count as 'real' key presses for the\n  // purpose of keymap fallthrough.\n  function isModifierKey(value) {\n    var name = typeof value == \"string\" ? value : keyNames[value.keyCode];\n    return name == \"Ctrl\" || name == \"Alt\" || name == \"Shift\" || name == \"Mod\"\n  }\n\n  function addModifierNames(name, event, noShift) {\n    var base = name;\n    if (event.altKey && base != \"Alt\") { name = \"Alt-\" + name; }\n    if ((flipCtrlCmd ? event.metaKey : event.ctrlKey) && base != \"Ctrl\") { name = \"Ctrl-\" + name; }\n    if ((flipCtrlCmd ? event.ctrlKey : event.metaKey) && base != \"Cmd\") { name = \"Cmd-\" + name; }\n    if (!noShift && event.shiftKey && base != \"Shift\") { name = \"Shift-\" + name; }\n    return name\n  }\n\n  // Look up the name of a key as indicated by an event object.\n  function keyName(event, noShift) {\n    if (presto && event.keyCode == 34 && event[\"char\"]) { return false }\n    var name = keyNames[event.keyCode];\n    if (name == null || event.altGraphKey) { return false }\n    // Ctrl-ScrollLock has keyCode 3, same as Ctrl-Pause,\n    // so we'll use event.code when available (Chrome 48+, FF 38+, Safari 10.1+)\n    if (event.keyCode == 3 && event.code) { name = event.code; }\n    return addModifierNames(name, event, noShift)\n  }\n\n  function getKeyMap(val) {\n    return typeof val == \"string\" ? keyMap[val] : val\n  }\n\n  // Helper for deleting text near the selection(s), used to implement\n  // backspace, delete, and similar functionality.\n  function deleteNearSelection(cm, compute) {\n    var ranges = cm.doc.sel.ranges, kill = [];\n    // Build up a set of ranges to kill first, merging overlapping\n    // ranges.\n    for (var i = 0; i < ranges.length; i++) {\n      var toKill = compute(ranges[i]);\n      while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\n        var replaced = kill.pop();\n        if (cmp(replaced.from, toKill.from) < 0) {\n          toKill.from = replaced.from;\n          break\n        }\n      }\n      kill.push(toKill);\n    }\n    // Next, remove those actual ranges.\n    runInOp(cm, function () {\n      for (var i = kill.length - 1; i >= 0; i--)\n        { replaceRange(cm.doc, \"\", kill[i].from, kill[i].to, \"+delete\"); }\n      ensureCursorVisible(cm);\n    });\n  }\n\n  function moveCharLogically(line, ch, dir) {\n    var target = skipExtendingChars(line.text, ch + dir, dir);\n    return target < 0 || target > line.text.length ? null : target\n  }\n\n  function moveLogically(line, start, dir) {\n    var ch = moveCharLogically(line, start.ch, dir);\n    return ch == null ? null : new Pos(start.line, ch, dir < 0 ? \"after\" : \"before\")\n  }\n\n  function endOfLine(visually, cm, lineObj, lineNo, dir) {\n    if (visually) {\n      if (cm.doc.direction == \"rtl\") { dir = -dir; }\n      var order = getOrder(lineObj, cm.doc.direction);\n      if (order) {\n        var part = dir < 0 ? lst(order) : order[0];\n        var moveInStorageOrder = (dir < 0) == (part.level == 1);\n        var sticky = moveInStorageOrder ? \"after\" : \"before\";\n        var ch;\n        // With a wrapped rtl chunk (possibly spanning multiple bidi parts),\n        // it could be that the last bidi part is not on the last visual line,\n        // since visual lines contain content order-consecutive chunks.\n        // Thus, in rtl, we are looking for the first (content-order) character\n        // in the rtl chunk that is on the last line (that is, the same line\n        // as the last (content-order) character).\n        if (part.level > 0 || cm.doc.direction == \"rtl\") {\n          var prep = prepareMeasureForLine(cm, lineObj);\n          ch = dir < 0 ? lineObj.text.length - 1 : 0;\n          var targetTop = measureCharPrepared(cm, prep, ch).top;\n          ch = findFirst(function (ch) { return measureCharPrepared(cm, prep, ch).top == targetTop; }, (dir < 0) == (part.level == 1) ? part.from : part.to - 1, ch);\n          if (sticky == \"before\") { ch = moveCharLogically(lineObj, ch, 1); }\n        } else { ch = dir < 0 ? part.to : part.from; }\n        return new Pos(lineNo, ch, sticky)\n      }\n    }\n    return new Pos(lineNo, dir < 0 ? lineObj.text.length : 0, dir < 0 ? \"before\" : \"after\")\n  }\n\n  function moveVisually(cm, line, start, dir) {\n    var bidi = getOrder(line, cm.doc.direction);\n    if (!bidi) { return moveLogically(line, start, dir) }\n    if (start.ch >= line.text.length) {\n      start.ch = line.text.length;\n      start.sticky = \"before\";\n    } else if (start.ch <= 0) {\n      start.ch = 0;\n      start.sticky = \"after\";\n    }\n    var partPos = getBidiPartAt(bidi, start.ch, start.sticky), part = bidi[partPos];\n    if (cm.doc.direction == \"ltr\" && part.level % 2 == 0 && (dir > 0 ? part.to > start.ch : part.from < start.ch)) {\n      // Case 1: We move within an ltr part in an ltr editor. Even with wrapped lines,\n      // nothing interesting happens.\n      return moveLogically(line, start, dir)\n    }\n\n    var mv = function (pos, dir) { return moveCharLogically(line, pos instanceof Pos ? pos.ch : pos, dir); };\n    var prep;\n    var getWrappedLineExtent = function (ch) {\n      if (!cm.options.lineWrapping) { return {begin: 0, end: line.text.length} }\n      prep = prep || prepareMeasureForLine(cm, line);\n      return wrappedLineExtentChar(cm, line, prep, ch)\n    };\n    var wrappedLineExtent = getWrappedLineExtent(start.sticky == \"before\" ? mv(start, -1) : start.ch);\n\n    if (cm.doc.direction == \"rtl\" || part.level == 1) {\n      var moveInStorageOrder = (part.level == 1) == (dir < 0);\n      var ch = mv(start, moveInStorageOrder ? 1 : -1);\n      if (ch != null && (!moveInStorageOrder ? ch >= part.from && ch >= wrappedLineExtent.begin : ch <= part.to && ch <= wrappedLineExtent.end)) {\n        // Case 2: We move within an rtl part or in an rtl editor on the same visual line\n        var sticky = moveInStorageOrder ? \"before\" : \"after\";\n        return new Pos(start.line, ch, sticky)\n      }\n    }\n\n    // Case 3: Could not move within this bidi part in this visual line, so leave\n    // the current bidi part\n\n    var searchInVisualLine = function (partPos, dir, wrappedLineExtent) {\n      var getRes = function (ch, moveInStorageOrder) { return moveInStorageOrder\n        ? new Pos(start.line, mv(ch, 1), \"before\")\n        : new Pos(start.line, ch, \"after\"); };\n\n      for (; partPos >= 0 && partPos < bidi.length; partPos += dir) {\n        var part = bidi[partPos];\n        var moveInStorageOrder = (dir > 0) == (part.level != 1);\n        var ch = moveInStorageOrder ? wrappedLineExtent.begin : mv(wrappedLineExtent.end, -1);\n        if (part.from <= ch && ch < part.to) { return getRes(ch, moveInStorageOrder) }\n        ch = moveInStorageOrder ? part.from : mv(part.to, -1);\n        if (wrappedLineExtent.begin <= ch && ch < wrappedLineExtent.end) { return getRes(ch, moveInStorageOrder) }\n      }\n    };\n\n    // Case 3a: Look for other bidi parts on the same visual line\n    var res = searchInVisualLine(partPos + dir, dir, wrappedLineExtent);\n    if (res) { return res }\n\n    // Case 3b: Look for other bidi parts on the next visual line\n    var nextCh = dir > 0 ? wrappedLineExtent.end : mv(wrappedLineExtent.begin, -1);\n    if (nextCh != null && !(dir > 0 && nextCh == line.text.length)) {\n      res = searchInVisualLine(dir > 0 ? 0 : bidi.length - 1, dir, getWrappedLineExtent(nextCh));\n      if (res) { return res }\n    }\n\n    // Case 4: Nowhere to move\n    return null\n  }\n\n  // Commands are parameter-less actions that can be performed on an\n  // editor, mostly used for keybindings.\n  var commands = {\n    selectAll: selectAll,\n    singleSelection: function (cm) { return cm.setSelection(cm.getCursor(\"anchor\"), cm.getCursor(\"head\"), sel_dontScroll); },\n    killLine: function (cm) { return deleteNearSelection(cm, function (range) {\n      if (range.empty()) {\n        var len = getLine(cm.doc, range.head.line).text.length;\n        if (range.head.ch == len && range.head.line < cm.lastLine())\n          { return {from: range.head, to: Pos(range.head.line + 1, 0)} }\n        else\n          { return {from: range.head, to: Pos(range.head.line, len)} }\n      } else {\n        return {from: range.from(), to: range.to()}\n      }\n    }); },\n    deleteLine: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n      from: Pos(range.from().line, 0),\n      to: clipPos(cm.doc, Pos(range.to().line + 1, 0))\n    }); }); },\n    delLineLeft: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n      from: Pos(range.from().line, 0), to: range.from()\n    }); }); },\n    delWrappedLineLeft: function (cm) { return deleteNearSelection(cm, function (range) {\n      var top = cm.charCoords(range.head, \"div\").top + 5;\n      var leftPos = cm.coordsChar({left: 0, top: top}, \"div\");\n      return {from: leftPos, to: range.from()}\n    }); },\n    delWrappedLineRight: function (cm) { return deleteNearSelection(cm, function (range) {\n      var top = cm.charCoords(range.head, \"div\").top + 5;\n      var rightPos = cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\");\n      return {from: range.from(), to: rightPos }\n    }); },\n    undo: function (cm) { return cm.undo(); },\n    redo: function (cm) { return cm.redo(); },\n    undoSelection: function (cm) { return cm.undoSelection(); },\n    redoSelection: function (cm) { return cm.redoSelection(); },\n    goDocStart: function (cm) { return cm.extendSelection(Pos(cm.firstLine(), 0)); },\n    goDocEnd: function (cm) { return cm.extendSelection(Pos(cm.lastLine())); },\n    goLineStart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStart(cm, range.head.line); },\n      {origin: \"+move\", bias: 1}\n    ); },\n    goLineStartSmart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStartSmart(cm, range.head); },\n      {origin: \"+move\", bias: 1}\n    ); },\n    goLineEnd: function (cm) { return cm.extendSelectionsBy(function (range) { return lineEnd(cm, range.head.line); },\n      {origin: \"+move\", bias: -1}\n    ); },\n    goLineRight: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      return cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\")\n    }, sel_move); },\n    goLineLeft: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      return cm.coordsChar({left: 0, top: top}, \"div\")\n    }, sel_move); },\n    goLineLeftSmart: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      var pos = cm.coordsChar({left: 0, top: top}, \"div\");\n      if (pos.ch < cm.getLine(pos.line).search(/\\S/)) { return lineStartSmart(cm, range.head) }\n      return pos\n    }, sel_move); },\n    goLineUp: function (cm) { return cm.moveV(-1, \"line\"); },\n    goLineDown: function (cm) { return cm.moveV(1, \"line\"); },\n    goPageUp: function (cm) { return cm.moveV(-1, \"page\"); },\n    goPageDown: function (cm) { return cm.moveV(1, \"page\"); },\n    goCharLeft: function (cm) { return cm.moveH(-1, \"char\"); },\n    goCharRight: function (cm) { return cm.moveH(1, \"char\"); },\n    goColumnLeft: function (cm) { return cm.moveH(-1, \"column\"); },\n    goColumnRight: function (cm) { return cm.moveH(1, \"column\"); },\n    goWordLeft: function (cm) { return cm.moveH(-1, \"word\"); },\n    goGroupRight: function (cm) { return cm.moveH(1, \"group\"); },\n    goGroupLeft: function (cm) { return cm.moveH(-1, \"group\"); },\n    goWordRight: function (cm) { return cm.moveH(1, \"word\"); },\n    delCharBefore: function (cm) { return cm.deleteH(-1, \"char\"); },\n    delCharAfter: function (cm) { return cm.deleteH(1, \"char\"); },\n    delWordBefore: function (cm) { return cm.deleteH(-1, \"word\"); },\n    delWordAfter: function (cm) { return cm.deleteH(1, \"word\"); },\n    delGroupBefore: function (cm) { return cm.deleteH(-1, \"group\"); },\n    delGroupAfter: function (cm) { return cm.deleteH(1, \"group\"); },\n    indentAuto: function (cm) { return cm.indentSelection(\"smart\"); },\n    indentMore: function (cm) { return cm.indentSelection(\"add\"); },\n    indentLess: function (cm) { return cm.indentSelection(\"subtract\"); },\n    insertTab: function (cm) { return cm.replaceSelection(\"\\t\"); },\n    insertSoftTab: function (cm) {\n      var spaces = [], ranges = cm.listSelections(), tabSize = cm.options.tabSize;\n      for (var i = 0; i < ranges.length; i++) {\n        var pos = ranges[i].from();\n        var col = countColumn(cm.getLine(pos.line), pos.ch, tabSize);\n        spaces.push(spaceStr(tabSize - col % tabSize));\n      }\n      cm.replaceSelections(spaces);\n    },\n    defaultTab: function (cm) {\n      if (cm.somethingSelected()) { cm.indentSelection(\"add\"); }\n      else { cm.execCommand(\"insertTab\"); }\n    },\n    // Swap the two chars left and right of each selection's head.\n    // Move cursor behind the two swapped characters afterwards.\n    //\n    // Doesn't consider line feeds a character.\n    // Doesn't scan more than one line above to find a character.\n    // Doesn't do anything on an empty line.\n    // Doesn't do anything with non-empty selections.\n    transposeChars: function (cm) { return runInOp(cm, function () {\n      var ranges = cm.listSelections(), newSel = [];\n      for (var i = 0; i < ranges.length; i++) {\n        if (!ranges[i].empty()) { continue }\n        var cur = ranges[i].head, line = getLine(cm.doc, cur.line).text;\n        if (line) {\n          if (cur.ch == line.length) { cur = new Pos(cur.line, cur.ch - 1); }\n          if (cur.ch > 0) {\n            cur = new Pos(cur.line, cur.ch + 1);\n            cm.replaceRange(line.charAt(cur.ch - 1) + line.charAt(cur.ch - 2),\n                            Pos(cur.line, cur.ch - 2), cur, \"+transpose\");\n          } else if (cur.line > cm.doc.first) {\n            var prev = getLine(cm.doc, cur.line - 1).text;\n            if (prev) {\n              cur = new Pos(cur.line, 1);\n              cm.replaceRange(line.charAt(0) + cm.doc.lineSeparator() +\n                              prev.charAt(prev.length - 1),\n                              Pos(cur.line - 1, prev.length - 1), cur, \"+transpose\");\n            }\n          }\n        }\n        newSel.push(new Range(cur, cur));\n      }\n      cm.setSelections(newSel);\n    }); },\n    newlineAndIndent: function (cm) { return runInOp(cm, function () {\n      var sels = cm.listSelections();\n      for (var i = sels.length - 1; i >= 0; i--)\n        { cm.replaceRange(cm.doc.lineSeparator(), sels[i].anchor, sels[i].head, \"+input\"); }\n      sels = cm.listSelections();\n      for (var i$1 = 0; i$1 < sels.length; i$1++)\n        { cm.indentLine(sels[i$1].from().line, null, true); }\n      ensureCursorVisible(cm);\n    }); },\n    openLine: function (cm) { return cm.replaceSelection(\"\\n\", \"start\"); },\n    toggleOverwrite: function (cm) { return cm.toggleOverwrite(); }\n  };\n\n\n  function lineStart(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLine(line);\n    if (visual != line) { lineN = lineNo(visual); }\n    return endOfLine(true, cm, visual, lineN, 1)\n  }\n  function lineEnd(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLineEnd(line);\n    if (visual != line) { lineN = lineNo(visual); }\n    return endOfLine(true, cm, line, lineN, -1)\n  }\n  function lineStartSmart(cm, pos) {\n    var start = lineStart(cm, pos.line);\n    var line = getLine(cm.doc, start.line);\n    var order = getOrder(line, cm.doc.direction);\n    if (!order || order[0].level == 0) {\n      var firstNonWS = Math.max(start.ch, line.text.search(/\\S/));\n      var inWS = pos.line == start.line && pos.ch <= firstNonWS && pos.ch;\n      return Pos(start.line, inWS ? 0 : firstNonWS, start.sticky)\n    }\n    return start\n  }\n\n  // Run a handler that was bound to a key.\n  function doHandleBinding(cm, bound, dropShift) {\n    if (typeof bound == \"string\") {\n      bound = commands[bound];\n      if (!bound) { return false }\n    }\n    // Ensure previous input has been read, so that the handler sees a\n    // consistent view of the document\n    cm.display.input.ensurePolled();\n    var prevShift = cm.display.shift, done = false;\n    try {\n      if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n      if (dropShift) { cm.display.shift = false; }\n      done = bound(cm) != Pass;\n    } finally {\n      cm.display.shift = prevShift;\n      cm.state.suppressEdits = false;\n    }\n    return done\n  }\n\n  function lookupKeyForEditor(cm, name, handle) {\n    for (var i = 0; i < cm.state.keyMaps.length; i++) {\n      var result = lookupKey(name, cm.state.keyMaps[i], handle, cm);\n      if (result) { return result }\n    }\n    return (cm.options.extraKeys && lookupKey(name, cm.options.extraKeys, handle, cm))\n      || lookupKey(name, cm.options.keyMap, handle, cm)\n  }\n\n  // Note that, despite the name, this function is also used to check\n  // for bound mouse clicks.\n\n  var stopSeq = new Delayed;\n\n  function dispatchKey(cm, name, e, handle) {\n    var seq = cm.state.keySeq;\n    if (seq) {\n      if (isModifierKey(name)) { return \"handled\" }\n      if (/\\'$/.test(name))\n        { cm.state.keySeq = null; }\n      else\n        { stopSeq.set(50, function () {\n          if (cm.state.keySeq == seq) {\n            cm.state.keySeq = null;\n            cm.display.input.reset();\n          }\n        }); }\n      if (dispatchKeyInner(cm, seq + \" \" + name, e, handle)) { return true }\n    }\n    return dispatchKeyInner(cm, name, e, handle)\n  }\n\n  function dispatchKeyInner(cm, name, e, handle) {\n    var result = lookupKeyForEditor(cm, name, handle);\n\n    if (result == \"multi\")\n      { cm.state.keySeq = name; }\n    if (result == \"handled\")\n      { signalLater(cm, \"keyHandled\", cm, name, e); }\n\n    if (result == \"handled\" || result == \"multi\") {\n      e_preventDefault(e);\n      restartBlink(cm);\n    }\n\n    return !!result\n  }\n\n  // Handle a key from the keydown event.\n  function handleKeyBinding(cm, e) {\n    var name = keyName(e, true);\n    if (!name) { return false }\n\n    if (e.shiftKey && !cm.state.keySeq) {\n      // First try to resolve full name (including 'Shift-'). Failing\n      // that, see if there is a cursor-motion command (starting with\n      // 'go') bound to the keyname without 'Shift-'.\n      return dispatchKey(cm, \"Shift-\" + name, e, function (b) { return doHandleBinding(cm, b, true); })\n          || dispatchKey(cm, name, e, function (b) {\n               if (typeof b == \"string\" ? /^go[A-Z]/.test(b) : b.motion)\n                 { return doHandleBinding(cm, b) }\n             })\n    } else {\n      return dispatchKey(cm, name, e, function (b) { return doHandleBinding(cm, b); })\n    }\n  }\n\n  // Handle a key from the keypress event\n  function handleCharBinding(cm, e, ch) {\n    return dispatchKey(cm, \"'\" + ch + \"'\", e, function (b) { return doHandleBinding(cm, b, true); })\n  }\n\n  var lastStoppedKey = null;\n  function onKeyDown(e) {\n    var cm = this;\n    cm.curOp.focus = activeElt();\n    if (signalDOMEvent(cm, e)) { return }\n    // IE does strange things with escape.\n    if (ie && ie_version < 11 && e.keyCode == 27) { e.returnValue = false; }\n    var code = e.keyCode;\n    cm.display.shift = code == 16 || e.shiftKey;\n    var handled = handleKeyBinding(cm, e);\n    if (presto) {\n      lastStoppedKey = handled ? code : null;\n      // Opera has no cut event... we try to at least catch the key combo\n      if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey))\n        { cm.replaceSelection(\"\", null, \"cut\"); }\n    }\n    if (gecko && !mac && !handled && code == 46 && e.shiftKey && !e.ctrlKey && document.execCommand)\n      { document.execCommand(\"cut\"); }\n\n    // Turn mouse into crosshair when Alt is held on Mac.\n    if (code == 18 && !/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className))\n      { showCrossHair(cm); }\n  }\n\n  function showCrossHair(cm) {\n    var lineDiv = cm.display.lineDiv;\n    addClass(lineDiv, \"CodeMirror-crosshair\");\n\n    function up(e) {\n      if (e.keyCode == 18 || !e.altKey) {\n        rmClass(lineDiv, \"CodeMirror-crosshair\");\n        off(document, \"keyup\", up);\n        off(document, \"mouseover\", up);\n      }\n    }\n    on(document, \"keyup\", up);\n    on(document, \"mouseover\", up);\n  }\n\n  function onKeyUp(e) {\n    if (e.keyCode == 16) { this.doc.sel.shift = false; }\n    signalDOMEvent(this, e);\n  }\n\n  function onKeyPress(e) {\n    var cm = this;\n    if (eventInWidget(cm.display, e) || signalDOMEvent(cm, e) || e.ctrlKey && !e.altKey || mac && e.metaKey) { return }\n    var keyCode = e.keyCode, charCode = e.charCode;\n    if (presto && keyCode == lastStoppedKey) {lastStoppedKey = null; e_preventDefault(e); return}\n    if ((presto && (!e.which || e.which < 10)) && handleKeyBinding(cm, e)) { return }\n    var ch = String.fromCharCode(charCode == null ? keyCode : charCode);\n    // Some browsers fire keypress events for backspace\n    if (ch == \"\\x08\") { return }\n    if (handleCharBinding(cm, e, ch)) { return }\n    cm.display.input.onKeyPress(e);\n  }\n\n  var DOUBLECLICK_DELAY = 400;\n\n  var PastClick = function(time, pos, button) {\n    this.time = time;\n    this.pos = pos;\n    this.button = button;\n  };\n\n  PastClick.prototype.compare = function (time, pos, button) {\n    return this.time + DOUBLECLICK_DELAY > time &&\n      cmp(pos, this.pos) == 0 && button == this.button\n  };\n\n  var lastClick, lastDoubleClick;\n  function clickRepeat(pos, button) {\n    var now = +new Date;\n    if (lastDoubleClick && lastDoubleClick.compare(now, pos, button)) {\n      lastClick = lastDoubleClick = null;\n      return \"triple\"\n    } else if (lastClick && lastClick.compare(now, pos, button)) {\n      lastDoubleClick = new PastClick(now, pos, button);\n      lastClick = null;\n      return \"double\"\n    } else {\n      lastClick = new PastClick(now, pos, button);\n      lastDoubleClick = null;\n      return \"single\"\n    }\n  }\n\n  // A mouse down can be a single click, double click, triple click,\n  // start of selection drag, start of text drag, new cursor\n  // (ctrl-click), rectangle drag (alt-drag), or xwin\n  // middle-click-paste. Or it might be a click on something we should\n  // not interfere with, such as a scrollbar or widget.\n  function onMouseDown(e) {\n    var cm = this, display = cm.display;\n    if (signalDOMEvent(cm, e) || display.activeTouch && display.input.supportsTouch()) { return }\n    display.input.ensurePolled();\n    display.shift = e.shiftKey;\n\n    if (eventInWidget(display, e)) {\n      if (!webkit) {\n        // Briefly turn off draggability, to allow widgets to do\n        // normal dragging things.\n        display.scroller.draggable = false;\n        setTimeout(function () { return display.scroller.draggable = true; }, 100);\n      }\n      return\n    }\n    if (clickInGutter(cm, e)) { return }\n    var pos = posFromMouse(cm, e), button = e_button(e), repeat = pos ? clickRepeat(pos, button) : \"single\";\n    window.focus();\n\n    // #3261: make sure, that we're not starting a second selection\n    if (button == 1 && cm.state.selectingText)\n      { cm.state.selectingText(e); }\n\n    if (pos && handleMappedButton(cm, button, pos, repeat, e)) { return }\n\n    if (button == 1) {\n      if (pos) { leftButtonDown(cm, pos, repeat, e); }\n      else if (e_target(e) == display.scroller) { e_preventDefault(e); }\n    } else if (button == 2) {\n      if (pos) { extendSelection(cm.doc, pos); }\n      setTimeout(function () { return display.input.focus(); }, 20);\n    } else if (button == 3) {\n      if (captureRightClick) { cm.display.input.onContextMenu(e); }\n      else { delayBlurEvent(cm); }\n    }\n  }\n\n  function handleMappedButton(cm, button, pos, repeat, event) {\n    var name = \"Click\";\n    if (repeat == \"double\") { name = \"Double\" + name; }\n    else if (repeat == \"triple\") { name = \"Triple\" + name; }\n    name = (button == 1 ? \"Left\" : button == 2 ? \"Middle\" : \"Right\") + name;\n\n    return dispatchKey(cm,  addModifierNames(name, event), event, function (bound) {\n      if (typeof bound == \"string\") { bound = commands[bound]; }\n      if (!bound) { return false }\n      var done = false;\n      try {\n        if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n        done = bound(cm, pos) != Pass;\n      } finally {\n        cm.state.suppressEdits = false;\n      }\n      return done\n    })\n  }\n\n  function configureMouse(cm, repeat, event) {\n    var option = cm.getOption(\"configureMouse\");\n    var value = option ? option(cm, repeat, event) : {};\n    if (value.unit == null) {\n      var rect = chromeOS ? event.shiftKey && event.metaKey : event.altKey;\n      value.unit = rect ? \"rectangle\" : repeat == \"single\" ? \"char\" : repeat == \"double\" ? \"word\" : \"line\";\n    }\n    if (value.extend == null || cm.doc.extend) { value.extend = cm.doc.extend || event.shiftKey; }\n    if (value.addNew == null) { value.addNew = mac ? event.metaKey : event.ctrlKey; }\n    if (value.moveOnDrag == null) { value.moveOnDrag = !(mac ? event.altKey : event.ctrlKey); }\n    return value\n  }\n\n  function leftButtonDown(cm, pos, repeat, event) {\n    if (ie) { setTimeout(bind(ensureFocus, cm), 0); }\n    else { cm.curOp.focus = activeElt(); }\n\n    var behavior = configureMouse(cm, repeat, event);\n\n    var sel = cm.doc.sel, contained;\n    if (cm.options.dragDrop && dragAndDrop && !cm.isReadOnly() &&\n        repeat == \"single\" && (contained = sel.contains(pos)) > -1 &&\n        (cmp((contained = sel.ranges[contained]).from(), pos) < 0 || pos.xRel > 0) &&\n        (cmp(contained.to(), pos) > 0 || pos.xRel < 0))\n      { leftButtonStartDrag(cm, event, pos, behavior); }\n    else\n      { leftButtonSelect(cm, event, pos, behavior); }\n  }\n\n  // Start a text drag. When it ends, see if any dragging actually\n  // happen, and treat as a click if it didn't.\n  function leftButtonStartDrag(cm, event, pos, behavior) {\n    var display = cm.display, moved = false;\n    var dragEnd = operation(cm, function (e) {\n      if (webkit) { display.scroller.draggable = false; }\n      cm.state.draggingText = false;\n      off(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n      off(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n      off(display.scroller, \"dragstart\", dragStart);\n      off(display.scroller, \"drop\", dragEnd);\n      if (!moved) {\n        e_preventDefault(e);\n        if (!behavior.addNew)\n          { extendSelection(cm.doc, pos, null, null, behavior.extend); }\n        // Work around unexplainable focus problem in IE9 (#2127) and Chrome (#3081)\n        if (webkit || ie && ie_version == 9)\n          { setTimeout(function () {display.wrapper.ownerDocument.body.focus(); display.input.focus();}, 20); }\n        else\n          { display.input.focus(); }\n      }\n    });\n    var mouseMove = function(e2) {\n      moved = moved || Math.abs(event.clientX - e2.clientX) + Math.abs(event.clientY - e2.clientY) >= 10;\n    };\n    var dragStart = function () { return moved = true; };\n    // Let the drag handler handle this.\n    if (webkit) { display.scroller.draggable = true; }\n    cm.state.draggingText = dragEnd;\n    dragEnd.copy = !behavior.moveOnDrag;\n    // IE's approach to draggable\n    if (display.scroller.dragDrop) { display.scroller.dragDrop(); }\n    on(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n    on(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n    on(display.scroller, \"dragstart\", dragStart);\n    on(display.scroller, \"drop\", dragEnd);\n\n    delayBlurEvent(cm);\n    setTimeout(function () { return display.input.focus(); }, 20);\n  }\n\n  function rangeForUnit(cm, pos, unit) {\n    if (unit == \"char\") { return new Range(pos, pos) }\n    if (unit == \"word\") { return cm.findWordAt(pos) }\n    if (unit == \"line\") { return new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))) }\n    var result = unit(cm, pos);\n    return new Range(result.from, result.to)\n  }\n\n  // Normal selection, as opposed to text dragging.\n  function leftButtonSelect(cm, event, start, behavior) {\n    var display = cm.display, doc = cm.doc;\n    e_preventDefault(event);\n\n    var ourRange, ourIndex, startSel = doc.sel, ranges = startSel.ranges;\n    if (behavior.addNew && !behavior.extend) {\n      ourIndex = doc.sel.contains(start);\n      if (ourIndex > -1)\n        { ourRange = ranges[ourIndex]; }\n      else\n        { ourRange = new Range(start, start); }\n    } else {\n      ourRange = doc.sel.primary();\n      ourIndex = doc.sel.primIndex;\n    }\n\n    if (behavior.unit == \"rectangle\") {\n      if (!behavior.addNew) { ourRange = new Range(start, start); }\n      start = posFromMouse(cm, event, true, true);\n      ourIndex = -1;\n    } else {\n      var range = rangeForUnit(cm, start, behavior.unit);\n      if (behavior.extend)\n        { ourRange = extendRange(ourRange, range.anchor, range.head, behavior.extend); }\n      else\n        { ourRange = range; }\n    }\n\n    if (!behavior.addNew) {\n      ourIndex = 0;\n      setSelection(doc, new Selection([ourRange], 0), sel_mouse);\n      startSel = doc.sel;\n    } else if (ourIndex == -1) {\n      ourIndex = ranges.length;\n      setSelection(doc, normalizeSelection(cm, ranges.concat([ourRange]), ourIndex),\n                   {scroll: false, origin: \"*mouse\"});\n    } else if (ranges.length > 1 && ranges[ourIndex].empty() && behavior.unit == \"char\" && !behavior.extend) {\n      setSelection(doc, normalizeSelection(cm, ranges.slice(0, ourIndex).concat(ranges.slice(ourIndex + 1)), 0),\n                   {scroll: false, origin: \"*mouse\"});\n      startSel = doc.sel;\n    } else {\n      replaceOneSelection(doc, ourIndex, ourRange, sel_mouse);\n    }\n\n    var lastPos = start;\n    function extendTo(pos) {\n      if (cmp(lastPos, pos) == 0) { return }\n      lastPos = pos;\n\n      if (behavior.unit == \"rectangle\") {\n        var ranges = [], tabSize = cm.options.tabSize;\n        var startCol = countColumn(getLine(doc, start.line).text, start.ch, tabSize);\n        var posCol = countColumn(getLine(doc, pos.line).text, pos.ch, tabSize);\n        var left = Math.min(startCol, posCol), right = Math.max(startCol, posCol);\n        for (var line = Math.min(start.line, pos.line), end = Math.min(cm.lastLine(), Math.max(start.line, pos.line));\n             line <= end; line++) {\n          var text = getLine(doc, line).text, leftPos = findColumn(text, left, tabSize);\n          if (left == right)\n            { ranges.push(new Range(Pos(line, leftPos), Pos(line, leftPos))); }\n          else if (text.length > leftPos)\n            { ranges.push(new Range(Pos(line, leftPos), Pos(line, findColumn(text, right, tabSize)))); }\n        }\n        if (!ranges.length) { ranges.push(new Range(start, start)); }\n        setSelection(doc, normalizeSelection(cm, startSel.ranges.slice(0, ourIndex).concat(ranges), ourIndex),\n                     {origin: \"*mouse\", scroll: false});\n        cm.scrollIntoView(pos);\n      } else {\n        var oldRange = ourRange;\n        var range = rangeForUnit(cm, pos, behavior.unit);\n        var anchor = oldRange.anchor, head;\n        if (cmp(range.anchor, anchor) > 0) {\n          head = range.head;\n          anchor = minPos(oldRange.from(), range.anchor);\n        } else {\n          head = range.anchor;\n          anchor = maxPos(oldRange.to(), range.head);\n        }\n        var ranges$1 = startSel.ranges.slice(0);\n        ranges$1[ourIndex] = bidiSimplify(cm, new Range(clipPos(doc, anchor), head));\n        setSelection(doc, normalizeSelection(cm, ranges$1, ourIndex), sel_mouse);\n      }\n    }\n\n    var editorSize = display.wrapper.getBoundingClientRect();\n    // Used to ensure timeout re-tries don't fire when another extend\n    // happened in the meantime (clearTimeout isn't reliable -- at\n    // least on Chrome, the timeouts still happen even when cleared,\n    // if the clear happens after their scheduled firing time).\n    var counter = 0;\n\n    function extend(e) {\n      var curCount = ++counter;\n      var cur = posFromMouse(cm, e, true, behavior.unit == \"rectangle\");\n      if (!cur) { return }\n      if (cmp(cur, lastPos) != 0) {\n        cm.curOp.focus = activeElt();\n        extendTo(cur);\n        var visible = visibleLines(display, doc);\n        if (cur.line >= visible.to || cur.line < visible.from)\n          { setTimeout(operation(cm, function () {if (counter == curCount) { extend(e); }}), 150); }\n      } else {\n        var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;\n        if (outside) { setTimeout(operation(cm, function () {\n          if (counter != curCount) { return }\n          display.scroller.scrollTop += outside;\n          extend(e);\n        }), 50); }\n      }\n    }\n\n    function done(e) {\n      cm.state.selectingText = false;\n      counter = Infinity;\n      // If e is null or undefined we interpret this as someone trying\n      // to explicitly cancel the selection rather than the user\n      // letting go of the mouse button.\n      if (e) {\n        e_preventDefault(e);\n        display.input.focus();\n      }\n      off(display.wrapper.ownerDocument, \"mousemove\", move);\n      off(display.wrapper.ownerDocument, \"mouseup\", up);\n      doc.history.lastSelOrigin = null;\n    }\n\n    var move = operation(cm, function (e) {\n      if (e.buttons === 0 || !e_button(e)) { done(e); }\n      else { extend(e); }\n    });\n    var up = operation(cm, done);\n    cm.state.selectingText = up;\n    on(display.wrapper.ownerDocument, \"mousemove\", move);\n    on(display.wrapper.ownerDocument, \"mouseup\", up);\n  }\n\n  // Used when mouse-selecting to adjust the anchor to the proper side\n  // of a bidi jump depending on the visual position of the head.\n  function bidiSimplify(cm, range) {\n    var anchor = range.anchor;\n    var head = range.head;\n    var anchorLine = getLine(cm.doc, anchor.line);\n    if (cmp(anchor, head) == 0 && anchor.sticky == head.sticky) { return range }\n    var order = getOrder(anchorLine);\n    if (!order) { return range }\n    var index = getBidiPartAt(order, anchor.ch, anchor.sticky), part = order[index];\n    if (part.from != anchor.ch && part.to != anchor.ch) { return range }\n    var boundary = index + ((part.from == anchor.ch) == (part.level != 1) ? 0 : 1);\n    if (boundary == 0 || boundary == order.length) { return range }\n\n    // Compute the relative visual position of the head compared to the\n    // anchor (<0 is to the left, >0 to the right)\n    var leftSide;\n    if (head.line != anchor.line) {\n      leftSide = (head.line - anchor.line) * (cm.doc.direction == \"ltr\" ? 1 : -1) > 0;\n    } else {\n      var headIndex = getBidiPartAt(order, head.ch, head.sticky);\n      var dir = headIndex - index || (head.ch - anchor.ch) * (part.level == 1 ? -1 : 1);\n      if (headIndex == boundary - 1 || headIndex == boundary)\n        { leftSide = dir < 0; }\n      else\n        { leftSide = dir > 0; }\n    }\n\n    var usePart = order[boundary + (leftSide ? -1 : 0)];\n    var from = leftSide == (usePart.level == 1);\n    var ch = from ? usePart.from : usePart.to, sticky = from ? \"after\" : \"before\";\n    return anchor.ch == ch && anchor.sticky == sticky ? range : new Range(new Pos(anchor.line, ch, sticky), head)\n  }\n\n\n  // Determines whether an event happened in the gutter, and fires the\n  // handlers for the corresponding event.\n  function gutterEvent(cm, e, type, prevent) {\n    var mX, mY;\n    if (e.touches) {\n      mX = e.touches[0].clientX;\n      mY = e.touches[0].clientY;\n    } else {\n      try { mX = e.clientX; mY = e.clientY; }\n      catch(e) { return false }\n    }\n    if (mX >= Math.floor(cm.display.gutters.getBoundingClientRect().right)) { return false }\n    if (prevent) { e_preventDefault(e); }\n\n    var display = cm.display;\n    var lineBox = display.lineDiv.getBoundingClientRect();\n\n    if (mY > lineBox.bottom || !hasHandler(cm, type)) { return e_defaultPrevented(e) }\n    mY -= lineBox.top - display.viewOffset;\n\n    for (var i = 0; i < cm.display.gutterSpecs.length; ++i) {\n      var g = display.gutters.childNodes[i];\n      if (g && g.getBoundingClientRect().right >= mX) {\n        var line = lineAtHeight(cm.doc, mY);\n        var gutter = cm.display.gutterSpecs[i];\n        signal(cm, type, cm, line, gutter.className, e);\n        return e_defaultPrevented(e)\n      }\n    }\n  }\n\n  function clickInGutter(cm, e) {\n    return gutterEvent(cm, e, \"gutterClick\", true)\n  }\n\n  // CONTEXT MENU HANDLING\n\n  // To make the context menu work, we need to briefly unhide the\n  // textarea (making it as unobtrusive as possible) to let the\n  // right-click take effect on it.\n  function onContextMenu(cm, e) {\n    if (eventInWidget(cm.display, e) || contextMenuInGutter(cm, e)) { return }\n    if (signalDOMEvent(cm, e, \"contextmenu\")) { return }\n    if (!captureRightClick) { cm.display.input.onContextMenu(e); }\n  }\n\n  function contextMenuInGutter(cm, e) {\n    if (!hasHandler(cm, \"gutterContextMenu\")) { return false }\n    return gutterEvent(cm, e, \"gutterContextMenu\", false)\n  }\n\n  function themeChanged(cm) {\n    cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, \"\") +\n      cm.options.theme.replace(/(^|\\s)\\s*/g, \" cm-s-\");\n    clearCaches(cm);\n  }\n\n  var Init = {toString: function(){return \"CodeMirror.Init\"}};\n\n  var defaults = {};\n  var optionHandlers = {};\n\n  function defineOptions(CodeMirror) {\n    var optionHandlers = CodeMirror.optionHandlers;\n\n    function option(name, deflt, handle, notOnInit) {\n      CodeMirror.defaults[name] = deflt;\n      if (handle) { optionHandlers[name] =\n        notOnInit ? function (cm, val, old) {if (old != Init) { handle(cm, val, old); }} : handle; }\n    }\n\n    CodeMirror.defineOption = option;\n\n    // Passed to option handlers when there is no old value.\n    CodeMirror.Init = Init;\n\n    // These two are, on init, called from the constructor because they\n    // have to be initialized before the editor can start at all.\n    option(\"value\", \"\", function (cm, val) { return cm.setValue(val); }, true);\n    option(\"mode\", null, function (cm, val) {\n      cm.doc.modeOption = val;\n      loadMode(cm);\n    }, true);\n\n    option(\"indentUnit\", 2, loadMode, true);\n    option(\"indentWithTabs\", false);\n    option(\"smartIndent\", true);\n    option(\"tabSize\", 4, function (cm) {\n      resetModeState(cm);\n      clearCaches(cm);\n      regChange(cm);\n    }, true);\n\n    option(\"lineSeparator\", null, function (cm, val) {\n      cm.doc.lineSep = val;\n      if (!val) { return }\n      var newBreaks = [], lineNo = cm.doc.first;\n      cm.doc.iter(function (line) {\n        for (var pos = 0;;) {\n          var found = line.text.indexOf(val, pos);\n          if (found == -1) { break }\n          pos = found + val.length;\n          newBreaks.push(Pos(lineNo, found));\n        }\n        lineNo++;\n      });\n      for (var i = newBreaks.length - 1; i >= 0; i--)\n        { replaceRange(cm.doc, val, newBreaks[i], Pos(newBreaks[i].line, newBreaks[i].ch + val.length)); }\n    });\n    option(\"specialChars\", /[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u061c\\u200b-\\u200f\\u2028\\u2029\\ufeff\\ufff9-\\ufffc]/g, function (cm, val, old) {\n      cm.state.specialChars = new RegExp(val.source + (val.test(\"\\t\") ? \"\" : \"|\\t\"), \"g\");\n      if (old != Init) { cm.refresh(); }\n    });\n    option(\"specialCharPlaceholder\", defaultSpecialCharPlaceholder, function (cm) { return cm.refresh(); }, true);\n    option(\"electricChars\", true);\n    option(\"inputStyle\", mobile ? \"contenteditable\" : \"textarea\", function () {\n      throw new Error(\"inputStyle can not (yet) be changed in a running editor\") // FIXME\n    }, true);\n    option(\"spellcheck\", false, function (cm, val) { return cm.getInputField().spellcheck = val; }, true);\n    option(\"autocorrect\", false, function (cm, val) { return cm.getInputField().autocorrect = val; }, true);\n    option(\"autocapitalize\", false, function (cm, val) { return cm.getInputField().autocapitalize = val; }, true);\n    option(\"rtlMoveVisually\", !windows);\n    option(\"wholeLineUpdateBefore\", true);\n\n    option(\"theme\", \"default\", function (cm) {\n      themeChanged(cm);\n      updateGutters(cm);\n    }, true);\n    option(\"keyMap\", \"default\", function (cm, val, old) {\n      var next = getKeyMap(val);\n      var prev = old != Init && getKeyMap(old);\n      if (prev && prev.detach) { prev.detach(cm, next); }\n      if (next.attach) { next.attach(cm, prev || null); }\n    });\n    option(\"extraKeys\", null);\n    option(\"configureMouse\", null);\n\n    option(\"lineWrapping\", false, wrappingChanged, true);\n    option(\"gutters\", [], function (cm, val) {\n      cm.display.gutterSpecs = getGutters(val, cm.options.lineNumbers);\n      updateGutters(cm);\n    }, true);\n    option(\"fixedGutter\", true, function (cm, val) {\n      cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + \"px\" : \"0\";\n      cm.refresh();\n    }, true);\n    option(\"coverGutterNextToScrollbar\", false, function (cm) { return updateScrollbars(cm); }, true);\n    option(\"scrollbarStyle\", \"native\", function (cm) {\n      initScrollbars(cm);\n      updateScrollbars(cm);\n      cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);\n      cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft);\n    }, true);\n    option(\"lineNumbers\", false, function (cm, val) {\n      cm.display.gutterSpecs = getGutters(cm.options.gutters, val);\n      updateGutters(cm);\n    }, true);\n    option(\"firstLineNumber\", 1, updateGutters, true);\n    option(\"lineNumberFormatter\", function (integer) { return integer; }, updateGutters, true);\n    option(\"showCursorWhenSelecting\", false, updateSelection, true);\n\n    option(\"resetSelectionOnContextMenu\", true);\n    option(\"lineWiseCopyCut\", true);\n    option(\"pasteLinesPerSelection\", true);\n    option(\"selectionsMayTouch\", false);\n\n    option(\"readOnly\", false, function (cm, val) {\n      if (val == \"nocursor\") {\n        onBlur(cm);\n        cm.display.input.blur();\n      }\n      cm.display.input.readOnlyChanged(val);\n    });\n    option(\"disableInput\", false, function (cm, val) {if (!val) { cm.display.input.reset(); }}, true);\n    option(\"dragDrop\", true, dragDropChanged);\n    option(\"allowDropFileTypes\", null);\n\n    option(\"cursorBlinkRate\", 530);\n    option(\"cursorScrollMargin\", 0);\n    option(\"cursorHeight\", 1, updateSelection, true);\n    option(\"singleCursorHeightPerLine\", true, updateSelection, true);\n    option(\"workTime\", 100);\n    option(\"workDelay\", 100);\n    option(\"flattenSpans\", true, resetModeState, true);\n    option(\"addModeClass\", false, resetModeState, true);\n    option(\"pollInterval\", 100);\n    option(\"undoDepth\", 200, function (cm, val) { return cm.doc.history.undoDepth = val; });\n    option(\"historyEventDelay\", 1250);\n    option(\"viewportMargin\", 10, function (cm) { return cm.refresh(); }, true);\n    option(\"maxHighlightLength\", 10000, resetModeState, true);\n    option(\"moveInputWithCursor\", true, function (cm, val) {\n      if (!val) { cm.display.input.resetPosition(); }\n    });\n\n    option(\"tabindex\", null, function (cm, val) { return cm.display.input.getField().tabIndex = val || \"\"; });\n    option(\"autofocus\", null);\n    option(\"direction\", \"ltr\", function (cm, val) { return cm.doc.setDirection(val); }, true);\n    option(\"phrases\", null);\n  }\n\n  function dragDropChanged(cm, value, old) {\n    var wasOn = old && old != Init;\n    if (!value != !wasOn) {\n      var funcs = cm.display.dragFunctions;\n      var toggle = value ? on : off;\n      toggle(cm.display.scroller, \"dragstart\", funcs.start);\n      toggle(cm.display.scroller, \"dragenter\", funcs.enter);\n      toggle(cm.display.scroller, \"dragover\", funcs.over);\n      toggle(cm.display.scroller, \"dragleave\", funcs.leave);\n      toggle(cm.display.scroller, \"drop\", funcs.drop);\n    }\n  }\n\n  function wrappingChanged(cm) {\n    if (cm.options.lineWrapping) {\n      addClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      cm.display.sizer.style.minWidth = \"\";\n      cm.display.sizerWidth = null;\n    } else {\n      rmClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      findMaxLine(cm);\n    }\n    estimateLineHeights(cm);\n    regChange(cm);\n    clearCaches(cm);\n    setTimeout(function () { return updateScrollbars(cm); }, 100);\n  }\n\n  // A CodeMirror instance represents an editor. This is the object\n  // that user code is usually dealing with.\n\n  function CodeMirror(place, options) {\n    var this$1 = this;\n\n    if (!(this instanceof CodeMirror)) { return new CodeMirror(place, options) }\n\n    this.options = options = options ? copyObj(options) : {};\n    // Determine effective options based on given values and defaults.\n    copyObj(defaults, options, false);\n\n    var doc = options.value;\n    if (typeof doc == \"string\") { doc = new Doc(doc, options.mode, null, options.lineSeparator, options.direction); }\n    else if (options.mode) { doc.modeOption = options.mode; }\n    this.doc = doc;\n\n    var input = new CodeMirror.inputStyles[options.inputStyle](this);\n    var display = this.display = new Display(place, doc, input, options);\n    display.wrapper.CodeMirror = this;\n    themeChanged(this);\n    if (options.lineWrapping)\n      { this.display.wrapper.className += \" CodeMirror-wrap\"; }\n    initScrollbars(this);\n\n    this.state = {\n      keyMaps: [],  // stores maps added by addKeyMap\n      overlays: [], // highlighting overlays, as added by addOverlay\n      modeGen: 0,   // bumped when mode/overlay changes, used to invalidate highlighting info\n      overwrite: false,\n      delayingBlurEvent: false,\n      focused: false,\n      suppressEdits: false, // used to disable editing during key handlers when in readOnly mode\n      pasteIncoming: -1, cutIncoming: -1, // help recognize paste/cut edits in input.poll\n      selectingText: false,\n      draggingText: false,\n      highlight: new Delayed(), // stores highlight worker timeout\n      keySeq: null,  // Unfinished key sequence\n      specialChars: null\n    };\n\n    if (options.autofocus && !mobile) { display.input.focus(); }\n\n    // Override magic textarea content restore that IE sometimes does\n    // on our hidden textarea on reload\n    if (ie && ie_version < 11) { setTimeout(function () { return this$1.display.input.reset(true); }, 20); }\n\n    registerEventHandlers(this);\n    ensureGlobalHandlers();\n\n    startOperation(this);\n    this.curOp.forceUpdate = true;\n    attachDoc(this, doc);\n\n    if ((options.autofocus && !mobile) || this.hasFocus())\n      { setTimeout(bind(onFocus, this), 20); }\n    else\n      { onBlur(this); }\n\n    for (var opt in optionHandlers) { if (optionHandlers.hasOwnProperty(opt))\n      { optionHandlers[opt](this, options[opt], Init); } }\n    maybeUpdateLineNumberWidth(this);\n    if (options.finishInit) { options.finishInit(this); }\n    for (var i = 0; i < initHooks.length; ++i) { initHooks[i](this); }\n    endOperation(this);\n    // Suppress optimizelegibility in Webkit, since it breaks text\n    // measuring on line wrapping boundaries.\n    if (webkit && options.lineWrapping &&\n        getComputedStyle(display.lineDiv).textRendering == \"optimizelegibility\")\n      { display.lineDiv.style.textRendering = \"auto\"; }\n  }\n\n  // The default configuration options.\n  CodeMirror.defaults = defaults;\n  // Functions to run when options are changed.\n  CodeMirror.optionHandlers = optionHandlers;\n\n  // Attach the necessary event handlers when initializing the editor\n  function registerEventHandlers(cm) {\n    var d = cm.display;\n    on(d.scroller, \"mousedown\", operation(cm, onMouseDown));\n    // Older IE's will not fire a second mousedown for a double click\n    if (ie && ie_version < 11)\n      { on(d.scroller, \"dblclick\", operation(cm, function (e) {\n        if (signalDOMEvent(cm, e)) { return }\n        var pos = posFromMouse(cm, e);\n        if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) { return }\n        e_preventDefault(e);\n        var word = cm.findWordAt(pos);\n        extendSelection(cm.doc, word.anchor, word.head);\n      })); }\n    else\n      { on(d.scroller, \"dblclick\", function (e) { return signalDOMEvent(cm, e) || e_preventDefault(e); }); }\n    // Some browsers fire contextmenu *after* opening the menu, at\n    // which point we can't mess with it anymore. Context menu is\n    // handled in onMouseDown for these browsers.\n    on(d.scroller, \"contextmenu\", function (e) { return onContextMenu(cm, e); });\n    on(d.input.getField(), \"contextmenu\", function (e) {\n      if (!d.scroller.contains(e.target)) { onContextMenu(cm, e); }\n    });\n\n    // Used to suppress mouse event handling when a touch happens\n    var touchFinished, prevTouch = {end: 0};\n    function finishTouch() {\n      if (d.activeTouch) {\n        touchFinished = setTimeout(function () { return d.activeTouch = null; }, 1000);\n        prevTouch = d.activeTouch;\n        prevTouch.end = +new Date;\n      }\n    }\n    function isMouseLikeTouchEvent(e) {\n      if (e.touches.length != 1) { return false }\n      var touch = e.touches[0];\n      return touch.radiusX <= 1 && touch.radiusY <= 1\n    }\n    function farAway(touch, other) {\n      if (other.left == null) { return true }\n      var dx = other.left - touch.left, dy = other.top - touch.top;\n      return dx * dx + dy * dy > 20 * 20\n    }\n    on(d.scroller, \"touchstart\", function (e) {\n      if (!signalDOMEvent(cm, e) && !isMouseLikeTouchEvent(e) && !clickInGutter(cm, e)) {\n        d.input.ensurePolled();\n        clearTimeout(touchFinished);\n        var now = +new Date;\n        d.activeTouch = {start: now, moved: false,\n                         prev: now - prevTouch.end <= 300 ? prevTouch : null};\n        if (e.touches.length == 1) {\n          d.activeTouch.left = e.touches[0].pageX;\n          d.activeTouch.top = e.touches[0].pageY;\n        }\n      }\n    });\n    on(d.scroller, \"touchmove\", function () {\n      if (d.activeTouch) { d.activeTouch.moved = true; }\n    });\n    on(d.scroller, \"touchend\", function (e) {\n      var touch = d.activeTouch;\n      if (touch && !eventInWidget(d, e) && touch.left != null &&\n          !touch.moved && new Date - touch.start < 300) {\n        var pos = cm.coordsChar(d.activeTouch, \"page\"), range;\n        if (!touch.prev || farAway(touch, touch.prev)) // Single tap\n          { range = new Range(pos, pos); }\n        else if (!touch.prev.prev || farAway(touch, touch.prev.prev)) // Double tap\n          { range = cm.findWordAt(pos); }\n        else // Triple tap\n          { range = new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))); }\n        cm.setSelection(range.anchor, range.head);\n        cm.focus();\n        e_preventDefault(e);\n      }\n      finishTouch();\n    });\n    on(d.scroller, \"touchcancel\", finishTouch);\n\n    // Sync scrolling between fake scrollbars and real scrollable\n    // area, ensure viewport is updated when scrolling.\n    on(d.scroller, \"scroll\", function () {\n      if (d.scroller.clientHeight) {\n        updateScrollTop(cm, d.scroller.scrollTop);\n        setScrollLeft(cm, d.scroller.scrollLeft, true);\n        signal(cm, \"scroll\", cm);\n      }\n    });\n\n    // Listen to wheel events in order to try and update the viewport on time.\n    on(d.scroller, \"mousewheel\", function (e) { return onScrollWheel(cm, e); });\n    on(d.scroller, \"DOMMouseScroll\", function (e) { return onScrollWheel(cm, e); });\n\n    // Prevent wrapper from ever scrolling\n    on(d.wrapper, \"scroll\", function () { return d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; });\n\n    d.dragFunctions = {\n      enter: function (e) {if (!signalDOMEvent(cm, e)) { e_stop(e); }},\n      over: function (e) {if (!signalDOMEvent(cm, e)) { onDragOver(cm, e); e_stop(e); }},\n      start: function (e) { return onDragStart(cm, e); },\n      drop: operation(cm, onDrop),\n      leave: function (e) {if (!signalDOMEvent(cm, e)) { clearDragCursor(cm); }}\n    };\n\n    var inp = d.input.getField();\n    on(inp, \"keyup\", function (e) { return onKeyUp.call(cm, e); });\n    on(inp, \"keydown\", operation(cm, onKeyDown));\n    on(inp, \"keypress\", operation(cm, onKeyPress));\n    on(inp, \"focus\", function (e) { return onFocus(cm, e); });\n    on(inp, \"blur\", function (e) { return onBlur(cm, e); });\n  }\n\n  var initHooks = [];\n  CodeMirror.defineInitHook = function (f) { return initHooks.push(f); };\n\n  // Indent the given line. The how parameter can be \"smart\",\n  // \"add\"/null, \"subtract\", or \"prev\". When aggressive is false\n  // (typically set to true for forced single-line indents), empty\n  // lines are not indented, and places where the mode returns Pass\n  // are left alone.\n  function indentLine(cm, n, how, aggressive) {\n    var doc = cm.doc, state;\n    if (how == null) { how = \"add\"; }\n    if (how == \"smart\") {\n      // Fall back to \"prev\" when the mode doesn't have an indentation\n      // method.\n      if (!doc.mode.indent) { how = \"prev\"; }\n      else { state = getContextBefore(cm, n).state; }\n    }\n\n    var tabSize = cm.options.tabSize;\n    var line = getLine(doc, n), curSpace = countColumn(line.text, null, tabSize);\n    if (line.stateAfter) { line.stateAfter = null; }\n    var curSpaceString = line.text.match(/^\\s*/)[0], indentation;\n    if (!aggressive && !/\\S/.test(line.text)) {\n      indentation = 0;\n      how = \"not\";\n    } else if (how == \"smart\") {\n      indentation = doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);\n      if (indentation == Pass || indentation > 150) {\n        if (!aggressive) { return }\n        how = \"prev\";\n      }\n    }\n    if (how == \"prev\") {\n      if (n > doc.first) { indentation = countColumn(getLine(doc, n-1).text, null, tabSize); }\n      else { indentation = 0; }\n    } else if (how == \"add\") {\n      indentation = curSpace + cm.options.indentUnit;\n    } else if (how == \"subtract\") {\n      indentation = curSpace - cm.options.indentUnit;\n    } else if (typeof how == \"number\") {\n      indentation = curSpace + how;\n    }\n    indentation = Math.max(0, indentation);\n\n    var indentString = \"\", pos = 0;\n    if (cm.options.indentWithTabs)\n      { for (var i = Math.floor(indentation / tabSize); i; --i) {pos += tabSize; indentString += \"\\t\";} }\n    if (pos < indentation) { indentString += spaceStr(indentation - pos); }\n\n    if (indentString != curSpaceString) {\n      replaceRange(doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), \"+input\");\n      line.stateAfter = null;\n      return true\n    } else {\n      // Ensure that, if the cursor was in the whitespace at the start\n      // of the line, it is moved to the end of that space.\n      for (var i$1 = 0; i$1 < doc.sel.ranges.length; i$1++) {\n        var range = doc.sel.ranges[i$1];\n        if (range.head.line == n && range.head.ch < curSpaceString.length) {\n          var pos$1 = Pos(n, curSpaceString.length);\n          replaceOneSelection(doc, i$1, new Range(pos$1, pos$1));\n          break\n        }\n      }\n    }\n  }\n\n  // This will be set to a {lineWise: bool, text: [string]} object, so\n  // that, when pasting, we know what kind of selections the copied\n  // text was made out of.\n  var lastCopied = null;\n\n  function setLastCopied(newLastCopied) {\n    lastCopied = newLastCopied;\n  }\n\n  function applyTextInput(cm, inserted, deleted, sel, origin) {\n    var doc = cm.doc;\n    cm.display.shift = false;\n    if (!sel) { sel = doc.sel; }\n\n    var recent = +new Date - 200;\n    var paste = origin == \"paste\" || cm.state.pasteIncoming > recent;\n    var textLines = splitLinesAuto(inserted), multiPaste = null;\n    // When pasting N lines into N selections, insert one line per selection\n    if (paste && sel.ranges.length > 1) {\n      if (lastCopied && lastCopied.text.join(\"\\n\") == inserted) {\n        if (sel.ranges.length % lastCopied.text.length == 0) {\n          multiPaste = [];\n          for (var i = 0; i < lastCopied.text.length; i++)\n            { multiPaste.push(doc.splitLines(lastCopied.text[i])); }\n        }\n      } else if (textLines.length == sel.ranges.length && cm.options.pasteLinesPerSelection) {\n        multiPaste = map(textLines, function (l) { return [l]; });\n      }\n    }\n\n    var updateInput = cm.curOp.updateInput;\n    // Normal behavior is to insert the new text into every selection\n    for (var i$1 = sel.ranges.length - 1; i$1 >= 0; i$1--) {\n      var range = sel.ranges[i$1];\n      var from = range.from(), to = range.to();\n      if (range.empty()) {\n        if (deleted && deleted > 0) // Handle deletion\n          { from = Pos(from.line, from.ch - deleted); }\n        else if (cm.state.overwrite && !paste) // Handle overwrite\n          { to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + lst(textLines).length)); }\n        else if (paste && lastCopied && lastCopied.lineWise && lastCopied.text.join(\"\\n\") == inserted)\n          { from = to = Pos(from.line, 0); }\n      }\n      var changeEvent = {from: from, to: to, text: multiPaste ? multiPaste[i$1 % multiPaste.length] : textLines,\n                         origin: origin || (paste ? \"paste\" : cm.state.cutIncoming > recent ? \"cut\" : \"+input\")};\n      makeChange(cm.doc, changeEvent);\n      signalLater(cm, \"inputRead\", cm, changeEvent);\n    }\n    if (inserted && !paste)\n      { triggerElectric(cm, inserted); }\n\n    ensureCursorVisible(cm);\n    if (cm.curOp.updateInput < 2) { cm.curOp.updateInput = updateInput; }\n    cm.curOp.typing = true;\n    cm.state.pasteIncoming = cm.state.cutIncoming = -1;\n  }\n\n  function handlePaste(e, cm) {\n    var pasted = e.clipboardData && e.clipboardData.getData(\"Text\");\n    if (pasted) {\n      e.preventDefault();\n      if (!cm.isReadOnly() && !cm.options.disableInput)\n        { runInOp(cm, function () { return applyTextInput(cm, pasted, 0, null, \"paste\"); }); }\n      return true\n    }\n  }\n\n  function triggerElectric(cm, inserted) {\n    // When an 'electric' character is inserted, immediately trigger a reindent\n    if (!cm.options.electricChars || !cm.options.smartIndent) { return }\n    var sel = cm.doc.sel;\n\n    for (var i = sel.ranges.length - 1; i >= 0; i--) {\n      var range = sel.ranges[i];\n      if (range.head.ch > 100 || (i && sel.ranges[i - 1].head.line == range.head.line)) { continue }\n      var mode = cm.getModeAt(range.head);\n      var indented = false;\n      if (mode.electricChars) {\n        for (var j = 0; j < mode.electricChars.length; j++)\n          { if (inserted.indexOf(mode.electricChars.charAt(j)) > -1) {\n            indented = indentLine(cm, range.head.line, \"smart\");\n            break\n          } }\n      } else if (mode.electricInput) {\n        if (mode.electricInput.test(getLine(cm.doc, range.head.line).text.slice(0, range.head.ch)))\n          { indented = indentLine(cm, range.head.line, \"smart\"); }\n      }\n      if (indented) { signalLater(cm, \"electricInput\", cm, range.head.line); }\n    }\n  }\n\n  function copyableRanges(cm) {\n    var text = [], ranges = [];\n    for (var i = 0; i < cm.doc.sel.ranges.length; i++) {\n      var line = cm.doc.sel.ranges[i].head.line;\n      var lineRange = {anchor: Pos(line, 0), head: Pos(line + 1, 0)};\n      ranges.push(lineRange);\n      text.push(cm.getRange(lineRange.anchor, lineRange.head));\n    }\n    return {text: text, ranges: ranges}\n  }\n\n  function disableBrowserMagic(field, spellcheck, autocorrect, autocapitalize) {\n    field.setAttribute(\"autocorrect\", autocorrect ? \"\" : \"off\");\n    field.setAttribute(\"autocapitalize\", autocapitalize ? \"\" : \"off\");\n    field.setAttribute(\"spellcheck\", !!spellcheck);\n  }\n\n  function hiddenTextarea() {\n    var te = elt(\"textarea\", null, null, \"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none\");\n    var div = elt(\"div\", [te], null, \"overflow: hidden; position: relative; width: 3px; height: 0px;\");\n    // The textarea is kept positioned near the cursor to prevent the\n    // fact that it'll be scrolled into view on input from scrolling\n    // our fake cursor out of view. On webkit, when wrap=off, paste is\n    // very slow. So make the area wide instead.\n    if (webkit) { te.style.width = \"1000px\"; }\n    else { te.setAttribute(\"wrap\", \"off\"); }\n    // If border: 0; -- iOS fails to open keyboard (issue #1287)\n    if (ios) { te.style.border = \"1px solid black\"; }\n    disableBrowserMagic(te);\n    return div\n  }\n\n  // The publicly visible API. Note that methodOp(f) means\n  // 'wrap f in an operation, performed on its `this` parameter'.\n\n  // This is not the complete set of editor methods. Most of the\n  // methods defined on the Doc type are also injected into\n  // CodeMirror.prototype, for backwards compatibility and\n  // convenience.\n\n  function addEditorMethods(CodeMirror) {\n    var optionHandlers = CodeMirror.optionHandlers;\n\n    var helpers = CodeMirror.helpers = {};\n\n    CodeMirror.prototype = {\n      constructor: CodeMirror,\n      focus: function(){window.focus(); this.display.input.focus();},\n\n      setOption: function(option, value) {\n        var options = this.options, old = options[option];\n        if (options[option] == value && option != \"mode\") { return }\n        options[option] = value;\n        if (optionHandlers.hasOwnProperty(option))\n          { operation(this, optionHandlers[option])(this, value, old); }\n        signal(this, \"optionChange\", this, option);\n      },\n\n      getOption: function(option) {return this.options[option]},\n      getDoc: function() {return this.doc},\n\n      addKeyMap: function(map, bottom) {\n        this.state.keyMaps[bottom ? \"push\" : \"unshift\"](getKeyMap(map));\n      },\n      removeKeyMap: function(map) {\n        var maps = this.state.keyMaps;\n        for (var i = 0; i < maps.length; ++i)\n          { if (maps[i] == map || maps[i].name == map) {\n            maps.splice(i, 1);\n            return true\n          } }\n      },\n\n      addOverlay: methodOp(function(spec, options) {\n        var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\n        if (mode.startState) { throw new Error(\"Overlays may not be stateful.\") }\n        insertSorted(this.state.overlays,\n                     {mode: mode, modeSpec: spec, opaque: options && options.opaque,\n                      priority: (options && options.priority) || 0},\n                     function (overlay) { return overlay.priority; });\n        this.state.modeGen++;\n        regChange(this);\n      }),\n      removeOverlay: methodOp(function(spec) {\n        var overlays = this.state.overlays;\n        for (var i = 0; i < overlays.length; ++i) {\n          var cur = overlays[i].modeSpec;\n          if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\n            overlays.splice(i, 1);\n            this.state.modeGen++;\n            regChange(this);\n            return\n          }\n        }\n      }),\n\n      indentLine: methodOp(function(n, dir, aggressive) {\n        if (typeof dir != \"string\" && typeof dir != \"number\") {\n          if (dir == null) { dir = this.options.smartIndent ? \"smart\" : \"prev\"; }\n          else { dir = dir ? \"add\" : \"subtract\"; }\n        }\n        if (isLine(this.doc, n)) { indentLine(this, n, dir, aggressive); }\n      }),\n      indentSelection: methodOp(function(how) {\n        var ranges = this.doc.sel.ranges, end = -1;\n        for (var i = 0; i < ranges.length; i++) {\n          var range = ranges[i];\n          if (!range.empty()) {\n            var from = range.from(), to = range.to();\n            var start = Math.max(end, from.line);\n            end = Math.min(this.lastLine(), to.line - (to.ch ? 0 : 1)) + 1;\n            for (var j = start; j < end; ++j)\n              { indentLine(this, j, how); }\n            var newRanges = this.doc.sel.ranges;\n            if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0)\n              { replaceOneSelection(this.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll); }\n          } else if (range.head.line > end) {\n            indentLine(this, range.head.line, how, true);\n            end = range.head.line;\n            if (i == this.doc.sel.primIndex) { ensureCursorVisible(this); }\n          }\n        }\n      }),\n\n      // Fetch the parser token for a given character. Useful for hacks\n      // that want to inspect the mode state (say, for completion).\n      getTokenAt: function(pos, precise) {\n        return takeToken(this, pos, precise)\n      },\n\n      getLineTokens: function(line, precise) {\n        return takeToken(this, Pos(line), precise, true)\n      },\n\n      getTokenTypeAt: function(pos) {\n        pos = clipPos(this.doc, pos);\n        var styles = getLineStyles(this, getLine(this.doc, pos.line));\n        var before = 0, after = (styles.length - 1) / 2, ch = pos.ch;\n        var type;\n        if (ch == 0) { type = styles[2]; }\n        else { for (;;) {\n          var mid = (before + after) >> 1;\n          if ((mid ? styles[mid * 2 - 1] : 0) >= ch) { after = mid; }\n          else if (styles[mid * 2 + 1] < ch) { before = mid + 1; }\n          else { type = styles[mid * 2 + 2]; break }\n        } }\n        var cut = type ? type.indexOf(\"overlay \") : -1;\n        return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1)\n      },\n\n      getModeAt: function(pos) {\n        var mode = this.doc.mode;\n        if (!mode.innerMode) { return mode }\n        return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode\n      },\n\n      getHelper: function(pos, type) {\n        return this.getHelpers(pos, type)[0]\n      },\n\n      getHelpers: function(pos, type) {\n        var found = [];\n        if (!helpers.hasOwnProperty(type)) { return found }\n        var help = helpers[type], mode = this.getModeAt(pos);\n        if (typeof mode[type] == \"string\") {\n          if (help[mode[type]]) { found.push(help[mode[type]]); }\n        } else if (mode[type]) {\n          for (var i = 0; i < mode[type].length; i++) {\n            var val = help[mode[type][i]];\n            if (val) { found.push(val); }\n          }\n        } else if (mode.helperType && help[mode.helperType]) {\n          found.push(help[mode.helperType]);\n        } else if (help[mode.name]) {\n          found.push(help[mode.name]);\n        }\n        for (var i$1 = 0; i$1 < help._global.length; i$1++) {\n          var cur = help._global[i$1];\n          if (cur.pred(mode, this) && indexOf(found, cur.val) == -1)\n            { found.push(cur.val); }\n        }\n        return found\n      },\n\n      getStateAfter: function(line, precise) {\n        var doc = this.doc;\n        line = clipLine(doc, line == null ? doc.first + doc.size - 1: line);\n        return getContextBefore(this, line + 1, precise).state\n      },\n\n      cursorCoords: function(start, mode) {\n        var pos, range = this.doc.sel.primary();\n        if (start == null) { pos = range.head; }\n        else if (typeof start == \"object\") { pos = clipPos(this.doc, start); }\n        else { pos = start ? range.from() : range.to(); }\n        return cursorCoords(this, pos, mode || \"page\")\n      },\n\n      charCoords: function(pos, mode) {\n        return charCoords(this, clipPos(this.doc, pos), mode || \"page\")\n      },\n\n      coordsChar: function(coords, mode) {\n        coords = fromCoordSystem(this, coords, mode || \"page\");\n        return coordsChar(this, coords.left, coords.top)\n      },\n\n      lineAtHeight: function(height, mode) {\n        height = fromCoordSystem(this, {top: height, left: 0}, mode || \"page\").top;\n        return lineAtHeight(this.doc, height + this.display.viewOffset)\n      },\n      heightAtLine: function(line, mode, includeWidgets) {\n        var end = false, lineObj;\n        if (typeof line == \"number\") {\n          var last = this.doc.first + this.doc.size - 1;\n          if (line < this.doc.first) { line = this.doc.first; }\n          else if (line > last) { line = last; end = true; }\n          lineObj = getLine(this.doc, line);\n        } else {\n          lineObj = line;\n        }\n        return intoCoordSystem(this, lineObj, {top: 0, left: 0}, mode || \"page\", includeWidgets || end).top +\n          (end ? this.doc.height - heightAtLine(lineObj) : 0)\n      },\n\n      defaultTextHeight: function() { return textHeight(this.display) },\n      defaultCharWidth: function() { return charWidth(this.display) },\n\n      getViewport: function() { return {from: this.display.viewFrom, to: this.display.viewTo}},\n\n      addWidget: function(pos, node, scroll, vert, horiz) {\n        var display = this.display;\n        pos = cursorCoords(this, clipPos(this.doc, pos));\n        var top = pos.bottom, left = pos.left;\n        node.style.position = \"absolute\";\n        node.setAttribute(\"cm-ignore-events\", \"true\");\n        this.display.input.setUneditable(node);\n        display.sizer.appendChild(node);\n        if (vert == \"over\") {\n          top = pos.top;\n        } else if (vert == \"above\" || vert == \"near\") {\n          var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\n          hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth);\n          // Default to positioning above (if specified and possible); otherwise default to positioning below\n          if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)\n            { top = pos.top - node.offsetHeight; }\n          else if (pos.bottom + node.offsetHeight <= vspace)\n            { top = pos.bottom; }\n          if (left + node.offsetWidth > hspace)\n            { left = hspace - node.offsetWidth; }\n        }\n        node.style.top = top + \"px\";\n        node.style.left = node.style.right = \"\";\n        if (horiz == \"right\") {\n          left = display.sizer.clientWidth - node.offsetWidth;\n          node.style.right = \"0px\";\n        } else {\n          if (horiz == \"left\") { left = 0; }\n          else if (horiz == \"middle\") { left = (display.sizer.clientWidth - node.offsetWidth) / 2; }\n          node.style.left = left + \"px\";\n        }\n        if (scroll)\n          { scrollIntoView(this, {left: left, top: top, right: left + node.offsetWidth, bottom: top + node.offsetHeight}); }\n      },\n\n      triggerOnKeyDown: methodOp(onKeyDown),\n      triggerOnKeyPress: methodOp(onKeyPress),\n      triggerOnKeyUp: onKeyUp,\n      triggerOnMouseDown: methodOp(onMouseDown),\n\n      execCommand: function(cmd) {\n        if (commands.hasOwnProperty(cmd))\n          { return commands[cmd].call(null, this) }\n      },\n\n      triggerElectric: methodOp(function(text) { triggerElectric(this, text); }),\n\n      findPosH: function(from, amount, unit, visually) {\n        var dir = 1;\n        if (amount < 0) { dir = -1; amount = -amount; }\n        var cur = clipPos(this.doc, from);\n        for (var i = 0; i < amount; ++i) {\n          cur = findPosH(this.doc, cur, dir, unit, visually);\n          if (cur.hitSide) { break }\n        }\n        return cur\n      },\n\n      moveH: methodOp(function(dir, unit) {\n        var this$1 = this;\n\n        this.extendSelectionsBy(function (range) {\n          if (this$1.display.shift || this$1.doc.extend || range.empty())\n            { return findPosH(this$1.doc, range.head, dir, unit, this$1.options.rtlMoveVisually) }\n          else\n            { return dir < 0 ? range.from() : range.to() }\n        }, sel_move);\n      }),\n\n      deleteH: methodOp(function(dir, unit) {\n        var sel = this.doc.sel, doc = this.doc;\n        if (sel.somethingSelected())\n          { doc.replaceSelection(\"\", null, \"+delete\"); }\n        else\n          { deleteNearSelection(this, function (range) {\n            var other = findPosH(doc, range.head, dir, unit, false);\n            return dir < 0 ? {from: other, to: range.head} : {from: range.head, to: other}\n          }); }\n      }),\n\n      findPosV: function(from, amount, unit, goalColumn) {\n        var dir = 1, x = goalColumn;\n        if (amount < 0) { dir = -1; amount = -amount; }\n        var cur = clipPos(this.doc, from);\n        for (var i = 0; i < amount; ++i) {\n          var coords = cursorCoords(this, cur, \"div\");\n          if (x == null) { x = coords.left; }\n          else { coords.left = x; }\n          cur = findPosV(this, coords, dir, unit);\n          if (cur.hitSide) { break }\n        }\n        return cur\n      },\n\n      moveV: methodOp(function(dir, unit) {\n        var this$1 = this;\n\n        var doc = this.doc, goals = [];\n        var collapse = !this.display.shift && !doc.extend && doc.sel.somethingSelected();\n        doc.extendSelectionsBy(function (range) {\n          if (collapse)\n            { return dir < 0 ? range.from() : range.to() }\n          var headPos = cursorCoords(this$1, range.head, \"div\");\n          if (range.goalColumn != null) { headPos.left = range.goalColumn; }\n          goals.push(headPos.left);\n          var pos = findPosV(this$1, headPos, dir, unit);\n          if (unit == \"page\" && range == doc.sel.primary())\n            { addToScrollTop(this$1, charCoords(this$1, pos, \"div\").top - headPos.top); }\n          return pos\n        }, sel_move);\n        if (goals.length) { for (var i = 0; i < doc.sel.ranges.length; i++)\n          { doc.sel.ranges[i].goalColumn = goals[i]; } }\n      }),\n\n      // Find the word at the given position (as returned by coordsChar).\n      findWordAt: function(pos) {\n        var doc = this.doc, line = getLine(doc, pos.line).text;\n        var start = pos.ch, end = pos.ch;\n        if (line) {\n          var helper = this.getHelper(pos, \"wordChars\");\n          if ((pos.sticky == \"before\" || end == line.length) && start) { --start; } else { ++end; }\n          var startChar = line.charAt(start);\n          var check = isWordChar(startChar, helper)\n            ? function (ch) { return isWordChar(ch, helper); }\n            : /\\s/.test(startChar) ? function (ch) { return /\\s/.test(ch); }\n            : function (ch) { return (!/\\s/.test(ch) && !isWordChar(ch)); };\n          while (start > 0 && check(line.charAt(start - 1))) { --start; }\n          while (end < line.length && check(line.charAt(end))) { ++end; }\n        }\n        return new Range(Pos(pos.line, start), Pos(pos.line, end))\n      },\n\n      toggleOverwrite: function(value) {\n        if (value != null && value == this.state.overwrite) { return }\n        if (this.state.overwrite = !this.state.overwrite)\n          { addClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n        else\n          { rmClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n\n        signal(this, \"overwriteToggle\", this, this.state.overwrite);\n      },\n      hasFocus: function() { return this.display.input.getField() == activeElt() },\n      isReadOnly: function() { return !!(this.options.readOnly || this.doc.cantEdit) },\n\n      scrollTo: methodOp(function (x, y) { scrollToCoords(this, x, y); }),\n      getScrollInfo: function() {\n        var scroller = this.display.scroller;\n        return {left: scroller.scrollLeft, top: scroller.scrollTop,\n                height: scroller.scrollHeight - scrollGap(this) - this.display.barHeight,\n                width: scroller.scrollWidth - scrollGap(this) - this.display.barWidth,\n                clientHeight: displayHeight(this), clientWidth: displayWidth(this)}\n      },\n\n      scrollIntoView: methodOp(function(range, margin) {\n        if (range == null) {\n          range = {from: this.doc.sel.primary().head, to: null};\n          if (margin == null) { margin = this.options.cursorScrollMargin; }\n        } else if (typeof range == \"number\") {\n          range = {from: Pos(range, 0), to: null};\n        } else if (range.from == null) {\n          range = {from: range, to: null};\n        }\n        if (!range.to) { range.to = range.from; }\n        range.margin = margin || 0;\n\n        if (range.from.line != null) {\n          scrollToRange(this, range);\n        } else {\n          scrollToCoordsRange(this, range.from, range.to, range.margin);\n        }\n      }),\n\n      setSize: methodOp(function(width, height) {\n        var this$1 = this;\n\n        var interpret = function (val) { return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val; };\n        if (width != null) { this.display.wrapper.style.width = interpret(width); }\n        if (height != null) { this.display.wrapper.style.height = interpret(height); }\n        if (this.options.lineWrapping) { clearLineMeasurementCache(this); }\n        var lineNo = this.display.viewFrom;\n        this.doc.iter(lineNo, this.display.viewTo, function (line) {\n          if (line.widgets) { for (var i = 0; i < line.widgets.length; i++)\n            { if (line.widgets[i].noHScroll) { regLineChange(this$1, lineNo, \"widget\"); break } } }\n          ++lineNo;\n        });\n        this.curOp.forceUpdate = true;\n        signal(this, \"refresh\", this);\n      }),\n\n      operation: function(f){return runInOp(this, f)},\n      startOperation: function(){return startOperation(this)},\n      endOperation: function(){return endOperation(this)},\n\n      refresh: methodOp(function() {\n        var oldHeight = this.display.cachedTextHeight;\n        regChange(this);\n        this.curOp.forceUpdate = true;\n        clearCaches(this);\n        scrollToCoords(this, this.doc.scrollLeft, this.doc.scrollTop);\n        updateGutterSpace(this.display);\n        if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5)\n          { estimateLineHeights(this); }\n        signal(this, \"refresh\", this);\n      }),\n\n      swapDoc: methodOp(function(doc) {\n        var old = this.doc;\n        old.cm = null;\n        // Cancel the current text selection if any (#5821)\n        if (this.state.selectingText) { this.state.selectingText(); }\n        attachDoc(this, doc);\n        clearCaches(this);\n        this.display.input.reset();\n        scrollToCoords(this, doc.scrollLeft, doc.scrollTop);\n        this.curOp.forceScroll = true;\n        signalLater(this, \"swapDoc\", this, old);\n        return old\n      }),\n\n      phrase: function(phraseText) {\n        var phrases = this.options.phrases;\n        return phrases && Object.prototype.hasOwnProperty.call(phrases, phraseText) ? phrases[phraseText] : phraseText\n      },\n\n      getInputField: function(){return this.display.input.getField()},\n      getWrapperElement: function(){return this.display.wrapper},\n      getScrollerElement: function(){return this.display.scroller},\n      getGutterElement: function(){return this.display.gutters}\n    };\n    eventMixin(CodeMirror);\n\n    CodeMirror.registerHelper = function(type, name, value) {\n      if (!helpers.hasOwnProperty(type)) { helpers[type] = CodeMirror[type] = {_global: []}; }\n      helpers[type][name] = value;\n    };\n    CodeMirror.registerGlobalHelper = function(type, name, predicate, value) {\n      CodeMirror.registerHelper(type, name, value);\n      helpers[type]._global.push({pred: predicate, val: value});\n    };\n  }\n\n  // Used for horizontal relative motion. Dir is -1 or 1 (left or\n  // right), unit can be \"char\", \"column\" (like char, but doesn't\n  // cross line boundaries), \"word\" (across next word), or \"group\" (to\n  // the start of next group of word or non-word-non-whitespace\n  // chars). The visually param controls whether, in right-to-left\n  // text, direction 1 means to move towards the next index in the\n  // string, or towards the character to the right of the current\n  // position. The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosH(doc, pos, dir, unit, visually) {\n    var oldPos = pos;\n    var origDir = dir;\n    var lineObj = getLine(doc, pos.line);\n    var lineDir = visually && doc.direction == \"rtl\" ? -dir : dir;\n    function findNextLine() {\n      var l = pos.line + lineDir;\n      if (l < doc.first || l >= doc.first + doc.size) { return false }\n      pos = new Pos(l, pos.ch, pos.sticky);\n      return lineObj = getLine(doc, l)\n    }\n    function moveOnce(boundToLine) {\n      var next;\n      if (visually) {\n        next = moveVisually(doc.cm, lineObj, pos, dir);\n      } else {\n        next = moveLogically(lineObj, pos, dir);\n      }\n      if (next == null) {\n        if (!boundToLine && findNextLine())\n          { pos = endOfLine(visually, doc.cm, lineObj, pos.line, lineDir); }\n        else\n          { return false }\n      } else {\n        pos = next;\n      }\n      return true\n    }\n\n    if (unit == \"char\") {\n      moveOnce();\n    } else if (unit == \"column\") {\n      moveOnce(true);\n    } else if (unit == \"word\" || unit == \"group\") {\n      var sawType = null, group = unit == \"group\";\n      var helper = doc.cm && doc.cm.getHelper(pos, \"wordChars\");\n      for (var first = true;; first = false) {\n        if (dir < 0 && !moveOnce(!first)) { break }\n        var cur = lineObj.text.charAt(pos.ch) || \"\\n\";\n        var type = isWordChar(cur, helper) ? \"w\"\n          : group && cur == \"\\n\" ? \"n\"\n          : !group || /\\s/.test(cur) ? null\n          : \"p\";\n        if (group && !first && !type) { type = \"s\"; }\n        if (sawType && sawType != type) {\n          if (dir < 0) {dir = 1; moveOnce(); pos.sticky = \"after\";}\n          break\n        }\n\n        if (type) { sawType = type; }\n        if (dir > 0 && !moveOnce(!first)) { break }\n      }\n    }\n    var result = skipAtomic(doc, pos, oldPos, origDir, true);\n    if (equalCursorPos(oldPos, result)) { result.hitSide = true; }\n    return result\n  }\n\n  // For relative vertical movement. Dir may be -1 or 1. Unit can be\n  // \"page\" or \"line\". The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosV(cm, pos, dir, unit) {\n    var doc = cm.doc, x = pos.left, y;\n    if (unit == \"page\") {\n      var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);\n      var moveAmount = Math.max(pageSize - .5 * textHeight(cm.display), 3);\n      y = (dir > 0 ? pos.bottom : pos.top) + dir * moveAmount;\n\n    } else if (unit == \"line\") {\n      y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\n    }\n    var target;\n    for (;;) {\n      target = coordsChar(cm, x, y);\n      if (!target.outside) { break }\n      if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break }\n      y += dir * 5;\n    }\n    return target\n  }\n\n  // CONTENTEDITABLE INPUT STYLE\n\n  var ContentEditableInput = function(cm) {\n    this.cm = cm;\n    this.lastAnchorNode = this.lastAnchorOffset = this.lastFocusNode = this.lastFocusOffset = null;\n    this.polling = new Delayed();\n    this.composing = null;\n    this.gracePeriod = false;\n    this.readDOMTimeout = null;\n  };\n\n  ContentEditableInput.prototype.init = function (display) {\n      var this$1 = this;\n\n    var input = this, cm = input.cm;\n    var div = input.div = display.lineDiv;\n    disableBrowserMagic(div, cm.options.spellcheck, cm.options.autocorrect, cm.options.autocapitalize);\n\n    on(div, \"paste\", function (e) {\n      if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n      // IE doesn't fire input events, so we schedule a read for the pasted content in this way\n      if (ie_version <= 11) { setTimeout(operation(cm, function () { return this$1.updateFromDOM(); }), 20); }\n    });\n\n    on(div, \"compositionstart\", function (e) {\n      this$1.composing = {data: e.data, done: false};\n    });\n    on(div, \"compositionupdate\", function (e) {\n      if (!this$1.composing) { this$1.composing = {data: e.data, done: false}; }\n    });\n    on(div, \"compositionend\", function (e) {\n      if (this$1.composing) {\n        if (e.data != this$1.composing.data) { this$1.readFromDOMSoon(); }\n        this$1.composing.done = true;\n      }\n    });\n\n    on(div, \"touchstart\", function () { return input.forceCompositionEnd(); });\n\n    on(div, \"input\", function () {\n      if (!this$1.composing) { this$1.readFromDOMSoon(); }\n    });\n\n    function onCopyCut(e) {\n      if (signalDOMEvent(cm, e)) { return }\n      if (cm.somethingSelected()) {\n        setLastCopied({lineWise: false, text: cm.getSelections()});\n        if (e.type == \"cut\") { cm.replaceSelection(\"\", null, \"cut\"); }\n      } else if (!cm.options.lineWiseCopyCut) {\n        return\n      } else {\n        var ranges = copyableRanges(cm);\n        setLastCopied({lineWise: true, text: ranges.text});\n        if (e.type == \"cut\") {\n          cm.operation(function () {\n            cm.setSelections(ranges.ranges, 0, sel_dontScroll);\n            cm.replaceSelection(\"\", null, \"cut\");\n          });\n        }\n      }\n      if (e.clipboardData) {\n        e.clipboardData.clearData();\n        var content = lastCopied.text.join(\"\\n\");\n        // iOS exposes the clipboard API, but seems to discard content inserted into it\n        e.clipboardData.setData(\"Text\", content);\n        if (e.clipboardData.getData(\"Text\") == content) {\n          e.preventDefault();\n          return\n        }\n      }\n      // Old-fashioned briefly-focus-a-textarea hack\n      var kludge = hiddenTextarea(), te = kludge.firstChild;\n      cm.display.lineSpace.insertBefore(kludge, cm.display.lineSpace.firstChild);\n      te.value = lastCopied.text.join(\"\\n\");\n      var hadFocus = document.activeElement;\n      selectInput(te);\n      setTimeout(function () {\n        cm.display.lineSpace.removeChild(kludge);\n        hadFocus.focus();\n        if (hadFocus == div) { input.showPrimarySelection(); }\n      }, 50);\n    }\n    on(div, \"copy\", onCopyCut);\n    on(div, \"cut\", onCopyCut);\n  };\n\n  ContentEditableInput.prototype.prepareSelection = function () {\n    var result = prepareSelection(this.cm, false);\n    result.focus = document.activeElement == this.div;\n    return result\n  };\n\n  ContentEditableInput.prototype.showSelection = function (info, takeFocus) {\n    if (!info || !this.cm.display.view.length) { return }\n    if (info.focus || takeFocus) { this.showPrimarySelection(); }\n    this.showMultipleSelections(info);\n  };\n\n  ContentEditableInput.prototype.getSelection = function () {\n    return this.cm.display.wrapper.ownerDocument.getSelection()\n  };\n\n  ContentEditableInput.prototype.showPrimarySelection = function () {\n    var sel = this.getSelection(), cm = this.cm, prim = cm.doc.sel.primary();\n    var from = prim.from(), to = prim.to();\n\n    if (cm.display.viewTo == cm.display.viewFrom || from.line >= cm.display.viewTo || to.line < cm.display.viewFrom) {\n      sel.removeAllRanges();\n      return\n    }\n\n    var curAnchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n    var curFocus = domToPos(cm, sel.focusNode, sel.focusOffset);\n    if (curAnchor && !curAnchor.bad && curFocus && !curFocus.bad &&\n        cmp(minPos(curAnchor, curFocus), from) == 0 &&\n        cmp(maxPos(curAnchor, curFocus), to) == 0)\n      { return }\n\n    var view = cm.display.view;\n    var start = (from.line >= cm.display.viewFrom && posToDOM(cm, from)) ||\n        {node: view[0].measure.map[2], offset: 0};\n    var end = to.line < cm.display.viewTo && posToDOM(cm, to);\n    if (!end) {\n      var measure = view[view.length - 1].measure;\n      var map = measure.maps ? measure.maps[measure.maps.length - 1] : measure.map;\n      end = {node: map[map.length - 1], offset: map[map.length - 2] - map[map.length - 3]};\n    }\n\n    if (!start || !end) {\n      sel.removeAllRanges();\n      return\n    }\n\n    var old = sel.rangeCount && sel.getRangeAt(0), rng;\n    try { rng = range(start.node, start.offset, end.offset, end.node); }\n    catch(e) {} // Our model of the DOM might be outdated, in which case the range we try to set can be impossible\n    if (rng) {\n      if (!gecko && cm.state.focused) {\n        sel.collapse(start.node, start.offset);\n        if (!rng.collapsed) {\n          sel.removeAllRanges();\n          sel.addRange(rng);\n        }\n      } else {\n        sel.removeAllRanges();\n        sel.addRange(rng);\n      }\n      if (old && sel.anchorNode == null) { sel.addRange(old); }\n      else if (gecko) { this.startGracePeriod(); }\n    }\n    this.rememberSelection();\n  };\n\n  ContentEditableInput.prototype.startGracePeriod = function () {\n      var this$1 = this;\n\n    clearTimeout(this.gracePeriod);\n    this.gracePeriod = setTimeout(function () {\n      this$1.gracePeriod = false;\n      if (this$1.selectionChanged())\n        { this$1.cm.operation(function () { return this$1.cm.curOp.selectionChanged = true; }); }\n    }, 20);\n  };\n\n  ContentEditableInput.prototype.showMultipleSelections = function (info) {\n    removeChildrenAndAdd(this.cm.display.cursorDiv, info.cursors);\n    removeChildrenAndAdd(this.cm.display.selectionDiv, info.selection);\n  };\n\n  ContentEditableInput.prototype.rememberSelection = function () {\n    var sel = this.getSelection();\n    this.lastAnchorNode = sel.anchorNode; this.lastAnchorOffset = sel.anchorOffset;\n    this.lastFocusNode = sel.focusNode; this.lastFocusOffset = sel.focusOffset;\n  };\n\n  ContentEditableInput.prototype.selectionInEditor = function () {\n    var sel = this.getSelection();\n    if (!sel.rangeCount) { return false }\n    var node = sel.getRangeAt(0).commonAncestorContainer;\n    return contains(this.div, node)\n  };\n\n  ContentEditableInput.prototype.focus = function () {\n    if (this.cm.options.readOnly != \"nocursor\") {\n      if (!this.selectionInEditor() || document.activeElement != this.div)\n        { this.showSelection(this.prepareSelection(), true); }\n      this.div.focus();\n    }\n  };\n  ContentEditableInput.prototype.blur = function () { this.div.blur(); };\n  ContentEditableInput.prototype.getField = function () { return this.div };\n\n  ContentEditableInput.prototype.supportsTouch = function () { return true };\n\n  ContentEditableInput.prototype.receivedFocus = function () {\n    var input = this;\n    if (this.selectionInEditor())\n      { this.pollSelection(); }\n    else\n      { runInOp(this.cm, function () { return input.cm.curOp.selectionChanged = true; }); }\n\n    function poll() {\n      if (input.cm.state.focused) {\n        input.pollSelection();\n        input.polling.set(input.cm.options.pollInterval, poll);\n      }\n    }\n    this.polling.set(this.cm.options.pollInterval, poll);\n  };\n\n  ContentEditableInput.prototype.selectionChanged = function () {\n    var sel = this.getSelection();\n    return sel.anchorNode != this.lastAnchorNode || sel.anchorOffset != this.lastAnchorOffset ||\n      sel.focusNode != this.lastFocusNode || sel.focusOffset != this.lastFocusOffset\n  };\n\n  ContentEditableInput.prototype.pollSelection = function () {\n    if (this.readDOMTimeout != null || this.gracePeriod || !this.selectionChanged()) { return }\n    var sel = this.getSelection(), cm = this.cm;\n    // On Android Chrome (version 56, at least), backspacing into an\n    // uneditable block element will put the cursor in that element,\n    // and then, because it's not editable, hide the virtual keyboard.\n    // Because Android doesn't allow us to actually detect backspace\n    // presses in a sane way, this code checks for when that happens\n    // and simulates a backspace press in this case.\n    if (android && chrome && this.cm.display.gutterSpecs.length && isInGutter(sel.anchorNode)) {\n      this.cm.triggerOnKeyDown({type: \"keydown\", keyCode: 8, preventDefault: Math.abs});\n      this.blur();\n      this.focus();\n      return\n    }\n    if (this.composing) { return }\n    this.rememberSelection();\n    var anchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n    var head = domToPos(cm, sel.focusNode, sel.focusOffset);\n    if (anchor && head) { runInOp(cm, function () {\n      setSelection(cm.doc, simpleSelection(anchor, head), sel_dontScroll);\n      if (anchor.bad || head.bad) { cm.curOp.selectionChanged = true; }\n    }); }\n  };\n\n  ContentEditableInput.prototype.pollContent = function () {\n    if (this.readDOMTimeout != null) {\n      clearTimeout(this.readDOMTimeout);\n      this.readDOMTimeout = null;\n    }\n\n    var cm = this.cm, display = cm.display, sel = cm.doc.sel.primary();\n    var from = sel.from(), to = sel.to();\n    if (from.ch == 0 && from.line > cm.firstLine())\n      { from = Pos(from.line - 1, getLine(cm.doc, from.line - 1).length); }\n    if (to.ch == getLine(cm.doc, to.line).text.length && to.line < cm.lastLine())\n      { to = Pos(to.line + 1, 0); }\n    if (from.line < display.viewFrom || to.line > display.viewTo - 1) { return false }\n\n    var fromIndex, fromLine, fromNode;\n    if (from.line == display.viewFrom || (fromIndex = findViewIndex(cm, from.line)) == 0) {\n      fromLine = lineNo(display.view[0].line);\n      fromNode = display.view[0].node;\n    } else {\n      fromLine = lineNo(display.view[fromIndex].line);\n      fromNode = display.view[fromIndex - 1].node.nextSibling;\n    }\n    var toIndex = findViewIndex(cm, to.line);\n    var toLine, toNode;\n    if (toIndex == display.view.length - 1) {\n      toLine = display.viewTo - 1;\n      toNode = display.lineDiv.lastChild;\n    } else {\n      toLine = lineNo(display.view[toIndex + 1].line) - 1;\n      toNode = display.view[toIndex + 1].node.previousSibling;\n    }\n\n    if (!fromNode) { return false }\n    var newText = cm.doc.splitLines(domTextBetween(cm, fromNode, toNode, fromLine, toLine));\n    var oldText = getBetween(cm.doc, Pos(fromLine, 0), Pos(toLine, getLine(cm.doc, toLine).text.length));\n    while (newText.length > 1 && oldText.length > 1) {\n      if (lst(newText) == lst(oldText)) { newText.pop(); oldText.pop(); toLine--; }\n      else if (newText[0] == oldText[0]) { newText.shift(); oldText.shift(); fromLine++; }\n      else { break }\n    }\n\n    var cutFront = 0, cutEnd = 0;\n    var newTop = newText[0], oldTop = oldText[0], maxCutFront = Math.min(newTop.length, oldTop.length);\n    while (cutFront < maxCutFront && newTop.charCodeAt(cutFront) == oldTop.charCodeAt(cutFront))\n      { ++cutFront; }\n    var newBot = lst(newText), oldBot = lst(oldText);\n    var maxCutEnd = Math.min(newBot.length - (newText.length == 1 ? cutFront : 0),\n                             oldBot.length - (oldText.length == 1 ? cutFront : 0));\n    while (cutEnd < maxCutEnd &&\n           newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1))\n      { ++cutEnd; }\n    // Try to move start of change to start of selection if ambiguous\n    if (newText.length == 1 && oldText.length == 1 && fromLine == from.line) {\n      while (cutFront && cutFront > from.ch &&\n             newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1)) {\n        cutFront--;\n        cutEnd++;\n      }\n    }\n\n    newText[newText.length - 1] = newBot.slice(0, newBot.length - cutEnd).replace(/^\\u200b+/, \"\");\n    newText[0] = newText[0].slice(cutFront).replace(/\\u200b+$/, \"\");\n\n    var chFrom = Pos(fromLine, cutFront);\n    var chTo = Pos(toLine, oldText.length ? lst(oldText).length - cutEnd : 0);\n    if (newText.length > 1 || newText[0] || cmp(chFrom, chTo)) {\n      replaceRange(cm.doc, newText, chFrom, chTo, \"+input\");\n      return true\n    }\n  };\n\n  ContentEditableInput.prototype.ensurePolled = function () {\n    this.forceCompositionEnd();\n  };\n  ContentEditableInput.prototype.reset = function () {\n    this.forceCompositionEnd();\n  };\n  ContentEditableInput.prototype.forceCompositionEnd = function () {\n    if (!this.composing) { return }\n    clearTimeout(this.readDOMTimeout);\n    this.composing = null;\n    this.updateFromDOM();\n    this.div.blur();\n    this.div.focus();\n  };\n  ContentEditableInput.prototype.readFromDOMSoon = function () {\n      var this$1 = this;\n\n    if (this.readDOMTimeout != null) { return }\n    this.readDOMTimeout = setTimeout(function () {\n      this$1.readDOMTimeout = null;\n      if (this$1.composing) {\n        if (this$1.composing.done) { this$1.composing = null; }\n        else { return }\n      }\n      this$1.updateFromDOM();\n    }, 80);\n  };\n\n  ContentEditableInput.prototype.updateFromDOM = function () {\n      var this$1 = this;\n\n    if (this.cm.isReadOnly() || !this.pollContent())\n      { runInOp(this.cm, function () { return regChange(this$1.cm); }); }\n  };\n\n  ContentEditableInput.prototype.setUneditable = function (node) {\n    node.contentEditable = \"false\";\n  };\n\n  ContentEditableInput.prototype.onKeyPress = function (e) {\n    if (e.charCode == 0 || this.composing) { return }\n    e.preventDefault();\n    if (!this.cm.isReadOnly())\n      { operation(this.cm, applyTextInput)(this.cm, String.fromCharCode(e.charCode == null ? e.keyCode : e.charCode), 0); }\n  };\n\n  ContentEditableInput.prototype.readOnlyChanged = function (val) {\n    this.div.contentEditable = String(val != \"nocursor\");\n  };\n\n  ContentEditableInput.prototype.onContextMenu = function () {};\n  ContentEditableInput.prototype.resetPosition = function () {};\n\n  ContentEditableInput.prototype.needsContentAttribute = true;\n\n  function posToDOM(cm, pos) {\n    var view = findViewForLine(cm, pos.line);\n    if (!view || view.hidden) { return null }\n    var line = getLine(cm.doc, pos.line);\n    var info = mapFromLineView(view, line, pos.line);\n\n    var order = getOrder(line, cm.doc.direction), side = \"left\";\n    if (order) {\n      var partPos = getBidiPartAt(order, pos.ch);\n      side = partPos % 2 ? \"right\" : \"left\";\n    }\n    var result = nodeAndOffsetInLineMap(info.map, pos.ch, side);\n    result.offset = result.collapse == \"right\" ? result.end : result.start;\n    return result\n  }\n\n  function isInGutter(node) {\n    for (var scan = node; scan; scan = scan.parentNode)\n      { if (/CodeMirror-gutter-wrapper/.test(scan.className)) { return true } }\n    return false\n  }\n\n  function badPos(pos, bad) { if (bad) { pos.bad = true; } return pos }\n\n  function domTextBetween(cm, from, to, fromLine, toLine) {\n    var text = \"\", closing = false, lineSep = cm.doc.lineSeparator(), extraLinebreak = false;\n    function recognizeMarker(id) { return function (marker) { return marker.id == id; } }\n    function close() {\n      if (closing) {\n        text += lineSep;\n        if (extraLinebreak) { text += lineSep; }\n        closing = extraLinebreak = false;\n      }\n    }\n    function addText(str) {\n      if (str) {\n        close();\n        text += str;\n      }\n    }\n    function walk(node) {\n      if (node.nodeType == 1) {\n        var cmText = node.getAttribute(\"cm-text\");\n        if (cmText) {\n          addText(cmText);\n          return\n        }\n        var markerID = node.getAttribute(\"cm-marker\"), range;\n        if (markerID) {\n          var found = cm.findMarks(Pos(fromLine, 0), Pos(toLine + 1, 0), recognizeMarker(+markerID));\n          if (found.length && (range = found[0].find(0)))\n            { addText(getBetween(cm.doc, range.from, range.to).join(lineSep)); }\n          return\n        }\n        if (node.getAttribute(\"contenteditable\") == \"false\") { return }\n        var isBlock = /^(pre|div|p|li|table|br)$/i.test(node.nodeName);\n        if (!/^br$/i.test(node.nodeName) && node.textContent.length == 0) { return }\n\n        if (isBlock) { close(); }\n        for (var i = 0; i < node.childNodes.length; i++)\n          { walk(node.childNodes[i]); }\n\n        if (/^(pre|p)$/i.test(node.nodeName)) { extraLinebreak = true; }\n        if (isBlock) { closing = true; }\n      } else if (node.nodeType == 3) {\n        addText(node.nodeValue.replace(/\\u200b/g, \"\").replace(/\\u00a0/g, \" \"));\n      }\n    }\n    for (;;) {\n      walk(from);\n      if (from == to) { break }\n      from = from.nextSibling;\n      extraLinebreak = false;\n    }\n    return text\n  }\n\n  function domToPos(cm, node, offset) {\n    var lineNode;\n    if (node == cm.display.lineDiv) {\n      lineNode = cm.display.lineDiv.childNodes[offset];\n      if (!lineNode) { return badPos(cm.clipPos(Pos(cm.display.viewTo - 1)), true) }\n      node = null; offset = 0;\n    } else {\n      for (lineNode = node;; lineNode = lineNode.parentNode) {\n        if (!lineNode || lineNode == cm.display.lineDiv) { return null }\n        if (lineNode.parentNode && lineNode.parentNode == cm.display.lineDiv) { break }\n      }\n    }\n    for (var i = 0; i < cm.display.view.length; i++) {\n      var lineView = cm.display.view[i];\n      if (lineView.node == lineNode)\n        { return locateNodeInLineView(lineView, node, offset) }\n    }\n  }\n\n  function locateNodeInLineView(lineView, node, offset) {\n    var wrapper = lineView.text.firstChild, bad = false;\n    if (!node || !contains(wrapper, node)) { return badPos(Pos(lineNo(lineView.line), 0), true) }\n    if (node == wrapper) {\n      bad = true;\n      node = wrapper.childNodes[offset];\n      offset = 0;\n      if (!node) {\n        var line = lineView.rest ? lst(lineView.rest) : lineView.line;\n        return badPos(Pos(lineNo(line), line.text.length), bad)\n      }\n    }\n\n    var textNode = node.nodeType == 3 ? node : null, topNode = node;\n    if (!textNode && node.childNodes.length == 1 && node.firstChild.nodeType == 3) {\n      textNode = node.firstChild;\n      if (offset) { offset = textNode.nodeValue.length; }\n    }\n    while (topNode.parentNode != wrapper) { topNode = topNode.parentNode; }\n    var measure = lineView.measure, maps = measure.maps;\n\n    function find(textNode, topNode, offset) {\n      for (var i = -1; i < (maps ? maps.length : 0); i++) {\n        var map = i < 0 ? measure.map : maps[i];\n        for (var j = 0; j < map.length; j += 3) {\n          var curNode = map[j + 2];\n          if (curNode == textNode || curNode == topNode) {\n            var line = lineNo(i < 0 ? lineView.line : lineView.rest[i]);\n            var ch = map[j] + offset;\n            if (offset < 0 || curNode != textNode) { ch = map[j + (offset ? 1 : 0)]; }\n            return Pos(line, ch)\n          }\n        }\n      }\n    }\n    var found = find(textNode, topNode, offset);\n    if (found) { return badPos(found, bad) }\n\n    // FIXME this is all really shaky. might handle the few cases it needs to handle, but likely to cause problems\n    for (var after = topNode.nextSibling, dist = textNode ? textNode.nodeValue.length - offset : 0; after; after = after.nextSibling) {\n      found = find(after, after.firstChild, 0);\n      if (found)\n        { return badPos(Pos(found.line, found.ch - dist), bad) }\n      else\n        { dist += after.textContent.length; }\n    }\n    for (var before = topNode.previousSibling, dist$1 = offset; before; before = before.previousSibling) {\n      found = find(before, before.firstChild, -1);\n      if (found)\n        { return badPos(Pos(found.line, found.ch + dist$1), bad) }\n      else\n        { dist$1 += before.textContent.length; }\n    }\n  }\n\n  // TEXTAREA INPUT STYLE\n\n  var TextareaInput = function(cm) {\n    this.cm = cm;\n    // See input.poll and input.reset\n    this.prevInput = \"\";\n\n    // Flag that indicates whether we expect input to appear real soon\n    // now (after some event like 'keypress' or 'input') and are\n    // polling intensively.\n    this.pollingFast = false;\n    // Self-resetting timeout for the poller\n    this.polling = new Delayed();\n    // Used to work around IE issue with selection being forgotten when focus moves away from textarea\n    this.hasSelection = false;\n    this.composing = null;\n  };\n\n  TextareaInput.prototype.init = function (display) {\n      var this$1 = this;\n\n    var input = this, cm = this.cm;\n    this.createField(display);\n    var te = this.textarea;\n\n    display.wrapper.insertBefore(this.wrapper, display.wrapper.firstChild);\n\n    // Needed to hide big blue blinking cursor on Mobile Safari (doesn't seem to work in iOS 8 anymore)\n    if (ios) { te.style.width = \"0px\"; }\n\n    on(te, \"input\", function () {\n      if (ie && ie_version >= 9 && this$1.hasSelection) { this$1.hasSelection = null; }\n      input.poll();\n    });\n\n    on(te, \"paste\", function (e) {\n      if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n\n      cm.state.pasteIncoming = +new Date;\n      input.fastPoll();\n    });\n\n    function prepareCopyCut(e) {\n      if (signalDOMEvent(cm, e)) { return }\n      if (cm.somethingSelected()) {\n        setLastCopied({lineWise: false, text: cm.getSelections()});\n      } else if (!cm.options.lineWiseCopyCut) {\n        return\n      } else {\n        var ranges = copyableRanges(cm);\n        setLastCopied({lineWise: true, text: ranges.text});\n        if (e.type == \"cut\") {\n          cm.setSelections(ranges.ranges, null, sel_dontScroll);\n        } else {\n          input.prevInput = \"\";\n          te.value = ranges.text.join(\"\\n\");\n          selectInput(te);\n        }\n      }\n      if (e.type == \"cut\") { cm.state.cutIncoming = +new Date; }\n    }\n    on(te, \"cut\", prepareCopyCut);\n    on(te, \"copy\", prepareCopyCut);\n\n    on(display.scroller, \"paste\", function (e) {\n      if (eventInWidget(display, e) || signalDOMEvent(cm, e)) { return }\n      if (!te.dispatchEvent) {\n        cm.state.pasteIncoming = +new Date;\n        input.focus();\n        return\n      }\n\n      // Pass the `paste` event to the textarea so it's handled by its event listener.\n      var event = new Event(\"paste\");\n      event.clipboardData = e.clipboardData;\n      te.dispatchEvent(event);\n    });\n\n    // Prevent normal selection in the editor (we handle our own)\n    on(display.lineSpace, \"selectstart\", function (e) {\n      if (!eventInWidget(display, e)) { e_preventDefault(e); }\n    });\n\n    on(te, \"compositionstart\", function () {\n      var start = cm.getCursor(\"from\");\n      if (input.composing) { input.composing.range.clear(); }\n      input.composing = {\n        start: start,\n        range: cm.markText(start, cm.getCursor(\"to\"), {className: \"CodeMirror-composing\"})\n      };\n    });\n    on(te, \"compositionend\", function () {\n      if (input.composing) {\n        input.poll();\n        input.composing.range.clear();\n        input.composing = null;\n      }\n    });\n  };\n\n  TextareaInput.prototype.createField = function (_display) {\n    // Wraps and hides input textarea\n    this.wrapper = hiddenTextarea();\n    // The semihidden textarea that is focused when the editor is\n    // focused, and receives input.\n    this.textarea = this.wrapper.firstChild;\n  };\n\n  TextareaInput.prototype.prepareSelection = function () {\n    // Redraw the selection and/or cursor\n    var cm = this.cm, display = cm.display, doc = cm.doc;\n    var result = prepareSelection(cm);\n\n    // Move the hidden textarea near the cursor to prevent scrolling artifacts\n    if (cm.options.moveInputWithCursor) {\n      var headPos = cursorCoords(cm, doc.sel.primary().head, \"div\");\n      var wrapOff = display.wrapper.getBoundingClientRect(), lineOff = display.lineDiv.getBoundingClientRect();\n      result.teTop = Math.max(0, Math.min(display.wrapper.clientHeight - 10,\n                                          headPos.top + lineOff.top - wrapOff.top));\n      result.teLeft = Math.max(0, Math.min(display.wrapper.clientWidth - 10,\n                                           headPos.left + lineOff.left - wrapOff.left));\n    }\n\n    return result\n  };\n\n  TextareaInput.prototype.showSelection = function (drawn) {\n    var cm = this.cm, display = cm.display;\n    removeChildrenAndAdd(display.cursorDiv, drawn.cursors);\n    removeChildrenAndAdd(display.selectionDiv, drawn.selection);\n    if (drawn.teTop != null) {\n      this.wrapper.style.top = drawn.teTop + \"px\";\n      this.wrapper.style.left = drawn.teLeft + \"px\";\n    }\n  };\n\n  // Reset the input to correspond to the selection (or to be empty,\n  // when not typing and nothing is selected)\n  TextareaInput.prototype.reset = function (typing) {\n    if (this.contextMenuPending || this.composing) { return }\n    var cm = this.cm;\n    if (cm.somethingSelected()) {\n      this.prevInput = \"\";\n      var content = cm.getSelection();\n      this.textarea.value = content;\n      if (cm.state.focused) { selectInput(this.textarea); }\n      if (ie && ie_version >= 9) { this.hasSelection = content; }\n    } else if (!typing) {\n      this.prevInput = this.textarea.value = \"\";\n      if (ie && ie_version >= 9) { this.hasSelection = null; }\n    }\n  };\n\n  TextareaInput.prototype.getField = function () { return this.textarea };\n\n  TextareaInput.prototype.supportsTouch = function () { return false };\n\n  TextareaInput.prototype.focus = function () {\n    if (this.cm.options.readOnly != \"nocursor\" && (!mobile || activeElt() != this.textarea)) {\n      try { this.textarea.focus(); }\n      catch (e) {} // IE8 will throw if the textarea is display: none or not in DOM\n    }\n  };\n\n  TextareaInput.prototype.blur = function () { this.textarea.blur(); };\n\n  TextareaInput.prototype.resetPosition = function () {\n    this.wrapper.style.top = this.wrapper.style.left = 0;\n  };\n\n  TextareaInput.prototype.receivedFocus = function () { this.slowPoll(); };\n\n  // Poll for input changes, using the normal rate of polling. This\n  // runs as long as the editor is focused.\n  TextareaInput.prototype.slowPoll = function () {\n      var this$1 = this;\n\n    if (this.pollingFast) { return }\n    this.polling.set(this.cm.options.pollInterval, function () {\n      this$1.poll();\n      if (this$1.cm.state.focused) { this$1.slowPoll(); }\n    });\n  };\n\n  // When an event has just come in that is likely to add or change\n  // something in the input textarea, we poll faster, to ensure that\n  // the change appears on the screen quickly.\n  TextareaInput.prototype.fastPoll = function () {\n    var missed = false, input = this;\n    input.pollingFast = true;\n    function p() {\n      var changed = input.poll();\n      if (!changed && !missed) {missed = true; input.polling.set(60, p);}\n      else {input.pollingFast = false; input.slowPoll();}\n    }\n    input.polling.set(20, p);\n  };\n\n  // Read input from the textarea, and update the document to match.\n  // When something is selected, it is present in the textarea, and\n  // selected (unless it is huge, in which case a placeholder is\n  // used). When nothing is selected, the cursor sits after previously\n  // seen text (can be empty), which is stored in prevInput (we must\n  // not reset the textarea when typing, because that breaks IME).\n  TextareaInput.prototype.poll = function () {\n      var this$1 = this;\n\n    var cm = this.cm, input = this.textarea, prevInput = this.prevInput;\n    // Since this is called a *lot*, try to bail out as cheaply as\n    // possible when it is clear that nothing happened. hasSelection\n    // will be the case when there is a lot of text in the textarea,\n    // in which case reading its value would be expensive.\n    if (this.contextMenuPending || !cm.state.focused ||\n        (hasSelection(input) && !prevInput && !this.composing) ||\n        cm.isReadOnly() || cm.options.disableInput || cm.state.keySeq)\n      { return false }\n\n    var text = input.value;\n    // If nothing changed, bail.\n    if (text == prevInput && !cm.somethingSelected()) { return false }\n    // Work around nonsensical selection resetting in IE9/10, and\n    // inexplicable appearance of private area unicode characters on\n    // some key combos in Mac (#2689).\n    if (ie && ie_version >= 9 && this.hasSelection === text ||\n        mac && /[\\uf700-\\uf7ff]/.test(text)) {\n      cm.display.input.reset();\n      return false\n    }\n\n    if (cm.doc.sel == cm.display.selForContextMenu) {\n      var first = text.charCodeAt(0);\n      if (first == 0x200b && !prevInput) { prevInput = \"\\u200b\"; }\n      if (first == 0x21da) { this.reset(); return this.cm.execCommand(\"undo\") }\n    }\n    // Find the part of the input that is actually new\n    var same = 0, l = Math.min(prevInput.length, text.length);\n    while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) { ++same; }\n\n    runInOp(cm, function () {\n      applyTextInput(cm, text.slice(same), prevInput.length - same,\n                     null, this$1.composing ? \"*compose\" : null);\n\n      // Don't leave long text in the textarea, since it makes further polling slow\n      if (text.length > 1000 || text.indexOf(\"\\n\") > -1) { input.value = this$1.prevInput = \"\"; }\n      else { this$1.prevInput = text; }\n\n      if (this$1.composing) {\n        this$1.composing.range.clear();\n        this$1.composing.range = cm.markText(this$1.composing.start, cm.getCursor(\"to\"),\n                                           {className: \"CodeMirror-composing\"});\n      }\n    });\n    return true\n  };\n\n  TextareaInput.prototype.ensurePolled = function () {\n    if (this.pollingFast && this.poll()) { this.pollingFast = false; }\n  };\n\n  TextareaInput.prototype.onKeyPress = function () {\n    if (ie && ie_version >= 9) { this.hasSelection = null; }\n    this.fastPoll();\n  };\n\n  TextareaInput.prototype.onContextMenu = function (e) {\n    var input = this, cm = input.cm, display = cm.display, te = input.textarea;\n    if (input.contextMenuPending) { input.contextMenuPending(); }\n    var pos = posFromMouse(cm, e), scrollPos = display.scroller.scrollTop;\n    if (!pos || presto) { return } // Opera is difficult.\n\n    // Reset the current text selection only if the click is done outside of the selection\n    // and 'resetSelectionOnContextMenu' option is true.\n    var reset = cm.options.resetSelectionOnContextMenu;\n    if (reset && cm.doc.sel.contains(pos) == -1)\n      { operation(cm, setSelection)(cm.doc, simpleSelection(pos), sel_dontScroll); }\n\n    var oldCSS = te.style.cssText, oldWrapperCSS = input.wrapper.style.cssText;\n    var wrapperBox = input.wrapper.offsetParent.getBoundingClientRect();\n    input.wrapper.style.cssText = \"position: static\";\n    te.style.cssText = \"position: absolute; width: 30px; height: 30px;\\n      top: \" + (e.clientY - wrapperBox.top - 5) + \"px; left: \" + (e.clientX - wrapperBox.left - 5) + \"px;\\n      z-index: 1000; background: \" + (ie ? \"rgba(255, 255, 255, .05)\" : \"transparent\") + \";\\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);\";\n    var oldScrollY;\n    if (webkit) { oldScrollY = window.scrollY; } // Work around Chrome issue (#2712)\n    display.input.focus();\n    if (webkit) { window.scrollTo(null, oldScrollY); }\n    display.input.reset();\n    // Adds \"Select all\" to context menu in FF\n    if (!cm.somethingSelected()) { te.value = input.prevInput = \" \"; }\n    input.contextMenuPending = rehide;\n    display.selForContextMenu = cm.doc.sel;\n    clearTimeout(display.detectingSelectAll);\n\n    // Select-all will be greyed out if there's nothing to select, so\n    // this adds a zero-width space so that we can later check whether\n    // it got selected.\n    function prepareSelectAllHack() {\n      if (te.selectionStart != null) {\n        var selected = cm.somethingSelected();\n        var extval = \"\\u200b\" + (selected ? te.value : \"\");\n        te.value = \"\\u21da\"; // Used to catch context-menu undo\n        te.value = extval;\n        input.prevInput = selected ? \"\" : \"\\u200b\";\n        te.selectionStart = 1; te.selectionEnd = extval.length;\n        // Re-set this, in case some other handler touched the\n        // selection in the meantime.\n        display.selForContextMenu = cm.doc.sel;\n      }\n    }\n    function rehide() {\n      if (input.contextMenuPending != rehide) { return }\n      input.contextMenuPending = false;\n      input.wrapper.style.cssText = oldWrapperCSS;\n      te.style.cssText = oldCSS;\n      if (ie && ie_version < 9) { display.scrollbars.setScrollTop(display.scroller.scrollTop = scrollPos); }\n\n      // Try to detect the user choosing select-all\n      if (te.selectionStart != null) {\n        if (!ie || (ie && ie_version < 9)) { prepareSelectAllHack(); }\n        var i = 0, poll = function () {\n          if (display.selForContextMenu == cm.doc.sel && te.selectionStart == 0 &&\n              te.selectionEnd > 0 && input.prevInput == \"\\u200b\") {\n            operation(cm, selectAll)(cm);\n          } else if (i++ < 10) {\n            display.detectingSelectAll = setTimeout(poll, 500);\n          } else {\n            display.selForContextMenu = null;\n            display.input.reset();\n          }\n        };\n        display.detectingSelectAll = setTimeout(poll, 200);\n      }\n    }\n\n    if (ie && ie_version >= 9) { prepareSelectAllHack(); }\n    if (captureRightClick) {\n      e_stop(e);\n      var mouseup = function () {\n        off(window, \"mouseup\", mouseup);\n        setTimeout(rehide, 20);\n      };\n      on(window, \"mouseup\", mouseup);\n    } else {\n      setTimeout(rehide, 50);\n    }\n  };\n\n  TextareaInput.prototype.readOnlyChanged = function (val) {\n    if (!val) { this.reset(); }\n    this.textarea.disabled = val == \"nocursor\";\n  };\n\n  TextareaInput.prototype.setUneditable = function () {};\n\n  TextareaInput.prototype.needsContentAttribute = false;\n\n  function fromTextArea(textarea, options) {\n    options = options ? copyObj(options) : {};\n    options.value = textarea.value;\n    if (!options.tabindex && textarea.tabIndex)\n      { options.tabindex = textarea.tabIndex; }\n    if (!options.placeholder && textarea.placeholder)\n      { options.placeholder = textarea.placeholder; }\n    // Set autofocus to true if this textarea is focused, or if it has\n    // autofocus and no other element is focused.\n    if (options.autofocus == null) {\n      var hasFocus = activeElt();\n      options.autofocus = hasFocus == textarea ||\n        textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body;\n    }\n\n    function save() {textarea.value = cm.getValue();}\n\n    var realSubmit;\n    if (textarea.form) {\n      on(textarea.form, \"submit\", save);\n      // Deplorable hack to make the submit method do the right thing.\n      if (!options.leaveSubmitMethodAlone) {\n        var form = textarea.form;\n        realSubmit = form.submit;\n        try {\n          var wrappedSubmit = form.submit = function () {\n            save();\n            form.submit = realSubmit;\n            form.submit();\n            form.submit = wrappedSubmit;\n          };\n        } catch(e) {}\n      }\n    }\n\n    options.finishInit = function (cm) {\n      cm.save = save;\n      cm.getTextArea = function () { return textarea; };\n      cm.toTextArea = function () {\n        cm.toTextArea = isNaN; // Prevent this from being ran twice\n        save();\n        textarea.parentNode.removeChild(cm.getWrapperElement());\n        textarea.style.display = \"\";\n        if (textarea.form) {\n          off(textarea.form, \"submit\", save);\n          if (!options.leaveSubmitMethodAlone && typeof textarea.form.submit == \"function\")\n            { textarea.form.submit = realSubmit; }\n        }\n      };\n    };\n\n    textarea.style.display = \"none\";\n    var cm = CodeMirror(function (node) { return textarea.parentNode.insertBefore(node, textarea.nextSibling); },\n      options);\n    return cm\n  }\n\n  function addLegacyProps(CodeMirror) {\n    CodeMirror.off = off;\n    CodeMirror.on = on;\n    CodeMirror.wheelEventPixels = wheelEventPixels;\n    CodeMirror.Doc = Doc;\n    CodeMirror.splitLines = splitLinesAuto;\n    CodeMirror.countColumn = countColumn;\n    CodeMirror.findColumn = findColumn;\n    CodeMirror.isWordChar = isWordCharBasic;\n    CodeMirror.Pass = Pass;\n    CodeMirror.signal = signal;\n    CodeMirror.Line = Line;\n    CodeMirror.changeEnd = changeEnd;\n    CodeMirror.scrollbarModel = scrollbarModel;\n    CodeMirror.Pos = Pos;\n    CodeMirror.cmpPos = cmp;\n    CodeMirror.modes = modes;\n    CodeMirror.mimeModes = mimeModes;\n    CodeMirror.resolveMode = resolveMode;\n    CodeMirror.getMode = getMode;\n    CodeMirror.modeExtensions = modeExtensions;\n    CodeMirror.extendMode = extendMode;\n    CodeMirror.copyState = copyState;\n    CodeMirror.startState = startState;\n    CodeMirror.innerMode = innerMode;\n    CodeMirror.commands = commands;\n    CodeMirror.keyMap = keyMap;\n    CodeMirror.keyName = keyName;\n    CodeMirror.isModifierKey = isModifierKey;\n    CodeMirror.lookupKey = lookupKey;\n    CodeMirror.normalizeKeyMap = normalizeKeyMap;\n    CodeMirror.StringStream = StringStream;\n    CodeMirror.SharedTextMarker = SharedTextMarker;\n    CodeMirror.TextMarker = TextMarker;\n    CodeMirror.LineWidget = LineWidget;\n    CodeMirror.e_preventDefault = e_preventDefault;\n    CodeMirror.e_stopPropagation = e_stopPropagation;\n    CodeMirror.e_stop = e_stop;\n    CodeMirror.addClass = addClass;\n    CodeMirror.contains = contains;\n    CodeMirror.rmClass = rmClass;\n    CodeMirror.keyNames = keyNames;\n  }\n\n  // EDITOR CONSTRUCTOR\n\n  defineOptions(CodeMirror);\n\n  addEditorMethods(CodeMirror);\n\n  // Set up methods on CodeMirror's prototype to redirect to the editor's document.\n  var dontDelegate = \"iter insert remove copy getEditor constructor\".split(\" \");\n  for (var prop in Doc.prototype) { if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0)\n    { CodeMirror.prototype[prop] = (function(method) {\n      return function() {return method.apply(this.doc, arguments)}\n    })(Doc.prototype[prop]); } }\n\n  eventMixin(Doc);\n  CodeMirror.inputStyles = {\"textarea\": TextareaInput, \"contenteditable\": ContentEditableInput};\n\n  // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n  CodeMirror.defineMode = function(name/*, mode, …*/) {\n    if (!CodeMirror.defaults.mode && name != \"null\") { CodeMirror.defaults.mode = name; }\n    defineMode.apply(this, arguments);\n  };\n\n  CodeMirror.defineMIME = defineMIME;\n\n  // Minimal default mode.\n  CodeMirror.defineMode(\"null\", function () { return ({token: function (stream) { return stream.skipToEnd(); }}); });\n  CodeMirror.defineMIME(\"text/plain\", \"null\");\n\n  // EXTENSIONS\n\n  CodeMirror.defineExtension = function (name, func) {\n    CodeMirror.prototype[name] = func;\n  };\n  CodeMirror.defineDocExtension = function (name, func) {\n    Doc.prototype[name] = func;\n  };\n\n  CodeMirror.fromTextArea = fromTextArea;\n\n  addLegacyProps(CodeMirror);\n\n  CodeMirror.version = \"5.52.2\";\n\n  return CodeMirror;\n\n})));\n"],"sourceRoot":""}